<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MathLingo - A Jornada Matem√°tica</title>

    <script src="https://cdn.tailwindcss.com"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Nunito', 'sans-serif'] },
                    colors: {
                        brand: {
                            green: '#58CC02', greenDark: '#46A302',
                            blue: '#1CB0F6', blueDark: '#1899D6',
                            purple: '#CE82FF', purpleDark: '#A568CC',
                            red: '#FF4B4B', redDark: '#EA2B2B',
                            yellow: '#FFC800', yellowDark: '#E5B400',
                            orange: '#FF9600', orangeDark: '#CC7A00',
                            magenta: '#FF2E93', magentaDark: '#D11873', // NOVA COR
                            text: '#4B4B4B', bg: '#F7F9FA'
                        }
                    },
                    boxShadow: { 'card': '0 4px 0 #E5E5E5', 'btn': '0 4px 0 rgba(0,0,0,0.2)' },
                    animation: {
                        'fade-in': 'fadeIn 0.4s ease-out forwards',
                        'pop-in': 'popIn 0.3s ease-out forwards',
                    },
                    keyframes: {
                        fadeIn: { '0%': { opacity: '0', transform: 'translateY(10px)' }, '100%': { opacity: '1', transform: 'translateY(0)' } },
                        popIn: { '0%': { transform: 'scale(0)' }, '80%': { transform: 'scale(1.1)' }, '100%': { transform: 'scale(1)' } }
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #F7F9FA;
            color: #4B4B4B;
            -webkit-tap-highlight-color: transparent;
        }

        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* Classes utilit√°rias para widgets */
        .btn-game {
            transition: all 0.1s;
            border-bottom-width: 4px;
        }

        .btn-game:active {
            transform: translateY(4px);
            border-bottom-width: 0;
        }

        /* Estilos de conte√∫do */
        .lesson-content h3 {
            color: #1CB0F6;
            font-weight: 800;
            font-size: 1.5rem;
            margin-top: 2rem;
            margin-bottom: 1rem;
        }

        .lesson-content p {
            margin-bottom: 1rem;
            line-height: 1.6;
            font-size: 1.1rem;
        }

        .lesson-content ul,
        .lesson-content ol {
            margin-bottom: 1rem;
            padding-left: 1.5rem;
        }

        .lesson-content li {
            margin-bottom: 0.5rem;
        }

        /* Slider customizado */
        input[type=range] {
            accent-color: currentColor;
        }
    </style>
</head>

<body class="h-screen flex flex-col overflow-hidden font-sans">

    <header
        class="bg-white border-b-2 border-gray-200 h-16 md:h-20 flex items-center justify-between px-4 md:px-8 z-50 shrink-0">
        <div class="flex items-center gap-4">
            <button id="btn-back" class="hidden text-gray-400 hover:bg-gray-100 p-2 rounded-xl transition-colors"
                onclick="app.goBack()">
                <i class="fas fa-chevron-left text-2xl"></i>
            </button>
            <div id="logo-area" class="flex items-center gap-3 cursor-pointer" onclick="app.navigate('home')">
                <div class="w-10 h-10 bg-brand-green rounded-xl relative overflow-hidden shadow-sm">
                    <div class="absolute top-1 left-1 w-3 h-3 bg-white rounded-full opacity-40"></div>
                    <div class="absolute bottom-1 right-1 w-4 h-4 bg-brand-greenDark rounded-full"></div>
                </div>
                <h1 class="text-2xl font-extrabold text-brand-green tracking-tight hidden md:block">MathLingo</h1>
            </div>
        </div>

        <div class="flex items-center gap-4 font-bold text-gray-400">
            <div class="hidden md:flex items-center gap-2 text-brand-red bg-red-50 px-3 py-1 rounded-xl">
                <i class="fas fa-fire animate-pulse"></i> <span>50</span>
            </div>
            <div class="flex items-center gap-2 text-brand-blue bg-blue-50 px-3 py-1 rounded-xl">
                <i class="fas fa-gem"></i> <span>3200</span>
            </div>
        </div>
    </header>

    <main id="main-container" class="flex-1 overflow-y-auto no-scrollbar p-4 w-full max-w-5xl mx-auto relative">
    </main>

    <script>
        // --- TEMAS POR N√çVEL ---
        const LEVEL_THEMES = {
            // Fundamental
            "6¬∫ Ano": { main: 'bg-[#58cc02]', text: 'text-[#58cc02]', border: 'border-[#58cc02]', borderDark: 'border-[#46a302]', light: 'bg-green-50', ring: 'ring-green-100', gradient: 'from-green-400 to-green-600' },
            "7¬∫ Ano": { main: 'bg-[#1cb0f6]', text: 'text-[#1cb0f6]', border: 'border-[#1cb0f6]', borderDark: 'border-[#1899d6]', light: 'bg-blue-50', ring: 'ring-blue-100', gradient: 'from-blue-400 to-blue-600' },
            "8¬∫ Ano": { main: 'bg-[#ce82ff]', text: 'text-[#ce82ff]', border: 'border-[#ce82ff]', borderDark: 'border-[#a568cc]', light: 'bg-purple-50', ring: 'ring-purple-100', gradient: 'from-purple-400 to-purple-600' },
            "9¬∫ Ano": { main: 'bg-[#ff4b4b]', text: 'text-[#ff4b4b]', border: 'border-[#ff4b4b]', borderDark: 'border-[#ea2b2b]', light: 'bg-red-50', ring: 'ring-red-100', gradient: 'from-red-400 to-red-600' },
            // Ensino M√©dio 
            "1¬∫ Ano do Ensino M√©dio": { main: 'bg-[#FF9600]', text: 'text-[#FF9600]', border: 'border-[#FF9600]', borderDark: 'border-[#CC7A00]', light: 'bg-orange-50', ring: 'ring-orange-100', gradient: 'from-orange-400 to-orange-600' },
            "2¬∫ Ano do Ensino M√©dio": { main: 'bg-[#FFC800]', text: 'text-[#E5B400]', border: 'border-[#FFC800]', borderDark: 'border-[#E5B400]', light: 'bg-yellow-50', ring: 'ring-yellow-100', gradient: 'from-yellow-400 to-yellow-600' },
            "3¬∫ Ano do Ensino M√©dio": { main: 'bg-[#FF2E93]', text: 'text-[#FF2E93]', border: 'border-[#FF2E93]', borderDark: 'border-[#D11873]', light: 'bg-pink-50', ring: 'ring-pink-100', gradient: 'from-pink-400 to-pink-600' }
        };
        // 1. ESTRUTURA CURRICULAR
        const CURRICULO = {
            "6¬∫ Ano": {
                "Unidade 1: N√∫meros Naturais e Sentido Num√©rico": [
                    "Origem e Sistemas Num√©ricos",
                    "A Reta Num√©rica e Ordem",
                    "Estimativa e Arredondamento (Sentido Num√©rico)",
                    "Adi√ß√£o e Subtra√ß√£o",
                    "Multiplica√ß√£o e Divis√£o",
                    "Potencia√ß√£o e Raiz Quadrada",
                    "Express√µes Num√©ricas e Hierarquia"
                ],
                "Unidade 2: √Ålgebra: O In√≠cio": [
                    "Igualdade e Valor Desconhecido",
                    "Propriedades da Igualdade (Balan√ßa)",
                    "Problemas de Partilha Desigual"
                ],
                "Unidade 3: Geometria: Formas e Localiza√ß√£o": [
                    "Entes Geom√©tricos: Ponto, Reta e Plano",
                    "Localiza√ß√£o no Plano Cartesiano", // * 
                    "√Çngulos: Classifica√ß√£o e Medida",
                    "Pol√≠gonos: Tri√¢ngulos e Quadril√°teros",
                    "Amplia√ß√£o e Redu√ß√£o em Malhas",
                    "Ferramentas Geom√©tricas",
                    "S√≥lidos Geom√©tricos: Poliedros e Corpos Redondos"
                ],
                "Unidade 4: Divisibilidade e Pensamento Algor√≠tmico": [
                    "M√∫ltiplos e Divisores",
                    "L√≥gica de Fluxogramas (Algoritmos)",
                    "Crit√©rios de Divisibilidade",
                    "N√∫meros Primos e Compostos",
                    "Fatora√ß√£o, MMC e MDC"
                ],
                "Unidade 5: O Mundo Racional (Fra√ß√µes e Decimais)": [
                    "Conceito de Fra√ß√£o",
                    "Fra√ß√µes Equivalentes e Simplifica√ß√£o",
                    "Fra√ß√£o de uma Quantidade (O Operador)",
                    "Opera√ß√µes com Fra√ß√µes (Soma e Subtra√ß√£o)",
                    "Opera√ß√µes com Fra√ß√µes (Mult. e Divis√£o)",
                    "Conex√£o: Fra√ß√£o vira Decimal",
                    "N√∫meros Decimais e Sistema Monet√°rio",
                    "Opera√ß√µes com Decimais",
                    "Porcentagem B√°sica"
                ],
                "Unidade 6: Grandezas e Medidas": [
                    "Comprimento e Per√≠metro",
                    "√Årea de Figuras Planas",
                    "Investigando √Årea vs Per√≠metro",
                    "Volume e Capacidade",
                    "Tempo e suas Convers√µes",
                    "Plantas Baixas e Vistas A√©reas"
                ],
                "Unidade 7: Estat√≠stica e Probabilidade": [
                    "Lendo Gr√°ficos e Tabelas",
                    "Tipos de Vari√°veis e Pesquisa",
                    "Introdu√ß√£o √† Probabilidade"
                ]
            },
            "7¬∫ Ano": {
                "Unidade 1: N√∫meros Inteiros (Z)": [
                    "N√∫meros Inteiros e Reta Num√©rica",
                    "Adi√ß√£o e Subtra√ß√£o em Z",
                    "Multiplica√ß√£o e Divis√£o em Z",
                    "Potencia√ß√£o e Raiz Quadrada em Z",
                    "Express√µes Num√©ricas em Z"
                ],
                "Unidade 2: N√∫meros Racionais (Q)": [
                    "O Conjunto Q: Fra√ß√£o e Decimal",
                    "Adi√ß√£o e Subtra√ß√£o em Q",
                    "Multiplica√ß√£o e Divis√£o em Q",
                    "Potencia√ß√£o e Raiz em Q",
                    "Express√µes com Racionais"
                ],
                "Unidade 3: Inicia√ß√£o √† √Ålgebra": [
                    "Vari√°veis e Express√µes Alg√©bricas",
                    "Valor Num√©rico de uma Express√£o",
                    "Opera√ß√µes com Mon√¥mios (Intro)",
                    "Equa√ß√µes do 1¬∫ Grau",
                    "Resolu√ß√£o de Problemas com Equa√ß√µes",
                    "Inequa√ß√µes do 1¬∫ Grau"
                ],
                "Unidade 4: Grandezas Proporcionais": [
                    "Raz√£o e Propor√ß√£o",
                    "Grandezas Diretamente Proporcionais",
                    "Grandezas Inversamente Proporcionais",
                    "Regra de Tr√™s Simples",
                    "Porcentagem e Juros Simples"
                ],
                "Unidade 5: Geometria Plana": [
                    "√Çngulos: Medidas e Opera√ß√µes",
                    "Retas Paralelas e Transversais",
                    "Tri√¢ngulos: Soma dos √Çngulos e Classifica√ß√£o",
                    "Pol√≠gonos: Diagonais e √Çngulos Internos",
                    "Simetria e Transforma√ß√µes"
                ],
                "Unidade 6: Tratamento da Informa√ß√£o": [
                    "M√©dia Aritm√©tica e Amplitude",
                    "Gr√°ficos de Setores e Barras"
                ]
            },
            "8¬∫ Ano": {
                "Unidade 1: Potencia√ß√£o e Reais": [
                    "Pot√™ncia com Expoente Inteiro",
                    "Nota√ß√£o Cient√≠fica",
                    "Ra√≠zes e N√∫meros Irracionais",
                    "O Conjunto dos N√∫meros Reais (R)"
                ],
                "Unidade 2: C√°lculo Alg√©brico (Parte 1)": [
                    "Mon√¥mios e Polin√¥mios",
                    "Opera√ß√µes com Polin√¥mios",
                    "Produtos Not√°veis (O Quadrado da Soma/Diferen√ßa)",
                    "Produto da Soma pela Diferen√ßa"
                ],
                "Unidade 3: C√°lculo Alg√©brico (Parte 2)": [
                    "Fatora√ß√£o: Fator Comum e Agrupamento",
                    "Fatora√ß√£o: Trin√¥mio Quadrado Perfeito",
                    "Fra√ß√µes Alg√©bricas e MMC de Polin√¥mios"
                ],
                "Unidade 4: Equa√ß√µes e Sistemas": [
                    "Sistemas de Equa√ß√µes do 1¬∫ Grau",
                    "Resolu√ß√£o por Adi√ß√£o e Substitui√ß√£o",
                    "Problemas Envolvendo Sistemas"
                ],
                "Unidade 5: Geometria Plana": [
                    "√Çngulos em Pol√≠gonos e Diagonais",
                    "Tri√¢ngulos: Casos de Congru√™ncia",
                    "Quadril√°teros Not√°veis",
                    "C√≠rculo e Circunfer√™ncia (√Årea e Comprimento)"
                ],
                "Unidade 6: Estat√≠stica e Probabilidade": [
                    "M√©dia, Moda e Mediana",
                    "Gr√°ficos e Pesquisas Censit√°rias",
                    "Princ√≠pio da Contagem (Revis√£o)"
                ]
            },
            "9¬∫ Ano": {
                "Unidade 1: Radicia√ß√£o e Potencia√ß√£o Real": [
                    "Propriedades dos Radicais",
                    "Opera√ß√µes com Radicais (Soma e Produto)",
                    "Racionaliza√ß√£o de Denominadores",
                    "Pot√™ncia com Expoente Fracion√°rio",
                    "Nota√ß√£o Cient√≠fica (Aprofundamento)"
                ],
                "Unidade 2: Equa√ß√µes do 2¬∫ Grau": [
                    "Conceito e Coeficientes (a, b, c)",
                    "Equa√ß√µes Incompletas",
                    "F√≥rmula de Bh√°skara (Completa)",
                    "Rela√ß√£o Soma e Produto",
                    "Sistemas de Equa√ß√µes do 2¬∫ Grau"
                ],
                "Unidade 3: Introdu√ß√£o √†s Fun√ß√µes": [
                    "No√ß√£o de Fun√ß√£o (Dom√≠nio e Imagem)",
                    "Fun√ß√£o Afim (1¬∫ Grau): Gr√°fico e Zero",
                    "Fun√ß√£o Quadr√°tica (2¬∫ Grau): Par√°bola e V√©rtice"
                ],
                "Unidade 4: Geometria: Semelhan√ßa": [
                    "Raz√£o e Propor√ß√£o em Segmentos",
                    "Teorema de Tales",
                    "Semelhan√ßa de Tri√¢ngulos",
                    "Rela√ß√µes M√©tricas no Tri√¢ngulo Ret√¢ngulo"
                ],
                "Unidade 5: Geometria: Trigonometria e C√≠rculo": [
                    "Teorema de Pit√°goras (Revis√£o Aprofundada)",
                    "Trigonometria (Seno, Cosseno, Tangente)",
                    "Rela√ß√µes M√©tricas na Circunfer√™ncia",
                    "√Årea de Setores Circulares e Coroas"
                ],
                "Unidade 6: Probabilidade e Estat√≠stica": [
                    "Probabilidade de Eventos Independentes",
                    "An√°lise de Gr√°ficos Complexos (Histogramas)"
                ]
            },
            "1¬∫ Ano do Ensino M√©dio": {
                "Unidade 1: Conjuntos e N√∫meros": [
                    "No√ß√µes de Conjuntos e Opera√ß√µes",
                    "Conjuntos Num√©ricos (N, Z, Q, I, R)",
                    "Intervalos Reais",
                    "M√≥dulos e Desigualdades"
                ],
                "Unidade 2: Introdu√ß√£o √†s Fun√ß√µes": [
                    "Conceito de Fun√ß√£o e Gr√°ficos",
                    "Fun√ß√£o Afim (1¬∫ Grau): Estudo Completo",
                    "Fun√ß√£o Quadr√°tica (2¬∫ Grau): Estudo Completo",
                    "Fun√ß√£o Modular"
                ],
                "Unidade 3: Fun√ß√µes Exponencial e Logar√≠tmica": [
                    "Potencia√ß√£o e Fun√ß√£o Exponencial",
                    "Equa√ß√µes e Inequa√ß√µes Exponenciais",
                    "Logaritmos: Defini√ß√£o e Propriedades",
                    "Fun√ß√£o Logar√≠tmica e Equa√ß√µes"
                ],
                "Unidade 4: Sequ√™ncias e Financeira": [
                    "Progress√£o Aritm√©tica (PA)",
                    "Progress√£o Geom√©trica (PG)",
                    "Porcentagem, Juros Simples e Compostos"
                ],
                "Unidade 5: Geometria Plana Aprofundada": [
                    "Semelhan√ßa e Rela√ß√µes M√©tricas",
                    "Pol√≠gonos Regulares",
                    "√Åreas de Figuras Planas"
                ]
            },
            "2¬∫ Ano do Ensino M√©dio": {
                "Unidade 1: Trigonometria": [
                    "Ciclo Trigonom√©trico: Arcos e √Çngulos",
                    "Fun√ß√µes Trigonom√©tricas (Seno, Cosseno, Tangente)",
                    "Rela√ß√µes Fundamentais e Identidades",
                    "Transforma√ß√µes (Soma e Diferen√ßa)"
                ],
                "Unidade 2: Matrizes e Determinantes": [
                    "Matrizes: Conceitos e Opera√ß√µes",
                    "Determinantes e Propriedades",
                    "Matriz Inversa"
                ],
                "Unidade 3: Sistemas Lineares": [
                    "Classifica√ß√£o e Discuss√£o",
                    "Escalonamento de Sistemas"
                ],
                "Unidade 4: An√°lise Combinat√≥ria": [
                    "Princ√≠pio Fundamental da Contagem",
                    "Fatorial, Arranjos e Permuta√ß√µes",
                    "Combina√ß√µes Simples"
                ],
                "Unidade 5: Probabilidade": [
                    "Defini√ß√£o e Espa√ßo Amostral",
                    "Probabilidade Condicional e Eventos Independentes"
                ],
                "Unidade 6: Geometria Espacial": [
                    "Poliedros e Rela√ß√£o de Euler",
                    "Prismas e Cilindros (√Årea e Volume)",
                    "Pir√¢mides e Cones (√Årea e Volume)",
                    "Esfera (√Årea e Volume)"
                ]
            },
            "3¬∫ Ano do Ensino M√©dio": {
                "Unidade 1: Geometria Anal√≠tica (Reta)": [
                    "Ponto: Dist√¢ncia e Ponto M√©dio",
                    "Estudo da Reta: Equa√ß√µes e Posi√ß√µes",
                    "Dist√¢ncia de Ponto a Reta"
                ],
                "Unidade 2: Geometria Anal√≠tica (C√¥nicas)": [
                    "Equa√ß√£o da Circunfer√™ncia",
                    "Introdu√ß√£o a Elipse, Hip√©rbole e Par√°bola"
                ],
                "Unidade 3: N√∫meros Complexos": [
                    "Forma Alg√©brica e Opera√ß√µes",
                    "Plano de Argand-Gauss",
                    "Forma Trigonom√©trica"
                ],
                "Unidade 4: Polin√¥mios": [
                    "Polin√¥mios: Grau e Opera√ß√µes",
                    "Equa√ß√µes Polinomiais e Briot-Ruffini",
                    "Rela√ß√µes de Girard"
                ],
                "Unidade 5: Estat√≠stica": [
                    "Medidas de Tend√™ncia Central",
                    "Medidas de Dispers√£o (Vari√¢ncia e Desvio Padr√£o)",
                    "empty"
                ]
            }
        };
        // 2. CONTE√öDO DA TEORIA (COMPLETO)
        const CONTEUDO_TEORIA = {
            //
            // SEXTO ANO
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //

            // === 6¬∫ ANO: Aritm√©tica ===
            "Origem e Sistemas Num√©ricos": `
    <h3>1. A Primeira Tecnologia Humana ü¶¥</h3>
    <p>Antes de inventar a roda ou o fogo, o ser humano precisou inventar o <strong>N√∫mero</strong>. Sem isso, n√£o existiria com√©rcio, constru√ß√£o ou calend√°rios.</p>
    
    <div class="bg-gray-50 p-4 rounded-xl border-l-4 border-gray-500 my-4">
        <h4 class="font-bold text-gray-700">üêë O Problema das Ovelhas (Correspond√™ncia Biun√≠voca)</h4>
        <p class="text-sm mt-1">Imagine um pastor h√° 10.000 anos. Ele n√£o sabia falar "quarenta e dois". Para controlar o rebanho, ele usava uma pedra para cada ovelha.</p>
        <ul class="list-none mt-2 text-sm font-mono text-gray-600">
            <li>Saiu ovelha ‚û° P√µe pedra no saco.</li>
            <li>Voltou ovelha ‚û° Tira pedra do saco.</li>
            <li>Sobrou pedra? ‚û° O lobo comeu uma ovelha!</li>
        </ul>
    </div>

    <h3>2. A Guerra dos Sistemas ‚öîÔ∏è</h3>
    <p>Conforme as cidades cresciam, carregar sacos de pedras ficou imposs√≠vel. As civiliza√ß√µes criaram seus pr√≥prios "c√≥digos" para representar quantidades.</p>

    <div class="space-y-6 mt-4">
        
        <div class="relative bg-yellow-50 p-4 rounded-xl border-2 border-yellow-200">
            <div class="absolute -top-3 left-4 bg-yellow-200 text-yellow-800 text-xs font-bold px-2 py-1 rounded">3.000 a.C.</div>
            <h4 class="font-bold text-brand-text mt-2">üá™üá¨ Sistema Eg√≠pcio: O Amontoado</h4>
            <p class="text-sm text-gray-700">Eles usavam desenhos (hier√≥glifos) para 1, 10, 100, 1000...</p>
            
            <div class="grid grid-cols-2 gap-4 mt-3 text-sm">
                <div>
                    <strong>Como funciona:</strong><br>
                    √â <strong>Aditivo</strong>. Voc√™ desenha os s√≠mbolos e soma tudo. A ordem n√£o importa (uma bagun√ßa!).
                </div>
                <div class="bg-white p-2 rounded border border-yellow-300 text-center">
                    <span class="text-xs text-gray-400">Para escrever 999:</span><br>
                    <strong>Voc√™ precisa desenhar 27 s√≠mbolos!</strong> üò±<br>
                    (9 cordas, 9 calcanhares, 9 bast√µes)
                </div>
            </div>
            <div class="mt-2 text-xs text-red-500 font-bold">üö´ Defeito: N√£o √© posicional. √â dif√≠cil escrever n√∫meros grandes.</div>
        </div>

        <div class="relative bg-red-50 p-4 rounded-xl border-2 border-red-200">
            <div class="absolute -top-3 left-4 bg-red-200 text-red-800 text-xs font-bold px-2 py-1 rounded">Imp√©rio Romano</div>
            <h4 class="font-bold text-brand-text mt-2">üèõÔ∏è Sistema Romano: A L√≥gica R√≠gida</h4>
            <p class="text-sm text-gray-700">Usavam letras: I, V, X, L, C, D, M.</p>
            
            <div class="mt-3 text-sm">
                <strong>A Inova√ß√£o:</strong> Eles criaram a <strong>Subtra√ß√£o</strong> na escrita.<br>
                VI = 6 (5 + 1) <span class="text-gray-400">|</span> IV = 4 (5 - 1).
            </div>

            <div class="bg-white p-3 rounded mt-3 border border-red-100 shadow-sm">
                <p class="text-xs font-bold text-brand-text mb-1">üß† Desafio Mental:</p>
                <p class="text-sm">Tente calcular <strong>CXIV $\\times$ XLII</strong> sem converter para o nosso sistema.</p>
                <p class="text-brand-red font-black mt-1">√â quase imposs√≠vel!</p>
            </div>
            <div class="mt-2 text-xs text-red-500 font-bold">üö´ Defeito: N√£o tem ZERO. P√©ssimo para fazer contas.</div>
        </div>

        <div class="relative bg-green-50 p-4 rounded-xl border-2 border-green-200">
            <div class="absolute -top-3 left-4 bg-green-200 text-green-800 text-xs font-bold px-2 py-1 rounded">Am√©rica Central</div>
            <h4 class="font-bold text-brand-text mt-2">üåΩ Sistema Maia: Os G√™nios Esquecidos</h4>
            <p class="text-sm text-gray-700">Enquanto os romanos sofriam, os Maias j√° tinham inventado o <strong>ZERO</strong> (uma concha)!</p>
            
            <ul class="list-disc list-inside mt-2 text-sm text-gray-600">
                <li><strong>Base 20:</strong> Contavam os dedos das m√£os e dos p√©s.</li>
                <li><strong>Posicional:</strong> O valor mudava dependendo da altura do s√≠mbolo.</li>
            </ul>
            <div class="mt-2 text-xs text-brand-green font-bold">‚úÖ Vantagem: Tinham o Zero e valor posicional!</div>
        </div>

    </div>

    <h3>3. Por que estudamos "coisas velhas"? ü§î</h3>
    <p>Voc√™ pode pensar: <em>"Pra que aprender n√∫mero romano se eu n√£o sou um gladiador?"</em>. Aqui est√£o os motivos reais:</p>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 my-4">
        <div class="bg-white p-3 rounded-xl border-l-4 border-brand-blue shadow-sm">
            <strong class="text-brand-blue block mb-1">1. Para Valorizar o Zero</strong>
            <p class="text-xs text-gray-600">S√≥ estudando os sistemas falhos (como o Eg√≠pcio) entendemos a genialidade do nosso sistema. O Zero permite escrever n√∫meros gigantes (como 1.000.000) usando pouco espa√ßo.</p>
        </div>
        
        <div class="bg-white p-3 rounded-xl border-l-4 border-brand-purple shadow-sm">
            <strong class="text-brand-purple block mb-1">2. O Mundo n√£o √© s√≥ Base 10</strong>
            <p class="text-xs text-gray-600">
                Estudar os Maias (Base 20) nos prepara para entender:
                <br>‚Ä¢ <strong>Computadores:</strong> Usam Base 2 (Bin√°rio).
                <br>‚Ä¢ <strong>Rel√≥gios:</strong> Usam Base 60 (Sexagesimal, heran√ßa dos Babil√¥nios).
            </p>
        </div>
    </div>

    <h3>4. O Campe√£o: Sistema Indo-Ar√°bico üèÜ</h3>
    <p>Nascido na √çndia e divulgado pelos √Årabes, √© o sistema perfeito porque usa apenas 10 s√≠mbolos (0 a 9) para escrever <strong>qualquer n√∫mero do universo</strong>.</p>

    <div class="bg-gray-800 text-white p-4 rounded-xl text-center mt-4">
        <p class="text-sm uppercase tracking-widest font-bold text-gray-400 mb-2">O Segredo do Sucesso</p>
        <div class="text-2xl font-mono">Valor Posicional</div>
        <p class="text-xs mt-2 text-gray-300">O "3" em <strong>3</strong>00 vale cem vezes mais que o "3" em <strong>3</strong>.</p>
    </div>

    <h3>5. O Endere√ßo dos N√∫meros üèòÔ∏è</h3>
    <p>Tente ler este n√∫mero r√°pido: <strong>23849281</strong>.</p>
    <p>Dif√≠cil, n√©? Agora tente este: <strong>23 849 281</strong>.</p>
    
    <p>Muito melhor! Na matem√°tica, para n√£o nos perdermos em n√∫meros gigantes, n√≥s organizamos os algarismos em <strong>Ordens</strong> e <strong>Classes</strong>. √â como organizar um condom√≠nio.</p>

    <div class="bg-white p-4 rounded-xl border-l-4 border-brand-blue shadow-sm my-4">
        <h4 class="font-bold text-brand-blue mb-2">ü™ë 1. As Ordens (O Lugar Individual)</h4>
        <p class="text-sm text-gray-600">Cada d√≠gito senta em uma cadeira numerada. A contagem come√ßa sempre da <strong>DIREITA para a ESQUERDA</strong>.</p>
        <ul class="list-none mt-2 text-sm font-mono text-gray-500">
            <li>1¬™ Ordem: Unidade</li>
            <li>2¬™ Ordem: Dezena</li>
            <li>3¬™ Ordem: Centena</li>
            <li>4¬™ Ordem: Unidade de Milhar...</li>
        </ul>
    </div>

    <div class="bg-white p-4 rounded-xl border-l-4 border-brand-purple shadow-sm my-4">
        <h4 class="font-bold text-brand-purple mb-2">üè¢ 2. As Classes (Os Apartamentos)</h4>
        <p class="text-sm text-gray-600">A cada <strong>3 Ordens</strong>, formamos uma Classe. O espa√ßo ( ) que usamos nos n√∫meros serve justamente para separar esses apartamentos.</p>
        
        <div class="grid grid-cols-3 gap-2 mt-3 text-center text-xs font-bold uppercase">
            <div class="bg-green-100 text-green-800 p-2 rounded">Classe das<br>Unidades</div>
            <div class="bg-blue-100 text-blue-800 p-2 rounded">Classe dos<br>Milhares</div>
            <div class="bg-orange-100 text-orange-800 p-2 rounded">Classe dos<br>Milh√µes</div>
        </div>
    </div>

    <p>Dentro de <strong>TODA</strong> classe, a regra se repete: Unidade, Dezena, Centena. S√≥ muda o sobrenome!</p>

    [WIDGET:interactive_class_order_explorer]

    <div class="bg-red-50 p-4 rounded-xl border-l-4 border-brand-red mt-6 text-sm shadow-sm">
        <strong class="text-brand-red flex items-center gap-2"><i class="fas fa-exclamation-triangle"></i> Regra de Ouro:</strong>
        <p class="mt-1">Sempre comece a analisar o n√∫mero pelo <strong>FINAL</strong> (pelas unidades simples). Se voc√™ come√ßar pelo come√ßo, pode errar a ordem!</p>
    </div>

    [WIDGET:interactive_place_value_extended]

    <h3>6. O Conjunto dos N√∫meros Naturais ($\\mathbb{N}$)</h3>
    <p>Quando organizamos esses n√∫meros de contagem em uma fila infinita, criamos o conjunto dos Naturais:</p>
    <div class="text-center text-xl font-mono font-bold my-4 bg-gray-100 p-2 rounded">
        ‚Ñï = { 0, 1, 2, 3, 4, ... }
    </div>

<p>Uma das propriedades mais importantes dos n√∫meros naturais ($\\mathbb{N}$) √© possuir sempre um sucessor, ou seja, um n√∫mero que √© o pr√≥ximo, e um antescessor, ou seja, um n√∫mero que veio antes.</p>

<p>Portanto, observando o conjunto dos n√∫meros $\\mathb{N}$ √© muito facil dizer se um n√∫mero √© maior que o outro simplesmente sabendo se ele est√° antes (sendo o anterior, ou seja o sucessor) ou depois (sendo o pr√≥ximo, ou seja, o sucessor) do n√∫mero em quest√£o que estamos comparando.</p>

<p>Assim, todo n√∫mero natural tem um vizinho da frente ($n+1$) e um vizinho de tr√°s($n-1$).</p>

<p>Vamos pegar o $15$ como exemplo base.</p>

    <div class="flex items-center justify-center gap-2 my-6 font-mono">
        <div class="flex flex-col items-center">
            <div class="bg-orange-100 text-brand-orange p-3 rounded-lg border-2 border-orange-200 font-bold text-xl shadow-sm">14</div>
            <span class="text-[10px] font-bold uppercase mt-2 text-gray-400">Antecessor</span>
            <span class="text-[10px] text-brand-orange font-bold">(-1)</span>
        </div>

        <div class="text-2xl text-gray-300">‚Üê</div>

        <div class="flex flex-col items-center transform scale-110">
            <div class="bg-brand-blue text-white p-4 rounded-xl font-black text-3xl shadow-lg z-10">15</div>
            <span class="text-xs font-bold uppercase mt-2 text-brand-blue">N√∫mero</span>
        </div>

        <div class="text-2xl text-gray-300">‚Üí</div>

        <div class="flex flex-col items-center">
            <div class="bg-green-100 text-brand-green p-3 rounded-lg border-2 border-green-200 font-bold text-xl shadow-sm">16</div>
            <span class="text-[10px] font-bold uppercase mt-2 text-gray-400">Sucessor</span>
            <span class="text-[10px] text-brand-green font-bold">(+1)</span>
        </div>
    </div>

<p>Assim ent√£o sabemos que o $15$ √© MAIOR que o $14$ e tamb√©m que o $15$ √© MENOR que o $16$. Com isso tamb√©m sabemos que o $14$ √© MENOR que o $16$. Note que o $14$ n√£o √© um Antescessor direto do $16$, mas √© o antescessor de um antescessor de $16$, ou seja, podemos usar a ideia at√© o n√∫mero $0$ quando trabalhamos com antescessor e para o sucessor podemos usar essa mesma ideia, mas nunca vamos parar de encontrar sucessores, isso por que o conjunto $\\mathbb{N}$ n√£o tem fim. Por hora vamos dizer que ele √© INFINITO (+$\\infty$).</p>

    <div class="bg-yellow-50 p-4 rounded-xl border-l-4 border-brand-yellow mt-6 text-sm shadow-sm">
        <h4 class="font-bold text-yellow-700 mb-1 flex items-center gap-2"><i class="fas fa-exclamation-triangle"></i> A Exce√ß√£o do Zero</h4>
        <p>Nos N√∫meros Naturais ($\\mathbb{N}$), o <strong>Zero</strong> √© o √∫nico que n√£o tem antecessor. Ele √© o in√≠cio da estrada!</p>
        <p class="text-xs text-gray-500 mt-1">*(O antecessor dele seria o -1, mas ele mora em outro conjunto, os Inteiros, que veremos no 7¬∫ ano).*</p>
    </div>
`,
            "A Reta Num√©rica e Ordem": `


            <h3>1. A Estrada dos N√∫meros üõ£Ô∏è</h3>
    <p>Imagine uma estrada que tem come√ßo (no zero), mas n√£o tem fim. Cada n√∫mero tem sua "casa" fixa nela, sempre √† mesma dist√¢ncia um do outro. Isso √© a <strong>Reta Num√©rica</strong>.</p>
    
    <div class="relative h-16 w-full max-w-md mx-auto my-8 flex items-end select-none">
        <div class="absolute bottom-0 left-2 right-0 border-b-4 border-gray-400"></div>
        
        <div class="absolute right-0 bottom-[-8px] text-2xl text-gray-400">‚û§</div>

        <div class="absolute left-0 bottom-0 flex flex-col items-center" style="left: 5%">
            <div class="h-4 w-1 bg-brand-text"></div>
            <span class="font-bold text-lg mt-1">0</span>
        </div>
        <div class="absolute bottom-0 flex flex-col items-center" style="left: 20%">
            <div class="h-3 w-0.5 bg-gray-400"></div>
            <span class="font-bold text-sm mt-1 text-gray-500">1</span>
        </div>
        <div class="absolute bottom-0 flex flex-col items-center" style="left: 35%">
            <div class="h-3 w-0.5 bg-gray-400"></div>
            <span class="font-bold text-sm mt-1 text-gray-500">2</span>
        </div>
        <div class="absolute bottom-0 flex flex-col items-center" style="left: 50%">
            <div class="h-3 w-0.5 bg-gray-400"></div>
            <span class="font-bold text-sm mt-1 text-gray-500">3</span>
        </div>
        <div class="absolute bottom-0 flex flex-col items-center" style="left: 65%">
            <div class="h-3 w-0.5 bg-gray-400"></div>
            <span class="font-bold text-sm mt-1 text-gray-500">4</span>
        </div>
        <div class="absolute bottom-0 flex flex-col items-center" style="left: 80%">
            <div class="h-3 w-0.5 bg-gray-400"></div>
            <span class="font-bold text-sm mt-1 text-gray-500">5</span>
        </div>
        
        <div class="absolute top-0 left-1/4 right-0 border-t-2 border-dashed border-brand-blue h-full pointer-events-none opacity-30"></div>
        <div class="absolute top-[-10px] right-10 text-xs font-bold text-brand-blue uppercase tracking-widest">Cresce para l√° ‚ûú</div>
    </div>

    <div class="bg-blue-50 p-3 rounded-lg border-l-4 border-brand-blue text-sm text-center">
        <strong>Regra de Ouro:</strong><br>
        Na reta, quem est√° √† <strong>DIREITA</strong> √© sempre <strong>MAIOR</strong>.
    </div>

<h3>2. A Arte de Comparar ‚öñÔ∏è</h3>
    <p>Por que precisamos saber quem √© maior ou menor? Porque a vida √© feita de compara√ß√µes!</p>
    <ul class="list-disc list-inside text-sm text-gray-700 space-y-1 bg-gray-50 p-3 rounded-lg border border-gray-200 mb-4">
        <li>üí∞ <strong>Dinheiro:</strong> R\$ 50,00 √© melhor que R\$ 20,00?</li>
        <li>üå°Ô∏è <strong>Sa√∫de:</strong> 39¬∞C de febre √© mais perigoso que 37¬∞C?</li>
        <li>üéÆ <strong>Games:</strong> O N√≠vel 10 √© mais dif√≠cil que o N√≠vel 5?</li>
    </ul>

    <p>Para escrever essas compara√ß√µes sem usar palavras, os matem√°ticos criaram tr√™s s√≠mbolos oficiais:</p>

    <div class="grid grid-cols-1 gap-3 my-4">
        <div class="flex items-center bg-white p-3 rounded-xl border-l-4 border-brand-blue shadow-sm">
            <div class="text-4xl font-black text-brand-blue w-16 text-center">></div>
            <div class="pl-4 border-l border-gray-200">
                <h4 class="font-bold text-gray-700 uppercase text-xs">Maior Que</h4>
                <p class="font-mono text-lg">5 > 2</p>
                <p class="text-[10px] text-gray-400 italic">"Cinco √© maior que dois"</p>
            </div>
        </div>

        <div class="flex items-center bg-white p-3 rounded-xl border-l-4 border-brand-orange shadow-sm">
            <div class="text-4xl font-black text-brand-orange w-16 text-center"><</div>
            <div class="pl-4 border-l border-gray-200">
                <h4 class="font-bold text-gray-700 uppercase text-xs">Menor Que</h4>
                <p class="font-mono text-lg">2 < 5</p>
                <p class="text-[10px] text-gray-400 italic">"Dois √© menor que cinco"</p>
            </div>
        </div>

        <div class="flex items-center bg-white p-3 rounded-xl border-l-4 border-brand-green shadow-sm">
            <div class="text-4xl font-black text-brand-green w-16 text-center">=</div>
            <div class="pl-4 border-l border-gray-200">
                <h4 class="font-bold text-gray-700 uppercase text-xs">Igual A</h4>
                <p class="font-mono text-lg">3 = 3</p>
                <p class="text-[10px] text-gray-400 italic">"Tr√™s √© igual a tr√™s"</p>
            </div>
        </div>
    </div>

    <div class="bg-yellow-50 p-4 rounded-xl border-2 border-yellow-200 mt-6 relative overflow-hidden">
        <div class="absolute -right-4 -top-4 text-6xl opacity-20">üêä</div>
        <h4 class="font-bold text-yellow-800 mb-2">Dica de Memoriza√ß√£o: O Jacar√© Guloso</h4>
        <p class="text-sm text-yellow-900">
            Confunde o lado da boca? Lembre-se: O jacar√© est√° sempre com fome. Ele <strong>SEMPRE</strong> abre a boca para comer o n√∫mero <strong>MAIOR</strong>.
        </p>
        <div class="flex justify-center gap-8 mt-4 font-black text-xl text-brand-text">
            <span>5 <span class="text-brand-blue">></span> 2</span>
            <span>1 <span class="text-brand-orange"><</span> 9</span>
        </div>
    </div>

    <h3>1. O Endere√ßo dos N√∫meros üè†</h3>
    <p>Imagine uma estrada infinita que vai para a direita. Cada n√∫mero tem sua casa fixa nela. Isso √© a <strong>Reta Num√©rica</strong>.</p>
    
    <div class="relative h-12 w-full max-w-md mx-auto my-6 border-b-2 border-gray-400 flex items-end">
        <div class="absolute left-0 bottom-0 h-3 w-0.5 bg-gray-400"></div><div class="absolute left-0 -bottom-6 text-xs font-bold">0</div>
        <div class="absolute left-[20%] bottom-0 h-3 w-0.5 bg-gray-400"></div><div class="absolute left-[20%] -bottom-6 text-xs font-bold">1</div>
        <div class="absolute left-[40%] bottom-0 h-3 w-0.5 bg-gray-400"></div><div class="absolute left-[40%] -bottom-6 text-xs font-bold">2</div>
        <div class="absolute left-[60%] bottom-0 h-3 w-0.5 bg-gray-400"></div><div class="absolute left-[60%] -bottom-6 text-xs font-bold">3</div>
        <div class="absolute left-[80%] bottom-0 h-3 w-0.5 bg-gray-400"></div><div class="absolute left-[80%] -bottom-6 text-xs font-bold">4</div>
        <div class="absolute right-0 bottom-2 text-2xl text-brand-blue">‚ûú</div>
    </div>
    <p class="mt-8 text-center text-sm text-gray-500">Quanto mais para a <strong>direita</strong>, <strong>maior</strong> o n√∫mero.</p>

    <h3>2. Ordem: Quem ganha de quem?</h3>
    <p>Usamos s√≠mbolos para comparar (o "jacar√©" sempre come o maior n√∫mero):</p>
    <ul class="list-none space-y-2 text-center font-bold text-lg text-brand-text">
        <li>5 <span class="text-brand-blue">></span> 2 ("Maior que")</li>
        <li>1 <span class="text-brand-orange"><</span> 4 ("Menor que")</li>
        <li>3 <span class="text-brand-green">=</span> 3 ("Igual a")</li>
    </ul>

    <h3>3. Antecessor e Sucessor</h3>

    <p> Com isso entendemos por que temos o conceito de sucessor e antescessor como pilares fundamentais dos n√∫meros, para termos a ideia de um n√∫mero ser menor, maior ou igual a outro em compara√ß√£o.</p>
    <div class="grid grid-cols-2 gap-4 mt-4 text-sm">
        <div class="bg-gray-100 p-3 rounded border-l-4 border-gray-400">
            <strong>Antecessor (-1):</strong><br>Vem antes (√† esquerda).<br>Ex: 9 √© antecessor de 10.
        </div>
        <div class="bg-blue-100 p-3 rounded border-r-4 border-blue-400 text-right">
            <strong>Sucessor (+1):</strong><br>Vem depois (√† direita).<br>Ex: 11 √© sucessor de 10.
        </div>
    </div>
`,
            "Estimativa e Arredondamento (Sentido Num√©rico)": `




<h3>1. O Superpoder do "Olh√¥metro" üëÄ</h3>
    <p>Voc√™ n√£o precisa ser uma calculadora humana, mas precisa ter <strong>no√ß√£o de grandeza</strong>. Imagine que voc√™ est√° no mercado com uma nota de <strong>R$ 50,00</strong> e colocou isto no carrinho:</p>
    
    <div class="bg-white p-4 rounded-xl border-2 border-gray-200 my-4 shadow-sm">
        <ul class="list-none space-y-2 text-sm">
            <li class="flex justify-between border-b border-gray-100 pb-1">
                <span>üç´ Chocolate (R\$ 18,90)</span>
                <span class="text-brand-blue font-bold">Virou R\$ 20,00</span>
            </li>
            <li class="flex justify-between border-b border-gray-100 pb-1">
                <span>ü•§ Suco (R\$ 11,20)</span>
                <span class="text-brand-blue font-bold">Virou R\$ 10,00</span>
            </li>
            <li class="flex justify-between">
                <span>üç™ Bolacha (R\$ 29,50)</span>
                <span class="text-brand-blue font-bold">Virou R$ 30,00</span>
            </li>
        </ul>
        <div class="mt-3 pt-2 border-t-2 border-gray-300 flex justify-between font-black text-lg">
            <span>Total Estimado:</span>
            <span class="text-brand-red">R\$ 60,00</span>
        </div>
    </div>

    <p><strong>Conclus√£o R√°pida:</strong> R$ \\$ $ 60 √© maior que R$ \\$ $ 50. Voc√™ vai passar vergonha no caixa! A estimativa te salvou antes mesmo de voc√™ entrar na fila.</p>

    <h3>2. A Regra da Montanha (Arredondamento) üèîÔ∏è</h3>
    <p>Para estimar, trocamos n√∫meros "quebrados" por n√∫meros "redondos" (que terminam em zero). Mas para onde corremos? Para a dezena de baixo ou de cima?</p>
    
    <p class="text-sm text-gray-600 mb-2">Olhe sempre para o <strong>√∫ltimo d√≠gito</strong> (o vizinho da direita):</p>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
        <div class="bg-red-50 p-4 rounded-xl border-b-4 border-brand-red text-center relative overflow-hidden group">
            <div class="absolute top-0 right-0 bg-red-200 text-red-800 text-[10px] font-bold px-2 py-1 rounded-bl-lg">0, 1, 2, 3, 4</div>
            <div class="text-3xl mb-2 group-hover:scale-110 transition-transform">üìâ</div>
            <h4 class="font-bold text-brand-red uppercase text-xs tracking-widest">Desliza para Baixo</h4>
            <p class="text-xs text-gray-600 mt-2">O carro n√£o tem for√ßa para subir a ladeira. Ele volta para a dezena anterior.</p>
            <div class="mt-3 bg-white p-2 rounded border border-red-100 font-mono font-bold text-gray-700">
                1<span class="text-brand-red">3</span> &rarr; 10
            </div>
        </div>

        <div class="bg-green-50 p-4 rounded-xl border-b-4 border-brand-green text-center relative overflow-hidden group">
            <div class="absolute top-0 right-0 bg-green-200 text-green-800 text-[10px] font-bold px-2 py-1 rounded-bl-lg">5, 6, 7, 8, 9</div>
            <div class="text-3xl mb-2 group-hover:scale-110 transition-transform">üßó</div>
            <h4 class="font-bold text-brand-green uppercase text-xs tracking-widest">Escala para Cima</h4>
            <p class="text-xs text-gray-600 mt-2">O carro √© potente! Ele consegue subir e chegar na pr√≥xima dezena.</p>
            <div class="mt-3 bg-white p-2 rounded border border-green-100 font-mono font-bold text-gray-700">
                1<span class="text-brand-green">7</span> &rarr; 20
            </div>
        </div>
    </div>

    <h3>3. O Detetive de Erros üïµÔ∏è‚Äç‚ôÇÔ∏è</h3>
    <p>A calculadora n√£o erra, mas o seu dedo sim! A estimativa √© sua <strong>Checagem de Sanidade</strong>.</p>

    <div class="bg-gray-800 text-white p-5 rounded-xl shadow-lg my-4 font-mono relative">
        <div class="text-xs text-gray-400 mb-2">CALCULADORA</div>
        <div class="text-xl">19 x 21</div>
        <div class="text-4xl text-red-400 text-right mt-2">3.059</div>
        <div class="absolute top-2 right-2 text-red-500 text-xs font-sans font-bold bg-white px-2 py-1 rounded">ERRO!</div>
    </div>

    <p>Como saber que est√° errado sem refazer a conta? Usando a mente:</p>
    <ul class="list-none space-y-1 text-sm text-gray-700 font-medium bg-yellow-50 p-3 rounded-lg border border-yellow-200">
        <li>üß† 19 est√° perto de <strong>20</strong>.</li>
        <li>üß† 21 est√° perto de <strong>20</strong>.</li>
        <li>üß† $20 \\times 20 = 400$.</li>
        <li>üö® <strong>Alerta:</strong> 3.059 √© muito longe de 400. Voc√™ digitou algo errado!</li>
    </ul>

    [WIDGET:interactive_estimation_game]
`,

            "Adi√ß√£o e Subtra√ß√£o": `

            <h3>1. Adi√ß√£o: O Poder da Uni√£o</h3>
    <p>A adi√ß√£o √© a opera√ß√£o mais natural que existe. Ela serve para <strong>juntar</strong> quantidades ou <strong>acrescentar</strong> algo ao que voc√™ j√° tem.</p>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 my-4">
        <div class="bg-blue-50 p-4 rounded-xl border-2 border-blue-200">
            <h4 class="font-bold text-brand-blue mb-2">üèóÔ∏è A Estrutura (Nomenclatura)</h4>
            <p>N√£o chame de "n√∫mero de cima" e "n√∫mero de baixo". Use os nomes corretos:</p>
            <ul class="list-disc list-inside mt-2 text-sm">
                <li><strong>Parcelas:</strong> Os n√∫meros que voc√™ quer somar.</li>
                <li><strong>Soma (ou Total):</strong> O resultado final.</li>
            </ul>
        </div>
        
        <div class="bg-green-50 p-4 rounded-xl border-2 border-green-200">
            <h4 class="font-bold text-brand-green mb-2">‚ú® Superpoderes (Propriedades)</h4>
            <ul class="list-none space-y-2 text-sm">
                <li>üîÑ <strong>Comutativa:</strong> A ordem n√£o importa! <br>$10 + 2$ √© igual a $2 + 10$.</li>
                <li>ü§ù <strong>Associativa:</strong> Voc√™ pode agrupar como quiser. <br>$(2+3)+5$ d√° o mesmo que $2+(3+5)$.</li>
                <li>0Ô∏è‚É£ <strong>Elemento Neutro:</strong> O zero n√£o faz nada. <br>$50 + 0 = 50$.</li>
            </ul>
        </div>
    </div>

<div class="bg-green-50 p-4 rounded-xl border-2 border-green-200 shadow-sm">
            <h4 class="font-bold text-brand-green mb-4 flex items-center gap-2">
                <i class="fas fa-magic"></i> Superpoderes (Propriedades)
            </h4>
            
            <div class="mb-6">
                <p class="text-sm font-bold text-gray-700 mb-2">üîÑ Comutativa: A ordem n√£o importa!</p>
                <div class="flex items-center justify-center gap-4 md:gap-8 bg-white p-3 rounded-lg border border-green-100">
                    <div class="font-mono text-lg text-right">
                        <div>10</div>
                        <div class="border-b-2 border-gray-400">+ 2</div>
                        <div class="font-bold text-brand-green">12</div>
                    </div>
                    <div class="text-2xl text-gray-300">=</div>
                    <div class="font-mono text-lg text-right">
                        <div>2</div>
                        <div class="border-b-2 border-gray-400">+ 10</div>
                        <div class="font-bold text-brand-green">12</div>
                    </div>
                </div>
            </div>

            <div class="mb-4">
                <p class="text-sm font-bold text-gray-700 mb-2">ü§ù Associativa: Voc√™ escolhe quem somar primeiro.</p>
                <div class="flex flex-col md:flex-row items-center justify-center gap-4 bg-white p-3 rounded-lg border border-green-100 text-sm">
                    <div class="text-center">
                        <div class="font-mono bg-gray-100 px-2 py-1 rounded mb-1">(10 + 2) + 5</div>
                        <div><strong>12</strong> + 5 = <strong class="text-brand-green">17</strong></div>
                    </div>
                    <div class="text-xl text-gray-300">vs</div>
                    <div class="text-center">
                        <div class="font-mono bg-gray-100 px-2 py-1 rounded mb-1">10 + (2 + 5)</div>
                        <div>10 + <strong>7</strong> = <strong class="text-brand-green">17</strong></div>
                    </div>
                </div>
            </div>
            
            <div class="text-xs text-gray-500 bg-green-100 px-2 py-1 rounded inline-block">
                <strong>0Ô∏è‚É£ Elemento Neutro:</strong> O zero n√£o muda nada ($50 + 0 = 50$).
            </div>
        </div>

    [WIDGET:interactive_addition_vertical]

    <div class="bg-yellow-50 p-3 rounded-lg border-l-4 border-brand-yellow mt-4 text-sm">
        <strong>‚ö†Ô∏è Dica de Mestre:</strong> Ao armar a conta, o segredo √© o alinhamento! Unidade embaixo de Unidade, Dezena embaixo de Dezena. Se alinhar errado, a conta quebra.
    </div>

    <h3>2. Subtra√ß√£o: A Arte de Retirar e Comparar</h3>

    <p>A subtra√ß√£o √© o inverso da adi√ß√£o. Ela √© usada em tr√™s situa√ß√µes cl√°ssicas:</p>

    <ol class="list-decimal list-inside space-y-1 font-medium text-gray-700 ml-2" style="list-style-type:none">
        <li><div class="bg-red-400 px-3 py-1 rounded-full flex-1" style="list-style-type:none">Retirar "Tenho 10 reais e gastei 4."</div></li>
        <li><div class="bg-orange-400 px-3 py-1 rounded-full flex-1" style="list-style-type:none">Completar "Tenho 4, quanto falta para 10?"</div></li>
        <li><div class="bg-purple-400 px-3 py-1 rounded-full flex-1" style="list-style-type:none">Comparar "Eu tenho 10 anos, voc√™ tem 4. Sou quantos anos mais velho?"</div></li>
    </ol>

    <div class="bg-red-50 p-4 rounded-xl border-2 border-red-200 my-4">
        <h4 class="font-bold text-brand-red mb-2">üèóÔ∏è A Estrutura (Nomenclatura)</h4>
        <ul class="list-disc list-inside text-sm">
            <li><strong>Minuendo:</strong> O valor total que voc√™ tem (o maior, por enquanto).</li>
            <li><strong>Subtraendo:</strong> O quanto voc√™ vai tirar.</li>
            <li><strong>Resto ou Diferen√ßa:</strong> O resultado.</li>
        </ul>
        <div class="mt-2 pt-2 border-t border-red-200 text-center font-mono font-bold">
            Minuendo - Subtraendo = Diferen√ßa
        </div>
    </div>

    [WIDGET:interactive_subtraction_vertical]

    <h3>3. A Regra de Ouro dos Naturais (‚Ñï)</h3>
    <p>No 6¬∫ ano, estamos trabalhando com N√∫meros Naturais (0, 1, 2, 3...). Neste conjunto, existe uma lei:</p>
    
    <div class="text-center font-bold text-xl my-4 text-brand-text bg-gray-100 p-3 rounded-lg shadow-inner">
        Minuendo $\\ge$ Subtraendo
    </div>

    <p>Ou seja: <strong>Voc√™ n√£o pode tirar 10 de 8.</strong> (Isso s√≥ ser√° poss√≠vel no 7¬∫ ano, quando aprendermos sobre n√∫meros negativos e d√≠vidas!).</p>

    <h3>4. A Prova Real üîç</h3>
    <p>Adi√ß√£o e Subtra√ß√£o s√£o opostas, como ir e voltar. Uma vigia a outra!</p>
    <div class="flex items-center justify-center gap-4 my-4 font-mono bg-white p-2 rounded border border-gray-200">
        <div class="text-center">
            <div class="text-xs text-gray-400 mb-1">Conta</div>
            10 - 3 = <strong class="text-brand-red">7</strong>
        </div>
        <div class="text-2xl text-brand-blue">‚ÜîÔ∏è</div>
        <div class="text-center">
            <div class="text-xs text-gray-400 mb-1">Prova</div>
            <strong class="text-brand-red">7</strong> + 3 = 10
        </div>
    </div>
`,

            "Multiplica√ß√£o e Divis√£o": `




            <h3>1. Multiplica√ß√£o: Acelere seus C√°lculos üèéÔ∏è</h3>
    <p>Somar $12+12+12+12+12$ cansa. A <strong>Multiplica√ß√£o</strong> √© o atalho para somar parcelas iguais rapidamente.</p>
        <div class="grid grid-cols-1 gap-6 my-4">
        <div class="bg-orange-50 p-4 rounded-xl border-2 border-orange-200 shadow-sm">
            <h4 class="font-bold text-brand-orange mb-4 flex items-center gap-2">
                <i class="fas fa-magic"></i> Superpoderes (Propriedades)
            </h4>
            
            <div class="mb-6">
                <p class="text-sm font-bold text-gray-700 mb-2">üîÑ Comutativa: A ordem n√£o importa!</p>
                <div class="flex flex-col md:flex-row items-center justify-center gap-4 bg-white p-3 rounded-lg border border-orange-100 text-sm">
                    <div class="text-center">
                        <div class="font-mono bg-gray-100 px-2 py-1 rounded mb-1">3 √ó 4</div>
                        
                        <div><strong>12</strong></div>
                    </div>
                    <div class="text-xl text-gray-300">=</div>
                    <div class="text-center">
                        <div class="font-mono bg-gray-100 px-2 py-1 rounded mb-1">4 √ó 3</div>
                        <div><strong>12</strong></div>
                    </div>
                </div>
            </div>

            <div class="mb-4">
                <p class="text-sm font-bold text-gray-700 mb-2">ü§ù Associativa: Agrupe como quiser.</p>
                <div class="flex flex-col md:flex-row items-center justify-center gap-4 bg-white p-3 rounded-lg border border-orange-100 text-sm">
                    <div class="text-center">
                        <div class="font-mono bg-gray-100 px-2 py-1 rounded mb-1">2 √ó 3 √ó 4</div>
                        <div><strong>6</strong> √ó 4 = <strong class="text-brand-orange">24</strong></div>
                    </div>
                    <div class="text-xl text-gray-300">vs</div>
                    <div class="text-center">
                        <div class="font-mono bg-gray-100 px-2 py-1 rounded mb-1">4 √ó 3 √ó 2 </div>
                        <div><strong>12</strong> √ó 2 = <strong class="text-brand-orange">24</strong></div>
                    </div>
                </div>
            </div>
            
            <div class="text-xs text-gray-500 bg-orange-100 px-2 py-1 rounded inline-block">
                <strong>1Ô∏è‚É£ Elemento Neutro:</strong> O um n√£o muda nada ($50 \\times 1 = 50$).
            </div>
        </div>

        <div class="bg-purple-50 p-4 rounded-xl border-l-4 border-brand-purple shadow-sm">
            <h4 class="font-bold text-brand-purple mb-2">üöø O Truque do "Chuveirinho" (Distributiva)</h4>
            <p class="text-sm text-gray-600 mb-2">Como fazer $4 \\times 12$ de cabe√ßa? Quebre o n√∫mero!</p>
            
            <div class="flex items-center justify-center gap-2 font-mono text-lg bg-white p-2 rounded border border-purple-100">
                <span class="font-bold text-brand-purple">4</span> 
                <span>√ó</span> 
                <span>(10 + 2)</span>
                <span>=</span>
                <span class="text-gray-400 text-sm">(4√ó10) + (4√ó2)</span>
                <span>=</span>
                <strong>48</strong>
            </div>
        </div>
    </div>

    [WIDGET:interactive_multiplication_vertical]

    <h3>2. Divis√£o: O Juiz Justo ‚öñÔ∏è</h3>
    <p>A Divis√£o serve para duas coisas: <strong>Repartir</strong> em partes iguais ou <strong>Medir</strong> (quantos cabem?).</p>

    <div class="bg-red-50 p-4 rounded-xl border-2 border-red-200 my-4 shadow-sm">
        <h4 class="font-bold text-brand-red mb-3">üîë O Algoritmo de Euclides</h4>
        <div class="flex flex-col md:flex-row items-center justify-around gap-4">
            <div class="text-sm text-gray-600 space-y-1">
                <p>üì¶ <strong>Dividendo (D):</strong> O total que voc√™ tem.</p>
                <p>üî™ <strong>Divisor (d):</strong> Em quantas partes vai cortar.</p>
                <p>üéÅ <strong>Quociente (q):</strong> Quanto cada um ganha.</p>
                <p>üí∞ <strong>Resto (r):</strong> O que sobrou.</p>
            </div>
            
            <div class="font-mono text-xl bg-white p-4 rounded border border-red-100 shadow-inner">
                <div class="flex">
                    <div class="pr-2">20</div>
                    <div class="border-l-2 border-b-2 border-brand-red pl-2 pb-1">3</div>
                </div>
                <div class="flex justify-between w-full mt-1">
                    <div class="text-brand-red opacity-50">-18</div>
                    <div class="font-bold text-brand-red pl-4">6</div>
                </div>
                <div class="border-t border-gray-300 mt-1 w-8 text-center font-bold">2</div>
            </div>
        </div>
        <div class="mt-3 pt-2 border-t border-red-200 text-center font-mono font-bold text-brand-text text-sm">
            Prova Real: Dividendo = Divisor √ó Quociente + Resto
        </div>
    </div>

    [WIDGET:interactive_division_vertical]

    <div class="bg-gray-800 text-white p-4 rounded-xl text-center mt-6 shadow-lg">
        <h4 class="font-bold text-red-400 mb-1 uppercase tracking-widest text-xs"><i class="fas fa-skull"></i> Pecado Matem√°tico</h4>
        <p class="text-lg font-bold">NUNCA DIVIDA POR ZERO!</p>
        <p class="text-xs text-gray-400 mt-1">Se voc√™ tem 10 balas para 0 pessoas... a pergunta n√£o faz sentido. √â imposs√≠vel.</p>
    </div>

    <h3>3. Opera√ß√µes Inversas üîÑ</h3>
    <p>Multiplica√ß√£o e Divis√£o s√£o caminhos de ida e volta. Use isso para conferir suas contas!</p>
    <div class="flex items-center justify-center gap-4 my-4 font-mono bg-white p-2 rounded border border-gray-200">
        <div class="text-center">
            <div class="text-xs text-gray-400 mb-1">Conta</div>
            12 √∑ 3 = <strong class="text-brand-blue">4</strong>
        </div>
        <div class="text-2xl text-brand-blue">‚ÜîÔ∏è</div>
        <div class="text-center">
            <div class="text-xs text-gray-400 mb-1">Prova</div>
            <strong class="text-brand-blue">4</strong> √ó 3 = 12
        </div>
    </div>
`,

            "Potencia√ß√£o e Raiz Quadrada": `




    <h3>1. Potencia√ß√£o: A Multiplica√ß√£o Turbo üöÄ</h3>
    <p>Se a multiplica√ß√£o √© uma soma r√°pida ($5+5+5 = 3 \\times 5$), a <strong>Potencia√ß√£o</strong> √© uma multiplica√ß√£o r√°pida! Ela acontece quando queremos multiplicar um n√∫mero por ele mesmo v√°rias vezes.</p>

    <div class="bg-purple-50 p-6 rounded-xl border-2 border-purple-200 my-6 relative overflow-hidden">
        <div class="absolute top-0 right-0 bg-purple-200 text-purple-800 text-[10px] font-bold px-2 py-1 rounded-bl-lg">ANATOMIA</div>
        
        <div class="flex items-center justify-center gap-8">
            <div class="text-center relative group">
                <div class="text-6xl font-black text-brand-purple relative z-10">5</div>
                <span class="text-xs font-bold text-purple-400 uppercase tracking-widest mt-2 block">Base</span>
                
                <div class="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-32 bg-gray-800 text-white text-[10px] p-2 rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none text-center">
                    üë∑ <strong>O Oper√°rio:</strong><br>√â ele quem trabalha e se repete na conta.
                </div>
            </div>

            <div class="text-center relative group self-start -mt-4">
                <div class="text-4xl font-black text-brand-orange relative z-10">3</div>
                <span class="text-xs font-bold text-orange-400 uppercase tracking-widest mt-1 block">Expoente</span>

                <div class="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-32 bg-gray-800 text-white text-[10px] p-2 rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none text-center">
                    üëë <strong>O Chefe:</strong><br>Ele √© pequeno, mas manda! Diz quantas vezes a base aparece.
                </div>
            </div>
        </div>

        <div class="mt-6 text-center">
            <div class="inline-block bg-white border-2 border-purple-100 px-4 py-2 rounded-lg font-mono text-lg shadow-sm text-gray-600">
                <span class="text-brand-purple font-bold">5</span> 
                <span class="text-gray-300">√ó</span> 
                <span class="text-brand-purple font-bold">5</span> 
                <span class="text-gray-300">√ó</span> 
                <span class="text-brand-purple font-bold">5</span> 
                <span class="text-gray-300">=</span> 
                <span class="text-brand-text font-black">125</span>
            </div>
            <p class="text-xs text-gray-400 mt-2 italic">"O n√∫mero 5 aparece 3 vezes na multiplica√ß√£o."</p>
        </div>
    </div>

    [WIDGET:interactive_power_visualizer]

    <div class="bg-red-50 p-4 rounded-xl border-l-4 border-brand-red mt-6 mb-6 shadow-sm">
        <h4 class="font-bold text-brand-red flex items-center gap-2 text-lg">
            <i class="fas fa-exclamation-triangle"></i> A Armadilha Mortal
        </h4>
        <p class="text-gray-700 mt-1">
            O c√©rebro adora somar. Quando voc√™ v√™ <strong>$2^3$</strong>, seu c√©rebro grita "SEIS!".
        </p>
        <p class="font-bold text-brand-red mt-2 text-lg">N√ÉO ESCUTE SEU C√âREBRO!</p>
        <ul class="mt-2 space-y-1 text-sm text-gray-600">
            <li>‚ùå <span class="line-through decoration-brand-red">2 x 3 = 6</span> (Isso √© multiplica√ß√£o comum).</li>
            <li>‚úÖ <strong>2 x 2 x 2 = 8</strong> (Isso √© pot√™ncia!).</li>
        </ul>
    </div>

    <h3>2. Regras Especiais (Os Casos M√°gicos)</h3>
    <p>Existem situa√ß√µes que funcionam como atalhos de videogame. Memorize para ganhar tempo:</p>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-3 mt-3">
        <div class="bg-gray-50 p-3 rounded-lg border border-gray-200">
            <strong class="text-brand-blue">Expoente 1</strong>
            <p class="text-xs text-gray-500 mt-1">O chefe mandou aparecer uma vez s√≥.</p>
            <div class="font-mono font-bold mt-1 text-brand-text">$15^1 = 15$</div>
        </div>

        <div class="bg-gray-50 p-3 rounded-lg border border-gray-200">
            <strong class="text-brand-blue">Expoente 0</strong>
            <p class="text-xs text-gray-500 mt-1">Regra m√°gica! Todo n√∫mero (n√£o nulo) vira 1.</p>
            <div class="font-mono font-bold mt-1 text-brand-text">$5000^0 = 1$</div>
        </div>

        <div class="bg-gray-50 p-3 rounded-lg border border-gray-200 col-span-1 md:col-span-2">
            <strong class="text-brand-blue">Base 10 (O Truque dos Zeros)</strong>
            <p class="text-xs text-gray-500 mt-1">O expoente diz exatamente quantos zeros colocar.</p>
            <div class="font-mono font-bold mt-1 text-brand-text">$10^3 = 1.000$ <span class="text-xs font-normal text-gray-400">(3 zeros)</span></div>
        </div>
    </div>

    <hr class="border-gray-300 my-8">

    <h3>3. Raiz Quadrada: O Detetive Matem√°tico üïµÔ∏è‚Äç‚ôÇÔ∏è</h3>
    <p>A Raiz √© a opera√ß√£o <strong>inversa</strong> da pot√™ncia. √â como o "Desfazer" do computador.</p>
    
    <p>Quando perguntamos "Qual √© a raiz quadrada de 36?" ($\\sqrt{36}$), estamos fazendo uma pergunta:</p>

    <div class="bg-green-50 p-4 rounded-xl border-2 border-green-200 text-center my-4 shadow-sm">
        <p class="text-brand-green font-bold text-lg mb-1">‚ùì A Pergunta do Detetive:</p>
        <p class="text-gray-700 italic">"Qual n√∫mero, multiplicado por ele mesmo, d√° 36?"</p>
        
        <div class="mt-4 flex justify-center items-center gap-4 font-mono text-xl">
            <span class="bg-white px-3 py-1 rounded border border-green-300 text-brand-green font-bold">?</span>
            <span>√ó</span>
            <span class="bg-white px-3 py-1 rounded border border-green-300 text-brand-green font-bold">?</span>
            <span>= 36</span>
        </div>
        
        <p class="mt-3 font-bold text-brand-text">Resposta: 6! (Pois $6 \\times 6 = 36$)</p>
    </div>

    <h3>4. Por que "Quadrada"? üü©</h3>
    <p>O nome n√£o √© coincid√™ncia. Tem tudo a ver com geometria!</p>
    
    <div class="flex flex-col items-center gap-4 my-4">
        <div class="w-32 h-32 bg-brand-green flex items-center justify-center text-white font-bold text-xl shadow-lg relative">
            √Årea = 49
            <div class="absolute -left-8 top-1/2 -translate-y-1/2 text-gray-500 text-sm font-mono">Lado=?</div>
            <div class="absolute -bottom-6 left-1/2 -translate-x-1/2 text-gray-500 text-sm font-mono">Lado=?</div>
        </div>
        <p class="text-sm text-center text-gray-600 max-w-sm">
            Se voc√™ tem um quadrado de √°rea <strong>49</strong>, quanto mede o lado? <br>
            A resposta √© $\\sqrt{49}$, que √© <strong>7</strong>.
        </p>
    </div>

    <div class="bg-yellow-50 p-4 rounded-xl border-l-4 border-brand-yellow mt-4 text-sm shadow-sm">
        <h4 class="font-bold text-yellow-800 mb-1 flex items-center gap-2"><i class="fas fa-ban"></i> Cuidado com a Metade!</h4>
        <p>Muitos alunos olham para $\\sqrt{16}$ e respondem <strong>8</strong>. <strong>ERRADO!</strong></p>
        <p class="mt-1 text-gray-600">8 vezes 8 d√° 64. <br>A raiz de 16 √© <strong>4</strong> (porque $4 \\times 4 = 16$).</p>
    </div>

    <h3>5. Quadrados Perfeitos (O Hall da Fama)</h3>
    <p>S√£o os n√∫meros que t√™m raiz exata. Vale a pena memorizar:</p>
    <div class="grid grid-cols-4 gap-2 text-center font-mono text-xs md:text-sm mt-2">
        <div class="bg-gray-100 p-2 rounded hover:bg-gray-200 transition-colors">‚àö1 = 1</div>
        <div class="bg-gray-100 p-2 rounded hover:bg-gray-200 transition-colors">‚àö4 = 2</div>
        <div class="bg-gray-100 p-2 rounded hover:bg-gray-200 transition-colors">‚àö9 = 3</div>
        <div class="bg-gray-100 p-2 rounded hover:bg-gray-200 transition-colors">‚àö16 = 4</div>
        <div class="bg-gray-100 p-2 rounded hover:bg-gray-200 transition-colors">‚àö25 = 5</div>
        <div class="bg-gray-100 p-2 rounded hover:bg-gray-200 transition-colors">‚àö36 = 6</div>
        <div class="bg-gray-100 p-2 rounded hover:bg-gray-200 transition-colors">‚àö49 = 7</div>
        <div class="bg-gray-100 p-2 rounded hover:bg-gray-200 transition-colors">‚àö64 = 8</div>
    </div>



`,

            "Express√µes Num√©ricas e Hierarquia": `
<h3>1. O Caos da Internet ü§Ø</h3>
    <p>Voc√™ j√° viu aqueles desafios que deixam todo mundo brigando nos coment√°rios? Tipo este:</p>
    
    <div class="flex justify-center my-6">
        <div class="bg-gray-800 text-white font-mono text-3xl p-6 rounded-xl shadow-lg border-4 border-gray-600 tracking-widest">
            2 + 3 √ó 4 = ?
        </div>
    </div>

    <p>Por que metade da internet erra? Porque eles seguem a intui√ß√£o (ler como um texto) em vez de seguir a <strong>Lei da Matem√°tica</strong>.</p>

    <div class="bg-blue-50 p-4 rounded-xl border-l-4 border-brand-blue my-4 text-sm text-gray-700">
        <strong>üß† Pense assim:</strong><br>
        "Fiz 3 montinhos de 4 moedas e coloquei no bolso direito. No bolso esquerdo, tenho 2 moedas soltas."
        <br><br>
        Primeiro voc√™ agrupa os montinhos ($3 \\times 4 = 12$). S√≥ depois junta com as soltas ($12 + 2 = 14$).
        <br>Se somasse antes ($2+3=5$ montinhos?), daria uma conta sem sentido!
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 my-4 text-center">
        <div class="bg-red-50 p-4 rounded-xl border-2 border-red-200 opacity-70">
            <strong class="text-red-500 block mb-2"><i class="fas fa-times"></i> O Jeito Intuitivo (Errado)</strong>
            <p class="text-sm text-gray-600">Soma primeiro ($2+3=5$)<br>Depois multiplica ($5 \\times 4$)</p>
            <div class="text-2xl font-bold text-red-400 mt-2">20</div>
        </div>
        <div class="bg-green-50 p-4 rounded-xl border-2 border-green-200 transform scale-105 shadow-md">
            <strong class="text-brand-green block mb-2"><i class="fas fa-check"></i> A Regra (Certo)</strong>
            <p class="text-sm text-gray-600">Multiplica primeiro ($3 \\times 4=12$)<br>Depois soma ($2+12$)</p>
            <div class="text-2xl font-black text-brand-green mt-2">14</div>
        </div>
    </div>

    <h3>2. A Hierarquia Militar (Quem manda mais?) üéñÔ∏è</h3>
    <p>As opera√ß√µes t√™m patentes. Um General n√£o espera pelo Soldado. Quem tem a patente maior, √© resolvido primeiro!</p>

    <div class="space-y-3 mt-4">
        <div class="flex items-center bg-purple-50 p-3 rounded-xl border-l-8 border-brand-purple shadow-sm">
            <div class="text-3xl mr-4">üëë</div>
            <div>
                <h4 class="font-bold text-brand-purple uppercase text-xs tracking-widest">N√≠vel 1: Os Reis</h4>
                <p class="font-bold text-gray-700">Potencia√ß√£o e Raiz Quadrada</p>
                <p class="text-xs text-gray-500">S√£o os mais fortes. Resolva eles antes de tudo!</p>
            </div>
        </div>

        <div class="flex items-center bg-orange-50 p-3 rounded-xl border-l-8 border-brand-orange shadow-sm">
            <div class="text-3xl mr-4">‚öîÔ∏è</div>
            <div>
                <h4 class="font-bold text-brand-orange uppercase text-xs tracking-widest">N√≠vel 2: Os Generais</h4>
                <p class="font-bold text-gray-700">Multiplica√ß√£o e Divis√£o</p>
                <p class="text-xs text-gray-500">Eles comandam a soma e a subtra√ß√£o.</p>
            </div>
        </div>

        <div class="flex items-center bg-green-50 p-3 rounded-xl border-l-8 border-brand-green shadow-sm">
            <div class="text-3xl mr-4">üõ°Ô∏è</div>
            <div>
                <h4 class="font-bold text-brand-green uppercase text-xs tracking-widest">N√≠vel 3: Os Soldados</h4>
                <p class="font-bold text-gray-700">Adi√ß√£o e Subtra√ß√£o</p>
                <p class="text-xs text-gray-500">S√£o a base. S√≥ agem quando os chefes terminam.</p>
            </div>
        </div>
    </div>

    <h3>3. A Regra do Desempate üö¶</h3>
    <p>E se aparecerem dois generais juntos ($10 \\div 2 \\times 5$)? Quem ganha?</p>
    
    <div class="bg-yellow-50 p-4 rounded-xl border-2 border-yellow-200 my-4">
        <p class="text-sm text-gray-800 text-center font-medium mb-2">
            Quando as patentes s√£o iguais, vale a <strong>Lei da Leitura</strong>:
        </p>
        <div class="flex items-center justify-center gap-4 font-bold text-brand-text text-lg">
            <i class="fas fa-arrow-right text-brand-blue"></i>
            <span>Da Esquerda</span>
            <span>para a</span>
            <span>Direita</span>
            <i class="fas fa-arrow-right text-brand-blue"></i>
        </div>
    </div>

    <div class="font-mono text-center text-sm text-gray-500 bg-white p-2 rounded border border-gray-200">
        ‚úÖ Certo: $10 \\div 2 = 5$ $\\to$ $5 \\times 5 = 25$.<br>
        ‚ùå Errado: $2 \\times 5 = 10$ $\\to$ $10 \\div 10 = 1$.
    </div>

    <h3>4. As √Åreas VIP (Sinais de Associa√ß√£o) üöß</h3>
    <p>Se voc√™ quer somar antes de multiplicar, voc√™ precisa proteger a soma. Os sinais de associa√ß√£o funcionam como <strong>Escudos</strong>.</p>
    <p>Resolvemos sempre de dentro para fora, como descascar uma cebola do mundo invertido:</p>

    <div class="flex flex-col md:flex-row justify-center items-center gap-4 my-8">
        
        <div class="flex flex-col items-center">
            <div class="w-16 h-16 bg-orange-100 border-4 border-orange-300 rounded-full flex items-center justify-center text-2xl font-black text-orange-800 shadow-sm animate-pulse z-20">
                ( )
            </div>
            <span class="text-xs font-bold text-orange-600 mt-2 uppercase tracking-widest">1¬∫ Miolo</span>
        </div>

        <div class="text-gray-300 text-2xl hidden md:block">‚ûú</div>
        <div class="text-gray-300 text-2xl md:hidden">‚¨áÔ∏è</div>

        <div class="flex flex-col items-center">
            <div class="w-20 h-20 bg-purple-100 border-4 border-purple-300 rounded-xl flex items-center justify-center text-2xl font-black text-purple-800 shadow-sm z-10">
                [ ]
            </div>
            <span class="text-xs font-bold text-purple-600 mt-2 uppercase tracking-widest">2¬∫ Meio</span>
        </div>

        <div class="text-gray-300 text-2xl hidden md:block">‚ûú</div>
        <div class="text-gray-300 text-2xl md:hidden">‚¨áÔ∏è</div>

        <div class="flex flex-col items-center">
            <div class="w-24 h-24 bg-blue-100 border-4 border-blue-300 rounded-xl flex items-center justify-center text-3xl font-black text-blue-800 shadow-sm z-0">
                { }
            </div>
            <span class="text-xs font-bold text-blue-600 mt-2 uppercase tracking-widest">3¬∫ Borda</span>
        </div>

    </div>

    <p>Veja o computador resolvendo uma express√£o gigante passo a passo:</p>
    
    [WIDGET:interactive_expression_solver]
    
    <div class="bg-gray-100 p-3 rounded-lg mt-4 text-center text-xs text-gray-500 italic">
        Dica: Escreva um passo por linha no seu caderno. Organiza√ß√£o √© metade da nota!
    </div>
`,
            "Igualdade e Valor Desconhecido": `

    <h3>1. A Crise do Sinal de Igual ‚öñÔ∏è</h3>
    <p>At√© hoje, voc√™ usou o sinal de igual ($=$) como um bot√£o de "Calcular". Mas na √Ålgebra, ele muda de emprego. Ele vira o fiel de uma <strong>Balan√ßa</strong>.</p>
    
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 my-6">
        <div class="bg-gray-50 p-4 rounded-xl border-2 border-gray-200 opacity-60 grayscale text-center">
            <h4 class="font-bold text-gray-500 mb-2 text-xs uppercase tracking-widest">Como voc√™ pensava</h4>
            <div class="font-mono text-xl">2 + 3 <span class="text-red-500 font-black">=</span> 5</div>
            <p class="text-xs mt-2">"Fa√ßa a conta e d√™ o resultado."</p>
        </div>

        <div class="bg-blue-50 p-4 rounded-xl border-2 border-brand-blue text-center shadow-md transform scale-105">
            <h4 class="font-bold text-brand-blue mb-2 text-xs uppercase tracking-widest">Como √© na √Ålgebra</h4>
            <div class="font-mono text-xl">x + 2 <span class="text-brand-green font-black">=</span> 5</div>
            <p class="text-xs mt-2">"O lado esquerdo <strong>PESA</strong> o mesmo que o direito."</p>
        </div>
    </div>

    <h3>2. O Detetive e a M√°scara üé≠</h3>
    <p>Na matem√°tica, quando n√£o sabemos quem √© o n√∫mero, colocamos uma m√°scara nele. Pode ser um quadradinho ($\square$) ou, a favorita dos matem√°ticos, a letra <strong>$x$</strong>.</p>
    
    <div class="bg-yellow-50 p-4 rounded-xl border-l-4 border-brand-yellow my-4 text-sm">
        <strong>üîç O Objetivo:</strong> Descobrir quem est√° por tr√°s da m√°scara para manter a balan√ßa equilibrada.
        <br>Chamamos esse n√∫mero misterioso de <strong>Inc√≥gnita</strong>.
    </div>

    [WIDGET:interactive_equality_balance]

    <h3>3. A Chave Mestra: Opera√ß√£o Inversa üóùÔ∏è</h3>
    <p>Para descobrir o valor do $x$, precisamos deix√°-lo sozinho. Mas ele est√° acompanhado! Para "desgrudar" os n√∫meros dele, usamos a opera√ß√£o contr√°ria.</p>

    <div class="grid grid-cols-2 gap-4 my-6 text-center font-bold text-white text-sm">
        <div class="bg-brand-green p-3 rounded-xl shadow-sm flex flex-col items-center relative overflow-hidden group">
            <div class="absolute top-0 left-0 w-full h-1 bg-white opacity-30"></div>
            <span class="text-2xl mb-1">+</span>
            <span>Soma</span>
            <i class="fas fa-arrow-down my-1 opacity-50"></i>
            <span class="text-green-100">Vira Subtra√ß√£o</span>
            <span class="text-2xl mt-1">-</span>
        </div>

        <div class="bg-brand-red p-3 rounded-xl shadow-sm flex flex-col items-center relative overflow-hidden group">
            <div class="absolute top-0 left-0 w-full h-1 bg-white opacity-30"></div>
            <span class="text-2xl mb-1">-</span>
            <span>Subtra√ß√£o</span>
            <i class="fas fa-arrow-down my-1 opacity-50"></i>
            <span class="text-red-100">Vira Soma</span>
            <span class="text-2xl mt-1">+</span>
        </div>

        <div class="bg-brand-purple p-3 rounded-xl shadow-sm flex flex-col items-center relative overflow-hidden group">
            <div class="absolute top-0 left-0 w-full h-1 bg-white opacity-30"></div>
            <span class="text-2xl mb-1">√ó</span>
            <span>Vezes</span>
            <i class="fas fa-arrow-down my-1 opacity-50"></i>
            <span class="text-purple-100">Vira Divis√£o</span>
            <span class="text-2xl mt-1">√∑</span>
        </div>

        <div class="bg-brand-orange p-3 rounded-xl shadow-sm flex flex-col items-center relative overflow-hidden group">
            <div class="absolute top-0 left-0 w-full h-1 bg-white opacity-30"></div>
            <span class="text-2xl mb-1">√∑</span>
            <span>Divis√£o</span>
            <i class="fas fa-arrow-down my-1 opacity-50"></i>
            <span class="text-orange-100">Vira Vezes</span>
            <span class="text-2xl mt-1">√ó</span>
        </div>
    </div>

    <h3>4. Resolvendo o Caso</h3>
    <p>Vamos resolver: <strong>$x + 5 = 20$</strong>.</p>
    <p>O 5 est√° somando. Para tir√°-lo dali, jogamos ele para o outro lado <strong>subtraindo</strong>.</p>
    <div class="font-mono text-center bg-gray-100 p-2 rounded border border-gray-300 mt-2">
        $x = 20 - 5$<br>
        <strong>$x = 15$</strong>
    </div>

    [WIDGET:interactive_equation_steps]

    <div class="bg-yellow-50 p-4 rounded-xl border-l-4 border-brand-yellow mt-6 text-sm shadow-sm">
        <h4 class="font-bold text-yellow-700 mb-1">‚ö†Ô∏è A Regra de Ouro</h4>
        <p>Uma igualdade √© absoluta! <strong>Tudo o que voc√™ faz de um lado, tem que fazer do outro.</strong></p>
        <p class="mt-1 text-xs text-gray-500">Se voc√™ tira 5 do prato esquerdo, tem que tirar 5 do prato direito para a balan√ßa n√£o cair.</p>
    </div>
`,

            "Propriedades da Igualdade (Balan√ßa)": `
    <h3>1. A Balan√ßa N√£o Pode Cair! ‚öñÔ∏è</h3>
    <p>Voc√™ j√° sabe que uma equa√ß√£o √© uma balan√ßa equilibrada. O sinal de igual ($=$) √© o fiel da balan√ßa (o centro). Tudo o que est√° no prato esquerdo pesa o mesmo que o prato direito.</p>
    
    <p>Para manter esse equil√≠brio, existem duas leis fundamentais na matem√°tica. Se voc√™ obedecer a elas, nunca vai errar uma equa√ß√£o!</p>

    <h3>2. Princ√≠pio Aditivo (A Lei de Somar e Tirar)</h3>
    <p>Imagine que a balan√ßa est√° parada. Se voc√™ colocar um peso de 2kg em um prato, ela desequilibra. Para arrumar, voc√™ precisa colocar 2kg no outro prato tamb√©m.</p>

    <div class="bg-blue-50 p-4 rounded-xl border-l-4 border-brand-blue my-4 shadow-sm text-sm">
        <strong>A Regra:</strong><br>
        Se somarmos (ou subtrairmos) o <strong>mesmo n√∫mero</strong> aos dois lados de uma igualdade, ela continua verdadeira.
    </div>

    <div class="flex flex-col items-center gap-2 font-mono text-lg my-4">
        <div class="bg-gray-100 px-4 py-2 rounded border border-gray-300">5 = 5</div>
        <div class="text-xs text-gray-400">Somando 3 dos dois lados...</div>
        <div class="flex gap-4">
            <span class="text-brand-blue font-bold">5 + 3</span>
            <span>=</span>
            <span class="text-brand-blue font-bold">5 + 3</span>
        </div>
        <div class="bg-blue-100 px-4 py-2 rounded border border-blue-300 font-bold text-brand-blue">8 = 8</div>
        <div class="text-xs text-gray-400">Continua igual!</div>
    </div>

    <h3>3. Princ√≠pio Multiplicativo (A Lei de Dobrar e Dividir)</h3>
    <p>E se eu dobrar a quantidade de coisas no prato esquerdo? Para manter o equil√≠brio, tenho que dobrar o prato direito tamb√©m.</p>

    <div class="bg-purple-50 p-4 rounded-xl border-l-4 border-brand-purple my-4 shadow-sm text-sm">
        <strong>A Regra:</strong><br>
        Se multiplicarmos (ou dividirmos) os dois lados de uma igualdade pelo <strong>mesmo n√∫mero</strong> (diferente de zero), ela continua verdadeira.
    </div>

    <div class="flex flex-col items-center gap-2 font-mono text-lg my-4">
        <div class="bg-gray-100 px-4 py-2 rounded border border-gray-300">10 = 10</div>
        <div class="text-xs text-gray-400">Dividindo por 2 dos dois lados...</div>
        <div class="flex gap-4">
            <span class="text-brand-purple font-bold">10 √∑ 2</span>
            <span>=</span>
            <span class="text-brand-purple font-bold">10 √∑ 2</span>
        </div>
        <div class="bg-purple-100 px-4 py-2 rounded border border-purple-300 font-bold text-brand-purple">5 = 5</div>
        <div class="text-xs text-gray-400">Ainda funciona!</div>
    </div>

    <h3>4. Por que isso √© √∫til? ü§î</h3>
    <p>√â assim que resolvemos equa√ß√µes como $2x + 4 = 10$!</p>
    
    <ol class="list-decimal list-inside space-y-2 text-sm text-gray-700 bg-white p-4 rounded-xl border border-gray-200 shadow-sm">
        <li>Queremos deixar o $x$ sozinho.</li>
        <li>O 4 est√° atrapalhando (somando). Usamos o <strong>Princ√≠pio Aditivo</strong>: tiramos 4 dos dois lados. <br>($2x + 4 - 4 = 10 - 4 \Rightarrow 2x = 6$)</li>
        <li>O 2 est√° atrapalhando (multiplicando). Usamos o <strong>Princ√≠pio Multiplicativo</strong>: dividimos os dois lados por 2. <br>($2x \div 2 = 6 \div 2 \Rightarrow x = 3$)</li>
    </ol>

    [WIDGET:interactive_equation_advanced] 
    `,
            "Problemas de Partilha Desigual": `
    <h3>1. Nem tudo √© meio a meio üç∞</h3>
    <p>√Äs vezes, dividir n√£o √© dar partes iguais. Imagine este problema:</p>
    
    <div class="bg-yellow-50 p-4 rounded-xl border-l-4 border-brand-yellow my-4 text-sm">
        <strong>O Desafio:</strong> "Ana e Bia dividiram 30 balas. Ana ganhou o <strong>dobro</strong> de Bia. Quantas cada uma ganhou?"
    </div>

    <h3>2. O M√©todo das Caixinhas üì¶</h3>
    <p>N√£o tente adivinhar! Use l√≥gica visual.</p>
    <ul class="list-none space-y-2 text-sm">
        <li>üë© <strong>Bia:</strong> Tem 1 parte (üì¶).</li>
        <li>üë±‚Äç‚ôÄÔ∏è <strong>Ana:</strong> Tem o dobro (üì¶üì¶).</li>
        <li><strong>Total:</strong> 3 caixas iguais = 30 balas.</li>
    </ul>
    
    <div class="flex justify-center gap-2 my-4">
        <div class="w-12 h-12 bg-gray-200 border-2 border-gray-400 flex items-center justify-center font-bold">10</div>
        <span>+</span>
        <div class="w-12 h-12 bg-gray-200 border-2 border-gray-400 flex items-center justify-center font-bold">10</div>
        <div class="w-12 h-12 bg-gray-200 border-2 border-gray-400 flex items-center justify-center font-bold">10</div>
        <span>= 30</span>
    </div>

    <p>Se 3 caixas valem 30, cada uma vale <strong>10</strong>.</p>
    <ul class="font-bold text-brand-blue text-center mt-2">
        <li>Bia = 10</li>
        <li>Ana = 20</li>
    </ul>
`,
            "Entes Geom√©tricos: Ponto, Reta e Plano": `
    <h3>1. Os Blocos de Constru√ß√£o do Universo üß±</h3>
    <p>A Geometria come√ßa com tr√™s conceitos que s√£o t√£o b√°sicos que n√£o t√™m defini√ß√£o. N√≥s n√£o explicamos <em>o que s√£o</em>, n√≥s apenas sentimos e aceitamos que eles existem. Chamamos isso de <strong>Conceitos Primitivos</strong>.</p>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 my-6">
        <div class="bg-white p-4 rounded-xl border-b-4 border-brand-purple shadow-sm hover:-translate-y-1 transition-transform">
            <div class="flex items-center gap-2 mb-2">
                <div class="w-3 h-3 bg-brand-purple rounded-full"></div>
                <h4 class="font-bold text-brand-purple uppercase text-sm">1. O Ponto</h4>
            </div>
            <p class="text-xs text-gray-600 mb-2">Imagine a marca mais fina que a ponta de uma agulha pode fazer.</p>
            <ul class="text-xs space-y-1 font-medium text-gray-500">
                <li>üö´ Sem tamanho (n√£o tem altura nem largura).</li>
                <li>üìç Indica apenas uma <strong>posi√ß√£o</strong>.</li>
                <li>üî§ Nome: Letra <strong>Mai√∫scula</strong> (A, B, P).</li>
            </ul>
        </div>

        <div class="bg-white p-4 rounded-xl border-b-4 border-brand-blue shadow-sm hover:-translate-y-1 transition-transform">
            <div class="flex items-center gap-2 mb-2">
                <div class="w-8 h-0.5 bg-brand-blue"></div>
                <h4 class="font-bold text-brand-blue uppercase text-sm">2. A Reta</h4>
            </div>
            <p class="text-xs text-gray-600 mb-2">Um fio de laser esticado que n√£o faz curva e nunca acaba.</p>
            <ul class="text-xs space-y-1 font-medium text-gray-500">
                <li>üìè 1 Dimens√£o (Comprimento infinito).</li>
                <li>‚ôæÔ∏è N√£o tem come√ßo nem fim.</li>
                <li>üî§ Nome: Letra <strong>min√∫scula</strong> (r, s, t).</li>
            </ul>
        </div>

        <div class="bg-white p-4 rounded-xl border-b-4 border-brand-green shadow-sm hover:-translate-y-1 transition-transform">
            <div class="flex items-center gap-2 mb-2">
                <div class="w-6 h-4 border-2 border-brand-green bg-green-50 transform -skew-x-12"></div>
                <h4 class="font-bold text-brand-green uppercase text-sm">3. O Plano</h4>
            </div>
            <p class="text-xs text-gray-600 mb-2">A superf√≠cie de uma mesa lisa que cresce para sempre.</p>
            <ul class="text-xs space-y-1 font-medium text-gray-500">
                <li>‚¨õ 2 Dimens√µes (Comprimento e Largura).</li>
                <li>üè† √â onde moram os pontos e as retas.</li>
                <li>üî§ Nome: Letra <strong>Grega</strong> ($\\alpha, \\beta, \\gamma$).</li>
            </ul>
        </div>
    </div>

    [WIDGET:interactive_geometry_canvas]

    <h3>2. Postulados (As Leis do Universo)</h3>
    <p>Existem regras que aceitamos como verdades absolutas:</p>
    <ul class="list-none space-y-3 mt-2 text-sm text-gray-700">
        <li class="flex gap-3 items-start bg-gray-50 p-2 rounded">
            <span class="text-xl">üåå</span>
            <span><strong>Por um ponto</strong>, passam infinitas retas. (Imagine uma estrela explodindo raios de luz para todo lado).</span>
        </li>
        <li class="flex gap-3 items-start bg-gray-50 p-2 rounded">
            <span class="text-xl">üõ§Ô∏è</span>
            <span><strong>Por dois pontos</strong>, passa uma √öNICA reta. (√â por isso que para mirar, voc√™ precisa alinhar a al√ßa e a massa de mira).</span>
        </li>
    </ul>

    <h3>3. Peda√ßos da Reta (N√£o confunda!)</h3>
    <p>A Reta √© infinita, mas podemos cortar peda√ßos dela. A diferen√ßa est√° nas pontas:</p>

    <div class="overflow-x-auto">
        <table class="w-full text-left border-collapse mt-4 text-sm">
            <thead>
                <tr class="text-gray-400 uppercase text-xs border-b-2 border-gray-100">
                    <th class="p-2">Nome</th>
                    <th class="p-2">Visual</th>
                    <th class="p-2">Defini√ß√£o</th>
                </tr>
            </thead>
            <tbody class="font-medium text-gray-600">
                <tr class="border-b border-gray-50">
                    <td class="p-2 text-brand-blue">Reta</td>
                    <td class="p-2 font-mono">‚Üê‚Äî‚Äî‚Äî‚Äî‚Üí</td>
                    <td class="p-2">Infinita para os dois lados.</td>
                </tr>
                <tr class="border-b border-gray-50">
                    <td class="p-2 text-brand-orange">Semirreta</td>
                    <td class="p-2 font-mono">‚óè‚Äî‚Äî‚Äî‚Äî‚Üí</td>
                    <td class="p-2">Tem come√ßo, mas n√£o tem fim.</td>
                </tr>
                <tr>
                    <td class="p-2 text-brand-green">Segmento</td>
                    <td class="p-2 font-mono">‚óè‚Äî‚Äî‚Äî‚Äî‚óè</td>
                    <td class="p-2">Tem come√ßo e tem fim. (√â o √∫nico que podemos medir!).</td>
                </tr>
            </tbody>
        </table>
    </div>
`,

            "Localiza√ß√£o no Plano Cartesiano": `
    <h3>1. Batalha Naval Matem√°tica üö¢</h3>
    <p>Para encontrar qualquer coisa em um mapa, precisamos de duas informa√ß√µes: uma <strong>horizontal (Deitada)</strong> e uma <strong>vertical (Em p√©)</strong>.</p>
    
    <p>Chamamos isso de <strong>Par Ordenado $(x, y)$</strong>.</p>
    
    <div class="bg-gray-100 p-4 rounded-xl text-center font-mono text-lg border-2 border-dashed border-gray-300 my-4">
        (3, 2)<br>
        <span class="text-xs text-gray-500 font-sans">Ande 3 para o lado ‚ûú, suba 2 para cima ‚¨ÜÔ∏è</span>
    </div>

    <h3>2. Os Eixos</h3>
    <ul class="list-disc list-inside text-sm text-gray-700 space-y-2">
        <li><strong>Eixo X (Abscissas):</strong> O ch√£o. A linha deitada.</li>
        <li><strong>Eixo Y (Ordenadas):</strong> A parede. A linha em p√©.</li>
        <li><strong>Origem (0,0):</strong> O canto onde tudo come√ßa.</li>
    </ul>

    [WIDGET:interactive_cartesian_plane]
    `,


            "√Çngulos: Classifica√ß√£o e Medida": `
    <h3>1. O Que √© um √Çngulo? (N√£o √© s√≥ uma ponta!) üìê</h3>
    <p>Muitas pessoas acham que √¢ngulo √© apenas "o canto da mesa". Mas na matem√°tica, √¢ngulo √© <strong>MOVIMENTO</strong>.</p>

    <div class="bg-blue-50 p-4 rounded-xl border-l-4 border-brand-blue my-4 text-sm">
        <strong>üîÑ A Defini√ß√£o Din√¢mica:</strong><br>
        Imagine dois ponteiros de um rel√≥gio come√ßando juntos. Quando um deles se move, o espa√ßo que abre entre eles √© o <strong>√Çngulo</strong>.
    </div>

    <p>Para desenhar um √¢ngulo, precisamos de tr√™s coisas:</p>
    <ul class="list-none space-y-2 mt-2 text-sm text-gray-700">
        <li>üìç <strong>V√©rtice:</strong> O ponto de origem (o parafuso do rel√≥gio).</li>
        <li>üìè <strong>Lados:</strong> As duas semirretas (os ponteiros).</li>
        <li>üëê <strong>Abertura:</strong> A regi√£o interna. √â isso que medimos!</li>
    </ul>

    [WIDGET:interactive_geometry_canvas]

    <h3>2. Como Medimos? (O Grau)</h3>
    <p>N√£o usamos r√©gua (cm) para medir √¢ngulos. Usamos o <strong>Transferidor</strong> e a unidade √© o <strong>Grau (¬∞)</strong>.</p>
    <p>Imagine uma pizza cortada em 360 fatias fininhas. Cada fatia √© <strong>1 grau</strong>. Uma volta completa tem 360¬∫.</p>

    <h3>3. A Fam√≠lia dos √Çngulos (Classifica√ß√£o)</h3>
    <p>Os √¢ngulos recebem nomes dependendo de qu√£o "abertos" eles est√£o. Imagine uma boca se abrindo:</p>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 my-4">
        
        <div class="bg-green-50 p-4 rounded-xl border-2 border-green-200 hover:scale-105 transition-transform">
            <h4 class="font-bold text-brand-green mb-1 flex items-center gap-2">
                <i class="fas fa-compress-arrows-alt"></i> Agudo
            </h4>
            <p class="text-xs text-gray-600 mb-2 font-bold uppercase tracking-wide">Menor que 90¬∞</p>
            <p class="text-sm text-gray-700">√â "fechadinho" e pontudo. Lembra a ponta de uma lan√ßa ou uma fatia fina de pizza.</p>
            <div class="mt-2 text-center font-mono text-brand-green font-bold text-xl">‚à† < 90¬∞</div>
        </div>

        <div class="bg-blue-50 p-4 rounded-xl border-2 border-blue-200 hover:scale-105 transition-transform">
            <h4 class="font-bold text-brand-blue mb-1 flex items-center gap-2">
                <i class="far fa-square"></i> Reto
            </h4>
            <p class="text-xs text-gray-600 mb-2 font-bold uppercase tracking-wide">Exatos 90¬∞</p>
            <p class="text-sm text-gray-700">√â o canto perfeito. O encontro da parede com o ch√£o. Representado por um quadradinho com um ponto.</p>
            <div class="mt-2 text-center font-mono text-brand-blue font-bold text-xl">‚à† = 90¬∞</div>
        </div>

        <div class="bg-orange-50 p-4 rounded-xl border-2 border-orange-200 hover:scale-105 transition-transform">
            <h4 class="font-bold text-brand-orange mb-1 flex items-center gap-2">
                <i class="fas fa-expand-arrows-alt"></i> Obtuso
            </h4>
            <p class="text-xs text-gray-600 mb-2 font-bold uppercase tracking-wide">Entre 90¬∞ e 180¬∞</p>
            <p class="text-sm text-gray-700">√â "abert√£o". Lembra uma cadeira de praia reclinada. Passou de 90, mas n√£o chegou no ch√£o.</p>
            <div class="mt-2 text-center font-mono text-brand-orange font-bold text-xl">90¬∞ < ‚à† < 180¬∞</div>
        </div>

        <div class="bg-red-50 p-4 rounded-xl border-2 border-red-200 hover:scale-105 transition-transform">
            <h4 class="font-bold text-brand-red mb-1 flex items-center gap-2">
                <i class="fas fa-ruler-horizontal"></i> Raso
            </h4>
            <p class="text-xs text-gray-600 mb-2 font-bold uppercase tracking-wide">Exatos 180¬∞</p>
            <p class="text-sm text-gray-700">√â a meia-volta. Os ponteiros est√£o opostos, formando uma linha reta perfeita.</p>
            <div class="mt-2 text-center font-mono text-brand-red font-bold text-xl">‚à† = 180¬∞</div>
        </div>

    </div>

    [WIDGET:interactive_angle_maker]

    <div class="bg-yellow-50 p-4 rounded-xl border-l-4 border-brand-yellow mt-6 text-sm shadow-sm">
        <h4 class="font-bold text-yellow-700 mb-1 flex items-center gap-2"><i class="fas fa-eye"></i> Ilus√£o de √ìtica</h4>
        <p><strong>O tamanho das retas N√ÉO importa!</strong></p>
        <p class="mt-1 text-gray-600">Voc√™ pode esticar os lados do √¢ngulo at√© o infinito, mas se a <strong>abertura</strong> (o giro) for a mesma, o √¢ngulo √© o mesmo. Um √¢ngulo de 30¬∞ desenhado num papelzinho √© igual a um √¢ngulo de 30¬∞ desenhado num campo de futebol.</p>
    </div>
`,
            "Pol√≠gonos: Tri√¢ngulos e Quadril√°teros": `
    <h3>1. Tri√¢ngulos: O Clube dos 3 üìê</h3>
    <p>Podemos classificar os tri√¢ngulos de duas formas: pelos <strong>Lados</strong> ou pelos <strong>√Çngulos</strong>.</p>
    
    <div class="grid grid-cols-1 gap-2 text-sm">
        <div class="bg-green-50 p-2 rounded border-l-4 border-green-400">
            <strong>Pelos Lados:</strong>
            <ul class="list-disc list-inside text-xs mt-1">
                <li><strong>Equil√°tero:</strong> 3 lados iguais. (Perfeito).</li>
                <li><strong>Is√≥sceles:</strong> 2 lados iguais. (Pernas longas).</li>
                <li><strong>Escaleno:</strong> 0 lados iguais. (Todo torto).</li>
            </ul>
        </div>
        <div class="bg-blue-50 p-2 rounded border-l-4 border-blue-400">
            <strong>Pelos √Çngulos:</strong>
            <ul class="list-disc list-inside text-xs mt-1">
                <li><strong>Ret√¢ngulo:</strong> Tem 1 √¢ngulo reto (90¬∞).</li>
                <li><strong>Acut√¢ngulo:</strong> 3 √¢ngulos agudos (pontudos).</li>
                <li><strong>Obtus√¢ngulo:</strong> 1 √¢ngulo obtuso (aberto).</li>
            </ul>
        </div>
    </div>

    <h3>2. Quadril√°teros: O Clube dos 4 üüß</h3>
    <p>√â uma fam√≠lia grande! Veja a hierarquia:</p>
    <ul class="space-y-2 text-sm text-gray-700 bg-white p-4 rounded-xl border shadow-sm">
        <li>üü¶ <strong>Paralelogramo:</strong> Tem 2 pares de lados paralelos (Reto ou Torto).</li>
        <li class="ml-4">üëâ <strong>Ret√¢ngulo:</strong> Paralelogramo com 4 √¢ngulos retos.</li>
        <li class="ml-4">üëâ <strong>Losango:</strong> Paralelogramo com 4 lados iguais.</li>
        <li class="ml-8">üëë <strong>Quadrado:</strong> √â Ret√¢ngulo E Losango ao mesmo tempo! (Perfeito).</li>
        <li>üü´ <strong>Trap√©zio:</strong> S√≥ tem 1 par de lados paralelos.</li>
    </ul>
`,
            "Amplia√ß√£o e Redu√ß√£o em Malhas": `
    <h3>1. O Zoom da C√¢mera üîç</h3>
    <p>Ampliar uma figura n√£o √© s√≥ "esticar". Voc√™ precisa esticar <strong>tudo por igual</strong> para n√£o deformar. Chamamos isso de <strong>Figuras Semelhantes</strong>.</p>
    
    <div class="flex items-center justify-center gap-8 my-6">
        <div class="w-10 h-10 border-2 border-brand-blue bg-blue-100 flex items-center justify-center text-xs font-bold">1x</div>
        <div class="text-2xl text-gray-300">‚ûú</div>
        <div class="w-20 h-20 border-2 border-brand-blue bg-blue-50 flex items-center justify-center text-sm font-bold">2x</div>
    </div>

    <h3>2. A Regra da Malha Quadriculada</h3>
    <p>Para ampliar pelo dobro (2x):</p>
    <ul class="list-disc list-inside text-sm text-gray-700 bg-yellow-50 p-3 rounded border border-yellow-200">
        <li>Se o lado media <strong>2 quadradinhos</strong>, agora medir√° <strong>4</strong>.</li>
        <li>Se media <strong>3</strong>, agora medir√° <strong>6</strong>.</li>
        <li><strong>ATEN√á√ÉO:</strong> Os √¢ngulos N√ÉO mudam! (Um quadrado ampliado continua sendo um quadrado, n√£o vira um losango).</li>
    </ul>
`,

            "Ferramentas Geom√©tricas": `
    <h3>1. A Caixa de Ferramentas do Matem√°tico üß∞</h3>
    <p>Desenhar √† m√£o livre √© arte. Desenhar com instrumentos √© <strong>Engenharia</strong>. Para construir pr√©dios, criar logotipos ou desenhar mapas, precisamos de precis√£o.</p>
    
    <p>Vamos conhecer os "Quatro Fant√°sticos" da geometria:</p>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 my-6">
        <div class="bg-white p-4 rounded-xl border-l-4 border-brand-blue shadow-sm">
            <div class="flex items-center gap-2 mb-2">
                <i class="fas fa-ruler-horizontal text-brand-blue text-xl"></i>
                <h4 class="font-bold text-gray-700">1. A R√©gua Graduada</h4>
            </div>
            <p class="text-xs text-gray-600">Serve para tra√ßar retas e medir dist√¢ncias.</p>
            <div class="mt-2 text-[10px] bg-blue-50 p-2 rounded text-blue-800 font-bold">
                ‚ö†Ô∏è Aten√ß√£o: O zero nem sempre est√° na pontinha do pl√°stico! Olhe o tra√ßo do zero.
            </div>
        </div>

        <div class="bg-white p-4 rounded-xl border-l-4 border-brand-orange shadow-sm">
            <div class="flex items-center gap-2 mb-2">
                <i class="fas fa-drafting-compass text-brand-orange text-xl"></i>
                <h4 class="font-bold text-gray-700">2. O Compasso</h4>
            </div>
            <p class="text-xs text-gray-600">Serve para fazer c√≠rculos perfeitos e transportar medidas.</p>
            <ul class="list-disc list-inside text-[10px] mt-2 text-gray-500">
                <li><strong>Ponta Seca (Ferro):</strong> O centro.</li>
                <li><strong>Ponta Grafite:</strong> O tra√ßo.</li>
                <li>A abertura √© o <strong>Raio</strong>.</li>
            </ul>
        </div>

        <div class="bg-white p-4 rounded-xl border-l-4 border-brand-purple shadow-sm">
            <div class="flex items-center gap-2 mb-2">
                <i class="fas fa-ruler-combined text-brand-purple text-xl"></i>
                <h4 class="font-bold text-gray-700">3. Os Esquadros</h4>
            </div>
            <p class="text-xs text-gray-600">Tri√¢ngulos especiais para desenhar √¢ngulos e retas paralelas.</p>
            <div class="flex gap-2 mt-2">
                <span class="bg-purple-100 text-purple-800 px-2 py-1 rounded text-[10px] font-bold">Is√≥sceles (45¬∞)</span>
                <span class="bg-purple-100 text-purple-800 px-2 py-1 rounded text-[10px] font-bold">Escaleno (60¬∞)</span>
            </div>
        </div>

        <div class="bg-white p-4 rounded-xl border-l-4 border-brand-green shadow-sm">
            <div class="flex items-center gap-2 mb-2">
                <div class="w-6 h-3 border-t-2 border-l-2 border-r-2 border-brand-green rounded-t-full"></div>
                <h4 class="font-bold text-gray-700">4. O Transferidor</h4>
            </div>
            <p class="text-xs text-gray-600">A "r√©gua curva" para medir aberturas (√¢ngulos) em graus.</p>
            <div class="mt-2 text-[10px] bg-green-50 p-2 rounded text-green-800 font-bold">
                üéØ O segredo √© alinhar o centro no v√©rtice e o zero na linha.
            </div>
        </div>
    </div>

    [WIDGET:interactive_geometry_tools]

    <h3>2. Os Esquadros em A√ß√£o üìê</h3>
    <p>Voc√™ sabia que seu kit de geometria tem dois tri√¢ngulos diferentes? Eles n√£o s√£o iguais por acaso.</p>
    
    <div class="flex flex-col gap-4 my-4 text-sm">
        <div class="flex items-center gap-4">
            <div class="w-16 h-16 bg-gray-200" style="clip-path: polygon(0 0, 0% 100%, 100% 100%);"></div>
            <div>
                <strong>O Is√≥sceles (O G√™meo):</strong> Tem dois lados iguais.
                <br>√Çngulos: <strong>90¬∞, 45¬∞, 45¬∞</strong>.
            </div>
        </div>
        <div class="flex items-center gap-4">
            <div class="w-12 h-20 bg-gray-200" style="clip-path: polygon(0 0, 0% 100%, 100% 100%);"></div>
            <div>
                <strong>O Escaleno (O Comprido):</strong> Tem tr√™s lados diferentes.
                <br>√Çngulos: <strong>90¬∞, 60¬∞, 30¬∞</strong>.
            </div>
        </div>
    </div>
    
    <div class="bg-yellow-50 p-3 rounded-lg border border-yellow-200 text-center text-sm font-bold text-yellow-800 mt-4">
        Dica: Juntando os dois, conseguimos somar √¢ngulos! <br>
        (Ex: 30¬∞ + 45¬∞ = 75¬∞)
    </div>
`,


            "Curvas, Pol√≠gonos e Regi√µes": `
    <h3>1. O Caminho do L√°pis (Curvas) ‚úèÔ∏è</h3>
    <p>Imagine que a ponta do seu l√°pis √© uma formiga passeando pelo papel. O rastro que ela deixa √© o que chamamos de <strong>Curva</strong> (mesmo que o tra√ßo seja reto!).</p>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 my-4">
        <div class="bg-gray-50 p-4 rounded-xl border border-gray-200">
            <h4 class="font-bold text-gray-700 mb-2">üö™ Aberta ou Fechada?</h4>
            <ul class="list-disc list-inside text-sm text-gray-600">
                <li><strong>Aberta:</strong> As pontas n√£o se encontram. A formiga n√£o consegue voltar ao in√≠cio.</li>
                <li><strong>Fechada:</strong> O final encosta no come√ßo. Forma um cercado.</li>
            </ul>
        </div>
        <div class="bg-gray-50 p-4 rounded-xl border border-gray-200">
            <h4 class="font-bold text-gray-700 mb-2">ü™¢ Simples ou N√£o Simples?</h4>
            <ul class="list-disc list-inside text-sm text-gray-600">
                <li><strong>Simples:</strong> A linha nunca cruza ela mesma.</li>
                <li><strong>N√£o Simples:</strong> Tem um n√≥, la√ßo ou cruzamento (como um n√∫mero 8).</li>
            </ul>
        </div>
    </div>

    <h3>2. Pol√≠gonos: O Clube VIP üé©</h3>
    <p>Nem toda figura fechada √© um Pol√≠gono. Para entrar nesse clube, a figura precisa seguir <strong>3 Regras de Ouro</strong>:</p>

    <div class="bg-blue-50 p-4 rounded-xl border-l-4 border-brand-blue my-4 shadow-sm">
        <ol class="list-decimal list-inside space-y-2 font-bold text-brand-blue">
            <li><span class="text-gray-700 font-medium">Ser formada APENAS por <strong>segmentos de reta</strong> (nada de curvas!).</span></li>
            <li><span class="text-gray-700 font-medium">Ser <strong>Fechada</strong>.</span></li>
            <li><span class="text-gray-700 font-medium">Ser <strong>Simples</strong> (as linhas n√£o podem se cruzar).</span></li>
        </ol>
    </div>

    <p class="text-sm text-center italic text-gray-500 mb-4">
        üö´ O C√≠rculo n√£o entra (tem curva). <br>
        üö´ A letra "D" n√£o entra (tem uma parte curva). <br>
        ‚úÖ O Tri√¢ngulo e o Quadrado s√£o s√≥cios fundadores!
    </p>

    <h3>3. Convexo ou C√¥ncavo? (O Teste da Mordida) ü¶∑</h3>
    <p>Os pol√≠gonos se dividem em dois times. Como diferenci√°-los?</p>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 my-4">
        <div class="bg-green-50 p-4 rounded-xl border-2 border-green-200 hover:scale-105 transition-transform">
            <div class="flex items-center gap-2 mb-2">
                <div class="w-3 h-3 bg-brand-green rounded-full"></div>
                <h4 class="font-bold text-brand-green uppercase">Convexo</h4>
            </div>
            <p class="text-sm text-gray-700">Todos os bicos apontam <strong>para fora</strong>. √â "gordinho" e cheio.</p>
            <div class="mt-2 text-xs font-mono bg-white p-2 rounded border border-green-100 text-green-800">
                üß™ <strong>Teste do Elastico:</strong> Se voc√™ colocar um el√°stico em volta, ele toca em todos os lados.
            </div>
        </div>

        <div class="bg-purple-50 p-4 rounded-xl border-2 border-purple-200 hover:scale-105 transition-transform">
            <div class="flex items-center gap-2 mb-2">
                <div class="w-3 h-3 bg-brand-purple rounded-full"></div>
                <h4 class="font-bold text-brand-purple uppercase">C√¥ncavo</h4>
            </div>
            <p class="text-sm text-gray-700">Tem uma "reentr√¢ncia" ou buraco. Parece que <strong>levou uma mordida</strong>.</p>
            <div class="mt-2 text-xs font-mono bg-white p-2 rounded border border-purple-100 text-purple-800">
                üß™ <strong>Teste do Esconderijo:</strong> √â poss√≠vel desenhar uma linha ligando dois pontos internos que passa pelo lado de fora.
            </div>
        </div>
    </div>

    [WIDGET:interactive_poly_types]

    <h3>4. Nomenclatura (O Grego Matem√°tico)</h3>
    <p>Os nomes v√™m da quantidade de √¢ngulos (ou lados). <em>Poly</em> (muitos) + <em>Gonos</em> (√¢ngulos).</p>
    
    <div class="flex flex-wrap gap-2 mt-2 justify-center">
        <span class="bg-gray-100 px-3 py-1 rounded-full text-xs font-bold text-gray-600">3 = Tri√¢ngulo</span>
        <span class="bg-gray-100 px-3 py-1 rounded-full text-xs font-bold text-gray-600">4 = Quadril√°tero</span>
        <span class="bg-gray-100 px-3 py-1 rounded-full text-xs font-bold text-gray-600">5 = Pent√°gono</span>
        <span class="bg-gray-100 px-3 py-1 rounded-full text-xs font-bold text-gray-600">6 = Hex√°gono</span>
        <span class="bg-gray-100 px-3 py-1 rounded-full text-xs font-bold text-gray-600">8 = Oct√≥gono</span>
    </div>

    <div class="bg-yellow-50 p-3 rounded-lg border-l-4 border-brand-yellow mt-4 text-sm">
        <strong>‚ö†Ô∏è Aten√ß√£o:</strong> N√£o existe pol√≠gono de 1 ou 2 lados. O menor pol√≠gono poss√≠vel √© o <strong>Tri√¢ngulo</strong>.
    </div>
`,
            "S√≥lidos Geom√©tricos: Poliedros e Corpos Redondos": `
    <h3>1. Bem-vindo √† 3¬™ Dimens√£o üëì</h3>
    <p>At√© agora, viv√≠amos no mundo plano (2D), como um desenho numa folha. Mas o mundo real tem profundidade! As figuras sa√≠ram do papel e ganharam corpo.</p>

    <div class="flex justify-center gap-8 my-6 text-center">
        <div class="opacity-50">
            <div class="w-16 h-16 border-2 border-gray-400 bg-gray-100 mx-auto"></div>
            <p class="text-xs font-bold mt-2">Quadrado (2D)</p>
            <p class="text-[10px]">S√≥ tem √°rea</p>
        </div>
        <div class="text-2xl text-brand-blue pt-4">‚ûî</div>
        <div class="transform scale-110">
            <div class="w-16 h-16 border-2 border-brand-blue bg-blue-100 mx-auto relative shadow-lg">
                <div class="absolute top-[-10px] right-[-10px] w-16 h-16 border-2 border-brand-blue bg-blue-50 -z-10"></div>
                <div class="absolute top-0 right-0 w-[1px] h-[20px] bg-brand-blue origin-bottom -rotate-45"></div> 
                </div>
            <p class="text-xs font-bold text-brand-blue mt-2">Cubo (3D)</p>
            <p class="text-[10px]">Tem Volume!</p>
        </div>
    </div>

    <h3>2. A Grande Divis√£o: Quem Rola? üé≥</h3>
    <p>Separamos os s√≥lidos em dois grandes times baseados no "Teste do Empurr√£o":</p>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 my-4">
        <div class="bg-purple-50 p-4 rounded-xl border-2 border-purple-200">
            <h4 class="font-bold text-brand-purple mb-2 flex items-center gap-2">
                <i class="fas fa-cube"></i> Poliedros
            </h4>
            <p class="text-sm text-gray-700 mb-2">Do grego: <em>V√°rias Faces</em>.</p>
            <ul class="list-disc list-inside text-sm text-gray-600">
                <li>Todas as faces s√£o <strong>PLANAS</strong>.</li>
                <li>N√£o rolam (se voc√™ empurrar, eles deslizam ou tombam).</li>
                <li>Ex: Caixas, Dados, Pir√¢mides, Tijolos.</li>
            </ul>
        </div>

        <div class="bg-orange-50 p-4 rounded-xl border-2 border-orange-200">
            <h4 class="font-bold text-brand-orange mb-2 flex items-center gap-2">
                <i class="fas fa-bowling-ball"></i> Corpos Redondos
            </h4>
            <p class="text-sm text-gray-700 mb-2">Tamb√©m chamados de S√≥lidos de Revolu√ß√£o.</p>
            <ul class="list-disc list-inside text-sm text-gray-600">
                <li>T√™m pelo menos uma parte <strong>CURVA</strong>.</li>
                <li>Rolam facilmente se colocados numa rampa.</li>
                <li>Ex: Bolas (Esfera), Latas (Cilindro), Chap√©u de festa (Cone).</li>
            </ul>
        </div>
    </div>

    [WIDGET:interactive_solids_viewer]

    <h3>3. Anatomia de um Poliedro ü¶¥</h3>
    <p>Para estudar os poliedros, precisamos saber o nome das suas partes. Imagine que voc√™ est√° segurando um dado:</p>

    <div class="grid grid-cols-3 gap-2 text-center my-4">
        <div class="bg-white p-2 rounded-lg border border-gray-200 shadow-sm">
            <div class="text-2xl">üü¶</div>
            <strong class="text-brand-blue block text-sm">FACE</strong>
            <p class="text-[10px] text-gray-500">S√£o os lados planos (as "paredes").</p>
        </div>
        <div class="bg-white p-2 rounded-lg border border-gray-200 shadow-sm">
            <div class="text-2xl">üìè</div>
            <strong class="text-brand-green block text-sm">ARESTA</strong>
            <p class="text-[10px] text-gray-500">S√£o as linhas de dobra (as "quinas").</p>
        </div>
        <div class="bg-white p-2 rounded-lg border border-gray-200 shadow-sm">
            <div class="text-2xl">üìç</div>
            <strong class="text-brand-purple block text-sm">V√âRTICE</strong>
            <p class="text-[10px] text-gray-500">S√£o as pontas onde as linhas se encontram (os "bicos").</p>
        </div>
    </div>

    <h3>4. A Rela√ß√£o M√°gica de Euler ‚ú®</h3>
    <p>Para a maioria dos poliedros (os que n√£o t√™m buracos), existe uma regra matem√°tica que sempre funciona:</p>
    
    <div class="bg-yellow-50 p-4 rounded-xl border-l-4 border-brand-yellow my-4 text-center">
        <span class="text-lg font-mono font-bold text-brand-text">V + F = A + 2</span>
        <p class="text-xs text-gray-500 mt-2">"V√©rtices mais Faces √© igual a Arestas mais dois"</p>
    </div>

    <p class="text-sm text-gray-600"><strong>Teste no Cubo:</strong><br>
    Tem 8 V√©rtices e 6 Faces ($8+6 = 14$).<br>
    Tem 12 Arestas ($12+2 = 14$).<br>
    <strong>Funcionou!</strong></p>
`,
            "M√∫ltiplos e Divisores": `
    <h3>1. M√∫ltiplos: O Salto Infinito üê∏</h3>
    <p>Imagine um sapo numa estrada de n√∫meros. Ele come√ßa no zero e d√° pulos sempre do mesmo tamanho.</p>
    
    <p>Se ele pula de <strong>3 em 3</strong>, onde ele pisa?</p>
    <div class="flex justify-center gap-2 my-4 font-mono font-bold text-lg text-brand-blue overflow-x-auto">
        <span>0</span> ‚ûî <span>3</span> ‚ûî <span>6</span> ‚ûî <span>9</span> ‚ûî <span>12</span> ‚ûî <span>15</span>...
    </div>
    
    <p>Esses n√∫meros s√£o os <strong>M√∫ltiplos de 3</strong>. √â a tabuada que nunca termina!</p>

    <div class="bg-blue-50 p-4 rounded-xl border-l-4 border-brand-blue my-4 text-sm">
        <h4 class="font-bold text-brand-blue">üìù Como escrever matematicamente?</h4>
        <p>Usamos a letra <strong>M</strong> e um conjunto entre chaves:</p>
        <div class="mt-2 bg-white p-2 rounded border border-blue-200 text-center font-mono">
            M(3) = {0, 3, 6, 9, 12, ...}
        </div>
        <p class="mt-1 text-xs text-gray-500">Os tr√™s pontinhos (...) significam que √© infinito.</p>
    </div>

    <h4 class="font-bold text-gray-700 mt-4">‚ö° Regras R√°pidas dos M√∫ltiplos:</h4>
    <ul class="list-disc list-inside text-sm text-gray-600 space-y-1">
        <li>O <strong>Zero</strong> √© m√∫ltiplo de todos os n√∫meros (√© o ponto de partida).</li>
        <li>Todo n√∫mero √© m√∫ltiplo de <strong>si mesmo</strong> ($5 \\times 1 = 5$).</li>
        <li>O conjunto √© <strong>Infinito</strong>.</li>
    </ul>

    <hr class="border-gray-300 my-6">

    <h3>2. Divisores: O Organizador de Festas üéâ</h3>
    <p>Imagine que voc√™ tem <strong>12 bombons</strong> e quer coloc√°-los em caixas, sem sobrar nenhum e sem cortar o bombom ao meio.</p>
    
    <p>Quais caixas funcionam?</p>
    <div class="grid grid-cols-2 gap-3 my-4 text-sm">
        <div class="bg-green-50 p-3 rounded border border-green-200 text-center">
            <strong class="text-brand-green">‚úÖ Funciona (Divisores)</strong>
            <ul class="mt-1 text-left list-disc list-inside">
                <li>1 caixa de 12</li>
                <li>2 caixas de 6</li>
                <li>3 caixas de 4</li>
                <li>4 caixas de 3...</li>
            </ul>
        </div>
        <div class="bg-red-50 p-3 rounded border border-red-200 text-center">
            <strong class="text-brand-red">‚ùå N√£o Funciona</strong>
            <ul class="mt-1 text-left list-disc list-inside">
                <li>Caixas de 5? (Sobram 2)</li>
                <li>Caixas de 7? (Sobra 5)</li>
            </ul>
        </div>
    </div>

    <p>Os n√∫meros que dividem o 12 "exatamente" (resto zero) s√£o os <strong>Divisores</strong>.</p>

    <div class="bg-orange-50 p-4 rounded-xl border-l-4 border-brand-orange my-4 text-sm">
        <h4 class="font-bold text-brand-orange">üìù Conjunto dos Divisores</h4>
        <p>Usamos a letra <strong>D</strong>. Ao contr√°rio dos m√∫ltiplos, aqui a lista acaba!</p>
        <div class="mt-2 bg-white p-2 rounded border border-orange-200 text-center font-mono">
            D(12) = {1, 2, 3, 4, 6, 12}
        </div>
    </div>

    <h4 class="font-bold text-gray-700 mt-4">‚ö° Regras R√°pidas dos Divisores:</h4>
    <ul class="list-disc list-inside text-sm text-gray-600 space-y-1">
        <li>O n√∫mero <strong>1</strong> √© divisor de todo mundo (√© o divisor universal).</li>
        <li>O <strong>maior</strong> divisor de um n√∫mero √© ele mesmo.</li>
        <li>O conjunto √© <strong>Finito</strong> (tem fim).</li>
    </ul>

    <h3>3. O Resumo da Batalha ‚öîÔ∏è</h3>
    <div class="grid grid-cols-2 gap-4 mt-4 text-center font-bold text-white text-sm">
        <div class="bg-brand-blue p-3 rounded-xl shadow-md">
            M√∫ltiplos üöÄ<br>
            <span class="font-normal text-xs opacity-90">Multiplica√ß√£o</span><br>
            <span class="font-normal text-xs opacity-90">Infinito (Cresce)</span><br>
            <span class="font-normal text-xs opacity-90">Come√ßa no 0</span>
        </div>
        <div class="bg-brand-orange p-3 rounded-xl shadow-md">
            Divisores üß±<br>
            <span class="font-normal text-xs opacity-90">Divis√£o Exata</span><br>
            <span class="font-normal text-xs opacity-90">Finito (Limitado)</span><br>
            <span class="font-normal text-xs opacity-90">Come√ßa no 1</span>
        </div>
    </div>
`,
            "L√≥gica de Fluxogramas (Algoritmos)": `
    <h3>1. Ensinando um Rob√¥ ü§ñ</h3>
    <p>Voc√™ sabia que computadores n√£o s√£o inteligentes? Eles s√£o apenas muito r√°pidos e obedientes. Eles precisam de uma receita passo a passo para fazer qualquer coisa.</p>
    
    <p>Essa receita se chama <strong>Algoritmo</strong>.</p>
    
    <div class="bg-gray-100 p-4 rounded-xl border-l-4 border-gray-500 my-4 text-sm font-mono">
        <strong>Exemplo: Algoritmo de Escovar os Dentes</strong><br>
        1. Pegar a escova.<br>
        2. Colocar pasta.<br>
        3. Escovar.<br>
        4. Enxaguar.<br>
        5. Fim.
    </div>

    <h3>2. O Mapa do Tesouro (Fluxograma) üó∫Ô∏è</h3>
    <p>Escrever listas cansa. Por isso, usamos desenhos para mostrar o caminho l√≥gico. Cada forma geom√©trica tem um significado:</p>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 my-6 text-center text-xs font-bold text-gray-600">
        <div class="flex flex-col items-center gap-2">
            <div class="px-6 py-2 rounded-full border-2 border-brand-green bg-green-50 text-brand-green">IN√çCIO / FIM</div>
            <p>A p√≠lula arredondada. <br>Onde come√ßa e termina.</p>
        </div>

        <div class="flex flex-col items-center gap-2">
            <div class="px-6 py-2 border-2 border-brand-blue bg-blue-50 text-brand-blue w-32">A√á√ÉO</div>
            <p>O ret√¢ngulo. <br>Uma ordem direta ("Fa√ßa isso").</p>
        </div>

        <div class="flex flex-col items-center gap-2">
            <div class="w-10 h-10 border-2 border-brand-orange bg-orange-50 text-brand-orange transform rotate-45 flex items-center justify-center">
                <span class="transform -rotate-45 text-lg">?</span>
            </div>
            <p class="mt-1">O losango. <br>Uma pergunta de Sim ou N√£o.</p>
        </div>
    </div>

    <h3>3. A Encruzilhada (SE... ENT√ÉO...) üö¶</h3>
    <p>A m√°gica acontece no Losango. O caminho se divide! Vamos criar um algoritmo para saber se um n√∫mero √© <strong>PAR</strong> ou <strong>√çMPAR</strong>.</p>

    <div class="flex flex-col items-center my-8 relative">
        <div class="absolute top-0 bottom-0 w-0.5 bg-gray-300 -z-10"></div>

        <div class="bg-green-100 text-green-800 px-4 py-1 rounded-full text-xs font-bold mb-4 border border-green-300">IN√çCIO</div>
        
        <div class="bg-white border-2 border-brand-blue px-4 py-2 text-brand-blue font-bold text-sm mb-4 shadow-sm">
            Pegue um n√∫mero
        </div>

        <div class="relative mb-12"> <div class="w-32 h-32 bg-orange-50 border-2 border-brand-orange transform rotate-45 flex items-center justify-center shadow-sm z-10 relative">
                <div class="transform -rotate-45 text-center text-xs font-bold text-brand-orange leading-tight">
                    Termina em<br>0, 2, 4, 6 ou 8?
                </div>
            </div>
            
            <div class="absolute top-1/2 left-full w-16 h-0.5 bg-gray-400 -translate-y-1/2"></div>
            <div class="absolute top-1/2 right-full w-16 h-0.5 bg-gray-400 -translate-y-1/2"></div>
            
            <div class="absolute top-1/2 left-[110%] -translate-y-1/2 bg-white px-1 text-xs font-bold text-green-600">SIM</div>
            <div class="absolute top-1/2 right-[110%] -translate-y-1/2 bg-white px-1 text-xs font-bold text-red-600">N√ÉO</div>

            <div class="absolute top-0 left-[160%] -translate-y-1/2 bg-green-100 border border-green-400 text-green-800 px-3 py-2 rounded font-bold shadow-md whitespace-nowrap">
                √â PAR!
            </div>
            <div class="absolute top-0 right-[160%] -translate-y-1/2 bg-red-100 border border-red-400 text-red-800 px-3 py-2 rounded font-bold shadow-md whitespace-nowrap">
                √â √çMPAR!
            </div>
        </div>

        <div class="bg-green-100 text-green-800 px-4 py-1 rounded-full text-xs font-bold mt-4 border border-green-300">FIM</div>
    </div>

    <div class="bg-yellow-50 p-4 rounded-xl border-l-4 border-brand-yellow mt-6 text-sm">
        <strong>üß† Pensamento Computacional:</strong>
        <p>Voc√™ acabou de "programar" a l√≥gica da divisibilidade por 2! Na matem√°tica, n√≥s n√£o adivinhamos; n√≥s seguimos regras l√≥gicas.</p>
    </div>

    [WIDGET:interactive_flowchart_divisibility]
`,
            "Crit√©rios de Divisibilidade": `
    <h3>1. O Superpoder do Raio-X ü¶∏‚Äç‚ôÇÔ∏è</h3>
    <p>Imagine que voc√™ tem o n√∫mero <strong>1.234.560</strong> e quer saber se d√° para dividir por 2. Voc√™ vai armar a conta e perder 5 minutos?</p>
    <p><strong>N√£o!</strong> Voc√™ vai usar os Crit√©rios de Divisibilidade. Eles s√£o atalhos para saber se a divis√£o √© exata (resto zero) sem precisar calcular.</p>

    <div class="bg-blue-50 p-4 rounded-xl border-l-4 border-brand-blue my-4 text-sm">
        <strong>üí° O Segredo:</strong> N√£o estamos interessados na resposta da conta. S√≥ queremos saber: "Divide ou n√£o divide?".
    </div>

    <h3>2. A Fam√≠lia do "Olhe para o Final" (2, 5 e 10) üëÄ</h3>
    <p>Para estes n√∫meros, n√£o importa se o n√∫mero tem 100 d√≠gitos. Voc√™ s√≥ precisa olhar para o <strong>√∫ltimo algarismo</strong>.</p>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 my-4">
        <div class="bg-green-50 p-3 rounded-xl border border-green-200 text-center">
            <div class="text-2xl mb-1">‚úåÔ∏è</div>
            <h4 class="font-bold text-brand-green mb-1">Por 2</h4>
            <p class="text-xs text-gray-600">O n√∫mero precisa ser <strong>PAR</strong>.</p>
            <div class="mt-2 text-xs font-mono font-bold text-brand-text">Final: 0, 2, 4, 6 ou 8</div>
        </div>

        <div class="bg-orange-50 p-3 rounded-xl border border-orange-200 text-center">
            <div class="text-2xl mb-1">‚úã</div>
            <h4 class="font-bold text-brand-orange mb-1">Por 5</h4>
            <p class="text-xs text-gray-600">Termina em "cheio" ou "meio".</p>
            <div class="mt-2 text-xs font-mono font-bold text-brand-text">Final: 0 ou 5</div>
        </div>

        <div class="bg-purple-50 p-3 rounded-xl border border-purple-200 text-center">
            <div class="text-2xl mb-1">üîü</div>
            <h4 class="font-bold text-brand-purple mb-1">Por 10</h4>
            <p class="text-xs text-gray-600">A regra mais f√°cil do mundo.</p>
            <div class="mt-2 text-xs font-mono font-bold text-brand-text">Final: 0</div>
        </div>
    </div>

    <h3>3. A Fam√≠lia da "Soma M√°gica" (3 e 9) ‚ú®</h3>
    <p>Aqui mora o perigo! <strong>N√ÉO adianta olhar o √∫ltimo n√∫mero.</strong> Voc√™ precisa somar todos os algarismos.</p>

    <div class="bg-gray-100 p-4 rounded-xl border-2 border-gray-200 my-4">
        <p class="font-bold text-gray-700 mb-2">Exemplo: O n√∫mero 1.230 divide por 3?</p>
        <ul class="list-none space-y-2 text-sm">
            <li>1Ô∏è‚É£ <strong>Some os d√≠gitos:</strong> $1 + 2 + 3 + 0 = 6$.</li>
            <li>2Ô∏è‚É£ <strong>Teste a soma:</strong> O 6 est√° na tabuada do 3?</li>
            <li>‚úÖ <strong>Sim!</strong> Ent√£o 1.230 tamb√©m √© divis√≠vel.</li>
        </ul>
        <hr class="border-gray-300 my-3">
        <div class="flex gap-2 text-xs items-center">
            <span class="font-bold text-brand-blue">Regra do 9:</span>
            <span>Mesma coisa! A soma deve estar na tabuada do 9.</span>
        </div>
    </div>

    <h3>4. A Fam√≠lia do "Combo" (6) üçî</h3>
    <p>O n√∫mero 6 n√£o tem regra pr√≥pria. Ele √© composto ($2 \\times 3$).</p>
    <p>Para entrar na festa do 6, o n√∫mero precisa de <strong>dois carimbos</strong> no passaporte:</p>
    <ul class="list-disc list-inside text-sm text-gray-700 mt-2">
        <li>Carimbo do 2 (Ser Par).</li>
        <li>Carimbo do 3 (Soma dos algarismos).</li>
    </ul>
    <p class="text-xs text-red-500 font-bold mt-1 ml-4">Se falhar em um, est√° fora!</p>

    <h3>5. A Regra dos √öltimos Dois (4)</h3>
    <p>Para saber se divide por 4, olhe apenas para os <strong>dois √∫ltimos d√≠gitos</strong>.</p>
    <ul class="list-none space-y-1 text-sm text-gray-700 bg-yellow-50 p-3 rounded border border-yellow-200">
        <li>Ex: 1.0<strong>24</strong> (24 divide por 4? Sim. Ent√£o o n√∫mero todo divide).</li>
        <li>Ex: 5.0<strong>00</strong> (Terminou em 00? Tamb√©m serve!).</li>
    </ul>

    [WIDGET:interactive_divisibility_checker] 
    `,

            "N√∫meros Primos e Compostos": `
    <h3>1. Os √Åtomos da Matem√°tica ‚öõÔ∏è</h3>
    <p>Na Qu√≠mica, tudo o que existe √© formado por √°tomos. Na Matem√°tica, tudo √© formado por <strong>N√∫meros Primos</strong>.</p>
    
    <p>Imagine que voc√™ tem pe√ßas de Lego. Algumas pe√ßas s√£o √∫nicas e indivis√≠veis. Outras s√£o montadas juntando v√°rias pe√ßas.</p>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 my-4">
        <div class="bg-green-50 p-4 rounded-xl border-2 border-green-200">
            <h4 class="font-bold text-brand-green mb-2">üü¢ N√∫meros Primos (As Pe√ßas)</h4>
            <p class="text-sm text-gray-600 mb-2">S√£o os n√∫meros "t√≠midos". Eles s√≥ aceitam ser divididos por dois n√∫meros:</p>
            <ul class="list-disc list-inside text-sm font-bold text-gray-700">
                <li>Pelo n√∫mero 1.</li>
                <li>Por eles mesmos.</li>
            </ul>
            <div class="mt-3 text-center font-mono text-brand-green font-black text-lg">
                2, 3, 5, 7, 11, 13, 17...
            </div>
        </div>

        <div class="bg-blue-50 p-4 rounded-xl border-2 border-blue-200">
            <h4 class="font-bold text-brand-blue mb-2">üîµ N√∫meros Compostos (As Constru√ß√µes)</h4>
            <p class="text-sm text-gray-600 mb-2">S√£o n√∫meros soci√°veis. T√™m <strong>mais de dois divisores</strong>.</p>
            <p class="text-sm text-gray-600">Eles s√£o chamados de "compostos" porque s√£o <em>compostos</em> pela multiplica√ß√£o de primos.</p>
            <div class="mt-3 text-center font-mono text-brand-blue font-black text-lg">
                4, 6, 8, 9, 10, 12...
            </div>
        </div>
    </div>

    <div class="bg-yellow-50 p-4 rounded-xl border-l-4 border-brand-yellow my-6 shadow-sm text-sm">
        <h4 class="font-bold text-yellow-700 mb-1 flex items-center gap-2"><i class="fas fa-exclamation-triangle"></i> O Caso Estranho do N√∫mero 1</h4>
        <p><strong>O n√∫mero 1 N√ÉO √© primo nem composto!</strong></p>
        <p class="mt-1 text-gray-600">Por qu√™? Porque ele s√≥ tem <strong>UM</strong> divisor (ele mesmo). Para ser primo, precisa ter exatamente dois. Ele √© a "Unidade".</p>
    </div>

    <h3>2. O DNA dos N√∫meros (Teorema Fundamental) üß¨</h3>
    <p>Essa √© a regra mais bonita da aritm√©tica: <strong>Todo n√∫mero composto pode ser escrito como uma multiplica√ß√£o de n√∫meros primos.</strong></p>
    
    <p>Exemplo com o n√∫mero <strong>12</strong>:</p>
    <div class="flex justify-center items-center gap-2 my-3 font-mono text-lg">
        <span class="bg-gray-100 p-2 rounded">12</span>
        <span>=</span>
        <span class="bg-green-100 text-brand-green p-2 rounded font-bold">2</span>
        <span>√ó</span>
        <span class="bg-green-100 text-brand-green p-2 rounded font-bold">2</span>
        <span>√ó</span>
        <span class="bg-green-100 text-brand-green p-2 rounded font-bold">3</span>
    </div>
    <p class="text-center text-xs text-gray-400 mb-4">Isso se chama Fatora√ß√£o.</p>

    <h3>3. Ca√ßando Primos: O Crivo de Erat√≥stenes üïµÔ∏è‚Äç‚ôÇÔ∏è</h3>
    <p>Como saber se o n√∫mero 47 √© primo? Um matem√°tico grego genial chamado Erat√≥stenes criou um m√©todo de "peneira":</p>
    
    <ol class="list-decimal list-inside text-sm text-gray-700 space-y-1 mb-4">
        <li>Liste os n√∫meros.</li>
        <li>Risque o 1 (n√£o vale).</li>
        <li>Circule o <strong>2</strong> (primo) e risque todos os seus m√∫ltiplos (4, 6, 8...).</li>
        <li>Circule o pr√≥ximo livre (<strong>3</strong>) e risque seus m√∫ltiplos.</li>
        <li>Repita at√© acabar!</li>
    </ol>

    <p>Vamos ver a peneira funcionando ao vivo:</p>

    [WIDGET:interactive_primes_sieve]

    <div class="bg-gray-100 p-3 rounded-lg border border-gray-300 mt-6 text-sm flex items-center gap-3">
        <div class="text-2xl">üêë</div>
        <div>
            <strong>Curiosidade:</strong> O n√∫mero <strong>2</strong> √© o √∫nico primo que √© <strong>PAR</strong>. Todos os outros primos s√£o √≠mpares (porque se fossem pares, dividiriam por 2 e n√£o seriam primos!). Ele √© a "ovelha negra" da fam√≠lia.
        </div>
    </div>
`,

            "Fatora√ß√£o, MMC e MDC": `
    <h3>1. Fatora√ß√£o: O C√≥digo de Barras üß¨</h3>
    <p>Todo n√∫mero composto tem um segredo: ele √© feito de n√∫meros primos multiplicados. Descobrir quais s√£o esses primos √© <strong>Fatorar</strong> (ou Decompor).</p>

    <div class="flex flex-col items-center my-6">
        <div class="bg-white p-4 rounded-xl border-2 border-gray-200 shadow-sm flex gap-6 font-mono text-lg">
            <div class="flex flex-col items-end text-brand-text font-bold">
                <div>60</div>
                <div>30</div>
                <div>15</div>
                <div>5</div>
                <div>1</div>
            </div>
            <div class="w-0.5 bg-brand-blue"></div>
            <div class="flex flex-col items-start text-brand-blue font-bold">
                <div>2</div>
                <div>2</div>
                <div>3</div>
                <div>5</div>
                <div class="text-xs text-gray-400 mt-1">(Primos)</div>
            </div>
        </div>
        <p class="mt-3 text-sm text-gray-600"><strong>Resultado:</strong> $60 = 2^2 \\times 3 \\times 5$</p>
    </div>

    <h3>2. MDC: O Grande Divisor (O Passado) ‚úÇÔ∏è</h3>
    <p>O <strong>M√°ximo Divisor Comum</strong> serve para <strong>DIVIDIR</strong> coisas em partes iguais do maior tamanho poss√≠vel.</p>
    
    <div class="bg-orange-50 p-4 rounded-xl border-l-4 border-brand-orange my-4">
        <h4 class="font-bold text-brand-orange mb-2">Quando usar MDC?</h4>
        <p class="text-sm text-gray-700">Procure estas palavras-chave nos problemas:</p>
        <div class="flex gap-2 mt-2 flex-wrap">
            <span class="bg-white px-2 py-1 rounded border border-orange-200 text-xs font-bold text-orange-600">Dividir</span>
            <span class="bg-white px-2 py-1 rounded border border-orange-200 text-xs font-bold text-orange-600">Repartir</span>
            <span class="bg-white px-2 py-1 rounded border border-orange-200 text-xs font-bold text-orange-600">Maior tamanho poss√≠vel</span>
            <span class="bg-white px-2 py-1 rounded border border-orange-200 text-xs font-bold text-orange-600">Sem sobras</span>
        </div>
    </div>

    <p class="text-sm italic text-gray-500">Exemplo: Tenho duas fitas (12m e 18m). Quero cortar em peda√ßos iguais do maior tamanho poss√≠vel. <br><strong>MDC(12, 18) = 6 metros.</strong></p>

    <h3>3. MMC: O Encontro (O Futuro) üîÆ</h3>
    <p>O <strong>M√≠nimo M√∫ltiplo Comum</strong> serve para prever o <strong>FUTURO</strong>. Ele descobre quando eventos repetitivos v√£o acontecer juntos novamente.</p>

    <div class="bg-purple-50 p-4 rounded-xl border-l-4 border-brand-purple my-4">
        <h4 class="font-bold text-brand-purple mb-2">Quando usar MMC?</h4>
        <p class="text-sm text-gray-700">Procure estas ideias:</p>
        <div class="flex gap-2 mt-2 flex-wrap">
            <span class="bg-white px-2 py-1 rounded border border-purple-200 text-xs font-bold text-purple-600">Tempo</span>
            <span class="bg-white px-2 py-1 rounded border border-purple-200 text-xs font-bold text-purple-600">Encontro</span>
            <span class="bg-white px-2 py-1 rounded border border-purple-200 text-xs font-bold text-purple-600">Coincid√™ncia</span>
            <span class="bg-white px-2 py-1 rounded border border-purple-200 text-xs font-bold text-purple-600">Daqui a quanto tempo?</span>
        </div>
    </div>

    <p class="text-sm italic text-gray-500">Exemplo: Um rem√©dio √© tomado de 4 em 4 horas. Outro de 6 em 6 horas. Tomei juntos agora. Quando tomo juntos de novo? <br><strong>MMC(4, 6) = 12 horas.</strong></p>

    [WIDGET:interactive_mmc_mdc]

    <h3>4. O Duelo Final: MDC vs MMC ü•ä</h3>
    <p>N√£o confunda mais! Olha a diferen√ßa visual:</p>

    <div class="grid grid-cols-2 gap-4 my-4 text-center text-white text-sm">
        <div class="bg-brand-orange p-4 rounded-xl shadow-md transform hover:scale-105 transition-transform">
            <div class="text-2xl mb-1">üìâ</div>
            <strong>MDC</strong>
            <p class="text-xs opacity-80 mt-1">Diminui os n√∫meros.</p>
            <p class="text-xs opacity-80">O resultado √© <strong>MENOR</strong> ou igual aos n√∫meros originais.</p>
        </div>
        <div class="bg-brand-purple p-4 rounded-xl shadow-md transform hover:scale-105 transition-transform">
            <div class="text-2xl mb-1">üìà</div>
            <strong>MMC</strong>
            <p class="text-xs opacity-80 mt-1">Aumenta os n√∫meros.</p>
            <p class="text-xs opacity-80">O resultado √© <strong>MAIOR</strong> ou igual aos n√∫meros originais.</p>
        </div>
    </div>
`,

            "Conceito de Fra√ß√£o": `
    <h3>1. O Problema da Pizza üçï</h3>
    <p>Imagine que voc√™ tem uma pizza inteira e 4 amigos famintos. Se voc√™ der a pizza para apenas um, vai dar briga. Voc√™ precisa <strong>quebrar o inteiro</strong>.</p>
    
    <p>A fra√ß√£o nasce quando um n√∫mero natural (1, 2, 3...) n√£o √© suficiente. Precisamos de peda√ßos!</p>

    <div class="bg-blue-50 p-6 rounded-xl border-2 border-blue-200 my-6 relative">
        <div class="absolute top-0 right-0 bg-blue-200 text-blue-800 text-[10px] font-bold px-2 py-1 rounded-bl-lg">ANATOMIA DA FRA√á√ÉO</div>
        
        <div class="flex flex-col items-center justify-center gap-2">
            <div class="text-center relative group">
                <div class="text-5xl font-black text-brand-orange relative z-10">3</div>
                <span class="text-xs font-bold text-orange-400 uppercase tracking-widest block">Numerador</span>
                
                <div class="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-40 bg-gray-800 text-white text-[10px] p-2 rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none text-center z-20">
                    üòã <strong>Quantos eu comi:</strong><br>O n√∫mero de partes que foram tomadas ou pintadas.
                </div>
            </div>

            <div class="w-16 h-1 bg-gray-400 rounded-full"></div>

            <div class="text-center relative group">
                <div class="text-5xl font-black text-brand-blue relative z-10">8</div>
                <span class="text-xs font-bold text-blue-400 uppercase tracking-widest block">Denominador</span>

                <div class="absolute top-full left-1/2 -translate-x-1/2 mt-2 w-40 bg-gray-800 text-white text-[10px] p-2 rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none text-center z-20">
                    üî™ <strong>O Corte Total:</strong><br>Em quantas partes iguais o inteiro foi dividido. Ele d√° o NOME da fra√ß√£o (Oitavos).
                </div>
            </div>
        </div>
    </div>

    [WIDGET:interactive_pizza_fractions]

    <h3>2. Como Ler? (O Sobrenome da Fra√ß√£o)</h3>
    <p>O n√∫mero de cima lemos normal (um, dois, tr√™s...). O n√∫mero de baixo d√° o sobrenome:</p>
    
    <div class="grid grid-cols-2 md:grid-cols-3 gap-2 text-sm text-center">
        <div class="bg-gray-50 p-2 rounded border border-gray-200">
            <strong>2</strong> ‚ûî Meio
        </div>
        <div class="bg-gray-50 p-2 rounded border border-gray-200">
            <strong>3</strong> ‚ûî Ter√ßo
        </div>
        <div class="bg-gray-50 p-2 rounded border border-gray-200">
            <strong>4</strong> ‚ûî Quarto
        </div>
        <div class="bg-gray-50 p-2 rounded border border-gray-200">
            <strong>5</strong> ‚ûî Quinto
        </div>
        <div class="bg-gray-50 p-2 rounded border border-gray-200">
            <strong>10</strong> ‚ûî D√©cimo
        </div>
        <div class="bg-gray-50 p-2 rounded border border-gray-200">
            <strong>12</strong> ‚ûî Doze <strong>avos</strong>
        </div>
    </div>
    
    <p class="text-xs text-gray-500 mt-2 italic text-center">A partir do 11, usamos a palavra m√°gica "avos". Ex: 5/13 = Cinco treze avos.</p>

    <h3>3. As Tr√™s Personalidades da Fra√ß√£o üé≠</h3>
    <p>Uma fra√ß√£o n√£o serve s√≥ para pizza. Ela √© uma atriz que interpreta tr√™s pap√©is diferentes:</p>

    <div class="space-y-3 mt-4">
        <div class="flex items-start gap-3">
            <div class="bg-green-100 p-2 rounded-lg text-2xl">üç∞</div>
            <div>
                <strong class="text-brand-green block">1. Parte de um Todo</strong>
                <span class="text-sm text-gray-600">"Comi 1 peda√ßo de 4." ($\\frac{1}{4}$)</span>
            </div>
        </div>

        <div class="flex items-start gap-3">
            <div class="bg-purple-100 p-2 rounded-lg text-2xl">‚ûó</div>
            <div>
                <strong class="text-brand-purple block">2. Uma Divis√£o</strong>
                <span class="text-sm text-gray-600">O tra√ßo da fra√ß√£o √© um sinal de dividir! $\\frac{10}{2}$ √© a mesma coisa que $10 \\div 2 = 5$.</span>
            </div>
        </div>

        <div class="flex items-start gap-3">
            <div class="bg-orange-100 p-2 rounded-lg text-2xl">üéØ</div>
            <div>
                <strong class="text-brand-orange block">3. Um Operador (Regra do "DE")</strong>
                <span class="text-sm text-gray-600">
                    "Quanto √© $\\frac{1}{2}$ <strong>DE</strong> 20 reais?"<br>
                    A fra√ß√£o atua sobre o n√∫mero. (Divide pelo de baixo, multiplica pelo de cima).
                </span>
            </div>
        </div>
    </div>

    <div class="bg-red-50 p-4 rounded-xl border-l-4 border-brand-red mt-6 text-sm shadow-sm">
        <h4 class="font-bold text-brand-red flex items-center gap-2"><i class="fas fa-ban"></i> Regra Proibida</h4>
        <p><strong>O Denominador nunca pode ser ZERO!</strong></p>
        <p class="mt-1 text-gray-600">N√£o faz sentido dividir uma pizza em zero peda√ßos. Isso destr√≥i a matem√°tica.</p>
    </div>
`,

            "Fra√ß√µes Equivalentes e Simplifica√ß√£o": `
    <h3>1. Os Mestres dos Disfarces ü•∏</h3>
    <p>Voc√™ sabia que a fra√ß√£o $\\frac{1}{2}$ √© um agente secreto? Ela tem v√°rios disfarces, mas o valor dela (a quantidade de pizza) nunca muda.</p>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 my-4 text-center">
        <div class="bg-white p-3 rounded-xl border-2 border-gray-200 shadow-sm">
            <div class="text-2xl">üòê</div>
            <div class="font-bold text-gray-700 mt-1">Original</div>
            <div class="font-mono text-xl text-brand-blue">$\\frac{1}{2}$</div>
            <div class="text-xs text-gray-400">"Metade"</div>
        </div>
        <div class="bg-white p-3 rounded-xl border-2 border-gray-200 shadow-sm">
            <div class="text-2xl">ü•∏</div>
            <div class="font-bold text-gray-700 mt-1">Disfarce 1</div>
            <div class="font-mono text-xl text-brand-purple">$\\frac{2}{4}$</div>
            <div class="text-xs text-gray-400">Ainda √© "Metade"</div>
        </div>
        <div class="bg-white p-3 rounded-xl border-2 border-gray-200 shadow-sm">
            <div class="text-2xl">üòé</div>
            <div class="font-bold text-gray-700 mt-1">Disfarce 2</div>
            <div class="font-mono text-xl text-brand-orange">$\\frac{50}{100}$</div>
            <div class="text-xs text-gray-400">Continua "Metade"</div>
        </div>
    </div>

    <p>Chamamos isso de <strong>Fra√ß√µes Equivalentes</strong>. Elas se escrevem diferente, mas valem a mesma coisa.</p>

    [WIDGET:interactive_fraction_wall]

    <h3>2. A Regra da Justi√ßa ‚öñÔ∏è</h3>
    <p>Como criar uma fra√ß√£o equivalente? Usando o superpoder da multiplica√ß√£o (ou divis√£o).</p>
    
    <div class="bg-blue-50 p-4 rounded-xl border-l-4 border-brand-blue my-4 text-sm">
        <strong>A Lei √Åurea:</strong> O que voc√™ faz em cima, √© <strong>OBRIGADO</strong> a fazer embaixo.
        <ul class="mt-2 list-disc list-inside">
            <li>Multiplicou o numerador por 2? Multiplique o denominador por 2.</li>
            <li>Dividiu o de cima por 5? Divida o de baixo por 5.</li>
        </ul>
    </div>

    <div class="text-center font-mono text-lg my-4">
        $\\frac{3}{4} \\xrightarrow{\\times 2} \\frac{6}{8} \\xrightarrow{\\times 10} \\frac{60}{80}$
    </div>

    <h3>3. Simplifica√ß√£o: O "Detox" Matem√°tico ü•ó</h3>
    <p>√Äs vezes, encontramos fra√ß√µes "gordas" e pesadas, cheias de n√∫meros grandes, tipo $\\frac{20}{40}$.</p>
    <p>Simplificar √© fazer a fra√ß√£o "emagrecer" sem perder seu valor. Dividimos em cima e embaixo pelo mesmo n√∫mero.</p>

    <div class="flex flex-col items-center gap-2 my-4">
        <div class="bg-red-100 text-red-800 px-4 py-2 rounded-lg font-bold line-through decoration-2">$\\frac{20}{40}$</div>
        <div class="text-gray-400 text-xs">Dividindo tudo por 10...</div>
        <div class="bg-orange-100 text-orange-800 px-4 py-2 rounded-lg font-bold">$\\frac{2}{4}$</div>
        <div class="text-gray-400 text-xs">Dividindo tudo por 2...</div>
        <div class="bg-green-100 text-green-800 px-6 py-3 rounded-xl font-black text-2xl border-2 border-green-400 shadow-lg">$\\frac{1}{2}$</div>
    </div>

    <p>Quando n√£o d√° mais para dividir, chegamos na <strong>Fra√ß√£o Irredut√≠vel</strong>. √â a forma mais elegante e "fitness" da fra√ß√£o!</p>

    <div class="bg-yellow-50 p-3 rounded-lg border-l-4 border-brand-yellow mt-4 text-sm">
        <strong>üí° Dica:</strong> Para simplificar de uma vez s√≥, divida pelo <strong>MDC</strong> (M√°ximo Divisor Comum) do numerador e do denominador.
    </div>
`,

            "Fra√ß√£o de uma Quantidade (O Operador)": `
    <h3>1. O Segredo da Palavra "DE" üïµÔ∏è‚Äç‚ôÇÔ∏è</h3>
    <p>Na l√≠ngua portuguesa, "de" indica posse. Na matem√°tica, "de" indica uma opera√ß√£o muito espec√≠fica: <strong>MULTIPLICA√á√ÉO</strong>.</p>
    
    <div class="bg-blue-50 p-4 rounded-xl border-l-4 border-brand-blue my-4 text-center font-mono text-lg shadow-sm">
        $\\frac{1}{2}$ <span class="text-brand-red font-black">DE</span> 20 = $\\frac{1}{2}$ <span class="text-brand-red font-black">√ó</span> 20
    </div>

    <p>Quando queremos calcular uma parte de um total (como $\\frac{2}{3}$ de 12 chocolates), estamos usando a fra√ß√£o como um <strong>OPERADOR</strong>. Ela age sobre o n√∫mero para transform√°-lo.</p>

    <h3>2. O Algoritmo M√°gico ‚ú®</h3>
    <p>Para calcular a fra√ß√£o de uma quantidade, seguimos dois passos l√≥gicos:</p>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 my-6">
        <div class="bg-white p-4 rounded-xl border-2 border-brand-blue shadow-sm">
            <div class="text-3xl mb-2">üî™</div>
            <h4 class="font-bold text-brand-blue mb-2">Passo 1: Dividir pelo de Baixo</h4>
            <p class="text-sm text-gray-600">Primeiro, descobrimos quanto vale <strong>um peda√ßo</strong> (a unidade fracion√°ria).</p>
            <div class="mt-2 font-mono text-center bg-gray-50 rounded p-2 text-sm">
                $12 \\div 3 = 4$<br>
                <span class="text-xs text-gray-400">(Cada ter√ßo vale 4)</span>
            </div>
        </div>

        <div class="bg-white p-4 rounded-xl border-2 border-brand-orange shadow-sm">
            <div class="text-3xl mb-2">‚úñÔ∏è</div>
            <h4 class="font-bold text-brand-orange mb-2">Passo 2: Multiplicar pelo de Cima</h4>
            <p class="text-sm text-gray-600">Agora, pegamos a quantidade de peda√ßos que queremos.</p>
            <div class="mt-2 font-mono text-center bg-gray-50 rounded p-2 text-sm">
                $4 \\times 2 = 8$<br>
                <span class="text-xs text-gray-400">(Peguei 2 peda√ßos)</span>
            </div>
        </div>
    </div>

    <h3>3. Visualizando o Processo üç´</h3>
    <p>N√£o decore apenas a regra. Veja o que est√° acontecendo:</p>
    <p>Queremos $\\frac{3}{5}$ de 20 moedas.</p>

    [WIDGET:interactive_fraction_operator]

    <div class="bg-yellow-50 p-4 rounded-xl border-l-4 border-brand-yellow mt-6 text-sm">
        <strong>üí° Dica Ninja:</strong> A ordem n√£o altera o produto! Voc√™ pode multiplicar primeiro e dividir depois, se preferir.
        <br>
        $(20 \\times 3) \\div 5 = 60 \\div 5 = 12$.
        <br>
        <em>(Mas geralmente dividir primeiro deixa a conta mais f√°cil de cabe√ßa!)</em>
    </div>
`,


            "Opera√ß√µes com Fra√ß√µes (Soma e Subtra√ß√£o)": `
    <h3>1. A Regra de Ouro: O "Sobrenome" üìõ</h3>
    <p>Imagine que voc√™ vai somar frutas:</p>
    <div class="flex justify-center gap-4 my-2 font-bold text-gray-600">
        <span>2 Bananas</span> + <span>3 Bananas</span> = <span class="text-brand-green">5 Bananas</span>
    </div>
    <p>Agora tente somar:</p>
    <div class="flex justify-center gap-4 my-2 font-bold text-gray-600">
        <span>2 Bananas</span> + <span>3 Laranjas</span> = <span class="text-brand-red">?</span>
    </div>
    <p>N√£o d√° para dizer "5 Banalaranjas". Voc√™ precisa mudar o nome para "5 Frutas".</p>
    
    <p>Na fra√ß√£o, o <strong>Denominador</strong> √© o sobrenome (o tipo da fruta). S√≥ podemos somar se o sobrenome for <strong>IGUAL</strong>.</p>

    <h3>2. N√≠vel F√°cil: Denominadores Iguais üòä</h3>
    <p>Se os peda√ßos t√™m o mesmo tamanho, √© s√≥ alegria. Conserve o sobrenome e some os numeradores.</p>

    <div class="bg-green-50 p-4 rounded-xl border-2 border-green-200 text-center text-xl font-mono my-4">
        $\\frac{2}{7} + \\frac{3}{7} = \\frac{2+3}{7} = \\mathbf{\\frac{5}{7}}$
    </div>
    
    <p class="text-xs text-center text-gray-400"><em>(Eu comi 2 peda√ßos, voc√™ comeu 3. O tamanho do corte da pizza (7) n√£o muda!)</em></p>

    <h3>3. N√≠vel Desafio: Denominadores Diferentes ü§Ø</h3>
    <p>Quanto √© $\\frac{1}{2} + \\frac{1}{4}$? Se voc√™ responder $\\frac{2}{6}$, um matem√°tico chora.</p>
    
    <p>O peda√ßo $\\frac{1}{2}$ √© gigante. O peda√ßo $\\frac{1}{4}$ √© pequeno. Eles n√£o se misturam.</p>

    <div class="bg-blue-50 p-6 rounded-xl border-l-4 border-brand-blue my-6">
        <h4 class="font-bold text-brand-blue mb-2">üõ†Ô∏è A Estrat√©gia do Tradutor (MMC)</h4>
        <p class="text-sm mb-2">Precisamos cortar as pizzas de novo para que todos os peda√ßos fiquem do mesmo tamanho.</p>
        
        <ol class="list-decimal list-inside space-y-3 text-sm text-gray-700 font-medium">
            <li>
                <strong>Ache o MMC dos denominadores:</strong><br>
                Entre 2 e 4, o MMC √© <strong>4</strong>. Esse √© o novo denominador!
            </li>
            <li>
                <strong>O Mantra Sagrado:</strong><br>
                <span class="bg-white px-2 py-1 rounded border border-blue-200 text-brand-blue font-bold">"Divide pelo de baixo, multiplica pelo de cima."</span>
            </li>
            <li>
                <strong>Transforma√ß√£o:</strong><br>
                $\\frac{1}{2}$ vira $\\frac{2}{4}$ (2 dividido por 2 d√° 1, vezes 1 d√° 2).<br>
                $\\frac{1}{4}$ continua $\\frac{1}{4}$.
            </li>
        </ol>

        <div class="mt-4 text-center font-mono text-xl bg-white p-3 rounded border border-blue-100">
            $\\frac{2}{4} + \\frac{1}{4} = \\mathbf{\\frac{3}{4}}$
        </div>
    </div>

    <h3>4. Visualizando o Processo</h3>
    <p>Veja como $\\frac{1}{2}$ muda de roupa para virar $\\frac{3}{6}$ e poder somar com $\\frac{1}{6}$:</p>

    <div class="flex items-center justify-center gap-2 my-4">
        <div class="w-16 h-16 bg-gray-200 rounded-full relative overflow-hidden border-2 border-gray-300">
            <div class="absolute h-full w-1/2 bg-brand-blue left-0"></div>
            <div class="absolute inset-0 flex items-center justify-center font-bold text-white drop-shadow-md">1/2</div>
        </div>
        <span>+</span>
        <div class="w-16 h-16 bg-gray-200 rounded-full relative overflow-hidden border-2 border-gray-300">
            <div class="absolute top-0 left-0 w-full h-full bg-brand-orange" style="clip-path: polygon(50% 50%, 100% 50%, 75% 6.7%);"></div>
            <div class="absolute inset-0 flex items-center justify-center font-bold text-gray-500 text-xs mt-4 ml-4">1/6</div>
        </div>
    </div>
    
    <div class="text-center text-sm text-gray-500 mb-4">
        <em>N√£o encaixa! Vamos fatiar o 1/2 em tr√™s peda√ßos de 1/6...</em>
    </div>

    [WIDGET:interactive_fraction_addition]
`,
            "Opera√ß√µes com Fra√ß√µes (Mult. e Divis√£o)": `
    <h3>1. Multiplica√ß√£o: A Via Expressa üöÖ</h3>
    <p>Esque√ßa o MMC! A multiplica√ß√£o √© a opera√ß√£o mais amig√°vel das fra√ß√µes. Ela segue uma linha reta, como um trem nos trilhos.</p>

    <div class="bg-green-50 p-4 rounded-xl border-2 border-green-200 text-center my-4">
        <h4 class="font-bold text-brand-green mb-2">A Regra do "Cima-Cima, Baixo-Baixo"</h4>
        <p class="text-sm text-gray-700 mb-3">Multiplica quem est√° em cima com quem est√° em cima. Multiplica quem est√° embaixo com quem est√° embaixo.</p>
        
        <div class="inline-flex items-center gap-3 font-mono text-xl bg-white p-3 rounded-lg border border-green-100 shadow-sm">
            <div class="flex flex-col text-center">
                <span class="text-brand-blue font-bold">2</span>
                <span class="border-t-2 border-gray-400 w-full block"></span>
                <span class="text-brand-orange font-bold">3</span>
            </div>
            <span class="text-gray-400">√ó</span>
            <div class="flex flex-col text-center">
                <span class="text-brand-blue font-bold">4</span>
                <span class="border-t-2 border-gray-400 w-full block"></span>
                <span class="text-brand-orange font-bold">5</span>
            </div>
            <span class="text-gray-400">=</span>
            <div class="flex flex-col text-center">
                <span class="text-brand-green font-black">8</span>
                <span class="border-t-2 border-gray-400 w-full block"></span>
                <span class="text-brand-green font-black">15</span>
            </div>
        </div>
        <div class="text-xs text-gray-500 mt-2">
            (2 x 4 = 8) e (3 x 5 = 15)
        </div>
    </div>

    <p><strong>O que isso significa?</strong> Multiplicar √© achar uma parte da parte. $\\frac{1}{2} \\times \\frac{1}{2}$ √© "metade da metade" (que d√° um quarto, $\\frac{1}{4}$).</p>

    [WIDGET:interactive_fraction_mult]

    <h3>2. Divis√£o: A Regra da Cambalhota ü§∏‚Äç‚ôÇÔ∏è</h3>
    <p>Dividir por uma fra√ß√£o parece dif√≠cil, mas usamos um truque para transformar a divis√£o em multiplica√ß√£o!</p>

    <div class="bg-orange-50 p-6 rounded-xl border-l-4 border-brand-orange my-6 relative">
        <span class="absolute top-0 left-0 bg-brand-orange text-white text-[10px] px-2 py-1 rounded-br-lg font-bold">ALGORITMO SECRETO</span>
        
        <ol class="list-decimal list-inside space-y-4 text-sm text-gray-700">
            <li><strong>Mantenha</strong> a primeira fra√ß√£o exatamente igual.</li>
            <li><strong>Troque</strong> o sinal de dividir ($\\div$) por multiplicar ($\\times$).</li>
            <li><strong>INVERTA</strong> a segunda fra√ß√£o (fa√ßa ela dar uma cambalhota: o de baixo sobe, o de cima desce).</li>
        </ol>
    </div>

    <div class="flex flex-col items-center gap-2 my-4">
        <p class="font-bold text-gray-500 text-sm">Exemplo: $\\frac{2}{3} \\div \\frac{5}{7}$</p>
        <div class="text-2xl text-gray-300">‚Üì</div>
        <div class="font-mono text-xl bg-gray-100 p-3 rounded-lg">
            $\\frac{2}{3} \\times \\mathbf{\\frac{7}{5}}$
        </div>
        <div class="text-2xl text-gray-300">‚Üì</div>
        <div class="font-mono text-xl font-bold text-brand-text">
            $\\frac{14}{15}$
        </div>
    </div>

    [WIDGET:interactive_fraction_div]

    <div class="bg-red-50 p-4 rounded-xl border-2 border-red-200 mt-6 text-sm text-center">
        <h4 class="font-bold text-brand-red mb-1 flex justify-center items-center gap-2"><i class="fas fa-exclamation-circle"></i> Alerta de Confus√£o</h4>
        <p>Nunca fa√ßa MMC na multiplica√ß√£o ou divis√£o!</p>
        <p class="mt-1 text-gray-600">O MMC √© uma ferramenta exclusiva da Soma e Subtra√ß√£o. Aqui ele n√£o √© bem-vindo.</p>
    </div>
`,

            "Conex√£o: Fra√ß√£o vira Decimal": `
    <h3>1. A Mesma Pessoa, Roupas Diferentes ü•∏</h3>
    <p>Voc√™ sabia que $\\frac{1}{2}$ e $0,5$ s√£o exatamente o mesmo n√∫mero? √â como se fosse o Batman e o Bruce Wayne. Um usa capa (barra da fra√ß√£o), o outro usa terno (v√≠rgula).</p>

    <div class="flex justify-center items-center gap-8 my-6 text-center">
        <div class="bg-blue-50 p-4 rounded-xl border-2 border-blue-200">
            <span class="text-xs font-bold text-gray-400 uppercase">Fra√ß√£o</span>
            <div class="text-3xl font-black text-brand-blue mt-1">$\\frac{1}{2}$</div>
        </div>
        <div class="text-2xl text-gray-300">‚ûú</div>
        <div class="bg-green-50 p-4 rounded-xl border-2 border-green-200">
            <span class="text-xs font-bold text-gray-400 uppercase">Decimal</span>
            <div class="text-3xl font-black text-brand-green mt-1">0,5</div>
        </div>
    </div>

    <h3>2. O Segredo: Toda Fra√ß√£o √© uma Divis√£o ‚ûó</h3>
    <p>Para descobrir a identidade secreta de uma fra√ß√£o, basta fazer o que o tra√ßo manda: <strong>DIVIDIR</strong>.</p>
    
    <div class="bg-yellow-50 p-4 rounded-xl border-l-4 border-brand-yellow my-4 text-sm text-gray-700">
        <strong>Regra de Ouro:</strong> Divida o de cima (Numerador) pelo de baixo (Denominador).
        <br>Exemplo: $\\frac{3}{4} = 3 \\div 4 = 0,75$.
    </div>

    [WIDGET:interactive_fraction_decimal_converter]

    <h3>3. O Caminho de Volta (Decimal para Fra√ß√£o) üîô</h3>
    <p>E se eu tiver $0,25$ e quiser transformar em fra√ß√£o? √â f√°cil! Basta "ler" o n√∫mero corretamente.</p>
    
    <ul class="list-disc list-inside text-sm text-gray-700 space-y-2 bg-white p-4 rounded-xl border border-gray-200 shadow-sm">
        <li><strong>0,5</strong> = "Cinco d√©cimos" = $\\frac{5}{10}$ (Simplificando: $\\frac{1}{2}$)</li>
        <li><strong>0,25</strong> = "Vinte e cinco cent√©simos" = $\\frac{25}{100}$ (Simplificando: $\\frac{1}{4}$)</li>
        <li><strong>0,125</strong> = "Cento e vinte e cinco mil√©simos" = $\\frac{125}{1000}$ (Simplificando: $\\frac{1}{8}$)</li>
    </ul>

    <h3>4. Desafio de Velocidade üèÅ</h3>
    <p>Consegue traduzir r√°pido? Teste seus reflexos e acumule pontos!</p>

    [WIDGET:interactive_conversion_game]
`,

            "N√∫meros Decimais e Sistema Monet√°rio": `
    <h3>1. O Poder da V√≠rgula üöß</h3>
    <p>Imagine que voc√™ vai comprar um celular. O pre√ßo na etiqueta √© <strong>150000</strong>.</p>
    <p>Isso √© caro ou barato? Depende de onde est√° a v√≠rgula!</p>
    
    <ul class="list-none space-y-2 text-sm text-center my-4 font-mono font-bold">
        <li class="bg-red-50 p-2 rounded text-brand-red">R$ 1.500,00 (Caro!)</li>
        <li class="bg-green-50 p-2 rounded text-brand-green">R$ 150,00 (Barato!)</li>
        <li class="bg-blue-50 p-2 rounded text-brand-blue">R$ 15,00 (De gra√ßa!)</li>
    </ul>

    <p>A v√≠rgula funciona como um <strong>Muro</strong>. Ela separa dois mundos:</p>
    <div class="flex items-center justify-center gap-1 text-xl md:text-3xl font-black my-4 bg-white p-4 rounded-xl border-2 border-gray-200 shadow-sm">
        <span class="text-brand-blue">INTEIROS</span>
        <span class="text-brand-red mx-2 text-4xl">,</span>
        <span class="text-brand-orange">DECIMAIS</span>
    </div>

    <h3>2. A Anatomia dos Peda√ßos üîç</h3>
    <p>Os n√∫meros decimais s√£o fra√ß√µes disfar√ßadas. Cada casa depois da v√≠rgula tem um nome e um valor:</p>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-3 my-4 text-center">
        <div class="bg-gray-50 p-3 rounded-xl border border-gray-200 relative group hover:border-brand-blue transition-colors">
            <div class="text-xs font-bold text-gray-400 uppercase mb-1">1¬™ Casa</div>
            <div class="text-2xl font-black text-brand-blue">0,1</div>
            <div class="text-sm font-bold text-gray-600">D√©cimo</div>
            <div class="text-xs text-gray-400 mt-1">($\\frac{1}{10}$)</div>
            <div class="absolute -top-2 -right-2 bg-brand-blue text-white text-[10px] px-2 py-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity">Moeda de 10 centavos</div>
        </div>

        <div class="bg-gray-50 p-3 rounded-xl border border-gray-200 relative group hover:border-brand-orange transition-colors">
            <div class="text-xs font-bold text-gray-400 uppercase mb-1">2¬™ Casa</div>
            <div class="text-2xl font-black text-brand-orange">0,01</div>
            <div class="text-sm font-bold text-gray-600">Cent√©simo</div>
            <div class="text-xs text-gray-400 mt-1">($\\frac{1}{100}$)</div>
            <div class="absolute -top-2 -right-2 bg-brand-orange text-white text-[10px] px-2 py-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity">Moeda de 1 centavo</div>
        </div>

        <div class="bg-gray-50 p-3 rounded-xl border border-gray-200 relative group hover:border-brand-green transition-colors">
            <div class="text-xs font-bold text-gray-400 uppercase mb-1">3¬™ Casa</div>
            <div class="text-2xl font-black text-brand-green">0,001</div>
            <div class="text-sm font-bold text-gray-600">Mil√©simo</div>
            <div class="text-xs text-gray-400 mt-1">($\\frac{1}{1000}$)</div>
            <div class="absolute -top-2 -right-2 bg-brand-green text-white text-[10px] px-2 py-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity">Combust√≠vel (Posto)</div>
        </div>
    </div>

    [WIDGET:interactive_place_value_extended]

    <h3>3. Quem √© Maior? (A Pegadinha) ‚öñÔ∏è</h3>
    <p>Qual n√∫mero √© maior: <strong>0,5</strong> ou <strong>0,12</strong>?</p>
    
    <div class="bg-red-50 p-4 rounded-xl border-l-4 border-brand-red my-4 text-sm">
        <strong>üö´ O Erro Comum:</strong> Muita gente responde 0,12 porque "12 √© maior que 5". <strong>ERRADO!</strong>
    </div>

    <p>Para comparar decimais, voc√™ precisa ser justo. Use a t√©cnica dos <strong>Zeros Invis√≠veis</strong> para igualar as casas:</p>

    <div class="flex flex-col md:flex-row justify-center items-center gap-6 my-4 font-mono text-xl">
        <div class="text-center">
            <p class="text-gray-400 text-xs font-sans mb-1">O desafiante</p>
            <span class="font-bold text-brand-text">0,5</span>
            <span class="text-brand-green font-bold animate-pulse">0</span>
        </div>
        <div class="text-2xl font-black text-brand-blue">></div>
        <div class="text-center">
            <p class="text-gray-400 text-xs font-sans mb-1">O oponente</p>
            <span class="font-bold text-brand-text">0,12</span>
        </div>
    </div>

    <p class="text-center italic text-gray-600 text-sm">
        Agora fica f√°cil: <strong>50</strong> centavos √© maior que <strong>12</strong> centavos.<br>
        Logo, $0,5 > 0,12$.
    </p>

    <h3>4. Dinheiro: O Decimal da Vida Real üíµ</h3>
    <p>O nosso sistema monet√°rio (Real) √© baseado em <strong>Cent√©simos</strong>.</p>
    <ul class="list-disc list-inside text-gray-700 text-sm space-y-2 bg-green-50 p-4 rounded-xl border border-green-100">
        <li>1 Real = 1 Inteiro ($1,00$).</li>
        <li>1 Centavo = 1 Cent√©simo de Real ($0,01$).</li>
        <li>50 Centavos = 50 Cent√©simos ou 5 D√©cimos ($0,50$ ou $0,5$).</li>
    </ul>
`,

            "Opera√ß√µes com Decimais": `
    <h3>1. Adi√ß√£o e Subtra√ß√£o: A Regra dos Bot√µes üëî</h3>
    <p>Imagine que voc√™ est√° abotoando uma camisa. Se voc√™ errar o primeiro bot√£o, a camisa inteira fica torta. Com decimais √© igual!</p>

    <div class="bg-blue-50 p-6 rounded-xl border-l-4 border-brand-blue my-4 shadow-sm">
        <h4 class="font-bold text-brand-blue text-lg mb-2">üìç A Lei do Alinhamento</h4>
        <p class="text-gray-700">N√£o alinhe pelo final do n√∫mero. <strong>Alinhe pela V√çRGULA!</strong></p>
        <p class="mt-2 text-sm text-gray-600">V√≠rgula embaixo de v√≠rgula. Unidade embaixo de unidade.</p>
    </div>

    <div class="flex flex-col md:flex-row items-center gap-8 justify-center my-6">
        <div class="bg-red-50 p-4 rounded-xl border-2 border-red-200 text-center opacity-70 grayscale transition-all hover:grayscale-0 hover:opacity-100">
            <div class="text-red-500 font-bold mb-2"><i class="fas fa-times"></i> JEITO ERRADO</div>
            <div class="font-mono text-xl text-gray-500">
                <div>3,5</div>
                <div class="border-b-2 border-gray-400">+ 12,42</div>
                <div>????</div>
            </div>
            <div class="text-xs mt-2 text-red-400 font-bold">Alinhou √† direita (Erro!)</div>
        </div>

        <div class="bg-green-50 p-4 rounded-xl border-2 border-green-200 text-center transform scale-110 shadow-lg">
            <div class="text-brand-green font-bold mb-2"><i class="fas fa-check"></i> JEITO CERTO</div>
            <div class="font-mono text-xl text-brand-text font-bold relative">
                <div class="absolute top-0 bottom-0 left-[58px] w-0.5 bg-red-400 opacity-50"></div>
                
                <div class="flex justify-end w-32">03,5<span class="text-brand-green">0</span></div>
                <div class="flex justify-end w-32 border-b-4 border-brand-text">+ 12,42</div>
                <div class="flex justify-end w-32 pt-1 text-brand-blue">15,92</div>
            </div>
            <div class="text-xs mt-2 text-brand-green font-bold">V√≠rgula sobre V√≠rgula!</div>
        </div>
    </div>

    <p><strong>Dica Ninja:</strong> Viu aquele zero verde ali em cima? Quando os n√∫meros t√™m tamanhos diferentes, preencha os buracos com <strong>Zeros Fantasmas</strong> para ningu√©m ficar sozinho.</p>

    [WIDGET:interactive_decimal_add_sub]

    <h3>2. Multiplica√ß√£o: O Esconde-Esconde üôà</h3>
    <p>Na multiplica√ß√£o, a v√≠rgula atrapalha. Ent√£o, a gente finge que ela n√£o existe!</p>

    <ol class="list-decimal list-inside space-y-4 mt-4 bg-white p-4 rounded-xl border border-gray-200">
        <li>
            <strong>Esconda a v√≠rgula:</strong> Multiplique os n√∫meros como se fossem naturais.
            <br><span class="text-xs text-gray-500 font-mono ml-5">Ex: 2,5 x 0,03 &rarr; Fa√ßa 25 x 3 = 75.</span>
        </li>
        <li>
            <strong>Conte as casas:</strong> Quantos n√∫meros haviam depois da v√≠rgula no total?
            <br><span class="text-xs text-gray-500 font-mono ml-5">2,<strong>5</strong> (1 casa) + 0,<strong>03</strong> (2 casas) = <strong>3 casas</strong> totais.</span>
        </li>
        <li>
            <strong>Devolva no final:</strong> O resultado precisa ter o mesmo n√∫mero total de casas decimais.
            <br><span class="text-xs text-gray-500 font-mono ml-5">75 vira <strong>0,075</strong> (3 casas).</span>
        </li>
    </ol>

    [WIDGET:interactive_decimal_mult]

    <h3>3. Divis√£o: O Nivelamento ‚öñÔ∏è</h3>
    <p>Dividir com v√≠rgula √© um pesadelo. O segredo √©: <strong>Eliminar a v√≠rgula</strong> antes de come√ßar a conta.</p>
    
    <div class="bg-orange-50 p-4 rounded-xl border-l-4 border-brand-orange my-4">
        <h4 class="font-bold text-brand-orange mb-2">Passo a Passo:</h4>
        <ul class="space-y-2 text-sm text-gray-800">
            <li>1Ô∏è‚É£ Olhe quem tem mais casas decimais.</li>
            <li>2Ô∏è‚É£ <strong>Iguale as casas</strong> do outro n√∫mero colocando zeros.</li>
            <li>3Ô∏è‚É£ Agora que os dois t√™m o mesmo n√∫mero de casas, <strong>corte a v√≠rgula</strong> dos dois!</li>
            <li>4Ô∏è‚É£ Divida normal (como se fossem naturais).</li>
        </ul>
    </div>

    <div class="flex flex-col items-center justify-center gap-2 font-mono text-lg my-4">
        <div>$6 \\div 0,5$</div>
        <div class="text-gray-400 text-xs">Iguala as casas (uma casa decimal)</div>
        <div class="font-bold text-brand-blue">$6,0 \\div 0,5$</div>
        <div class="text-gray-400 text-xs">Corta a v√≠rgula</div>
        <div class="font-black text-brand-green text-2xl">$60 \\div 5 = 12$</div>
    </div>

    [WIDGET:interactive_decimal_div]

    <h3>4. Atalho: Multiplicar e Dividir por 10, 100, 1000 üöÄ</h3>
    <p>N√£o fa√ßa conta armada para isso! √â s√≥ fazer a v√≠rgula pular.</p>
    
    <div class="grid grid-cols-2 gap-4 mt-4">
        <div class="bg-gray-100 p-3 rounded-lg text-center">
            <strong class="text-brand-blue block mb-1">Multiplicar (x)</strong>
            <span class="text-xs text-gray-600">O n√∫mero cresce.</span>
            <div class="mt-2 font-bold">V√≠rgula anda para a <br>üëâ DIREITA</div>
            <div class="text-xs font-mono mt-1 text-brand-blue">1,5 x 10 = 15</div>
        </div>
        <div class="bg-gray-100 p-3 rounded-lg text-center">
            <strong class="text-brand-orange block mb-1">Dividir (√∑)</strong>
            <span class="text-xs text-gray-600">O n√∫mero diminui.</span>
            <div class="mt-2 font-bold">V√≠rgula anda para a <br>üëà ESQUERDA</div>
            <div class="text-xs font-mono mt-1 text-brand-orange">15 √∑ 10 = 1,5</div>
        </div>
    </div>
`,

            "Porcentagem B√°sica": `
    <h3>1. O C√≥digo Secreto do % üïµÔ∏è</h3>
    <p>Voc√™ v√™ esse s√≠mbolo o tempo todo: na bateria do celular, na liquida√ß√£o da loja, no download do jogo. Mas o que ele significa?</p>
    
    <div class="flex items-center justify-center gap-4 my-6">
        <div class="text-6xl font-black text-brand-blue">%</div>
        <div class="flex flex-col text-sm text-gray-600">
            <span><strong>POR</strong> (Divis√£o)</span>
            <span><strong>CENTO</strong> (Cem)</span>
        </div>
    </div>

    <p>Dizer <strong>30%</strong> √© apenas um jeito r√°pido de escrever a fra√ß√£o $\\frac{30}{100}$ ou o decimal <strong>0,30</strong>. √â tudo a mesma pessoa com roupas diferentes!</p>

    <div class="bg-gray-50 p-4 rounded-xl border-2 border-gray-200 my-4">
        <h4 class="font-bold text-gray-700 mb-2 text-center">A Bateria do Celular üîã</h4>
        <div class="w-full bg-gray-300 rounded-full h-6 overflow-hidden relative border border-gray-400">
            <div class="bg-brand-green h-full transition-all duration-1000" style="width: 50%"></div>
            <div class="absolute inset-0 flex items-center justify-center text-xs font-bold text-white drop-shadow-md">50%</div>
        </div>
        <p class="text-center text-xs text-gray-500 mt-2">50% significa "metade do tanque cheio". De cada 100 barrinhas, 50 est√£o cheias.</p>
    </div>

    <h3>2. C√°lculo Mental: Os 4 Fant√°sticos ü¶∏‚Äç‚ôÇÔ∏è</h3>
    <p>Voc√™ n√£o precisa fazer conta armada para tudo. Existem quatro porcentagens que voc√™ tem que saber de cabe√ßa:</p>

    <div class="grid grid-cols-2 gap-3 my-4">
        <div class="bg-blue-50 p-3 rounded-lg border border-blue-200 text-center hover:scale-105 transition-transform">
            <strong class="text-brand-blue text-xl block">50%</strong>
            <span class="text-xs font-bold text-gray-500 uppercase">A Metade</span>
            <div class="mt-2 text-sm bg-white rounded p-1 shadow-sm">Divida por 2</div>
        </div>

        <div class="bg-orange-50 p-3 rounded-lg border border-orange-200 text-center hover:scale-105 transition-transform">
            <strong class="text-brand-orange text-xl block">25%</strong>
            <span class="text-xs font-bold text-gray-500 uppercase">Metade da Metade</span>
            <div class="mt-2 text-sm bg-white rounded p-1 shadow-sm">Divida por 4</div>
        </div>

        <div class="bg-green-50 p-3 rounded-lg border border-green-200 text-center hover:scale-105 transition-transform">
            <strong class="text-brand-green text-xl block">100%</strong>
            <span class="text-xs font-bold text-gray-500 uppercase">O Todo</span>
            <div class="mt-2 text-sm bg-white rounded p-1 shadow-sm">√â o pr√≥prio n√∫mero!</div>
        </div>

        <div class="bg-purple-50 p-3 rounded-lg border border-purple-200 text-center hover:scale-105 transition-transform">
            <strong class="text-brand-purple text-xl block">10%</strong>
            <span class="text-xs font-bold text-gray-500 uppercase">A D√©cima Parte</span>
            <div class="mt-2 text-sm bg-white rounded p-1 shadow-sm">Ande a v√≠rgula üëà</div>
        </div>
    </div>

    <h3>3. O Truque dos 10% (Como calcular qualquer coisa) üß†</h3>
    <p>Quer calcular <strong>30% de 50 reais</strong> sem papel?</p>
    
    <div class="bg-yellow-50 p-6 rounded-xl border-l-4 border-brand-yellow my-6">
        <ol class="list-decimal list-inside space-y-4 text-sm text-gray-800">
            <li>
                <strong>Ache 10% primeiro:</strong><br>
                10% de 50 √© f√°cil. Basta cortar um zero (ou andar a v√≠rgula).<br>
                <span class="font-bold text-brand-blue">10% = 5 reais.</span>
            </li>
            <li>
                <strong>Multiplique pelo que voc√™ quer:</strong><br>
                Voc√™ quer 30%? Isso √© 3 vezes o 10%.<br>
                $3 \\times 5 = 15$.
            </li>
        </ol>
        <div class="mt-4 text-center font-black text-xl text-brand-text bg-white p-2 rounded-lg shadow-sm">
            30% de 50 = R$ 15,00
        </div>
    </div>

    <h3>4. A Fra√ß√£o Centesimal</h3>
    <p>Lembre-se sempre: Porcentagem √© uma fra√ß√£o. Quando voc√™ v√™ um gr√°fico de pizza, ele √© um bolo inteiro (100%) fatiado.</p>

    [WIDGET:interactive_charts_demo]
    
    <div class="text-center text-xs text-gray-400 mt-2">
        <em>(Dica: Mude o gr√°fico para "Pizza" para ver as porcentagens somando o todo!)</em>
    </div>
`,
            "Comprimento e Per√≠metro": `
    <h3>1. O Mundo em Linha Reta üìè</h3>
    <p>Comprimento √© a dist√¢ncia entre dois pontos. √â uma medida de <strong>1 Dimens√£o</strong> (s√≥ tem tamanho, n√£o tem largura).</p>
    
    <p>A unidade principal √© o <strong>Metro (m)</strong>. Mas nem tudo cabe no metro:</p>
    
    <div class="grid grid-cols-1 md:grid-cols-3 gap-3 my-4 text-center">
        <div class="bg-blue-50 p-3 rounded-lg border border-blue-200">
            <div class="text-2xl">üêú</div>
            <strong class="text-brand-blue block mt-1">Pequenos</strong>
            <p class="text-xs text-gray-500">Mil√≠metros (mm) e Cent√≠metros (cm). Para l√°pis, insetos e telas.</p>
        </div>
        <div class="bg-green-50 p-3 rounded-lg border border-green-200">
            <div class="text-2xl">üö∂</div>
            <strong class="text-brand-green block mt-1">M√©dios</strong>
            <p class="text-xs text-gray-500">Metro (m). Para alturas, casas e tecidos.</p>
        </div>
        <div class="bg-orange-50 p-3 rounded-lg border border-orange-200">
            <div class="text-2xl">üöó</div>
            <strong class="text-brand-orange block mt-1">Grandes</strong>
            <p class="text-xs text-gray-500">Quil√¥metro (km). Para estradas e viagens.</p>
        </div>
    </div>

    <h3>2. A Escada M√©trica (Convers√£o) ü™ú</h3>
    <p>Como transformar km em m? Imagine uma escada. Cada degrau vale <strong>10 vezes</strong>.</p>

    <div class="bg-gray-50 p-4 rounded-xl border-2 border-gray-200 my-4 overflow-x-auto">
        <div class="flex items-center justify-center min-w-[300px] gap-1 font-mono text-sm md:text-base">
            <div class="flex flex-col items-center group">
                <div class="w-10 h-10 bg-brand-orange text-white rounded-full flex items-center justify-center font-bold shadow-md group-hover:scale-110 transition-transform">km</div>
                <span class="text-[10px] text-gray-400 mt-1">x10</span>
            </div>
            <div class="h-1 w-4 bg-gray-300"></div>
            <div class="flex flex-col items-center group">
                <div class="w-10 h-10 bg-orange-300 text-white rounded-full flex items-center justify-center font-bold shadow-md group-hover:scale-110 transition-transform">hm</div>
                <span class="text-[10px] text-gray-400 mt-1">x10</span>
            </div>
            <div class="h-1 w-4 bg-gray-300"></div>
            <div class="flex flex-col items-center group">
                <div class="w-10 h-10 bg-orange-200 text-white rounded-full flex items-center justify-center font-bold shadow-md group-hover:scale-110 transition-transform">dam</div>
                <span class="text-[10px] text-gray-400 mt-1">x10</span>
            </div>
            <div class="h-1 w-4 bg-gray-300"></div>
            <div class="flex flex-col items-center group">
                <div class="w-12 h-12 bg-brand-blue text-white rounded-xl flex items-center justify-center font-black shadow-lg border-4 border-white z-10 scale-110">m</div>
                <span class="text-[10px] text-brand-blue font-bold mt-1">BASE</span>
            </div>
            <div class="h-1 w-4 bg-gray-300"></div>
            <div class="flex flex-col items-center group">
                <div class="w-10 h-10 bg-blue-200 text-white rounded-full flex items-center justify-center font-bold shadow-md group-hover:scale-110 transition-transform">dm</div>
                <span class="text-[10px] text-gray-400 mt-1">√∑10</span>
            </div>
            <div class="h-1 w-4 bg-gray-300"></div>
            <div class="flex flex-col items-center group">
                <div class="w-10 h-10 bg-blue-300 text-white rounded-full flex items-center justify-center font-bold shadow-md group-hover:scale-110 transition-transform">cm</div>
                <span class="text-[10px] text-gray-400 mt-1">√∑10</span>
            </div>
            <div class="h-1 w-4 bg-gray-300"></div>
            <div class="flex flex-col items-center group">
                <div class="w-10 h-10 bg-brand-blue text-white rounded-full flex items-center justify-center font-bold shadow-md group-hover:scale-110 transition-transform">mm</div>
                <span class="text-[10px] text-gray-400 mt-1">√∑10</span>
            </div>
        </div>
    </div>

    <ul class="list-disc list-inside text-sm text-gray-700 ml-2">
        <li>‚¨áÔ∏è <strong>Descer a escada (Grande para Pequeno):</strong> Multiplica por 10 (o n√∫mero aumenta, ganha zeros). <br><em>Ex: 1 km = 1000 m.</em></li>
        <li>‚¨ÜÔ∏è <strong>Subir a escada (Pequeno para Grande):</strong> Divide por 10 (o n√∫mero diminui, a v√≠rgula anda). <br><em>Ex: 100 cm = 1 m.</em></li>
    </ul>

    [WIDGET:interactive_unit_converter]

    <h3>3. Per√≠metro: O Caminho da Formiga üêú</h3>
    <p>O <strong>Per√≠metro</strong> √© a medida do <strong>CONTORNO</strong> de uma figura. Imagine que voc√™ √© uma formiga e precisa dar uma volta completa em cima da linha do desenho.</p>
    
    <div class="bg-yellow-50 p-4 rounded-xl border-l-4 border-brand-yellow my-4 text-center">
        <p class="font-bold text-brand-text text-lg">Per√≠metro = Soma de TODOS os lados</p>
        <p class="text-xs text-gray-500 mt-1">(Cuidado: n√£o esque√ßa nenhum lado escondido!)</p>
    </div>

    <div class="flex flex-col items-center gap-4 my-4">
        <div class="relative w-40 h-24 border-4 border-brand-purple bg-purple-50 flex items-center justify-center rounded-lg">
            <span class="absolute -top-6 text-xs font-bold text-purple-600">10 cm</span>
            <span class="absolute -bottom-6 text-xs font-bold text-purple-600">10 cm</span>
            <span class="absolute -left-10 text-xs font-bold text-purple-600">5 cm</span>
            <span class="absolute -right-10 text-xs font-bold text-purple-600">5 cm</span>
            <div class="text-center">
                <span class="text-xs text-gray-400 font-bold uppercase">Ret√¢ngulo</span><br>
                <span class="font-bold text-brand-purple">P = 30 cm</span>
            </div>
        </div>
        <p class="text-sm text-gray-600">Conta: $10 + 5 + 10 + 5 = 30$ cm.</p>
    </div>

    <div class="bg-red-50 p-3 rounded-lg border border-red-200 text-sm mt-4">
        <strong class="text-brand-red"><i class="fas fa-exclamation-triangle"></i> Alerta de Erro:</strong>
        <p>Voc√™ <strong>N√ÉO</strong> pode somar ma√ß√£s com bananas! Antes de calcular o per√≠metro, garanta que todos os lados est√£o na mesma unidade (tudo em cm ou tudo em m).</p>
    </div>
`,
            "√Årea de Figuras Planas": `
    <h3>1. O Ch√£o √© Geometria! üü•</h3>
    <p>Imagine que voc√™ quer colocar carpete no seu quarto. N√£o adianta medir as paredes (isso √© per√≠metro). Voc√™ precisa medir o <strong>CH√ÉO</strong>.</p>
    
    <div class="flex gap-4 justify-center my-4">
        <div class="bg-white p-3 rounded-xl border-2 border-gray-200 text-center w-1/2">
            <strong class="text-gray-500 block mb-1">Per√≠metro (1D)</strong>
            <div class="h-16 w-24 border-4 border-brand-blue mx-auto mb-2"></div>
            <p class="text-xs text-brand-blue font-bold">Mede a Borda (m)</p>
        </div>
        <div class="bg-white p-3 rounded-xl border-2 border-gray-200 text-center w-1/2">
            <strong class="text-gray-500 block mb-1">√Årea (2D)</strong>
            <div class="h-16 w-24 bg-brand-orange mx-auto mb-2"></div>
            <p class="text-xs text-brand-orange font-bold">Mede o Recheio (m¬≤)</p>
        </div>
    </div>

    <p>A unidade de medida √© o <strong>Quadrado</strong> ($m^2$, $cm^2$). Calcular a √°rea √© responder: <em>"Quantos quadradinhos cabem aqui dentro?"</em></p>

    <h3>2. O Ret√¢ngulo: A M√£e de Todas as √Åreas üì¶</h3>
    <p>N√£o precisa contar os quadradinhos um por um! Use a multiplica√ß√£o inteligente.</p>
    
    <div class="bg-blue-50 p-4 rounded-xl border-l-4 border-brand-blue my-4 flex gap-4 items-center">
        <div class="grid grid-cols-4 gap-0.5 w-24 bg-white p-1 border border-blue-200">
            <div class="h-4 bg-blue-200"></div><div class="h-4 bg-blue-200"></div><div class="h-4 bg-blue-200"></div><div class="h-4 bg-blue-200"></div>
            <div class="h-4 bg-blue-200"></div><div class="h-4 bg-blue-200"></div><div class="h-4 bg-blue-200"></div><div class="h-4 bg-blue-200"></div>
            <div class="h-4 bg-blue-200"></div><div class="h-4 bg-blue-200"></div><div class="h-4 bg-blue-200"></div><div class="h-4 bg-blue-200"></div>
        </div>
        <div class="text-sm text-brand-blue">
            <strong>3 fileiras</strong> com <strong>4 pisos</strong> cada.<br>
            Total: $3 \\times 4 = 12$.
        </div>
    </div>

    <div class="text-center font-mono text-xl font-bold bg-gray-100 p-2 rounded mb-6">
        √Årea = Base $\\times$ Altura ($A = b \\cdot h$)
    </div>

    <h3>3. O Tri√¢ngulo: A Metade M√°gica üìê</h3>
    <p>E se a figura tiver uma ponta? Como contar quadradinhos quebrados?</p>
    <p><strong>Truque Ninja:</strong> Imagine que o tri√¢ngulo √© um ret√¢ngulo que foi cortado ao meio na diagonal!</p>

    <div class="relative w-40 h-24 mx-auto my-4 border-2 border-dashed border-gray-400 bg-transparent">
        <div class="absolute top-0 left-0 w-full h-full bg-brand-orange opacity-50" style="clip-path: polygon(0% 100%, 100% 100%, 100% 0%);"></div>
        <div class="absolute bottom-2 left-2 text-xs font-bold text-gray-500">Base</div>
        <div class="absolute right-2 top-10 text-xs font-bold text-gray-500 rotate-90">Altura</div>
        <div class="absolute inset-0 flex items-center justify-center font-black text-white text-shadow">METADE</div>
    </div>

    <div class="text-center font-mono text-xl font-bold bg-orange-50 text-brand-orange p-2 rounded border border-orange-200 mb-6">
        √Årea = $\\frac{\\text{Base} \\cdot \\text{Altura}}{2}$
    </div>

    [WIDGET:interactive_area_calc]

    <h3>4. A Estrat√©gia do LEGO (Decomposi√ß√£o) üß©</h3>
    <p>E se a figura for estranha, tipo um "L" ou uma casa? Simples: <strong>Quebre ela!</strong></p>
    <ul class="list-disc list-inside text-gray-700 text-sm space-y-1 bg-yellow-50 p-4 rounded-xl">
        <li>Corte a figura em ret√¢ngulos e tri√¢ngulos menores.</li>
        <li>Calcule a √°rea de cada peda√ßo separado.</li>
        <li>Some tudo no final. √â como desmontar um brinquedo!</li>
    </ul>
`,
            "Investigando √Årea vs Per√≠metro": `
    <h3>1. A Grande Ilus√£o üé©</h3>
    <p>Se voc√™ dobrar o tamanho do lado de um quadrado, o que acontece com a √°rea dele? Dobra tamb√©m?</p>
    <p class="text-center font-black text-brand-red text-xl my-2">N√ÉO!</p>

    <div class="grid grid-cols-2 gap-4 text-center my-4">
        <div class="flex flex-col items-center">
            <div class="w-8 h-8 bg-brand-blue mb-2"></div>
            <p class="text-xs">Lado 1<br>√Årea 1</p>
        </div>
        <div class="flex flex-col items-center">
            <div class="w-16 h-16 bg-brand-blue grid grid-cols-2 gap-0.5 p-0.5">
                <div class="bg-white opacity-30"></div><div class="bg-white opacity-30"></div>
                <div class="bg-white opacity-30"></div><div class="bg-white opacity-30"></div>
            </div>
            <p class="text-xs mt-2">Lado 2 (Dobrou)<br><strong>√Årea 4 (Quadruplicou!)</strong></p>
        </div>
    </div>

    <div class="bg-blue-50 p-4 rounded-xl border-l-4 border-brand-blue text-sm">
        <strong>A Regra do Quadrado:</strong><br>
        Quando voc√™ aumenta o comprimento ($k$), a √°rea aumenta ao quadrado ($k^2$).
        <br>3x maior $\to$ 9x mais √°rea.
        <br>10x maior $\to$ 100x mais √°rea.
    </div>
`,
            "Volume e Capacidade": `
    <h3>1. O Mundo em 3D üßä</h3>
    <p>At√© agora, medimos linhas (1D) e superf√≠cies (2D). Agora, vamos medir o <strong>ESPA√áO</strong>.</p>
    <p>O Volume √© a quantidade de espa√ßo que um objeto ocupa. A unidade de medida √© o <strong>Cubo</strong>.</p>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-3 my-4 text-center text-sm">
        <div class="bg-gray-50 p-3 rounded-xl border border-gray-200">
            <div class="text-2xl">üìè</div>
            <strong>Comprimento</strong>
            <div class="text-xs text-gray-500">Metros ($m$)</div>
        </div>
        <div class="bg-gray-50 p-3 rounded-xl border border-gray-200">
            <div class="text-2xl">üü•</div>
            <strong>√Årea</strong>
            <div class="text-xs text-gray-500">Metros Quadrados ($m^2$)</div>
        </div>
        <div class="bg-blue-50 p-3 rounded-xl border-2 border-brand-blue shadow-sm scale-105">
            <div class="text-2xl">üì¶</div>
            <strong class="text-brand-blue">Volume</strong>
            <div class="text-xs text-gray-500">Metros C√∫bicos ($m^3$)</div>
        </div>
    </div>

    <h3>2. O Bloco Retangular (A Caixa de Sapato)</h3>
    <p>Como calcular o volume de uma caixa? √â f√°cil: imagine que a caixa √© feita de folhas de papel empilhadas.</p>
    
    <ul class="list-none space-y-2 bg-yellow-50 p-4 rounded-xl border-l-4 border-brand-yellow my-4 text-sm text-gray-700">
        <li>1Ô∏è‚É£ Calcule a <strong>√Årea da Base</strong> (o ch√£o da caixa).</li>
        <li>2Ô∏è‚É£ Multiplique pela <strong>Altura</strong> (quantas camadas tem).</li>
    </ul>

    <div class="text-center font-mono text-xl font-bold bg-gray-100 p-3 rounded-lg border border-gray-300 my-4">
        V = Comprimento $\\times$ Largura $\\times$ Altura
    </div>

    [WIDGET:interactive_volume_cube]

    <h3>3. Volume vs. Capacidade ü•õ</h3>
    <p>Parecem a mesma coisa, mas t√™m uma diferen√ßa sutil:</p>
    <ul class="list-disc list-inside text-sm text-gray-700 space-y-2">
        <li><strong>Volume:</strong> √â o tamanho do objeto (por fora). Medimos em $m^3$ ou $cm^3$.</li>
        <li><strong>Capacidade:</strong> √â quanto l√≠quido ou g√°s cabe dentro (por dentro). Medimos em <strong>Litros (L)</strong>.</li>
    </ul>

    <h3>4. A Ponte M√°gica: S√≥lido $\\to$ L√≠quido üåâ</h3>
    <p>Como transformar matem√°gica (cubos) em realidade (√°gua)? Existem portais de convers√£o que voc√™ precisa decorar:</p>

    <div class="grid grid-cols-1 gap-3 my-4">
        <div class="flex items-center gap-4 bg-white p-3 rounded-xl border-l-4 border-brand-green shadow-sm">
            <div class="text-3xl">üé≤</div>
            <div>
                <h4 class="font-bold text-gray-700">O Dado Pequeno ($1 cm^3$)</h4>
                <p class="text-xs text-gray-500">Um dadinho de 1cm cabe <strong>1 mililitro (mL)</strong> de √°gua. √â uma gota grande.</p>
                <div class="font-mono font-bold text-brand-green mt-1">1 cm¬≥ = 1 mL</div>
            </div>
        </div>

        <div class="flex items-center gap-4 bg-white p-3 rounded-xl border-l-4 border-brand-blue shadow-sm">
            <div class="text-3xl">ü•õ</div>
            <div>
                <h4 class="font-bold text-gray-700">A Caixa M√©dia ($1 dm^3$)</h4>
                <p class="text-xs text-gray-500">Um cubo de 10cm x 10cm x 10cm cabe exatamente <strong>1 Litro</strong>.</p>
                <div class="font-mono font-bold text-brand-blue mt-1">1 dm¬≥ = 1 L</div>
            </div>
        </div>

        <div class="flex items-center gap-4 bg-white p-3 rounded-xl border-l-4 border-brand-orange shadow-sm">
            <div class="text-3xl">üöõ</div>
            <div>
                <h4 class="font-bold text-gray-700">O Cubo Gigante ($1 m^3$)</h4>
                <p class="text-xs text-gray-500">Um cubo de 1 metro de lado √© enorme! Cabem <strong>1.000 Litros</strong>.</p>
                <div class="font-mono font-bold text-brand-orange mt-1">1 m¬≥ = 1.000 L</div>
            </div>
        </div>
    </div>
`,
            "Tempo e suas Convers√µes": `
    <h3>1. O Rebelde do Sistema ‚è≥</h3>
    <p>Quase tudo na matem√°tica √© feito de 10 em 10 (metros, dinheiro, quilos). Mas o <strong>Tempo</strong> √© rebelde. Ele n√£o gosta do 10.</p>
    <p>O Tempo usa o <strong>Sistema Sexagesimal</strong> (Base 60), inventado na antiga Babil√¥nia. Por isso, suas convers√µes s√£o diferentes:</p>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 my-6 text-center">
        <div class="bg-blue-50 p-4 rounded-xl border-2 border-blue-200 shadow-sm">
            <div class="text-3xl mb-2">üïí</div>
            <h4 class="font-bold text-brand-blue uppercase text-xs">A Hora (h)</h4>
            <p class="text-sm font-bold text-gray-600 mt-2">1 h = 60 min</p>
        </div>
        <div class="bg-orange-50 p-4 rounded-xl border-2 border-orange-200 shadow-sm">
            <div class="text-3xl mb-2">‚è±Ô∏è</div>
            <h4 class="font-bold text-brand-orange uppercase text-xs">O Minuto (min)</h4>
            <p class="text-sm font-bold text-gray-600 mt-2">1 min = 60 s</p>
        </div>
        <div class="bg-green-50 p-4 rounded-xl border-2 border-green-200 shadow-sm">
            <div class="text-3xl mb-2">‚ö°</div>
            <h4 class="font-bold text-brand-green uppercase text-xs">O Segundo (s)</h4>
            <p class="text-sm font-bold text-gray-600 mt-2">A base de tudo</p>
        </div>
    </div>

    <h3>2. A M√°quina do Tempo (Convers√£o) ‚öôÔ∏è</h3>
    <p>Para viajar entre as unidades, voc√™ precisa multiplicar ou dividir por <strong>60</strong>.</p>

    <div class="flex flex-col md:flex-row items-center justify-center gap-2 my-4 font-mono font-bold text-lg bg-gray-100 p-4 rounded-xl border border-gray-300">
        <div class="text-brand-blue">Horas</div>
        <div class="flex flex-col items-center px-2">
            <span class="text-xs text-gray-500">x 60</span>
            <i class="fas fa-arrow-right text-gray-400"></i>
        </div>
        <div class="text-brand-orange">Minutos</div>
        <div class="flex flex-col items-center px-2">
            <span class="text-xs text-gray-500">x 60</span>
            <i class="fas fa-arrow-right text-gray-400"></i>
        </div>
        <div class="text-brand-green">Segundos</div>
    </div>
    <p class="text-center text-xs text-gray-500 mb-4"><em>(Para voltar, divida por 60!)</em></p>

    [WIDGET:interactive_clock_math]

    <div class="bg-red-50 p-4 rounded-xl border-l-4 border-brand-red my-6 text-sm shadow-md">
        <h4 class="font-bold text-brand-red flex items-center gap-2 text-lg"><i class="fas fa-bomb"></i> A Armadilha Decimal</h4>
        <p><strong>Cuidado:</strong> 2,5 horas <strong>N√ÉO</strong> s√£o 2 horas e 50 minutos!</p>
        <div class="mt-2 bg-white p-2 rounded border border-red-100">
            <ul class="list-none space-y-1">
                <li>‚ùå 2,5 h = 2h 50min (Errado!)</li>
                <li>‚úÖ 2,5 h = 2h e <strong>meia</strong> = 2h 30min.</li>
            </ul>
        </div>
        <p class="mt-2 text-gray-600">0,5 hora √© metade de 60 minutos (30), n√£o 50!</p>
    </div>

    <h3>3. Opera√ß√µes com Tempo (O Balde Transborda)</h3>
    <p>Somar tempo √© diferente de somar dinheiro. O "balde" dos minutos s√≥ aguenta at√© 59. Se chegar a 60, ele transborda e vira 1 hora.</p>

    <div class="bg-yellow-50 p-4 rounded-xl border-2 border-yellow-200 font-mono text-sm md:text-base">
        <p class="mb-2 font-bold text-gray-500 border-b border-yellow-200 pb-1">Exemplo: 1h 40min + 1h 30min</p>
        <div class="grid grid-cols-2 gap-4 text-center">
            <div>
                <strong>Soma Simples</strong><br>
                1h + 1h = 2h<br>
                40 + 30 = 70min
            </div>
            <div class="text-brand-blue">
                <strong>Ajuste (Transbordo)</strong><br>
                70min = 60 + 10<br>
                <strong>2h + 1h + 10min = 3h 10min</strong>
            </div>
        </div>
    </div>
`,
            "Plantas Baixas e Vistas A√©reas": `
    <h3>1. O Olho do Drone üöÅ</h3>
    <p>Uma <strong>Planta Baixa</strong> √© o desenho de uma casa vista de cima, como se tiv√©ssemos cortado o teto.</p>
    
    <ul class="list-disc list-inside text-sm text-gray-700 space-y-1 my-4">
        <li>As paredes viram linhas grossas.</li>
        <li>As portas viram arcos (mostrando para onde abrem).</li>
        <li>N√≥s perdemos a altura, mas ganhamos a no√ß√£o de <strong>espa√ßo</strong>.</li>
    </ul>

    <h3>2. Vistas Ortogonais</h3>
    <p>Podemos olhar um objeto de 3 lugares:</p>
    <div class="flex justify-around text-center text-xs font-bold uppercase my-4">
        <div class="text-brand-blue">Superior<br>(Cima)</div>
        <div class="text-brand-green">Frontal<br>(Frente)</div>
        <div class="text-brand-orange">Lateral<br>(Lado)</div>
    </div>
    <p class="text-sm italic text-gray-500 text-center">Isso √© o segredo dos arquitetos e engenheiros!</p>
`,
            "Lendo Gr√°ficos e Tabelas": `
    <h3>1. Uma Imagem vale mil N√∫meros üì∏</h3>
    <p>Imagine que voc√™ tem uma lista com a temperatura de cada dia do ano. S√£o 365 n√∫meros numa tabela gigante. Ningu√©m consegue ler isso r√°pido!</p>
    <p>Mas se voc√™ transformar isso em um <strong>Gr√°fico</strong>, voc√™ bate o olho e descobre na hora: "Ah, no meio do ano fez frio!".</p>

    <div class="bg-blue-50 p-4 rounded-xl border-l-4 border-brand-blue my-4 text-sm">
        <strong>üìä O Superpoder:</strong> Ler gr√°ficos √© transformar dados em hist√≥rias. √â ver o que aconteceu sem precisar ler cada detalhe.
    </div>

    <h3>2. A Tabela: O Arm√°rio Organizado üóÑÔ∏è</h3>
    <p>Antes do desenho, vem a organiza√ß√£o. A tabela guarda os dados em:</p>
    <ul class="list-none space-y-1 mt-2 text-sm text-gray-700">
        <li>‚û°Ô∏è <strong>Linhas:</strong> (Horizontais) Cada assunto diferente.</li>
        <li>‚¨áÔ∏è <strong>Colunas:</strong> (Verticais) O tipo de informa√ß√£o.</li>
    </ul>

    <table class="w-full text-sm text-center border-collapse mt-4 shadow-sm bg-white rounded-lg overflow-hidden">
        <thead class="bg-brand-blue text-white font-bold">
            <tr>
                <th class="p-2 border-r border-blue-400">Jogo</th>
                <th class="p-2">Votos</th>
            </tr>
        </thead>
        <tbody class="text-gray-600">
            <tr class="border-b border-gray-100"><td class="p-2 font-bold border-r border-gray-100">Minecraft</td><td class="p-2">15</td></tr>
            <tr class="border-b border-gray-100"><td class="p-2 font-bold border-r border-gray-100">Roblox</td><td class="p-2">12</td></tr>
            <tr><td class="p-2 font-bold border-r border-gray-100">Fortnite</td><td class="p-2">8</td></tr>
        </tbody>
    </table>

    <h3>3. Os Tr√™s Reis dos Gr√°ficos üëë</h3>
    <p>Cada gr√°fico serve para contar um tipo de hist√≥ria. Escolha o certo:</p>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 my-6">
        <div class="bg-white p-4 rounded-xl border-b-4 border-brand-blue shadow-sm hover:-translate-y-1 transition-transform text-center">
            <div class="text-3xl text-brand-blue mb-2"><i class="fas fa-chart-bar"></i></div>
            <h4 class="font-bold text-brand-blue uppercase text-xs">Colunas / Barras</h4>
            <p class="text-sm font-bold mt-1">"Quem ganhou?"</p>
            <p class="text-xs text-gray-500 mt-2">Ideal para <strong>COMPARAR</strong> quantidades. Quanto maior a barra, maior o valor.</p>
        </div>

        <div class="bg-white p-4 rounded-xl border-b-4 border-brand-green shadow-sm hover:-translate-y-1 transition-transform text-center">
            <div class="text-3xl text-brand-green mb-2"><i class="fas fa-chart-line"></i></div>
            <h4 class="font-bold text-brand-green uppercase text-xs">Linhas</h4>
            <p class="text-sm font-bold mt-1">"Subiu ou Desceu?"</p>
            <p class="text-xs text-gray-500 mt-2">Ideal para ver a <strong>EVOLU√á√ÉO</strong> no tempo. (Crescimento, temperatura, inscritos no canal).</p>
        </div>

        <div class="bg-white p-4 rounded-xl border-b-4 border-brand-orange shadow-sm hover:-translate-y-1 transition-transform text-center">
            <div class="text-3xl text-brand-orange mb-2"><i class="fas fa-chart-pie"></i></div>
            <h4 class="font-bold text-brand-orange uppercase text-xs">Setores (Pizza)</h4>
            <p class="text-sm font-bold mt-1">"Qual a fatia?"</p>
            <p class="text-xs text-gray-500 mt-2">Ideal para ver a <strong>PROPOR√á√ÉO</strong> do todo. A pizza inteira √© 100%.</p>
        </div>
    </div>

    [WIDGET:interactive_charts_demo]

    <h3>4. O Detetive de Gr√°ficos üïµÔ∏è</h3>
    <p>Cuidado! Gr√°ficos podem mentir. Sempre olhe:</p>
    <ul class="list-disc list-inside text-sm text-gray-700 space-y-2 bg-yellow-50 p-4 rounded-xl border border-yellow-200">
        <li><strong>O T√≠tulo:</strong> Sobre o que √© isso?</li>
        <li><strong>A Escala (Eixo Y):</strong> Ela come√ßa no zero? Se come√ßar no 100, uma diferen√ßa pequena parece gigante!</li>
        <li><strong>A Fonte:</strong> Quem fez esse gr√°fico? √â confi√°vel?</li>
    </ul>
`,
            "Tipos de Vari√°veis e Pesquisa": `
    <h3>1. Censit√°ria vs Amostral üìä</h3>
    <p>Como fazer uma pesquisa?</p>
    
    <div class="grid grid-cols-1 gap-3 my-4 text-sm">
        <div class="bg-green-50 p-3 rounded border-l-4 border-green-400">
            <strong>Pesquisa Censit√°ria (Censo):</strong>
            <p class="text-xs mt-1">Pergunta para <strong>TODO MUNDO</strong>. (Ex: Censo do IBGE, Chamada da classe). √â perfeito, mas caro e demorado.</p>
        </div>
        <div class="bg-orange-50 p-3 rounded border-l-4 border-orange-400">
            <strong>Pesquisa Amostral:</strong>
            <p class="text-xs mt-1">Pergunta para um <strong>GRUPO PEQUENO</strong> (amostra) que representa o todo. (Ex: Pesquisa de inten√ß√£o de voto). √â r√°pido, mas tem margem de erro.</p>
        </div>
    </div>

    <h3>2. O que estamos perguntando? (Vari√°veis)</h3>
    <ul class="list-disc list-inside text-sm text-gray-700 space-y-2">
        <li><strong>Qualitativa:</strong> A resposta √© uma palavra. (Cor dos olhos, Time de futebol).</li>
        <li><strong>Quantitativa:</strong> A resposta √© um n√∫mero. (Altura, Idade, Sal√°rio).</li>
    </ul>
`,
            "Introdu√ß√£o √† Probabilidade": `
    <h3>1. A Matem√°tica da Sorte üçÄ</h3>
    <p>Na matem√°tica, quase tudo √© certeza ($2+2$ sempre ser√° $4$). Mas a vida real √© cheia de surpresas. Chover√° amanh√£? Quem vai ganhar o jogo? Vai dar Cara ou Coroa?</p>
    
    <p>A <strong>Probabilidade</strong> √© a ferramenta que usamos para medir a chance de algo acontecer.</p>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 my-4">
        <div class="bg-gray-50 p-4 rounded-xl border-2 border-gray-200">
            <h4 class="font-bold text-gray-700 mb-1">üîÆ Experimento Aleat√≥rio</h4>
            <p class="text-sm text-gray-600">√â aquele que, se voc√™ repetir nas mesmas condi√ß√µes, o resultado pode mudar. Ex: Lan√ßar um dado, girar uma roleta.</p>
        </div>
        <div class="bg-gray-50 p-4 rounded-xl border-2 border-gray-200">
            <h4 class="font-bold text-gray-700 mb-1">üåå Espa√ßo Amostral ($\\Omega$)</h4>
            <p class="text-sm text-gray-600">√â a lista de <strong>TUDO</strong> que pode acontecer. O "Menu de Op√ß√µes". No dado: {1, 2, 3, 4, 5, 6}.</p>
        </div>
    </div>

    <h3>2. A F√≥rmula M√°gica ‚öóÔ∏è</h3>
    <p>Como calcular a chance? √â uma guerra entre o seu desejo e a realidade.</p>

    <div class="bg-blue-50 p-6 rounded-xl border-l-4 border-brand-blue my-6 text-center shadow-sm">
        <p class="text-sm font-bold text-blue-800 uppercase mb-2">F√≥rmula da Probabilidade</p>
        <div class="text-2xl md:text-3xl font-black text-brand-blue flex flex-col items-center justify-center gap-2">
            <span>O que eu Quero</span>
            <div class="w-full h-1 bg-blue-300 rounded-full max-w-[200px]"></div>
            <span>Tudo que pode Acontecer</span>
        </div>
        <div class="mt-4 font-mono bg-white p-2 rounded border border-blue-200 inline-block text-sm">
            $P = \\frac{\\text{Casos Favor√°veis}}{\\text{Casos Poss√≠veis}}$
        </div>
    </div>

    <div class="flex flex-col items-center gap-2 my-4">
        <p class="font-bold text-gray-700">Exemplo: Jogar um dado e sair o n√∫mero 5.</p>
        <div class="flex gap-4 text-center text-sm">
            <div>
                <div class="w-10 h-10 bg-brand-green text-white rounded-lg flex items-center justify-center font-bold shadow-md mb-1">5</div>
                <span class="text-brand-green font-bold">Quero (1)</span>
            </div>
            <div class="text-2xl text-gray-300">vs</div>
            <div class="flex gap-1 opacity-50">
                <div class="w-6 h-6 bg-gray-300 rounded flex items-center justify-center text-[8px]">1</div>
                <div class="w-6 h-6 bg-gray-300 rounded flex items-center justify-center text-[8px]">2</div>
                <div class="w-6 h-6 bg-gray-300 rounded flex items-center justify-center text-[8px]">3</div>
                <div class="w-6 h-6 bg-gray-300 rounded flex items-center justify-center text-[8px]">4</div>
                <div class="w-6 h-6 bg-gray-300 rounded flex items-center justify-center text-[8px]">5</div>
                <div class="w-6 h-6 bg-gray-300 rounded flex items-center justify-center text-[8px]">6</div>
            </div>
        </div>
        <p class="mt-2 font-mono font-bold text-xl">Chance = $\\frac{1}{6}$</p>
    </div>

    <h3>3. A Lei dos Grandes N√∫meros üé≤</h3>
    <p>Se voc√™ jogar uma moeda <strong>uma vez</strong>, pode dar Coroa. Mas se voc√™ jogar <strong>1.000 vezes</strong>, vai ver algo m√°gico acontecer: a quantidade de Caras e Coroas fica quase igual!</p>
    
    <p>Teste a sorte agora. Tente jogar 100 moedas:</p>

    [WIDGET:interactive_head_tail]

    <h3>4. A R√©gua da Certeza üìè</h3>
    <p>A probabilidade sempre mora entre 0 e 1 (ou 0% e 100%).</p>

    <div class="relative h-12 bg-gray-200 rounded-full mt-6 mb-2 mx-2">
        <div class="absolute top-0 left-0 h-full w-full bg-gradient-to-r from-red-400 via-yellow-400 to-green-400 rounded-full opacity-50"></div>
        
        <div class="absolute top-1/2 left-2 -translate-y-1/2 text-xs font-bold text-red-800">Imposs√≠vel (0%)</div>
        <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-xs font-bold text-yellow-800">Meio a Meio (50%)</div>
        <div class="absolute top-1/2 right-2 -translate-y-1/2 text-xs font-bold text-green-800">Certo (100%)</div>
    </div>
    
    <ul class="list-disc list-inside text-sm text-gray-600 mt-4 space-y-1">
        <li>ü¶Ñ <strong>Imposs√≠vel (0):</strong> Tirar um 7 num dado comum.</li>
        <li>ü™ô <strong>Equiprov√°vel (1/2):</strong> Cara ou Coroa.</li>
        <li>‚òÄÔ∏è <strong>Certo (1):</strong> O sol vai nascer amanh√£ (ou tirar um n√∫mero menor que 7 no dado).</li>
    </ul>

    <div class="bg-red-50 p-3 rounded-lg border border-red-200 mt-4 text-sm text-center">
        <strong class="text-brand-red">‚ö†Ô∏è Alerta:</strong> N√£o existe probabilidade maior que 1 (110%). Isso √© apenas modo de falar!
    </div>
`,
            //
            // S√âTIMO ANO
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            // --- CONTE√öDOS DOS ANOS SEGUINTES ---
            // ==========================================
            // === 7¬∫ ANO: CURR√çCULO IEZZI COMPLETO ===
            // ==========================================

            // --- UNIDADE 1: INTEIROS (Z) ---
            "N√∫meros Inteiros e Reta Num√©rica": `
                <h3>Expandindo o Universo</h3>
                Os N√∫meros Naturais ($0, 1, 2...$) n√£o servem para medir temperaturas abaixo de zero ou saldos banc√°rios negativos. Surgem os Inteiros ($\\mathbb{Z}$).
                
                <b>Reta Num√©rica:</b>
                O zero √© a origem. √Ä direita, os positivos. √Ä esquerda, os negativos.
                $$... -3, -2, -1, 0, +1, +2, +3 ...$$
                
                <b>Conceitos Chave:</b>
                * <b>M√≥dulo (|x|):</b> √â a dist√¢ncia at√© o zero. $|-5| = 5$.
                * <b>Oposto (Sim√©trico):</b> Mesmo valor, sinal trocado. Oposto de $+8$ √© $-8$.
                
                [WIDGET:interactive_thermometer]
            `,
            "Adi√ß√£o e Subtra√ß√£o em Z": `
                <h3>Cr√©ditos e D√≠vidas</h3>
                Esque√ßa a regra de "menos com menos d√° mais" na soma! Use a l√≥gica banc√°ria:
                
                * <b>Sinais Iguais (Soma e conserva):</b> Devo 10 e fa√ßo d√≠vida de 20 -> Devo 30.
                * <b>Sinais Diferentes (Subtrai e d√° o sinal do maior):</b> Tenho 50, devo 80 -> Pago e ainda devo 30 ($-30$).
                
                <b>Elimina√ß√£o de Par√™nteses:<b>
                Um sinal de menos antes do par√™nteses inverte quem est√° dentro.
                $- (+5) = -5$
                $- (-3) = +3$ (D√≠vida de d√≠vida √© cr√©dito).
            `,
            "Multiplica√ß√£o e Divis√£o em Z": `
                <h3>A Regra dos Sinais</h3>
                Aqui sim usamos a tabela de sinais cl√°ssica:
                
                * $+ \\cdot + = +$ (Amigo do amigo)
                * $- \\cdot - = +$ (Inimigo do inimigo)
                * $+ \\cdot - = -$ (Amigo do inimigo)
                
                Exemplos:
                * $(-4) \\cdot (-3) = +12$
                * $(+20) \\div (-5) = -4$
                
                [WIDGET:interactive_sign_rules]
            `,
            "Potencia√ß√£o e Raiz Quadrada em Z": `
                <h3>Expoentes Pares e √çmpares</h3>
                No conjunto Z, a pot√™ncia exige aten√ß√£o:
                
                1. <b>Expoente Par:</b> O resultado √© sempre positivo.
                   $(-2)^4 = +16$
                2. <b>Expoente √çmpar:</b> Mant√©m o sinal da base.
                   $(-2)^3 = -8$
                   
                <b>Raiz Quadrada em Z:</b>
                N√£o existe raiz quadrada de n√∫mero negativo no conjunto dos Inteiros!
                $\\sqrt{-16}$ = Imposs√≠vel em $\\mathbb{Z}$.
            `,
            "Express√µes Num√©ricas em Z": `
                <h3>Organizando a Bagun√ßa</h3>
                A ordem de opera√ß√µes continua valendo:
                1. Potencia√ß√£o/Raiz
                2. Multiplica√ß√£o/Divis√£o
                3. Adi√ß√£o/Subtra√ß√£o
                
                <b>Exemplo:</b>
                $-5 + 3 \\cdot (-4)$
                Primeiro multiplica: $-5 + (-12)$
                Depois soma d√≠vidas: $-17$.
                
                [WIDGET:interactive_expression_solver]
            `,

            // --- UNIDADE 2: RACIONAIS (Q) ---
            "O Conjunto Q: Fra√ß√£o e Decimal": `
                <h3>O Mundo Fracionado</h3>
                Todo n√∫mero que pode ser escrito como fra√ß√£o $a/b$ (com b diferente de zero) √© Racional ($\\mathbb{Q}$).
                Isso inclui:
                * Inteiros ($5 = 5/1$)
                * Decimais Exatos ($0,5 = 1/2$)
                * D√≠zimas Peri√≥dicas ($0,333... = 1/3$)
                
                Agora temos fra√ß√µes negativas! Ex: $-1/2$ est√° entre 0 e -1.
            `,
            "Adi√ß√£o e Subtra√ß√£o em Q": `
                <h3>MMC com Sinais</h3>
                A regra √© a mesma das fra√ß√µes normais, mas agora cuidamos do sinal.
                
                Exemplo: $-\\frac{1}{2} + \\frac{2}{3}$
                1. MMC(2,3) = 6.
                2. Ajusta: $-\\frac{3}{6} + \\frac{4}{6}$
                3. Opera os numeradores: $-3 + 4 = +1$.
                4. Resultado: $+1/6$.
                
                [WIDGET:interactive_fraction_addition]
            `,
            "Multiplica√ß√£o e Divis√£o em Q": `
                <h3>Direto e Inverso</h3>
                * <b>Multiplica√ß√£o:</b> Numerador com numerador, denominador com denominador. Regra de sinais vale!
                  $(-1/2) \\cdot (-3/4) = +3/8$.
                  
                * <b>Divis√£o:</b> Repete a primeira, multiplica pelo inverso da segunda.
                  $(-2/5) \\div (3/4) = (-2/5) \\cdot (4/3) = -8/15$.
                  
                [WIDGET:interactive_fraction_mult]
            `,
            // --- UNIDADE 3: √ÅLGEBRA ---
            "Vari√°veis e Express√µes Alg√©bricas": `
                <h3>A Linguagem Matem√°tica</h3>
                Usamos letras (vari√°veis) para representar n√∫meros desconhecidos ou gen√©ricos.
                
                * O dobro de um n√∫mero: $2x$
                * Um n√∫mero mais 5: $y + 5$
                * O quadrado de um n√∫mero: $x^2$
                
                As letras s√£o como caixas vazias esperando um valor.
            `,
            "Valor Num√©rico de uma Express√£o": `
                <h3>Substituindo as Letras</h3>
                Calcular o valor num√©rico √© trocar a letra pelo n√∫mero dado.
                
                Dada a express√£o: $3x^2 - 2y$
                Para $x = 2$ e $y = 5$:
                1. Troca: $3 \\cdot (2^2) - 2 \\cdot (5)$
                2. Pot√™ncia: $3 \\cdot 4 - 10$
                3. Multiplica: $12 - 10$
                4. Resultado: $2$.
            `,
            "Equa√ß√µes do 1¬∫ Grau": `
                <h3>A Balan√ßa de Dois Pratos</h3>
                Uma equa√ß√£o √© uma igualdade com uma vari√°vel desconhecida.
                $$3x + 4 = 10$$
                O objetivo √© descobrir o valor de X que torna a senten√ßa verdadeira.
                
                <b>Raiz da Equa√ß√£o:</b> √â o n√∫mero que, ao substituir o X, valida a igualdade. (No exemplo acima, x=2).
                
                [WIDGET:interactive_equality_balance]
            `,
            "Resolu√ß√£o de Problemas com Equa√ß√µes": `
                <h3>Do Portugu√™s para o Matem√™s</h3>
                O segredo √© traduzir o texto.
                
                * "A soma de um n√∫mero com seu dobro √© 30":
                  $x + 2x = 30 \\rightarrow 3x = 30 \\rightarrow x = 10$.
                  
                * "Jo√£o tem o triplo da idade de Maria. Juntos tem 40 anos":
                  Maria = $x$, Jo√£o = $3x$.
                  $x + 3x = 40$.
                
                [WIDGET:interactive_equation_builder]
            `,
            "Inequa√ß√µes do 1¬∫ Grau": `
                <h3>Desigualdades</h3>
                Usamos $>$ (maior), $<$ (menor), $\\geq$ ou $\\leq$.
                
                Exemplo: $2x > 10$ (Quero n√∫meros que o dobro seja maior que 10).
                $x > 5$.
                
                <b>Regra Vital:</b> Se multiplicar ou dividir a inequa√ß√£o por n√∫mero <b>negativo</b>, o sinal da desigualdade <b>INVERTE</b>!
                $-x > 5 \\rightarrow x < -5$.
            `,

            // --- UNIDADE 4: GRANDEZAS ---
            "Raz√£o e Propor√ß√£o": `
                <h3>Comparando Grandezas</h3>
                <b>Raz√£o:</b> Divis√£o entre dois n√∫meros. Ex: Escala de mapa 1:100.
                <b>Propor√ß√£o:</b> Igualdade entre duas raz√µes.
                
                $$\\frac{A}{B} = \\frac{C}{D}$$
                
                Propriedade Fundamental: "O produto dos meios √© igual ao produto dos extremos" (multiplica cruzado).
            `,
            "Grandezas Diretamente Proporcionais": `
                <h3>Crescendo Juntos</h3>
                Se uma grandeza dobra, a outra dobra tamb√©m.
                Ex: Quantidade de farinha e n√∫mero de bolos.
                
                Gr√°fico: Uma reta que passa pela origem.
                
                [WIDGET:interactive_rule_of_three]
            `,
            "Grandezas Inversamente Proporcionais": `
                <h3>O Equil√≠brio Inverso</h3>
                Se uma grandeza dobra, a outra cai pela metade.
                Ex: Velocidade e Tempo de viagem.
                * Se vou a 100km/h, gasto 2 horas.
                * Se vou a 200km/h, gasto 1 hora.
            `,
            "Porcentagem e Juros Simples": `
                <h3>Matem√°tica Financeira B√°sica</h3>
                <b>Porcentagem:</b> Fra√ß√£o com denominador 100.
                
                <b>Juros Simples (J):</b> Rendimento sobre o capital inicial.
                F√≥rmula: $J = C \\cdot i \\cdot t$
                * C = Capital
                * i = Taxa (ex: 2% = 0,02)
                * t = Tempo
            `,
            // --- UNIDADE 5: GEOMETRIA PLANA ---
            "√Çngulos: Medidas e Opera√ß√µes": `
                <h3>Operando com Graus e Minutos</h3>
                O grau (¬∞) subdivide-se em Minutos (') e Segundos ('').
                $1¬∞ = 60'$ e $1' = 60''$.
                
                <b>Classifica√ß√£o:</b>
                * Nulo (0¬∞)
                * Reto (90¬∞)
                * Agudo (< 90¬∞)
                * Obtuso (> 90¬∞)
                * Raso (180¬∞)
                
                <b>Opostos pelo V√©rtice (OPV):</b> S√£o iguais!
                
                [WIDGET:interactive_angle_maker]
            `,
            "Retas Paralelas e Transversais": `
                <h3>O Teorema dos 8 √Çngulos</h3>
                Quando uma transversal corta duas paralelas, formam-se pares de √¢ngulos com nomes especiais:
                * <b>Correspondentes:</b> Posi√ß√£o igual, valor igual.
                * <b>Alternos (Internos/Externos):</b> Lados alternados, valor igual.
                * <b>Colaterais:</b> Mesmo lado, somam 180¬∞.
            `,
            "Tri√¢ngulos: Soma dos √Çngulos e Classifica√ß√£o": `
                <h3>A Lei dos 180 Graus</h3>
                A soma dos √¢ngulos internos de QUALQUER tri√¢ngulo √© sempre 180¬∞.
                
                <b>Desigualdade Triangular:</b>
                Para um tri√¢ngulo existir, um lado deve ser menor que a soma dos outros dois. N√£o d√° para fechar um tri√¢ngulo com lados 10, 2 e 2!
                
                [WIDGET:interactive_poly_types]
            `,
            "Pol√≠gonos: Diagonais e √Çngulos Internos": `
                <h3>F√≥rmulas Gerais</h3>
                
                <b>Soma dos √Çngulos Internos (Si):</b>
                Basta dividir o pol√≠gono em tri√¢ngulos.
                $$Si = (n - 2) \\cdot 180^{\\circ}$$
                (Onde n √© o n√∫mero de lados).
                
                Exemplo Pent√°gono (5 lados): $(5-2) \\cdot 180 = 3 \\cdot 180 = 540^{\\circ}$.
            `,

            // --- UNIDADE 6: TRATAMENTO DA INFORMA√á√ÉO ---
            "M√©dia Aritm√©tica e Amplitude": `
                <h3>Resumindo Dados</h3>
                <b>M√©dia Simples:</b> Soma dos valores dividido pela quantidade.
                <b>M√©dia Ponderada:</b> Cada valor tem um "peso" (import√¢ncia).
                
                <b>Amplitude:</b> A diferen√ßa entre o maior e o menor valor de uma pesquisa. Mostra o quanto os dados variam.
                
                [WIDGET:interactive_charts_demo]
            
            `,
            //
            // OITAVO ANO
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            // ==========================================
            // === 8¬∫ ANO: √ÅLGEBRA AVAN√áADA E GEOMETRIA ===
            // ==========================================

            // --- UNIDADE 1: POTENCIA√á√ÉO E REAIS ---
            "Pot√™ncia com Expoente Inteiro": `
                <h3>Expoente Negativo?</h3>
                At√© agora, expoente era "quantas vezes multiplico". Mas o que significa $2^{-3}$?
                <b>Regra do Tombo:</b> O expoente negativo inverte a base. "Quem est√° em cima desce, quem est√° embaixo sobe".
                
                $$a^{-n} = \\frac{1}{a^n}$$
                
                Exemplo: $2^{-3} = \\frac{1}{2^3} = \\frac{1}{8}$.
            `,
            "Nota√ß√£o Cient√≠fica": `
                <h3>N√∫meros Gigantes ou Min√∫sculos</h3>
                Usada por cientistas para escrever dist√¢ncias espaciais ou tamanhos de √°tomos.
                Formato: $N \\cdot 10^k$ (onde $1 \\le N < 10$).
                
                * <b>V√≠rgula para esquerda (N√∫mero grande):</b> Expoente positivo.
                  $5.000 = 5 \\cdot 10^3$.
                * <b>V√≠rgula para direita (N√∫mero pequeno):</b> Expoente negativo.
                  $0,005 = 5 \\cdot 10^{-3}$.
            `,
            "O Conjunto dos N√∫meros Reais (R)": `
                <h3>A Reta Completa</h3>
                Os Racionais ($\\mathbb{Q}$) deixam "buracos" na reta. Os Irracionais ($\\mathbb{I}$) preenchem esses buracos.
                
                * <b>Racionais:</b> Fra√ß√µes, D√≠zimas Peri√≥dicas (0,333...).
                * <b>Irracionais:</b> D√≠zimas N√£o-Peri√≥dicas ($\\pi = 3,1415...$, $\\sqrt{2}$).
                * <b>Reais ($\\mathbb{R}$):</b> A uni√£o de todos eles. Agora a reta num√©rica est√° cheia!
            `,

            // --- UNIDADE 2: C√ÅLCULO ALG√âBRICO 1 ---
            "Mon√¥mios e Polin√¥mios": `
                <h3>Tijolos da √Ålgebra</h3>
                * <b>Mon√¥mio:</b> Um termo s√≥ (ex: $3x^2y$). Tem coeficiente (3) e parte literal ($x^2y$).
                * <b>Polin√¥mio:</b> Soma de mon√¥mios (ex: $2x + 5y$).
                
                <b>Grau do Mon√¥mio:</b> Soma dos expoentes das letras.
                $4x^2y^3$ √© do 5¬∫ grau (2+3).
            `,
            "Opera√ß√µes com Polin√¥mios": `
                <h3>A Regra dos Semelhantes</h3>
                Voc√™ s√≥ pode somar <b>bananas com bananas</b>.
                * $2x + 3x = 5x$ (Pode).
                * $2x + 3y$ (N√£o pode misturar).
                
                <b>Multiplica√ß√£o:</b> Multiplica n√∫mero com n√∫mero, letra com letra (soma expoentes).
                $2x \\cdot 3x^2 = 6x^3$.
            `,
            "Produtos Not√°veis (O Quadrado da Soma/Diferen√ßa)": `
                <h3>O Atalho Ninja</h3>
                N√£o perca tempo fazendo "chuveirinho" em $(x+y)^2$. Decore a geometria da coisa!
                
                $$(a+b)^2 = a^2 + 2ab + b^2$$
                
                "Quadrado do primeiro, mais duas vezes o primeiro pelo segundo, mais quadrado do segundo".
                
                [WIDGET:interactive_square_sum]
            `,
            "Produto da Soma pela Diferen√ßa": `
                <h3>O Mais Elegante</h3>
                Quando multiplicamos g√™meos de sinais trocados, o termo do meio some!
                
                $$(a+b) \\cdot (a-b) = a^2 - b^2$$
                
                "Quadrado do primeiro menos quadrado do segundo".
            `,
            // --- UNIDADE 3: C√ÅLCULO ALG√âBRICO 2 ---
            "Fatora√ß√£o: Fator Comum e Agrupamento": `
                <h3>Colocando em Evid√™ncia</h3>
                Fatorar √© transformar soma em multiplica√ß√£o. √â o inverso do "chuveirinho".
                
                <b>Fator Comum:</b> O que se repete em todos?
                $2x + 2y \\rightarrow 2(x + y)$.
                
                <b>Agrupamento:</b> Quando n√£o tem um fator para todos, fazemos em duplas.
                $ax + ay + bx + by \\rightarrow a(x+y) + b(x+y) \\rightarrow (a+b)(x+y)$.
            `,
            "Fra√ß√µes Alg√©bricas e MMC de Polin√¥mios": `
                <h3>√Ålgebra com Denominador</h3>
                Para somar fra√ß√µes com letras embaixo, precisamos do MMC de polin√¥mios.
                
                1. Fatore tudo.
                2. Pegue os fatores comuns e n√£o comuns com maior expoente.
                
                Exemplo: $\\frac{1}{x} + \\frac{1}{y} = \\frac{y+x}{xy}$.
                
                [ALERTA]: Condi√ß√£o de Exist√™ncia! O denominador nunca pode dar zero. Em $1/(x-2)$, $x$ deve ser diferente de 2.
            `,

            // --- UNIDADE 4: SISTEMAS ---
            "Sistemas de Equa√ß√µes do 1¬∫ Grau": `
                <h3>O Cruzamento das Retas</h3>
                Um sistema procura um par $(x, y)$ que satisfa√ßa duas equa√ß√µes ao mesmo tempo.
                Geometricamente, √© o ponto onde duas retas se cruzam.
                
                $$\\begin{cases}                  x + y = 10 \\\\                 x - y = 2                  \\end{cases}$$
                
                [WIDGET:interactive_system_steps]
            `,
            "Problemas Envolvendo Sistemas": `
                <h3>Bicicletas e Triciclos</h3>
                "Num p√°tio h√° bicicletas e triciclos. Total de 10 ve√≠culos e 26 rodas. Quantos de cada?"
                
                * Ve√≠culos: $B + T = 10$
                * Rodas: $2B + 3T = 26$
                
                Agora √© s√≥ resolver o sistema!
            `,

            // --- UNIDADE 5: GEOMETRIA ---
            "√Çngulos em Pol√≠gonos e Diagonais": `
                <h3>F√≥rmulas Gerais</h3>
                
                <b>Soma dos √Çngulos Internos ($S_i$):</b>
                Todo pol√≠gono pode ser dividido em $(n-2)$ tri√¢ngulos.
                $$S_i = (n-2) \\cdot 180^{\\circ}$$
                
                <b>Diagonais ($d$):</b>
                De cada v√©rtice saem $(n-3)$ diagonais. Como a diagonal vai e volta, dividimos por 2.
                $$d = \\frac{n(n-3)}{2}$$
            `,
            "Tri√¢ngulos: Casos de Congru√™ncia": `
                <h3>S√£o G√™meos?</h3>
                Dois tri√¢ngulos s√£o congruentes (id√™nticos) se respeitarem um dos casos m√≠nimos:
                
                1. <b>L.A.L.:</b> Lado, √Çngulo, Lado iguais.
                2. <b>L.L.L.:</b> Tr√™s lados iguais.
                3. <b>A.L.A.:</b> √Çngulo, Lado, √Çngulo iguais.
                
                [WIDGET:interactive_poly_types]
            `,
            "C√≠rculo e Circunfer√™ncia (√Årea e Comprimento)": `
                <h3>O N√∫mero Pi ($\\pi$)</h3>
                * <b>Circunfer√™ncia (Borda):</b> √â o comprimento da linha. Imagine abrir o c√≠rculo.
                  $C = 2 \\cdot \\pi \\cdot r$ (Dois "pierre").
                
                * <b>C√≠rculo (Preenchimento):</b> √â a √°rea interna.
                  $A = \\pi \\cdot r^2$.
                
                [WIDGET:interactive_geometry_canvas]
                [WIDGET:interactive_area_calc]
            `,
            // --- UNIDADE 6: ESTAT√çSTICA ---
            "M√©dia, Moda e Mediana": `
                <h3>Medidas de Tend√™ncia Central</h3>
                Como resumir uma lista gigante de n√∫meros em um s√≥?
                
                1. <b>M√©dia:</b> A mais democr√°tica. Soma tudo e divide por todos.
                2. <b>Moda:</b> A mais popular. O valor que mais aparece.
                3. <b>Mediana:</b> O termo do meio. Coloque em ordem crescente e pegue o centro. Se tiver dois no meio, fa√ßa a m√©dia deles.
                
                [WIDGET:interactive_charts_demo]
            `
            ,

            //
            // NONO ANO
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            // ==========================================
            // === 9¬∫ ANO: O PREPARAT√ìRIO PARA O EM ===
            // ==========================================

            // --- UNIDADE 1: RADICIA√á√ÉO ---
            "Propriedades dos Radicais": `
                <h3>Domando as Ra√≠zes</h3>
                A radicia√ß√£o √© o inverso da potencia√ß√£o.
                $$\\sqrt[n]{a} = b \\iff b^n = a$$
                
                <b>Propriedade Fundamental:</b> Raiz de produto √© produto de ra√≠zes.
                $\\sqrt{a \\cdot b} = \\sqrt{a} \\cdot \\sqrt{b}$.
                Isso ajuda a simplificar: $\\sqrt{12} = \\sqrt{4 \\cdot 3} = 2\\sqrt{3}$.
            `,
            "Racionaliza√ß√£o de Denominadores": `
                <h3>Proibido Raiz no Por√£o</h3>
                Na matem√°tica, √© "inelegante" deixar raiz na parte de baixo da fra√ß√£o.
                
                Para arrumar $\\frac{1}{\\sqrt{2}}$, multiplicamos em cima e embaixo pela pr√≥pria raiz:
                $$\\frac{1}{\\sqrt{2}} \\cdot \\frac{\\sqrt{2}}{\\sqrt{2}} = \\frac{\\sqrt{2}}{2}$$
            `,
            "Pot√™ncia com Expoente Fracion√°rio": `
                <h3>O Sol e a Sombra</h3>
                Todo radical pode virar pot√™ncia e vice-versa.
                <b>Regra:</b> "Quem est√° no sol (expoente de dentro) vai para a sombra (baixo). Quem est√° na sombra (√≠ndice da raiz) vai para o sol (cima)."
                
                $$\\sqrt[n]{a^m} = a^{\\frac{m}{n}}$$
            `,

            // --- UNIDADE 2: EQUA√á√ïES 2¬∫ GRAU ---
            "Conceito e Coeficientes (a, b, c)": `
                <h3>A Curva Matem√°tica</h3>
                Uma equa√ß√£o do 2¬∫ grau tem a forma:
                $$ax^2 + bx + c = 0$$
                (Onde $a \\neq 0$).
                
                Identificar os coeficientes √© o primeiro passo para resolver.
                Ex: $2x^2 - 5x + 3 = 0$
                * a = 2
                * b = -5
                * c = 3
            `,
            "F√≥rmula de Bh√°skara (Completa)": `
                <h3>A F√≥rmula Mais Famosa</h3>
                Para encontrar os valores de x (ra√≠zes), usamos a f√≥rmula resolutiva.
                
                1. Calcule o Discriminante (Delta): $\\Delta = b^2 - 4ac$.
                2. Calcule as ra√≠zes: $x = \\frac{-b \\pm \\sqrt{\\Delta}}{2a}$.
                
                Acompanhe o passo a passo visual:
                [WIDGET:interactive_bhaskara_steps]
            `,
            "Rela√ß√£o Soma e Produto": `
                <h3>O M√©todo Mental</h3>
                Se a equa√ß√£o for simples ($a=1$), d√° para resolver de cabe√ßa!
                Procuramos dois n√∫meros que:
                * Somados d√£o $-b$.
                * Multiplicados d√£o $c$.
                
                Ex: $x^2 - 5x + 6 = 0$. (Soma 5, Produto 6). Resposta: 2 e 3.
            `,

            // --- UNIDADE 3: FUN√á√ïES ---
            "No√ß√£o de Fun√ß√£o (Dom√≠nio e Imagem)": `
                <h3>A M√°quina de Transformar</h3>
                Uma fun√ß√£o ($f$) √© uma regra que relaciona cada elemento de um conjunto A (Dom√≠nio) a um √∫nico elemento de B (Contradom√≠nio).
                $$f(x) = y$$
                Pense numa m√°quina: entra Mat√©ria Prima ($x$), sai Produto ($y$).
            `,
            "Fun√ß√£o Quadr√°tica (2¬∫ Grau): Par√°bola e V√©rtice": `
                <h3>A Trajet√≥ria dos Proj√©teis</h3>
                O gr√°fico da fun√ß√£o $f(x) = ax^2 + bx + c$ √© uma curva chamada <b>Par√°bola</b>.
                
                * <b>Concavidade:</b> Se $a > 0$, sorri (U). Se $a < 0$, chora (‚à©).
                * <b>V√©rtice:</b> √â o ponto de retorno (m√°ximo ou m√≠nimo).
                * <b>Zeros da Fun√ß√£o:</b> Onde a curva corta o eixo X (as ra√≠zes de Bh√°skara).
                
                Experimente alterar os coeficientes:
                [WIDGET:interactive_parabola_graph]
            `,
            // --- UNIDADE 4: SEMELHAN√áA ---
            "Teorema de Tales": `
                <h3>Propor√ß√£o entre Retas</h3>
                Se um feixe de retas paralelas √© cortado por duas transversais, os segmentos formados s√£o proporcionais.
                
                $$\\frac{A}{B} = \\frac{C}{D}$$
                
                Isso permite medir a altura de uma pir√¢mide usando apenas a sombra de um bast√£o!
                
                [WIDGET:interactive_rule_of_three]
            `,
            "Semelhan√ßa de Tri√¢ngulos": `
                <h3>Zoom In / Zoom Out</h3>
                Dois tri√¢ngulos s√£o semelhantes se t√™m os mesmos √¢ngulos. Um √© a "vers√£o ampliada" do outro.
                A raz√£o entre seus lados √© constante ($k$).
                
                Se um tri√¢ngulo tem lados 3, 4, 5 e o outro 6, 8, 10, eles s√£o semelhantes (raz√£o 2).
            `,
            "Rela√ß√µes M√©tricas no Tri√¢ngulo Ret√¢ngulo": `
                <h3>Al√©m de Pit√°goras</h3>
                Baixando a altura ($h$) sobre a hipotenusa ($a$), surgem v√°rias rela√ß√µes com as proje√ß√µes ($m, n$) e catetos ($b, c$).
                
                1. $h^2 = m \\cdot n$ (Altura √© m√©dia geom√©trica das proje√ß√µes).
                2. $b^2 = a \\cdot m$ (Cateto ao quadrado √© hipotenusa vezes proje√ß√£o).
                3. $a \\cdot h = b \\cdot c$ (Produto dos catetos √© produto da hipotenusa pela altura).
            `,

            // --- UNIDADE 5: TRIGONOMETRIA ---
            "Teorema de Pit√°goras (Revis√£o Aprofundada)": `
                <h3>O Rei da Geometria</h3>
                "A soma dos quadrados dos catetos √© igual ao quadrado da hipotenusa."
                
                $$a^2 = b^2 + c^2$$
                
                Fundamental para calcular diagonais de quadrados e alturas de tri√¢ngulos equil√°teros.
                
                [WIDGET:interactive_pythagoras_calc]
            `,
            "Trigonometria (Seno, Cosseno, Tangente)": `
                <h3>SOH CAH TOA</h3>
                Rela√ß√µes entre √¢ngulos e lados no tri√¢ngulo ret√¢ngulo.
                
                * <b>Seno:</b> Oposto / Hipotenusa.
                * <b>Cosseno:</b> Adjacente / Hipotenusa.
                * <b>Tangente:</b> Oposto / Adjacente.
                
                Tabela dos √Çngulos Not√°veis (30¬∞, 45¬∞, 60¬∞) √© obrigat√≥ria memorizar!
                
                [WIDGET:interactive_trig_calc]
            `,
            "√Årea de Setores Circulares e Coroas": `
                <h3>Peda√ßos de Pizza</h3>
                * <b>Setor Circular (Fatia):</b> Regra de tr√™s com a √°rea total ($\\pi R^2$) e o √¢ngulo ($\\alpha$).
                  $A = \\frac{\\alpha}{360} \\cdot \\pi R^2$.
                  
                * <b>Coroa Circular (Rosca):</b> √Årea do c√≠rculo grande menos a do pequeno.
                  $A = \\pi (R^2 - r^2)$.
            `,

            // --- UNIDADE 6: PROBABILIDADE ---
            "Probabilidade de Eventos Independentes": `
                <h3>Sorte Dupla</h3>
                Qual a chance de jogar uma moeda duas vezes e sair "Cara" nas duas?
                S√£o eventos independentes (um n√£o afeta o outro). Multiplicamos as probabilidades!
                
                $P = (1/2) \\cdot (1/2) = 1/4$ (25%).
            `,


            //
            // 1EM
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //

            // ==========================================
            // === 1¬∫ ANO DO ENSINO M√âDIO ===
            // ==========================================

            // --- UNIDADE 1: CONJUNTOS E N√öMEROS ---
            "No√ß√µes de Conjuntos e Opera√ß√µes": `
                <h3>A Linguagem Universal</h3>
                Na matem√°tica, um **Conjunto** √© uma cole√ß√£o de elementos. Usamos chaves $\\{ \\}$ para represent√°-los.
                
                **Opera√ß√µes Fundamentais:**
                * **Uni√£o ($\\cup$):** Junta tudo. "O que tem no A OU no B".
                * **Intersec√ß√£o ($\\cap$):** S√≥ o que repete. "O que tem no A E no B".
                * **Diferen√ßa ($A - B$):** O que tem no A, mas N√ÉO tem no B.
            `,
            "Conjuntos Num√©ricos (N, Z, Q, I, R)": `
                <h3>As Caixas de N√∫meros</h3>
                Os n√∫meros s√£o organizados em conjuntos que se expandem:
                
                1. **Naturais ($\\mathbb{N}$):** Contagem (0, 1, 2...).
                2. **Inteiros ($\\mathbb{Z}$):** Inclui os negativos (...-2, -1, 0...).
                3. **Racionais ($\\mathbb{Q}$):** Fra√ß√µes e d√≠zimas peri√≥dicas (tudo que vira fra√ß√£o).
                4. **Irracionais ($\\mathbb{I}$):** D√≠zimas n√£o peri√≥dicas ($\\pi, \\sqrt{2}$).
                5. **Reais ($\\mathbb{R}$):** A uni√£o de todos ($\\mathbb{Q} \\cup \\mathbb{I}$). A reta completa!
                
                [WIDGET:interactive_place_value_extended]
            `,
            "Intervalos Reais": `
                <h3>Peda√ßos da Reta</h3>
                Como representar todos os n√∫meros entre 2 e 5? Usamos intervalos.
                
                * **Fechado $[2, 5]$:** Inclui o 2 e o 5 ($2 \\le x \\le 5$). Bolinha cheia.
                * **Aberto $]2, 5[$:** N√£o inclui as pontas ($2 < x < 5$). Bolinha vazia.
                * **Misto $[2, 5[$:** Inclui o 2, mas n√£o o 5.
            `,
            "M√≥dulos e Desigualdades": `
                <h3>Dist√¢ncia e Ordem</h3>
                **M√≥dulo (|x|):** √â a dist√¢ncia geom√©trica at√© o zero. $|-5| = 5$.
                Propriedade: $\\sqrt{x^2} = |x|$.
                
                **Desigualdades:**
                Ao resolver inequa√ß√µes como $-2x > 10$, lembre-se: multiplicar por negativo **inverte** a desigualdade ($x < -5$).
            `,

            // --- UNIDADE 2: FUN√á√ïES ---
            "Conceito de Fun√ß√£o e Gr√°ficos": `
                <h3>A M√°quina Matem√°tica</h3>
                Uma fun√ß√£o $f: A \\to B$ √© uma lei que associa cada elemento de $x$ (Dom√≠nio) a um √∫nico elemento $y$ (Imagem).
                
                $$f(x) = y$$
                
                Pense numa m√°quina: Entra Mat√©ria Prima ($x$) $\\to$ Processamento ($f$) $\\to$ Sai Produto ($y$).
                O gr√°fico √© a "foto" de todos os pares ordenados $(x, y)$ no plano cartesiano.
                
                [WIDGET:interactive_cartesian_plane]
            `,
            "Fun√ß√£o Afim (1¬∫ Grau): Estudo Completo": `
                <h3>A Linha Reta</h3>
                Lei de forma√ß√£o: $f(x) = ax + b$.
                
                * **$a$ (Coeficiente Angular):** A taxa de varia√ß√£o. Se $a > 0$, a reta sobe (crescente). Se $a < 0$, desce (decrescente).
                * **$b$ (Coeficiente Linear):** Onde a reta corta o eixo Y (valor inicial).
                * **Zero da fun√ß√£o:** O valor de $x$ onde a reta corta o eixo X ($ax+b=0$).
            `,
            "Fun√ß√£o Quadr√°tica (2¬∫ Grau): Estudo Completo": `
                <h3>A Par√°bola</h3>
                Lei de forma√ß√£o: $f(x) = ax^2 + bx + c$.
                O gr√°fico √© uma curva chamada Par√°bola.
                
                * **Concavidade:** $a > 0$ (Sorriso $\\cup$), $a < 0$ (Triste $\\cap$).
                * **V√©rtice:** O ponto de retorno (m√°ximo ou m√≠nimo). $X_v = -b/2a$.
                * **Ra√≠zes:** Calculadas por Bh√°skara. S√£o onde a curva toca o ch√£o (eixo X).
                
                [WIDGET:interactive_parabola_graph]
                [WIDGET:interactive_bhaskara_steps]
            `,
            "Fun√ß√£o Modular": `
                <h3>O Espelho</h3>
                A fun√ß√£o $f(x) = |x|$ transforma tudo que √© negativo em positivo.
                O gr√°fico tem formato de **V**. A parte que estaria abaixo do eixo X √© "refletida" para cima.
            `,

            // --- UNIDADE 3: EXPONENCIAL E LOGAR√çTMICA ---
            "Potencia√ß√£o e Fun√ß√£o Exponencial": `
                <h3>Crescimento Explosivo</h3>
                Quando a vari√°vel est√° no expoente: $f(x) = a^x$ (com $a > 0$ e $a \\neq 1$).
                
                Exemplos: Reprodu√ß√£o de bact√©rias ou juros compostos.
                Ao contr√°rio da fun√ß√£o afim (que soma constante), a exponencial **multiplica** constante.
                O gr√°fico decola rapidamente (curva de crescimento).
                
                [WIDGET:interactive_power_visualizer]
            `,
            "Logaritmos: Defini√ß√£o e Propriedades": `
                <h3>Desfazendo a Pot√™ncia</h3>
                O logaritmo √© o expoente!
                $$\\log_a b = x \\iff a^x = b$$
                "A base $a$ elevada a quanto d√° $b$?"
                
                **Propriedades Poderosas:**
                1. $\\log(A \\cdot B) = \\log A + \\log B$ (Transforma produto em soma).
                2. $\\log(A / B) = \\log A - \\log B$ (Transforma divis√£o em subtra√ß√£o).
                3. $\\log(A^k) = k \\cdot \\log A$ (Regra do Tombo).
            `,
            "Fun√ß√£o Logar√≠tmica e Equa√ß√µes": `
                <h3>A Escala Lenta</h3>
                A fun√ß√£o $f(x) = \\log_a x$ √© a inversa da exponencial.
                Enquanto a exponencial cresce muito r√°pido, o logaritmo cresce muito devagar.
                √â usada para medir escalas s√≠smicas (Richter) e pH qu√≠mico.
            `,

            // --- UNIDADE 4: SEQU√äNCIAS E FINANCEIRA ---
            "Progress√£o Aritm√©tica (PA)": `
                <h3>Somando Sempre o Mesmo</h3>
                Uma sequ√™ncia onde cada termo √© o anterior somado a uma constante (raz√£o $r$).
                Exemplo (r=2): 2, 4, 6, 8...
                
                **Termo Geral:** $a_n = a_1 + (n-1)r$.
                **Soma da PA:** A lenda de Gauss. $S_n = \frac{(a_1 + a_n)n}{2}$.
            `,
            "Progress√£o Geom√©trica (PG)": `
                <h3>Multiplicando Sempre o Mesmo</h3>
                Uma sequ√™ncia onde cada termo √© o anterior multiplicado por uma constante (raz√£o $q$).
                Exemplo (q=2): 3, 6, 12, 24...
                
                **Termo Geral:** $a_n = a_1 \cdot q^{n-1}$.
                Cresce muito mais r√°pido que a PA!
            `,
            "Porcentagem, Juros Simples e Compostos": `
                <h3>O Dinheiro no Tempo</h3>
                
                **Juros Simples (PA):** A taxa incide apenas sobre o capital inicial. O juro √© constante.
                $$J = C \cdot i \cdot t$$
                
                **Juros Compostos (PG):** A taxa incide sobre o montante acumulado ("Juros sobre Juros"). √â como o mundo real funciona.
                $$M = C(1 + i)^t$$
                Aqui, o tempo √© um expoente!
            `,

            // --- UNIDADE 5: GEOMETRIA PLANA APROFUNDADA ---
            "Semelhan√ßa e Rela√ß√µes M√©tricas": `
                <h3>Zoom e Propor√ß√£o</h3>
                Dois pol√≠gonos s√£o semelhantes se t√™m √¢ngulos iguais e lados proporcionais.
                
                **Rela√ß√µes no Tri√¢ngulo Ret√¢ngulo:**
                Al√©m de Pit√°goras ($a^2 = b^2 + c^2$), temos:
                * $h^2 = m \\cdot n$ (Altura ao quadrado = produto das proje√ß√µes).
                * $b^2 = a \\cdot m$ (Cateto ao quadrado = hipotenusa $\\cdot$ proje√ß√£o).
                
                [WIDGET:interactive_pythagoras_calc]
            `,
            "Pol√≠gonos Regulares": `
                <h3>Perfei√ß√£o Geom√©trica</h3>
                Pol√≠gonos com todos os lados e √¢ngulos iguais (Equil√°tero, Quadrado, Hex√°gono...).
                
                **Hex√°gono Regular:** √â m√°gico! Ele √© formado por 6 tri√¢ngulos equil√°teros. Isso facilita muito calcular sua √°rea.
            `,
            "√Åreas de Figuras Planas": `
                <h3>Cobrindo Superf√≠cies</h3>
                Revis√£o e aprofundamento:
                * **Trap√©zio:** $A = \\frac{(B+b)h}{2}$ (M√©dia das bases vezes altura).
                * **Losango:** $A = \\frac{D \\cdot d}{2}$.
                * **C√≠rculo:** $A = \\pi r^2$.
                * **Setor Circular:** Regra de tr√™s com o √¢ngulo.
                
                [WIDGET:interactive_area_calc]
            `,
            //
            // 2EM
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            // ==========================================
            // === 2¬∫ ANO DO ENSINO M√âDIO ===
            // ==========================================

            // --- UNIDADE 1: TRIGONOMETRIA ---
            "Ciclo Trigonom√©trico: Arcos e √Çngulos": `
                <h3>O Rel√≥gio Matem√°tico</h3>
                Imagine um c√≠rculo de raio 1 centrado na origem do plano cartesiano. Este √© o **Ciclo Trigonom√©trico**.
                
                A partir dele, definimos seno e cosseno para qualquer √¢ngulo, n√£o apenas os agudos de um tri√¢ngulo.
                
                * **Eixo Vertical (y):** √â o eixo dos **Senos** ("Sem sono", est√° em p√©).
                * **Eixo Horizontal (x):** √â o eixo dos **Cossenos** ("Com sono", est√° deitado).
                
                **Unidades:**
                Podemos medir em Graus (360¬∞ a volta completa) ou Radianos ($2\pi$ a volta completa).
                Convers√£o: $180^{\circ} = \pi \text{ rad}$.
                
                [WIDGET:interactive_trig_calc]
            `,
            "Fun√ß√µes Trigonom√©tricas (Seno, Cosseno, Tangente)": `
                <h3>Ondas e Per√≠odos</h3>
                Como os √¢ngulos d√£o voltas no c√≠rculo, os valores de seno e cosseno se repetem. Isso gera fun√ß√µes peri√≥dicas (ondas).
                
                * **Fun√ß√£o Seno ($f(x) = \sin x$):** Come√ßa em 0, sobe at√© 1, desce a -1.
                * **Fun√ß√£o Cosseno ($f(x) = \cos x$):** Come√ßa em 1, desce a -1, sobe a 1.
                
                S√£o fundamentais para estudar som, luz, mar√©s e eletricidade!
            `,
            "Rela√ß√µes Fundamentais e Identidades": `
                <h3>A Identidade M√£e</h3>
                Aplicando o Teorema de Pit√°goras no ciclo trigonom√©trico (onde a hipotenusa √© o raio 1), chegamos √† rela√ß√£o mais importante da trigonometria:
                
                $\\sin^2 x + \\cos^2 x = 1$$
                
                Outras importantes:
                * $\\tan x = \\frac{\\sin x}{\\cos x}$
                * $\\sec x = \\frac{1}{\\cos x}$ (Secante)
                * $\\csc x = \\frac{1}{\\sin x}$ (Cossecante)
            `,
            "Transforma√ß√µes (Soma e Diferen√ßa)": `
                <h3>Matem√°tica Cantada</h3>
                Como calcular $\\sin(75^{\\circ})$? Podemos pensar como $\\sin(30^{\\circ} + 45^{\\circ})$.
                
                **F√≥rmula do Seno da Soma:**
                "Minha terra tem palmeiras, onde canta o sabi√°...
                Seno A Cosseno B, Seno B Cosseno A."
                
                $$\\sin(a+b) = \\sin a \\cdot \\cos b + \\sin b \\cdot \\cos a$$
                
                **Para o Cosseno:** "Co√ßa A, Co√ßa B, troca o sinal sem saber."
                $$\\cos(a+b) = \\cos a \\cdot \\cos b - \\sin a \\cdot \\sin b$$
            `,

            // --- UNIDADE 2: MATRIZES E DETERMINANTES ---
            "Matrizes: Conceitos e Opera√ß√µes": `
                <h3>Planilhas de Dados</h3>
                Uma matriz √© simplesmente uma tabela organizada de n√∫meros.
                $$                A = \\begin{bmatrix}                 1 & 2 \\\\                 3 & 4                 \\end{bmatrix}                $$
                * **Soma:** Somamos elemento com elemento (a11 com b11).
                * **Multiplica√ß√£o:** Linha por Coluna. "Mergulha a linha na coluna".
                
                Usadas intensamente em computa√ß√£o gr√°fica para mover e girar personagens 3D.
            `,
            "Determinantes e Propriedades": `
                <h3>O N√∫mero da Matriz</h3>
                O determinante √© um n√∫mero √∫nico associado a uma matriz quadrada que diz muito sobre ela.
                
                * **Ordem 2 (Regra do X):** Diagonal Principal - Diagonal Secund√°ria.
                * **Ordem 3 (Regra de Sarrus):** Copia as duas primeiras colunas, multiplica as diagonais principais e subtrai as secund√°rias.
                
                Se $det = 0$, a matriz n√£o tem inversa!
            `,
            "Matriz Inversa": `
                <h3>A "Divis√£o" de Matrizes</h3>
                N√£o existe divis√£o de matrizes (A / B). Em vez disso, multiplicamos pela inversa ($A^{-1}$).
                
                $$A \\cdot A^{-1} = I$$
                (Onde I √© a Matriz Identidade, cheia de 1s na diagonal e 0s no resto).
            `,

            // --- UNIDADE 3: SISTEMAS LINEARES ---
            "Classifica√ß√£o e Discuss√£o": `
                <h3>Quantas Solu√ß√µes?</h3>
                Um sistema linear pode ser:
                
                1. **SPD (Poss√≠vel e Determinado):** Tem uma √∫nica solu√ß√£o (as retas se cruzam num ponto). $Det \\neq 0$.
                2. **SPI (Poss√≠vel e Indeterminado):** Infinitas solu√ß√µes (as retas s√£o coincidentes). $Det = 0$.
                3. **SI (Imposs√≠vel):** Nenhuma solu√ß√£o (retas paralelas).
                
                [WIDGET:interactive_system_steps]
            `,
            "Escalonamento de Sistemas": `
                <h3>O M√©todo Escada</h3>
                Para sistemas grandes (3x3, 4x4), usamos o escalonamento.
                O objetivo √© eliminar vari√°veis at√© ficar com um formato de "escada":
                
                $$ \\begin{cases} x + y + z = 6 \\\\ 0 + y + z = 3 \\\\ 0 + 0 + z = 1 \\end{cases} $$
                
                Daqui tiramos que $z=1$, substitu√≠mos na de cima para achar $y$, e depois na primeira para achar $x$.
            `,

            // --- UNIDADE 4: AN√ÅLISE COMBINAT√ìRIA ---
            "Princ√≠pio Fundamental da Contagem": `
                <h3>A √Årvore de Possibilidades</h3>
                Se voc√™ tem 3 camisas e 2 cal√ßas, de quantas formas pode se vestir?
                Basta multiplicar as op√ß√µes de cada etapa: $3 \\times 2 = 6$.
                
                Isso vale para senhas, placas de carro e menus de restaurante!
                
                [WIDGET:interactive_combinatorics]
            `,
            "Fatorial, Arranjos e Permuta√ß√µes": `
                <h3>A Fila Anda</h3>
                **Fatorial ($n!$):** Multiplica√ß√£o decrescente. $5! = 5 \\cdot 4 \\cdot 3 \\cdot 2 \\cdot 1 = 120$.
                
                **Permuta√ß√£o:** Trocar a ordem de todos os elementos. (Ex: Anagramas da palavra AMOR = $4! = 24$).
                
                **Arranjo:** A ordem IMPORTA. (Ex: P√≥dio de corrida. Ouro e Prata √© diferente de Prata e Ouro).
                $$A_{n,p} = \\frac{n!}{(n-p)!}$$
            `,
            "Combina√ß√µes Simples": `
                <h3>A Ordem N√£o Importa</h3>
                Diferente do Arranjo, aqui a ordem n√£o muda o grupo.
                Ex: Escolher 2 amigos para ir ao cinema. (Jo√£o e Maria √© o mesmo grupo que Maria e Jo√£o).
                
                $$C_{n,p} = \\frac{n!}{p!(n-p)!}$$
                
                √â a f√≥rmula usada para ganhar na Mega-Sena!
            `,

            // --- UNIDADE 5: PROBABILIDADE ---
            "Defini√ß√£o e Espa√ßo Amostral": `
                <h3>Medindo a Sorte</h3>
                **Espa√ßo Amostral ($\\Omega$):** O conjunto de tudo que pode acontecer.
                **Evento (E):** O que eu quero que aconte√ßa.
                
                $$P(E) = \\frac{\\text{Quero}}{\\text{Total}}$$
                
                [WIDGET:interactive_prob_dice_intuitive]
            `,
            "Probabilidade Condicional e Eventos Independentes": `
                <h3>Depende do qu√™?</h3>
                
                **Independente:** Jogar uma moeda duas vezes. O segundo resultado n√£o liga para o primeiro. Multiplica-se as chances.
                
                **Condicional:** Qual a chance de tirar um Rei do baralho, *sabendo que* a carta √© de Copas?
                O espa√ßo amostral diminuiu! Agora s√≥ olhamos para as cartas de Copas.
                $$P(A|B) = \\frac{P(A \\cap B)}{P(B)}$$
            `,

            // --- UNIDADE 6: GEOMETRIA ESPACIAL ---
            "Poliedros e Rela√ß√£o de Euler": `
                <h3>S√≥lidos de Plat√£o</h3>
                Poliedros s√£o s√≥lidos formados por pol√≠gonos planos.
                Elementos: Faces (F), V√©rtices (V) e Arestas (A).
                
                **Rela√ß√£o de Euler:** "Vamos Fazer Amor a Dois"
                $$V + F = A + 2$$
                
                [WIDGET:interactive_solids_viewer]
            `,
            "Prismas e Cilindros (√Årea e Volume)": `
                <h3>Corpos que n√£o afunilam</h3>
                Para s√≥lidos que mant√™m a mesma "grossura" da base at√© o topo:
                
                **Volume:** √Årea da Base $\\times$ Altura.
                $V = A_b \\cdot h$
                
                No Cilindro, a base √© um c√≠rculo ($\\pi R^2$).
            `,
            "Pir√¢mides e Cones (√Årea e Volume)": `
                <h3>Corpos que afunilam</h3>
                Eles t√™m uma ponta (v√©rtice) l√° em cima.
                
                **Volume:** Um ter√ßo do prisma correspondente.
                $$V = \\frac{1}{3} \\cdot A_b \\cdot h$$
                
                [WIDGET:interactive_volume_cube]
            `,
            "Esfera (√Årea e Volume)": `
                <h3>A Forma Perfeita</h3>
                A esfera √© o s√≥lido com menor superf√≠cie para um dado volume.
                
                * **√Årea da Casca:** $A = 4 \\pi R^2$ (Equivale a 4 c√≠rculos).
                * **Volume:** $V = \\frac{4}{3} \\pi R^3$.
            `,
            //
            // 3EM
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            //
            // ==========================================
            // === 3¬∫ ANO DO ENSINO M√âDIO ===
            // ==========================================

            // --- UNIDADE 1: GEOMETRIA ANAL√çTICA (RETA) ---
            "Ponto: Dist√¢ncia e Ponto M√©dio": `
                <h3>O Mapa do Tesouro</h3>
                A Geometria Anal√≠tica traduz formas geom√©tricas para equa√ß√µes alg√©bricas.
                
                **Dist√¢ncia entre Dois Pontos ($d_{AB}$):**
                √â a hipotenusa de um tri√¢ngulo ret√¢ngulo imagin√°rio!
                $$d = \\sqrt{(x_B - x_A)^2 + (y_B - y_A)^2}$$
                
                **Ponto M√©dio ($M$):**
                √â a m√©dia aritm√©tica das coordenadas.
                $$x_M = \\frac{x_A + x_B}{2}, \\quad y_M = \\frac{y_A + y_B}{2}$$
                
                [WIDGET:interactive_cartesian_plane]
                [WIDGET:interactive_pythagoras_calc]
            `,
            "Estudo da Reta: Equa√ß√µes e Posi√ß√µes": `
                <h3>A Receita da Reta</h3>
                Toda reta no plano pode ser escrita como uma equa√ß√£o.
                
                1. **Equa√ß√£o Geral:** $ax + by + c = 0$.
                2. **Equa√ß√£o Reduzida:** $y = mx + n$.
                   * **$m$ (Coeficiente Angular):** √â a inclina√ß√£o (tangente do √¢ngulo). Define se a reta sobe ou desce.
                   * **$n$ (Coeficiente Linear):** Onde a reta corta o eixo Y.
                
                **Posi√ß√µes Relativas:**
                * **Paralelas:** Mesmo $m$.
                * **Perpendiculares:** $m_1 \\cdot m_2 = -1$ (Inverso e oposto).
            `,
            "Dist√¢ncia de Ponto a Reta": `
                <h3>O Caminho Mais Curto</h3>
                A dist√¢ncia de um ponto $P(x_0, y_0)$ at√© uma reta $ax + by + c = 0$ √© sempre uma linha perpendicular.
                
                **F√≥rmula "M√°gica":**
                $$d = \\frac{|ax_0 + by_0 + c|}{\\sqrt{a^2 + b^2}}$$
                (O m√≥dulo em cima garante que a dist√¢ncia seja positiva).
            `,

            // --- UNIDADE 2: C√îNICAS ---
            "Equa√ß√£o da Circunfer√™ncia": `
                <h3>O C√≠rculo Alg√©brico</h3>
                Uma circunfer√™ncia √© o conjunto de pontos que est√£o √† mesma dist√¢ncia ($R$) de um centro $C(a, b)$.
                
                **Equa√ß√£o Reduzida:**
                $$(x - a)^2 + (y - b)^2 = R^2$$
                
                Se o centro for na origem $(0,0)$, fica $x^2 + y^2 = R^2$.
                
                [WIDGET:interactive_geometry_canvas]
            `,
            "Introdu√ß√£o a Elipse, Hip√©rbole e Par√°bola": `
                <h3>Fatiando o Cone</h3>
                Dependendo de como voc√™ corta um cone, obt√©m curvas diferentes:
                
                1. **Elipse:** A "bola achatada". √ìrbita dos planetas. Tem dois focos. ($a^2 = b^2 + c^2$).
                2. **Hip√©rbole:** Duas curvas espelhadas.
                3. **Par√°bola:** Corte paralelo √† geratriz. (A mesma da fun√ß√£o do 2¬∫ grau).
            `,// --- UNIDADE 5: ESTAT√çSTICA ---
            "Medidas de Tend√™ncia Central": `
                <h3>O Centro dos Dados</h3>
                Resumindo uma pesquisa em um n√∫mero:
                
                1. **M√©dia ($\\bar{x}$):** A mais sens√≠vel. Soma tudo e divide. (Cuidado com valores extremos!).
                2. **Mediana:** O termo central da fila ordenada. (N√£o se abala com extremos).
                3. **Moda:** O valor que mais aparece. (O "hit" do momento).
                
                [WIDGET:interactive_charts_demo]
            `,
            "Medidas de Dispers√£o (Vari√¢ncia e Desvio Padr√£o)": `
                <h3>Confiabilidade</h3>
                A m√©dia sozinha engana. Precisamos saber se os dados est√£o "juntinhos" ou "espalhados".
                
                * **Vari√¢ncia ($s^2$):** A m√©dia dos erros ao quadrado.
                * **Desvio Padr√£o ($s$):** A raiz da vari√¢ncia.
                
                **Quanto menor o Desvio Padr√£o, mais confi√°vel e homog√™nea √© a amostra.**
            `

        };
        // 3. BANCO DE QUEST√ïES (QUIZ)
        const CONTEUDO_QUESTOES = {
            "6¬∫ Ano": [
                { q: "Quanto √© $2^3$?", opts: ["6", "8", "5", "9"], a: 1 },
                { q: "Qual √© o MMC de 4 e 6?", opts: ["24", "12", "10", "2"], a: 1 },
                { q: "Como se chama o resultado da divis√£o?", opts: ["Produto", "Soma", "Quociente", "Resto"], a: 2 },
                { q: "O que significa o denominador da fra√ß√£o?", opts: ["Quantas partes peguei", "O total de divis√µes", "O resultado", "O resto"], a: 1 },
                { q: "Qual n√∫mero √© primo?", opts: ["9", "15", "13", "21"], a: 2 }
            ],
            "7¬∫ Ano": [
                { q: "Quanto √© -5 + 2?", opts: ["-3", "-7", "3", "7"], a: 0 },
                { q: "Qual o valor de x em 2x = 10?", opts: ["5", "20", "8", "12"], a: 0 },
                { q: "O ponto (2, -3) est√° em qual quadrante?", opts: ["1¬∫", "2¬∫", "3¬∫", "4¬∫"], a: 3 }
            ],
            "8¬∫ Ano": [
                { q: "Qual √© o desenvolvimento de $(a+b)^2$?", opts: ["$a^2+b^2$", "$a^2+ab+b^2$", "$a^2+2ab+b^2$", "$2a+2b$"], a: 2 },
                { q: "A soma dos √¢ngulos internos de um tri√¢ngulo √©:", opts: ["180¬∞", "360¬∞", "90¬∞", "270¬∞"], a: 0 }
            ],
            "9¬∫ Ano": [
                { q: "Qual √© o valor de Delta em $x^2 - 5x + 6 = 0$?", opts: ["1", "25", "49", "-1"], a: 0 },
                { q: "Em um tri√¢ngulo ret√¢ngulo, $a^2 = b^2 + ...$", opts: ["$c^2$", "$2bc$", "$c$", "$bc$"], a: 0 }
            ]
        };
        // --- APP ENGINE ---
        const app = {
            history: [],
            currentView: 'home',
            currentData: null,
            completedLessons: JSON.parse(localStorage.getItem('mathlingo_progress') || '[]'),

            init() {
                this.render('home');
            },

            navigate(view, data = null) {
                if (this.currentView) this.history.push({ view: this.currentView, data: this.currentData });
                this.currentView = view;
                this.currentData = data;
                this.render(view, data);
            },

            goBack() {
                if (this.history.length === 0) return this.render('home');
                const prev = this.history.pop();
                this.currentView = prev.view;
                this.currentData = prev.data;
                this.render(prev.view, prev.data);
                window.scrollTo(0, 0);
            },

            completeLesson(lessonName) {
                if (!this.completedLessons.includes(lessonName)) {
                    this.completedLessons.push(lessonName);
                    localStorage.setItem('mathlingo_progress', JSON.stringify(this.completedLessons));
                }
            },

            // --- RENDERIZADORES DE TELA ---

            render(view, data) {
                const container = document.getElementById('main-container');
                const btnBack = document.getElementById('btn-back');

                btnBack.classList.toggle('hidden', view === 'home');
                container.innerHTML = '';
                window.scrollTo(0, 0);

                if (view === 'home') this.renderHome(container);
                else if (view === 'levels') this.renderLevels(container);
                else if (view === 'units') this.renderUnits(container, data);
                else if (view === 'path') this.renderPath(container, data);
                else if (view === 'lesson') this.renderLesson(container, data);
            },

            renderHome(container) {
                container.innerHTML = `
                    <div class="flex flex-col items-center justify-center pt-10 animate-fade-in">
                        <div class="flex flex-col items-center mb-12">
                            <div class="w-36 h-36 rounded-full bg-brand-green border-4 border-white shadow-xl mb-6 flex items-center justify-center relative">
                                <i class="fas fa-graduation-cap text-white text-6xl"></i>
                                <div class="absolute bottom-0 right-0 bg-white p-2 rounded-full shadow-sm">
                                    <div class="w-6 h-6 bg-brand-yellow rounded-full border-2 border-white"></div>
                                </div>
                            </div>
                            <h2 class="text-3xl font-extrabold text-gray-700">Ol√°, Estudante!</h2>
                            <p class="text-gray-400 font-bold text-lg mt-2">Pronto para aprender?</p>
                        </div>

                        <div class="w-full max-w-md space-y-6">
                            <div onclick="app.navigate('levels', 'teoria')" class="group cursor-pointer bg-white border-2 border-gray-200 rounded-3xl p-6 flex items-center gap-6 hover:border-brand-purple hover:bg-purple-50 transition-all shadow-card active:translate-y-1 active:shadow-none">
                                <div class="w-20 h-20 rounded-2xl bg-brand-purple flex items-center justify-center shadow-inner group-hover:scale-110 transition-transform text-white text-4xl">
                                    <i class="fas fa-book-open"></i>
                                </div>
                                <div>
                                    <h3 class="text-2xl font-extrabold text-gray-700">Trilha de Teoria</h3>
                                    <p class="text-gray-400 font-bold">Aulas passo a passo</p>
                                </div>
                            </div>

                            <div onclick="alert('Em breve!')" class="group cursor-pointer bg-white border-2 border-gray-200 rounded-3xl p-6 flex items-center gap-6 hover:border-brand-blue hover:bg-blue-50 transition-all shadow-card active:translate-y-1 active:shadow-none opacity-60">
                                <div class="w-20 h-20 rounded-2xl bg-brand-blue flex items-center justify-center shadow-inner group-hover:scale-110 transition-transform text-white text-4xl">
                                    <i class="fas fa-dumbbell"></i>
                                </div>
                                <div>
                                    <h3 class="text-2xl font-extrabold text-gray-700">Arena de Pr√°tica</h3>
                                    <p class="text-gray-400 font-bold">Desafios e Quiz (Em breve)</p>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            },

            renderLevels(container) {
                const allLevels = Object.keys(CURRICULO);
                
                // Separa Fundamental de M√©dio
                const fundamental = allLevels.filter(l => !l.includes('M√©dio'));
                const medio = allLevels.filter(l => l.includes('M√©dio'));

                // Helper para gerar bot√£o
                const createBtn = (lvl) => {
                    const theme = LEVEL_THEMES[lvl] || LEVEL_THEMES["6¬∫ Ano"];
                    // Extrai apenas o n√∫mero e o s√≠mbolo (Ex: "6¬∫") ou "1¬∫"
                    const shortLabel = lvl.split(' ')[0]; 
                    // Label completo para exibir em baixo se quiser, ou simplificado
                    const displayLabel = lvl.includes('M√©dio') ? lvl.replace('Ano do Ensino M√©dio', 'ano EM') : lvl;

                    return `
                        <button onclick="app.navigate('units', '${lvl}')" 
                            class="relative w-full md:w-40 h-28 rounded-3xl border-b-4 ${theme.borderDark} ${theme.main} hover:brightness-110 transition-all active:scale-95 active:border-b-0 flex flex-col items-center justify-center gap-1 shadow-lg text-white group">
                            <div class="w-10 h-10 rounded-xl bg-white/20 flex items-center justify-center text-xl font-extrabold shadow-inner group-hover:scale-110 transition-transform">
                                ${shortLabel.replace('¬∫', '')}
                            </div>
                            <span class="font-extrabold text-md tracking-wide uppercase">${displayLabel}</span>
                        </button>
                    `;
                };
                
                let html = `
                    <div class="flex flex-col items-center pt-4 w-full animate-fade-in pb-20 max-w-4xl mx-auto">
                        
                        <div class="w-full flex items-center gap-4 mb-6">
                            <div class="h-1 flex-1 bg-gray-200 rounded-full"></div>
                            <h3 class="text-gray-400 font-black text-sm uppercase tracking-widest">Ensino Fundamental</h3>
                            <div class="h-1 flex-1 bg-gray-200 rounded-full"></div>
                        </div>

                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 w-full mb-12 px-2">
                            ${fundamental.map(lvl => createBtn(lvl)).join('')}
                        </div>

                        <div class="w-full flex items-center gap-4 mb-6">
                            <div class="h-1 flex-1 bg-gray-200 rounded-full"></div>
                            <h3 class="text-gray-400 font-black text-sm uppercase tracking-widest">Ensino M√©dio</h3>
                            <div class="h-1 flex-1 bg-gray-200 rounded-full"></div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 w-full px-2 md:px-20">
                            ${medio.map(lvl => createBtn(lvl)).join('')}
                        </div>

                    </div>
                `;
                container.innerHTML = html;
            },

            renderUnits(container, levelName) {
                const theme = LEVEL_THEMES[levelName];
                const units = CURRICULO[levelName];

                let html = `
                    <div class="flex flex-col items-center pt-8 w-full animate-fade-in pb-20">
                        <h3 class="text-gray-700 font-extrabold text-2xl mb-6">Escolha o Conte√∫do</h3>
                        
                        <div class="bg-white border-2 ${theme.border} rounded-2xl px-8 py-3 mb-10 shadow-sm flex items-center gap-4">
                            <span class="font-extrabold text-lg ${theme.text}">${levelName}</span>
                        </div>

                        <div class="w-full border-2 ${theme.border} rounded-[2.5rem] p-6 md:p-8 bg-white shadow-sm space-y-8">
                `;

                let idx = 1;
                for (const [unitName, lessons] of Object.entries(units)) {
                    // Calcula progresso
                    const total = lessons.length;
                    const done = lessons.filter(l => this.completedLessons.includes(l)).length;
                    const pct = Math.round((done / total) * 100);

                    html += `
                        <div onclick="app.navigate('path', {level: '${levelName}', unit: '${unitName}'})" 
                             class="group cursor-pointer flex items-center gap-6 hover:bg-gray-50 p-2 rounded-2xl transition-colors">
                            
                            <div class="w-20 h-20 rounded-full flex items-center justify-center text-2xl font-extrabold text-white shrink-0 shadow-md transition-transform group-hover:scale-110
                                ${pct > 0 ? theme.main : 'bg-gray-200 text-gray-400'}">
                                ${idx}
                            </div>

                            <div class="flex-1">
                                <div class="flex justify-between items-end mb-2">
                                    <h4 class="font-extrabold text-gray-700 text-lg leading-tight group-hover:text-black">${unitName}</h4>
                                    <span class="text-sm font-extrabold ${pct > 0 ? theme.text : 'text-gray-400'}">${pct}%</span>
                                </div>
                                <div class="h-4 w-full bg-gray-100 rounded-full overflow-hidden">
                                    <div class="h-full bg-gradient-to-r ${theme.gradient} transition-all duration-1000" style="width: ${pct}%"></div>
                                </div>
                            </div>
                        </div>
                    `;
                    idx++;
                }

                html += `</div></div>`;
                container.innerHTML = html;
            },

            renderPath(container, { level, unit }) {
                const theme = LEVEL_THEMES[level];
                const lessons = CURRICULO[level][unit];

                let html = `
                    <div class="flex flex-col items-center pt-8 w-full animate-fade-in pb-20 max-w-xl mx-auto">
                        
                        <div class="${theme.light} ${theme.text} text-sm font-extrabold px-6 py-2 rounded-2xl mb-4 tracking-wide">
                            ${level.toUpperCase()}
                        </div>

                        <h2 class="text-2xl md:text-3xl font-extrabold text-gray-700 text-center mb-2 leading-tight">${unit}</h2>
                        <p class="text-gray-400 font-bold text-base mb-12">Trilha de Aprendizagem</p>

                        <div class="relative w-full flex flex-col items-center">
                            <div class="absolute top-0 bottom-10 left-1/2 w-3 bg-gray-200 -translate-x-1/2 rounded-full -z-10"></div>
                `;

                lessons.forEach((lesson, i) => {
                    const isCompleted = this.completedLessons.includes(lesson);
                    const isUnlocked = i === 0 || this.completedLessons.includes(lessons[i - 1]);

                    // Ziguezague
                    const offset = i % 2 === 0 ? '-translate-x-8' : 'translate-x-8';

                    // Estilos do Bot√£o
                    let btnClass, icon;
                    if (isCompleted) {
                        btnClass = 'bg-[#ffc800] border-[#e5b400] text-white';
                        icon = '<i class="fas fa-check text-3xl"></i>';
                    } else if (isUnlocked) {
                        btnClass = `${theme.main} ${theme.borderDark} text-white ring-8 ${theme.ring}`;
                        icon = '<i class="fas fa-star text-2xl"></i>';
                    } else {
                        btnClass = 'bg-gray-200 border-gray-300 text-gray-400';
                        icon = '<i class="fas fa-lock text-2xl"></i>';
                    }

                    const action = isUnlocked ? `onclick="app.navigate('lesson', '${lesson}')"` : `onclick="alert('Complete a anterior!')"`;

                    html += `
                        <div class="flex items-center justify-center w-full mb-10 relative">
                            <div class="relative group transition-transform ${offset}">
                                
                                <div class="absolute top-1/2 -translate-y-1/2 ${i % 2 === 0 ? 'left-24 text-left' : 'right-24 text-right'} w-48 p-3 rounded-xl border-2 bg-white z-20 shadow-sm transition-all ${isUnlocked ? `${theme.border} scale-105` : 'border-gray-200 opacity-60'}">
                                    <h4 class="font-extrabold text-gray-700 text-sm leading-snug">${lesson}</h4>
                                </div>

                                <button ${action} class="w-20 h-20 rounded-full border-b-[6px] flex items-center justify-center transition-all active:scale-95 active:border-b-0 z-10 relative ${btnClass}">
                                    ${icon}
                                    <div class="absolute top-2 left-1/2 -translate-x-1/2 w-2/3 h-1/3 bg-white opacity-20 rounded-full"></div>
                                </button>
                            </div>
                        </div>
                    `;
                });

                html += `
                    <div class="w-24 h-24 mt-4 relative cursor-pointer hover:scale-105 transition-transform">
                        <div class="w-full h-full rounded-3xl ${theme.light} border-4 ${theme.border} flex items-center justify-center">
                            <i class="fas fa-gem text-4xl ${theme.text}"></i>
                        </div>
                    </div>
                </div></div>`;

                container.innerHTML = html;
            },

            renderLesson(container, lessonName) {
                // Recupera o texto. Se n√£o existir, mostra aviso.
                const content = CONTEUDO_TEORIA[lessonName] || `<div class="text-center py-10 text-gray-400 font-bold">Conte√∫do em desenvolvimento...</div>`;

                // Processa Widgets e Alertas
                const processedContent = this.parseContent(content);

                container.innerHTML = `
                    <div class="bg-white p-6 md:p-10 rounded-[2rem] shadow-card border-2 border-gray-100 animate-fade-in mb-20 max-w-3xl mx-auto">
                        <div class="flex items-center gap-3 mb-8 border-b-2 border-gray-100 pb-6">
                            <div class="w-12 h-12 bg-brand-green rounded-xl flex items-center justify-center text-white text-xl shadow-sm">
                                <i class="fas fa-book"></i>
                            </div>
                            <h1 class="text-2xl md:text-3xl font-black text-gray-700 leading-tight">${lessonName}</h1>
                        </div>
                        
                        <div id="lesson-body" class="lesson-content text-gray-700">
                            ${processedContent}
                        </div>
                        
                        <div class="mt-12 pt-8 border-t-2 border-gray-100">
                            <button onclick="app.completeLesson('${lessonName}'); app.goBack()" class="w-full bg-brand-green hover:bg-brand-greenDark text-white font-extrabold text-lg py-4 rounded-2xl shadow-btn btn-game uppercase tracking-widest transition-colors flex items-center justify-center gap-3">
                                <i class="fas fa-check-circle"></i> Concluir Li√ß√£o
                            </button>
                        </div>
                    </div>
                `;

                // Renderiza Matem√°tica (KaTeX)
                renderMathInElement(document.getElementById('lesson-body'), {
                    delimiters: [{ left: "$$", right: "$$", display: true }, { left: "$", right: "$", display: false }]
                });

                // Ativa Widgets
                this.activateWidgets();
            },

            // ... (M√©todos auxiliares: parseContent, activateWidgets, widgets object) ...
            // COPIAR OS M√âTODOS DE WIDGETS E PARSE DO C√ìDIGO ANTERIOR PARA C√Å
            // (Vou incluir os m√©todos base aqui para funcionar, voc√™ deve colar os widgets completos dentro de 'widgets')

            parseContent(text) {
                let processed = text.replace(/\n/g, '<br>');
                // Parsers de Alertas e Dicas (Estilo Duolingo)
                processed = processed.replace(/\[ALERTA.*?\]:(.*?)(<br>|$)/g, `<div class="bg-red-50 border-l-[6px] border-brand-red p-4 my-6 rounded-r-xl flex gap-4 items-start shadow-sm"><div class="text-brand-red text-xl mt-1"><i class="fas fa-exclamation-triangle"></i></div><div><h5 class="font-black text-brand-red text-sm uppercase tracking-wider mb-1">Aten√ß√£o</h5><p class="text-gray-700 text-sm font-bold m-0">$1</p></div></div>`);
                processed = processed.replace(/\[DICA.*?\]:(.*?)(<br>|$)/g, `<div class="bg-blue-50 border-l-[6px] border-brand-blue p-4 my-6 rounded-r-xl flex gap-4 items-start shadow-sm"><div class="text-brand-blue text-xl mt-1"><i class="fas fa-lightbulb"></i></div><div><h5 class="font-black text-brand-blue text-sm uppercase tracking-wider mb-1">Dica Ninja</h5><p class="text-gray-700 text-sm font-bold m-0">$1</p></div></div>`);
                processed = processed.replace(/\[WIDGET:(.*?)\]/g, (m, name) => `<div class="widget-placeholder w-full my-8" data-widget="${name.trim()}"></div>`);
                return processed;
            },

            activateWidgets() {
                document.querySelectorAll('.widget-placeholder').forEach(div => {
                    const name = div.dataset.widget;
                    if (this.widgets[name]) this.widgets[name](div);
                    else div.innerHTML = `<div class="bg-gray-100 rounded-2xl p-8 text-center border-2 border-dashed border-gray-300 text-gray-400 font-bold">Widget: ${name}</div>`;
                });
            },

            widgets: {

                interactive_fraction_decimal_converter(container) {
                    // Estado Inicial
                    let num = 1;
                    let den = 2;

                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col items-center w-full shadow-sm font-sans select-none">
                <h3 class="text-brand-blue font-bold uppercase text-xs tracking-widest mb-4">O Tradutor Matem√°tico</h3>
                
                <div class="flex flex-col md:flex-row items-center gap-8 w-full justify-center mb-6">
                    <div class="flex flex-col items-center gap-2 bg-blue-50 p-4 rounded-xl border border-blue-100">
                        <div class="flex flex-col items-center gap-1">
                            <input type="number" id="conv-num" value="${num}" class="w-12 text-center border-2 border-brand-blue rounded-lg font-bold text-lg outline-none text-brand-blue bg-white focus:border-brand-blueDark transition-colors">
                            <div class="w-full h-0.5 bg-brand-blue"></div>
                            <input type="number" id="conv-den" value="${den}" min="1" class="w-12 text-center border-2 border-brand-blue rounded-lg font-bold text-lg outline-none text-brand-blue bg-white focus:border-brand-blueDark transition-colors">
                        </div>
                        <span class="text-[10px] font-bold text-brand-blue uppercase">Fra√ß√£o</span>
                    </div>

                    <div class="text-3xl text-gray-300">
                        <i class="fas fa-arrow-right hidden md:block"></i>
                        <i class="fas fa-arrow-down md:hidden"></i>
                    </div>

                    <div class="flex flex-col items-center gap-2 bg-green-50 p-4 rounded-xl border border-green-100 min-w-[120px]">
                        <div class="text-4xl font-mono font-black text-brand-green" id="conv-res">0,5</div>
                        <span class="text-[10px] font-bold text-brand-green uppercase">Decimal</span>
                    </div>
                </div>

                <div class="w-full max-w-md space-y-2">
                    <div class="relative h-10 bg-gray-200 rounded-lg overflow-hidden border border-gray-300">
                        <div id="bar-frac" class="absolute top-0 left-0 h-full bg-brand-blue transition-all duration-500 flex items-center justify-end pr-2 text-white font-bold text-sm" style="width: 50%"></div>
                        <div class="absolute inset-0 flex items-center justify-center text-xs font-bold text-gray-500 mix-blend-multiply z-10 pointer-events-none">Fra√ß√£o</div>
                    </div>
                    <div class="relative h-10 bg-gray-200 rounded-lg overflow-hidden border border-gray-300">
                        <div id="bar-dec" class="absolute top-0 left-0 h-full bg-brand-green transition-all duration-500 flex items-center justify-end pr-2 text-white font-bold text-sm" style="width: 50%"></div>
                        <div class="absolute inset-0 flex items-center justify-center text-xs font-bold text-gray-500 mix-blend-multiply z-10 pointer-events-none">Decimal</div>
                    </div>
                </div>

                <div class="mt-4 text-center">
                    <p class="text-sm text-gray-600" id="calc-step">1 √∑ 2 = 0,5</p>
                </div>
            </div>
        `;

                    const nInput = container.querySelector('#conv-num');
                    const dInput = container.querySelector('#conv-den');
                    const resText = container.querySelector('#conv-res');
                    const barFrac = container.querySelector('#bar-frac');
                    const barDec = container.querySelector('#bar-dec');
                    const calcStep = container.querySelector('#calc-step');

                    const update = () => {
                        let n = parseFloat(nInput.value) || 0;
                        let d = parseFloat(dInput.value) || 1;
                        if (d === 0) d = 1; // Evita divis√£o por zero

                        const val = n / d;

                        // Formata√ß√£o BR
                        const valStr = val.toLocaleString('pt-BR', { maximumFractionDigits: 4 });

                        resText.innerText = valStr;
                        calcStep.innerText = `${n} √∑ ${d} = ${valStr}`;

                        // Atualiza Barras (Limita a 100% visualmente para n√£o quebrar layout, mas mostra valor real)
                        const percent = Math.min(val * 100, 100);
                        barFrac.style.width = `${percent}%`;
                        barDec.style.width = `${percent}%`;

                        barFrac.innerText = n + "/" + d;
                        barDec.innerText = valStr;
                    };

                    nInput.addEventListener('input', update);
                    dInput.addEventListener('input', update);
                },

                interactive_geometry_tools(container) {
                    // Estado
                    let activeTool = 'ruler';
                    let compassRadius = 50;
                    let protractorAngle = 0;

                    // 1. HTML
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-4 flex flex-col items-center w-full shadow-sm font-sans select-none overflow-hidden">
                
                <div class="flex gap-2 mb-6 bg-gray-100 p-1 rounded-xl overflow-x-auto w-full max-w-md no-scrollbar">
                    <button data-t="ruler" class="tool-tab flex-1 py-2 px-3 rounded-lg text-xs font-bold uppercase whitespace-nowrap transition-all bg-white text-brand-blue shadow-sm flex items-center justify-center gap-2">
                        <i class="fas fa-ruler-horizontal"></i> R√©gua
                    </button>
                    <button data-t="protractor" class="tool-tab flex-1 py-2 px-3 rounded-lg text-xs font-bold uppercase whitespace-nowrap transition-all text-gray-400 hover:bg-white flex items-center justify-center gap-2">
                        <div class="w-4 h-2 border-t-2 border-l-2 border-r-2 border-current rounded-t-full"></div> Transf.
                    </button>
                    <button data-t="squares" class="tool-tab flex-1 py-2 px-3 rounded-lg text-xs font-bold uppercase whitespace-nowrap transition-all text-gray-400 hover:bg-white flex items-center justify-center gap-2">
                        <i class="fas fa-ruler-combined"></i> Esquadros
                    </button>
                    <button data-t="compass" class="tool-tab flex-1 py-2 px-3 rounded-lg text-xs font-bold uppercase whitespace-nowrap transition-all text-gray-400 hover:bg-white flex items-center justify-center gap-2">
                        <i class="fas fa-drafting-compass"></i> Compasso
                    </button>
                </div>

                <div class="relative w-full h-64 bg-gray-50 border-2 border-dashed border-gray-200 rounded-xl overflow-hidden flex items-center justify-center" id="workspace">
                    
                    </div>

                <div class="mt-4 w-full max-w-xs" id="controls-area">
                    </div>

            </div>
        `;

                    // 2. Seletores
                    const workspace = container.querySelector('#workspace');
                    const controlsArea = container.querySelector('#controls-area');
                    const tabs = container.querySelectorAll('.tool-tab');

                    // 3. Renderizadores de Ferramentas

                    // --- R√âGUA ---
                    const renderRuler = () => {
                        // Gera um objeto aleat√≥rio para medir
                        const objectWidth = Math.floor(Math.random() * 150) + 50; // 50 a 200px
                        const cm = (objectWidth / 37.8).toFixed(1); // Aprox px para cm (web)

                        workspace.innerHTML = `
                <div class="absolute flex flex-col items-center justify-center pointer-events-none" style="width: ${objectWidth}px; height: 20px; background: #FF9600; border-radius: 4px; top: 40%;">
                    <span class="text-white text-[10px] font-bold opacity-50">Objeto</span>
                </div>
                
                <div id="ruler-el" class="absolute w-[320px] h-12 bg-yellow-100 border border-yellow-600 rounded shadow-lg flex items-end px-2 transition-transform duration-75 cursor-grab active:cursor-grabbing" style="top: 55%; left: 10px;">
                    ${Array.from({ length: 16 }).map((_, i) => `
                        <div class="h-full flex flex-col justify-end items-center" style="width: 20px; margin-right: 17.8px">
                            <div class="h-4 w-px bg-black"></div>
                            <span class="text-[10px] font-mono font-bold">${i}</span>
                        </div>
                    `).join('')}
                </div>
            `;

                        controlsArea.innerHTML = `
                <div class="text-center">
                    <label class="text-xs font-bold text-gray-400 uppercase mb-1 block">Posi√ß√£o da R√©gua</label>
                    <input type="range" min="-50" max="200" value="10" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-brand-blue" id="tool-slider">
                    <p class="text-xs text-gray-500 mt-2">Arraste para alinhar o zero!</p>
                </div>
            `;

                        const slider = container.querySelector('#tool-slider');
                        const rulerEl = container.querySelector('#ruler-el');

                        slider.oninput = (e) => {
                            rulerEl.style.left = `${e.target.value}px`;
                        };
                    };

                    // --- TRANSFERIDOR ---
                    const renderProtractor = () => {
                        const randomAngle = Math.floor(Math.random() * 120) + 30; // 30 a 150 graus

                        workspace.innerHTML = `
                <div class="absolute bottom-10 left-1/2 -translate-x-1/2 w-0 h-0">
                    <div class="absolute bottom-0 left-0 w-32 h-1 bg-black origin-left"></div> <div class="absolute bottom-0 left-0 w-32 h-1 bg-brand-red origin-left" style="transform: rotate(-${randomAngle}deg)"></div> <div class="absolute bottom-[-5px] left-[-5px] w-3 h-3 bg-black rounded-full"></div> </div>

                <div id="prot-el" class="absolute w-64 h-32 bg-white/80 backdrop-blur-sm border-2 border-blue-500 rounded-t-full shadow-xl flex justify-center items-end origin-bottom pb-2" style="bottom: 40px; left: 50%; margin-left: -128px; transform: rotate(0deg);">
                    <div class="absolute bottom-0 w-2 h-2 bg-blue-500 rounded-full"></div> <div class="absolute w-full h-full rounded-t-full border border-blue-200 opacity-50"></div>
                    
                    <div class="absolute top-2 font-bold text-blue-800 text-xs">90¬∞</div>
                    <div class="absolute bottom-2 left-4 font-bold text-blue-800 text-xs">180¬∞</div>
                    <div class="absolute bottom-2 right-4 font-bold text-blue-800 text-xs">0¬∞</div>
                    
                    <div class="absolute bottom-0 w-full h-px bg-blue-500"></div>
                </div>
            `;

                        controlsArea.innerHTML = `
                <div class="text-center">
                    <label class="text-xs font-bold text-gray-400 uppercase mb-1 block">Rota√ß√£o</label>
                    <input type="range" min="-45" max="45" value="0" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-brand-blue" id="tool-slider">
                    <p class="text-xs text-gray-500 mt-2">Alinhe a base com a linha preta.</p>
                </div>
            `;

                        const slider = container.querySelector('#tool-slider');
                        const protEl = container.querySelector('#prot-el');

                        slider.oninput = (e) => {
                            protEl.style.transform = `rotate(${e.target.value}deg)`;
                        };
                    };

                    // --- ESQUADROS ---
                    const renderSquares = () => {
                        workspace.innerHTML = `
                <div class="flex items-end justify-center gap-4 h-full pb-8">
                    <div class="w-32 h-32 bg-purple-100 border-2 border-purple-600 relative group cursor-pointer hover:scale-105 transition-transform" style="clip-path: polygon(0 0, 0% 100%, 100% 100%);">
                         <span class="absolute bottom-2 left-2 font-bold text-[10px] text-purple-800">90¬∞</span>
                         <span class="absolute bottom-2 right-8 font-bold text-[10px] text-purple-800">45¬∞</span>
                         <span class="absolute top-12 left-2 font-bold text-[10px] text-purple-800">45¬∞</span>
                    </div>

                    <div class="w-24 h-40 bg-purple-100 border-2 border-purple-600 relative group cursor-pointer hover:scale-105 transition-transform" style="clip-path: polygon(0 0, 0% 100%, 100% 100%);">
                         <span class="absolute bottom-2 left-2 font-bold text-[10px] text-purple-800">90¬∞</span>
                         <span class="absolute bottom-2 right-4 font-bold text-[10px] text-purple-800">60¬∞</span>
                         <span class="absolute top-8 left-2 font-bold text-[10px] text-purple-800">30¬∞</span>
                    </div>
                </div>
            `;
                        controlsArea.innerHTML = `
                <div class="text-center text-xs text-gray-500">
                    Os dois esquadros cl√°ssicos: <strong>Is√≥sceles</strong> (Esq) e <strong>Escaleno</strong> (Dir).
                </div>
            `;
                    };

                    // --- COMPASSO ---
                    const renderCompass = () => {
                        workspace.innerHTML = `
                <div class="absolute top-1/2 left-1/2 w-2 h-2 bg-black rounded-full z-10"></div> <div id="circle-draw" class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 rounded-full border-2 border-brand-orange transition-all duration-300" style="width: 100px; height: 100px; border-style: dashed;"></div>

                <div id="compass-img" class="absolute top-1/2 left-1/2 w-4 h-32 border-l-2 border-gray-400 origin-top transition-all duration-300" style="transform: rotate(-15deg)">
                    <div class="absolute bottom-0 -left-1 w-2 h-2 bg-gray-600 rounded-full"></div> </div>
                 <div id="compass-pencil" class="absolute top-1/2 left-1/2 w-4 h-32 border-l-2 border-orange-400 origin-top transition-all duration-300" style="transform: rotate(15deg)">
                    <div class="absolute bottom-0 -left-1 w-2 h-4 bg-orange-600"></div> </div>
            `;

                        controlsArea.innerHTML = `
                 <div class="text-center">
                    <label class="text-xs font-bold text-gray-400 uppercase mb-1 block">Abertura (Raio)</label>
                    <input type="range" min="20" max="100" value="50" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-brand-orange" id="radius-slider">
                    <p class="text-xs text-gray-500 mt-2">Mude o raio para ver o c√≠rculo crescer.</p>
                </div>
            `;

                        const slider = container.querySelector('#radius-slider');
                        const circle = container.querySelector('#circle-draw');
                        const legL = container.querySelector('#compass-img');
                        const legR = container.querySelector('#compass-pencil');

                        const updateCompass = (r) => {
                            const d = r * 2;
                            circle.style.width = `${d}px`;
                            circle.style.height = `${d}px`;

                            // Simula abertura das pernas
                            const angle = Math.min(r / 2, 45);
                            legL.style.transform = `rotate(-${angle}deg)`;
                            legR.style.transform = `rotate(${angle}deg)`;
                        };

                        slider.oninput = (e) => {
                            updateCompass(e.target.value);
                        };
                    };

                    // 4. L√≥gica de Tabs
                    tabs.forEach(tab => {
                        tab.onclick = () => {
                            activeTool = tab.dataset.t;

                            // Atualiza Estilos das Tabs
                            tabs.forEach(t => {
                                if (t.dataset.t === activeTool) {
                                    t.className = "tool-tab flex-1 py-2 px-3 rounded-lg text-xs font-bold uppercase whitespace-nowrap transition-all bg-white text-brand-blue shadow-sm flex items-center justify-center gap-2";
                                } else {
                                    t.className = "tool-tab flex-1 py-2 px-3 rounded-lg text-xs font-bold uppercase whitespace-nowrap transition-all text-gray-400 hover:bg-white flex items-center justify-center gap-2";
                                }
                            });

                            // Renderiza a ferramenta
                            if (activeTool === 'ruler') renderRuler();
                            if (activeTool === 'protractor') renderProtractor();
                            if (activeTool === 'squares') renderSquares();
                            if (activeTool === 'compass') renderCompass();
                        };
                    });

                    // Init
                    renderRuler();
                },

                interactive_estimation_game(container) {
                    // 1. Dados do Jogo (Perguntas Curadas para ensinar estrat√©gias)
                    const questions = [
                        {
                            q: "19 √ó 21",
                            options: [40, 400, 4000],
                            correct: 1,
                            logic: "19 √© perto de 20. 21 √© perto de 20.<br><strong>20 √ó 20 = 400</strong>"
                        },
                        {
                            q: "498 + 305",
                            options: [80, 800, 8000],
                            correct: 1,
                            logic: "Arredonde para centenas:<br><strong>500 + 300 = 800</strong>"
                        },
                        {
                            q: "102 √∑ 5",
                            options: [2, 20, 200],
                            correct: 1,
                            logic: "102 √© quase 100.<br><strong>100 √∑ 5 = 20</strong>"
                        },
                        {
                            q: "9,9 √ó 7,1",
                            options: [7, 70, 700],
                            correct: 1,
                            logic: "9,9 vira 10. 7,1 vira 7.<br><strong>10 √ó 7 = 70</strong>"
                        },
                        {
                            q: "3.100 - 98",
                            options: [2000, 3000, 4000],
                            correct: 1,
                            logic: "Tirar 98 √© quase tirar 100.<br><strong>3100 - 100 = 3000</strong>"
                        }
                    ];

                    let currentIdx = 0;
                    let score = 0;
                    let isAnswered = false;

                    // 2. Inje√ß√£o do HTML
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col items-center w-full shadow-sm font-sans select-none relative overflow-hidden">
                
                <div class="flex justify-between w-full items-center mb-6 border-b-2 border-gray-100 pb-2">
                    <h3 class="text-brand-blue font-bold uppercase text-xs tracking-widest"><i class="fas fa-bullseye"></i> Alvo Aproximado</h3>
                    <div class="text-xs font-bold text-gray-400">Quest√£o <span id="q-num">1</span>/${questions.length}</div>
                </div>

                <div class="absolute top-0 left-0 h-1 bg-brand-green transition-all duration-500" id="progress-bar" style="width: 0%"></div>

                <div class="bg-gray-800 text-white font-mono text-4xl md:text-5xl p-6 rounded-xl w-full text-center mb-8 shadow-inner border-4 border-gray-600 flex items-center justify-center min-h-[100px]">
                    <span id="question-text" class="tracking-widest animate-pop-in">${questions[0].q}</span>
                </div>

                <div class="grid grid-cols-3 gap-3 w-full mb-6" id="options-container">
                    </div>

                <div id="feedback-area" class="w-full bg-gray-50 rounded-xl p-4 border-2 border-gray-100 text-center hidden">
                    <div id="feedback-icon" class="text-4xl mb-2"></div>
                    <h4 id="feedback-title" class="font-black text-lg uppercase mb-1"></h4>
                    <p id="feedback-logic" class="text-sm text-gray-600 font-medium"></p>
                    <button id="next-btn" class="mt-4 bg-brand-blue text-white font-bold py-2 px-6 rounded-lg shadow-btn active:translate-y-1 active:shadow-none transition-all w-full">
                        Pr√≥ximo <i class="fas fa-arrow-right"></i>
                    </button>
                </div>

                <div id="final-screen" class="hidden flex-col items-center text-center py-8">
                    <div class="text-6xl mb-4">üèÜ</div>
                    <h3 class="text-2xl font-black text-brand-text mb-2">Fim de Jogo!</h3>
                    <p class="text-gray-500 mb-6">Voc√™ acertou <strong class="text-brand-green" id="final-score">0</strong> de ${questions.length} estimativas.</p>
                    <button onclick="app.renderLesson(document.getElementById('main-container'), app.currentLessonName)" class="bg-gray-200 text-gray-600 font-bold py-2 px-6 rounded-lg hover:bg-gray-300 transition-colors">
                        <i class="fas fa-redo"></i> Jogar Novamente
                    </button>
                </div>

            </div>
        `;

                    // 3. Seletores
                    const qNum = container.querySelector('#q-num');
                    const progressBar = container.querySelector('#progress-bar');
                    const qText = container.querySelector('#question-text');
                    const optsContainer = container.querySelector('#options-container');
                    const feedbackArea = container.querySelector('#feedback-area');
                    const feedbackIcon = container.querySelector('#feedback-icon');
                    const feedbackTitle = container.querySelector('#feedback-title');
                    const feedbackLogic = container.querySelector('#feedback-logic');
                    const nextBtn = container.querySelector('#next-btn');
                    const finalScreen = container.querySelector('#final-screen');
                    const finalScore = container.querySelector('#final-score');

                    // 4. Fun√ß√£o de Renderiza√ß√£o da Pergunta
                    const renderQuestion = () => {
                        isAnswered = false;
                        const q = questions[currentIdx];

                        // Atualiza UI
                        qNum.innerText = currentIdx + 1;
                        qText.innerText = q.q;
                        progressBar.style.width = `${(currentIdx / questions.length) * 100}%`;

                        feedbackArea.classList.add('hidden');
                        optsContainer.classList.remove('hidden');
                        optsContainer.innerHTML = ''; // Limpa bot√µes antigos

                        // Cria bot√µes
                        q.options.forEach((opt, idx) => {
                            const btn = document.createElement('button');
                            btn.className = "bg-white border-2 border-brand-blue text-brand-blue text-xl md:text-2xl font-bold py-4 rounded-xl shadow-sm hover:bg-blue-50 active:scale-95 transition-all transform hover:-translate-y-1";
                            btn.innerText = opt.toLocaleString('pt-BR'); // Formata milhar (4.000)

                            btn.onclick = () => checkAnswer(idx, btn);
                            optsContainer.appendChild(btn);
                        });
                    };

                    // 5. L√≥gica de Verifica√ß√£o
                    const checkAnswer = (selectedIdx, btnElement) => {
                        if (isAnswered) return;
                        isAnswered = true;

                        const q = questions[currentIdx];
                        const isCorrect = selectedIdx === q.correct;

                        // Estiliza os bot√µes
                        const allBtns = optsContainer.querySelectorAll('button');
                        allBtns.forEach((b, i) => {
                            b.classList.add('cursor-default', 'pointer-events-none'); // Trava cliques
                            if (i === q.correct) {
                                b.className = "bg-brand-green border-2 border-green-600 text-white text-xl md:text-2xl font-bold py-4 rounded-xl shadow-md transform scale-105 z-10"; // Correto destaca
                                b.innerHTML += ' <i class="fas fa-check ml-1"></i>';
                            } else if (i === selectedIdx && !isCorrect) {
                                b.className = "bg-brand-red border-2 border-red-600 text-white text-xl md:text-2xl font-bold py-4 rounded-xl opacity-50"; // Errado apaga
                            } else {
                                b.classList.add('opacity-30'); // Outros somem
                            }
                        });

                        // Mostra Feedback
                        feedbackArea.classList.remove('hidden');
                        feedbackArea.classList.add('animate-slide-up');

                        if (isCorrect) {
                            score++;
                            feedbackIcon.innerHTML = 'üéØ';
                            feedbackTitle.className = "font-black text-lg uppercase mb-1 text-brand-green";
                            feedbackTitle.innerText = "Na Mosca!";
                        } else {
                            feedbackIcon.innerHTML = 'üòÖ';
                            feedbackTitle.className = "font-black text-lg uppercase mb-1 text-brand-orange";
                            feedbackTitle.innerText = "Quase!";
                        }

                        feedbackLogic.innerHTML = q.logic;

                        // Bot√£o Pr√≥ximo
                        if (currentIdx === questions.length - 1) {
                            nextBtn.innerText = "Ver Resultado";
                        }
                    };

                    // 6. Listener Pr√≥ximo
                    nextBtn.onclick = () => {
                        currentIdx++;
                        if (currentIdx < questions.length) {
                            renderQuestion();
                        } else {
                            // Fim do Jogo
                            container.querySelector('.border-b-2').classList.add('hidden'); // Esconde header
                            container.querySelector('.bg-gray-800').classList.add('hidden'); // Esconde display
                            optsContainer.classList.add('hidden');
                            feedbackArea.classList.add('hidden');
                            progressBar.style.width = "100%";

                            finalScreen.classList.remove('hidden');
                            finalScreen.classList.add('flex', 'animate-pop-in');
                            finalScore.innerText = score;
                        }
                    };

                    // Init
                    renderQuestion();
                },

                interactive_fraction_operator(container) {
                    // Estado Inicial
                    let total = 12;
                    let num = 2;
                    let den = 3;

                    // 1. Inje√ß√£o do HTML
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col items-center w-full shadow-sm font-sans select-none">
                
                <h3 class="text-brand-text font-bold uppercase text-xs tracking-widest mb-6">Calculadora Visual de Fra√ß√µes</h3>

                <div class="flex flex-col md:flex-row gap-6 items-center justify-center w-full mb-8">
                    
                    <div class="flex items-center gap-2">
                        <div class="flex flex-col items-center gap-1">
                            <input type="number" id="in-num" value="${num}" min="1" class="w-12 text-center border-2 border-brand-orange rounded-lg font-bold text-lg outline-none text-brand-orange focus:bg-orange-50">
                            <div class="w-full h-0.5 bg-gray-400"></div>
                            <input type="number" id="in-den" value="${den}" min="1" class="w-12 text-center border-2 border-brand-blue rounded-lg font-bold text-lg outline-none text-brand-blue focus:bg-blue-50">
                        </div>
                        <span class="text-xl font-black text-gray-400">DE</span>
                        
                        <div class="flex flex-col items-center">
                            <input type="number" id="in-total" value="${total}" min="1" max="50" class="w-16 text-center border-2 border-gray-300 rounded-lg font-bold text-xl outline-none text-gray-600 focus:border-brand-text">
                            <span class="text-[10px] font-bold text-gray-400 uppercase mt-1">Total</span>
                        </div>
                    </div>

                    <div class="text-2xl font-black text-gray-300">=</div>

                    <div class="flex flex-col items-center">
                        <div id="res-val" class="text-4xl font-black text-brand-green animate-pop-in">8</div>
                        <span class="text-[10px] font-bold text-brand-green uppercase">Resultado</span>
                    </div>

                </div>

                <div class="w-full bg-gray-50 rounded-xl border-2 border-dashed border-gray-200 p-4 relative">
                    <div id="groups-container" class="flex flex-wrap justify-center gap-4"></div>
                    
                    <div id="step-explain" class="mt-4 text-center text-sm font-mono text-gray-500 bg-white p-2 rounded border border-gray-100 shadow-sm">
                        Dividimos ${total} em ${den} grupos de <span class="font-bold">?</span>.
                    </div>
                </div>

            </div>
        `;

                    // 2. Seletores
                    const inNum = container.querySelector('#in-num');
                    const inDen = container.querySelector('#in-den');
                    const inTotal = container.querySelector('#in-total');
                    const resVal = container.querySelector('#res-val');
                    const groupsContainer = container.querySelector('#groups-container');
                    const stepExplain = container.querySelector('#step-explain');

                    // 3. L√≥gica de Atualiza√ß√£o
                    const update = () => {
                        // Pega valores
                        let n = parseInt(inNum.value) || 1;
                        let d = parseInt(inDen.value) || 1;
                        let t = parseInt(inTotal.value) || 1;

                        // Valida√ß√µes simples para UX
                        if (d > t) d = t; // N√£o d√° pra dividir em mais grupos que itens
                        if (n > d) n = d; // Fra√ß√£o pr√≥pria para visualiza√ß√£o f√°cil
                        // if (t % d !== 0) ... podemos deixar quebrado ou avisar, mas vamos arredondar visualmente

                        // C√°lculo
                        const valPerGroup = t / d;
                        const result = (t / d) * n;

                        // Atualiza Resultado Num√©rico
                        // Se for inteiro mostra inteiro, sen√£o 2 casas
                        resVal.innerText = Number.isInteger(result) ? result : result.toFixed(2).replace('.', ',');

                        // Atualiza Explica√ß√£o
                        const isExact = Number.isInteger(valPerGroup);
                        if (isExact) {
                            stepExplain.innerHTML = `
                    1. Dividimos <strong>${t}</strong> por <strong class="text-brand-blue">${d}</strong> = <strong>${valPerGroup}</strong> por grupo.<br>
                    2. Pegamos <strong class="text-brand-orange">${n}</strong> grupos de <strong>${valPerGroup}</strong> = <strong class="text-brand-green">${result}</strong>.
                `;
                        } else {
                            stepExplain.innerHTML = `
                    <span class="text-brand-orange"><i class="fas fa-exclamation-circle"></i> Divis√£o n√£o exata!</span><br>
                    O resultado √© aproximadamente <strong>${result.toFixed(2).replace('.', ',')}</strong>.
                `;
                        }

                        // Renderiza Grupos Visuais (Apenas se for exato e total < 100 para n√£o travar)
                        groupsContainer.innerHTML = '';

                        if (isExact && t <= 50) {
                            for (let i = 0; i < d; i++) {
                                // Cria o Grupo
                                const group = document.createElement('div');
                                const isSelected = i < n;

                                // Estilo do Grupo
                                const borderColor = isSelected ? 'border-brand-orange' : 'border-gray-300';
                                const bgColor = isSelected ? 'bg-orange-50' : 'bg-white';
                                const opacity = isSelected ? 'opacity-100' : 'opacity-50';

                                group.className = `border-2 ${borderColor} ${bgColor} ${opacity} rounded-lg p-2 flex flex-wrap gap-1 justify-center items-center transition-all duration-500`;
                                group.style.minWidth = "40px";
                                group.style.minHeight = "40px";

                                // Adiciona Bolinhas dentro do grupo
                                for (let j = 0; j < valPerGroup; j++) {
                                    const dot = document.createElement('div');
                                    const dotColor = isSelected ? 'bg-brand-orange' : 'bg-gray-300';
                                    dot.className = `w-3 h-3 rounded-full ${dotColor} transition-colors duration-500`;
                                    group.appendChild(dot);
                                }

                                // Label do Grupo (Opcional)
                                // if (isSelected) {
                                //     const label = document.createElement('div');
                                //     label.className = "absolute -top-2 -right-2 bg-brand-orange text-white text-[8px] px-1 rounded";
                                //     label.innerText = "PEGUEI";
                                //     group.style.position = "relative";
                                //     group.appendChild(label);
                                // }

                                groupsContainer.appendChild(group);
                            }
                        } else if (!isExact) {
                            groupsContainer.innerHTML = `<div class="text-gray-400 text-sm py-8">Visualiza√ß√£o dispon√≠vel apenas para divis√µes exatas.</div>`;
                        } else {
                            groupsContainer.innerHTML = `<div class="text-gray-400 text-sm py-8">Muitos itens para desenhar! O c√°lculo continua certo.</div>`;
                        }
                    };

                    // 4. Listeners
                    inNum.addEventListener('input', update);
                    inDen.addEventListener('input', update);
                    inTotal.addEventListener('input', update);

                    // Init
                    update();
                },


                interactive_equation_steps(container) {
                    // 1. Estilos CSS para a anima√ß√£o espec√≠fica deste widget
                    const style = document.createElement('style');
                    style.innerHTML = `
                        @keyframes jumpOver {
                            0% { transform: translate(0, 0); color: #1CB0F6; }
                            40% { transform: translate(0, -40px) scale(1.1); color: #1CB0F6; }
                            50% { transform: translate(60px, -40px) scale(1.1); color: #FF4B4B; } /* Troca de cor no ar */
                            100% { transform: translate(120px, 0) scale(1); color: #FF4B4B; }
                        }
                        .animate-jump { animation: jumpOver 1.2s forwards ease-in-out; }
                        .fade-out { opacity: 0; pointer-events: none; transition: opacity 0.5s; }
                        .fade-in { opacity: 1; transition: opacity 0.5s; }
                    `;
                    container.appendChild(style);

                    // 2. HTML Estrutural
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col items-center w-full shadow-sm font-sans select-none h-[320px] relative overflow-hidden">
                
                <h3 class="text-brand-text font-bold uppercase text-xs tracking-widest mb-8">Resolvendo: x + 5 = 20</h3>

                <div class="relative flex items-center justify-center gap-4 text-4xl md:text-5xl font-mono font-bold text-brand-text w-full mb-8">
                    <div class="flex gap-4 relative" id="lhs">
                        <span class="text-brand-purple transition-all duration-500" id="term-x">x</span>
                        <span id="term-num" class="text-brand-blue inline-block relative z-10">+ 5</span>
                    </div>

                    <span class="text-gray-300">=</span>

                    <div class="flex gap-4 relative" id="rhs">
                        <span id="term-res">20</span>
                        <span id="landing-spot" class="text-brand-red opacity-0 w-0 transition-all duration-500">- 5</span> 
                    </div>
                </div>

                <div id="control-panel" class="w-full max-w-xs text-center transition-all duration-500 absolute bottom-6">
                    <p class="text-sm text-gray-500 mb-4 font-medium" id="instruction">
                        O <strong class="text-brand-blue">+5</strong> est√° somando. Para deixar o <strong>x</strong> sozinho, o que fazemos?
                    </p>
                    
                    <div class="grid grid-cols-2 gap-3">
                        <button class="action-btn bg-white border-2 border-gray-200 text-gray-400 font-bold py-3 rounded-xl hover:bg-red-50 hover:border-red-200 hover:text-red-400 transition-all" onclick="app.widgets.shakeEq(this)">
                            + 5
                        </button>
                        <button id="btn-correct" class="action-btn bg-brand-blue text-white font-bold py-3 rounded-xl shadow-[0_4px_0_#1899D6] active:shadow-none active:translate-y-[4px] transition-all border-b-4 border-brand-blueDark">
                            - 5 (Inverso)
                        </button>
                    </div>
                </div>

                <div id="success-msg" class="absolute bottom-6 flex-col items-center translate-y-20 opacity-0 transition-all duration-500 flex">
                    <div class="text-brand-green font-black text-3xl mb-2 bg-green-50 px-6 py-2 rounded-xl border-2 border-brand-green">x = 15</div>
                    <button id="btn-reset" class="text-xs text-gray-400 font-bold uppercase hover:text-brand-blue flex items-center gap-2 mt-2 p-2">
                        <i class="fas fa-undo"></i> Reiniciar
                    </button>
                </div>

            </div>
        `;

                    // 3. Seletores e L√≥gica
                    const termNum = container.querySelector('#term-num');
                    const termX = container.querySelector('#term-x'); // Para centralizar depois
                    const termRes = container.querySelector('#term-res');
                    const landingSpot = container.querySelector('#landing-spot');
                    const btnCorrect = container.querySelector('#btn-correct');
                    const controlPanel = container.querySelector('#control-panel');
                    const successMsg = container.querySelector('#success-msg');
                    const instruction = container.querySelector('#instruction');
                    const btnReset = container.querySelector('#btn-reset');

                    // Fun√ß√£o de Erro (Tremida)
                    app.widgets.shakeEq = (btn) => {
                        btn.classList.add('animate-pulse', 'bg-red-100', 'border-red-300');
                        setTimeout(() => btn.classList.remove('animate-pulse', 'bg-red-100', 'border-red-300'), 500);
                        instruction.innerHTML = "<span class='text-brand-red'>N√£o!</span> Se ele est√° somando, somar mais vai piorar!";
                    };

                    // Fun√ß√£o Principal: A Anima√ß√£o
                    btnCorrect.onclick = async () => {
                        // 1. Bloqueia bot√µes
                        btnCorrect.disabled = true;

                        // 2. Anima√ß√£o do Pulo
                        // O CSS keyframe 'jumpOver' cuida do movimento e da troca de cor
                        termNum.classList.add('animate-jump');

                        // 3. Espera a anima√ß√£o (1.2s)
                        await new Promise(r => setTimeout(r, 1200));

                        // 4. Ajuste do Layout p√≥s-pulo
                        termNum.classList.add('hidden'); // Esconde o original que voou
                        landingSpot.classList.remove('opacity-0', 'w-0'); // Mostra o novo no lugar certo

                        // Centraliza o X visualmente (opcional, mas fica bonito)
                        // termX.classList.add('translate-x-8'); 

                        // 5. Fase de C√°lculo
                        instruction.innerText = "Agora resolva: 20 - 5 = ?";

                        // Troca os bot√µes por "Calcular"
                        controlPanel.innerHTML = `
                            <button class="bg-brand-green text-white font-bold py-3 px-8 rounded-xl shadow-[0_4px_0_#46A302] active:shadow-none active:translate-y-[4px] text-xl w-full animate-pop-in" id="btn-calc">
                                Calcular
                            </button>
                        `;

                        const btnCalc = container.querySelector('#btn-calc');

                        btnCalc.onclick = () => {
                            // 6. Finaliza√ß√£o
                            controlPanel.classList.add('opacity-0', 'translate-y-10'); // Esconde painel
                            landingSpot.classList.add('hidden'); // Some o -5
                            termRes.classList.add('hidden'); // Some o 20

                            successMsg.classList.remove('translate-y-20', 'opacity-0'); // Sobe o sucesso
                        };
                    };

                    btnReset.onclick = () => {
                        app.renderLesson(document.getElementById('main-container'), app.currentLessonName);
                    };
                },







                interactive_place_value_extended(container) {
                    // 1. Inje√ß√£o do HTML (Layout e Estilos)
                    // Usamos classes gen√©ricas para selecionar os elementos depois (ex: .pv-grid)
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col items-center w-full font-sans shadow-sm">
                <p class="text-xs font-bold text-brand-blue mb-4 uppercase tracking-wide">DIGITE UM N√öMERO (Max 12 d√≠gitos)</p>
                
                <input type="number" value="1234567890" min="0" max="999999999999" 
                    class="text-3xl md:text-4xl font-extrabold text-center w-full max-w-md p-3 rounded-xl border-2 border-brand-gray focus:border-brand-blue outline-none mb-6 bg-brand-bg text-brand-text transition-colors placeholder-gray-300">
                
                <!-- O Grid onde os blocos ser√£o gerados dinamicamente -->
                <div class="pv-grid grid grid-flow-col auto-cols-max gap-4 overflow-x-auto w-full pb-4 justify-start md:justify-center scrollbar-hide"></div>
            </div>
        `;

                    // 2. Sele√ß√£o de Elementos (Escopado ao container atual)
                    // Usamos container.querySelector para pegar APENAS os elementos deste widget espec√≠fico
                    const input = container.querySelector('input');
                    const grid = container.querySelector('.pv-grid');

                    // 3. Defini√ß√£o das Classes/Cores
                    const classes = [
                        { name: "Unidades", color: "border-brand-purple text-brand-purple bg-purple-50" },
                        { name: "Milhares", color: "border-brand-blue text-brand-blue bg-blue-50" },
                        { name: "Milh√µes", color: "border-brand-red text-brand-red bg-red-50" },
                        { name: "Bilh√µes", color: "border-brand-orange text-brand-orange bg-orange-50" }
                    ];

                    // 4. L√≥gica de Atualiza√ß√£o (Encapsulada aqui dentro)
                    const update = () => {
                        // Limita a 12 d√≠gitos para n√£o quebrar o layout
                        if (input.value.length > 12) input.value = input.value.slice(0, 12);

                        const val = input.value;
                        grid.innerHTML = ''; // Limpa o grid atual

                        // L√≥gica: Reverte string -> Agrupa de 3 em 3 -> Gera HTML
                        let reversed = val.split('').reverse().join('');
                        let groups = reversed.match(/.{1,3}/g) || [];

                        groups.forEach((group, groupIndex) => {
                            if (groupIndex >= classes.length) return;

                            const cls = classes[groupIndex];

                            // Cria o container do grupo (Ex: Milhares)
                            const groupContainer = document.createElement('div');

                            // Extrai as cores da string de configura√ß√£o
                            const borderColor = cls.color.split(' ')[0];
                            const textColor = cls.color.split(' ')[1];
                            const bgColor = cls.color.split(' ')[2];

                            groupContainer.className = `flex flex-col items-center border-2 ${borderColor} rounded-xl p-2 ${bgColor} min-w-[100px] animate-fade-in`;

                            // Gera os d√≠gitos individuais (C, D, U)
                            let digitsHtml = '<div class="flex gap-1">';
                            const normalGroup = group.split('').reverse().join(''); // Desvira o n√∫mero (321 -> 123)

                            normalGroup.split('').forEach((d, i) => {
                                // Calcula label (C, D, U) baseado na posi√ß√£o
                                const pos = normalGroup.length - 1 - i;
                                const label = ['U', 'D', 'C'][pos];

                                digitsHtml += `
                        <div class="flex flex-col items-center bg-white rounded p-1 w-8 shadow-sm">
                            <span class="text-xl font-bold text-brand-text">${d}</span>
                            <span class="text-[10px] text-gray-400 font-bold border-t border-gray-100 w-full text-center mt-1">${label}</span>
                        </div>`;
                            });
                            digitsHtml += '</div>';

                            // Junta tudo
                            groupContainer.innerHTML = `
                    <span class="text-xs font-bold uppercase mb-2 ${textColor}">${cls.name}</span>
                    ${digitsHtml}
                `;

                            // Insere no in√≠cio (prepend) para que Bilh√µes fiquem √† esquerda
                            grid.prepend(groupContainer);
                        });
                    };

                    // 5. Adiciona o Event Listener e Roda a primeira vez
                    input.addEventListener('input', update);
                    update();
                },
                renderVerticalCalc(c, op) {
                    const sym = op === '*' ? '√ó' : op;
                    const res = op === '+' ? 468 : op === '-' ? 125 : 48;
                    const n1 = op === '+' ? 125 : op === '-' ? 450 : 12;
                    const n2 = op === '+' ? 343 : op === '-' ? 325 : 4;
                    c.innerHTML = `
                    <div class="bg-white border-2 border-gray-200 rounded-3xl p-8 flex justify-center shadow-sm hover:shadow-md transition-shadow">
                        <div class="font-mono text-3xl md:text-4xl text-right tracking-widest text-brand-text">
                            <div>${n1}</div>
                            <div class="border-b-4 border-brand-text pr-2 mb-2 pb-1 relative"><span class="absolute left-[-40px] text-brand-blue font-bold">${sym}</span>${n2}</div>
                            <div class="font-black text-brand-green fade-in">${res}</div>
                        </div>
                    </div>`;
                },
                // WIDGET DE ADI√á√ÉO (Azul)
                interactive_addition_vertical(container) {
                    // 1. Configura√ß√£o Espec√≠fica da Adi√ß√£o
                    const config = {
                        symbol: "+",
                        colorText: "text-brand-blue",
                        colorBorder: "border-brand-blue", // Para foco
                        labels: ["Parcela 1", "Parcela 2", "Soma"]
                    };

                    // 2. Inje√ß√£o do HTML
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col md:flex-row items-center justify-center gap-8 shadow-sm">
                <div class="flex flex-col gap-4">
                    <div class="flex flex-col gap-1">
                        <label class="text-[10px] font-bold text-gray-400 uppercase tracking-wide">${config.labels[0]}</label>
                        <input type="number" class="input-v1 border-2 border-brand-gray rounded-lg p-2 w-28 text-center font-bold text-xl outline-none focus:${config.colorBorder} transition-colors text-brand-text" value="125">
                    </div>
                    <div class="flex flex-col gap-1">
                        <label class="text-[10px] font-bold text-gray-400 uppercase tracking-wide">${config.labels[1]}</label>
                        <input type="number" class="input-v2 border-2 border-brand-gray rounded-lg p-2 w-28 text-center font-bold text-xl outline-none focus:${config.colorBorder} transition-colors text-brand-text" value="48">
                    </div>
                </div>

                <div class="display-area bg-gray-50 p-6 rounded-xl border-2 border-gray-100 min-w-[180px] flex flex-col items-end font-mono text-4xl shadow-inner select-none cursor-default">
                    </div>
            </div>
        `;

                    // 3. Seletores Escopados
                    const inputV1 = container.querySelector('.input-v1');
                    const inputV2 = container.querySelector('.input-v2');
                    const display = container.querySelector('.display-area');

                    // 4. Fun√ß√£o de Atualiza√ß√£o
                    const update = () => {
                        const v1 = parseInt(inputV1.value) || 0;
                        const v2 = parseInt(inputV2.value) || 0;
                        const res = v1 + v2; // L√≥gica da SOMA

                        // Renderiza a conta armada com labels flutuantes (hover)
                        display.innerHTML = `
                <div class="relative w-full text-right group mb-1">
                    ${v1}
                    <span class="absolute -right-32 top-1 text-xs font-sans text-gray-400 opacity-0 group-hover:opacity-100 bg-white p-1 shadow rounded border z-10 w-24 text-center transition-opacity pointer-events-none font-bold uppercase">${config.labels[0]}</span>
                </div>
                
                <div class="relative w-full text-right border-b-4 border-brand-text pr-2 group pb-1">
                    <span class="absolute left-0 ${config.colorText}">${config.symbol}</span> 
                    ${v2}
                    <span class="absolute -right-32 top-1 text-xs font-sans text-gray-400 opacity-0 group-hover:opacity-100 bg-white p-1 shadow rounded border z-10 w-24 text-center transition-opacity pointer-events-none font-bold uppercase">${config.labels[1]}</span>
                </div>
                
                <div class="relative w-full text-right ${config.colorText} pt-2 group font-extrabold">
                    ${res}
                    <span class="absolute -right-32 top-3 text-xs font-sans text-gray-400 opacity-0 group-hover:opacity-100 bg-white p-1 shadow rounded border z-10 w-24 text-center transition-opacity pointer-events-none font-bold uppercase">${config.labels[2]}</span>
                </div>
            `;
                    };

                    // 5. Listeners
                    inputV1.addEventListener('input', update);
                    inputV2.addEventListener('input', update);
                    update();
                },

                // WIDGET DE SUBTRA√á√ÉO (Vermelho)
                interactive_subtraction_vertical(container) {
                    // 1. Configura√ß√£o Espec√≠fica da Subtra√ß√£o
                    const config = {
                        symbol: "-",
                        colorText: "text-brand-red",
                        colorBorder: "border-brand-red", // Para foco
                        labels: ["Minuendo", "Subtraendo", "Diferen√ßa"]
                    };

                    // 2. Inje√ß√£o do HTML
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col md:flex-row items-center justify-center gap-8 shadow-sm">
                <div class="flex flex-col gap-4">
                    <div class="flex flex-col gap-1">
                        <label class="text-[10px] font-bold text-gray-400 uppercase tracking-wide">${config.labels[0]}</label>
                        <input type="number" class="input-v1 border-2 border-brand-gray rounded-lg p-2 w-28 text-center font-bold text-xl outline-none focus:${config.colorBorder} transition-colors text-brand-text" value="125">
                    </div>
                    <div class="flex flex-col gap-1">
                        <label class="text-[10px] font-bold text-gray-400 uppercase tracking-wide">${config.labels[1]}</label>
                        <input type="number" class="input-v2 border-2 border-brand-gray rounded-lg p-2 w-28 text-center font-bold text-xl outline-none focus:${config.colorBorder} transition-colors text-brand-text" value="48">
                    </div>
                </div>

                <div class="display-area bg-gray-50 p-6 rounded-xl border-2 border-gray-100 min-w-[180px] flex flex-col items-end font-mono text-4xl shadow-inner select-none cursor-default">
                    </div>
            </div>
        `;

                    // 3. Seletores Escopados
                    const inputV1 = container.querySelector('.input-v1');
                    const inputV2 = container.querySelector('.input-v2');
                    const display = container.querySelector('.display-area');

                    // 4. Fun√ß√£o de Atualiza√ß√£o
                    const update = () => {
                        const v1 = parseInt(inputV1.value) || 0;
                        const v2 = parseInt(inputV2.value) || 0;
                        const res = v1 - v2; // L√≥gica da SUBTRA√á√ÉO

                        display.innerHTML = `
                <div class="relative w-full text-right group mb-1">
                    ${v1}
                    <span class="absolute -right-32 top-1 text-xs font-sans text-gray-400 opacity-0 group-hover:opacity-100 bg-white p-1 shadow rounded border z-10 w-24 text-center transition-opacity pointer-events-none font-bold uppercase">${config.labels[0]}</span>
                </div>
                
                <div class="relative w-full text-right border-b-4 border-brand-text pr-2 group pb-1">
                    <span class="absolute left-0 ${config.colorText}">${config.symbol}</span> 
                    ${v2}
                    <span class="absolute -right-32 top-1 text-xs font-sans text-gray-400 opacity-0 group-hover:opacity-100 bg-white p-1 shadow rounded border z-10 w-24 text-center transition-opacity pointer-events-none font-bold uppercase">${config.labels[1]}</span>
                </div>
                
                <div class="relative w-full text-right ${config.colorText} pt-2 group font-extrabold">
                    ${res}
                    <span class="absolute -right-32 top-3 text-xs font-sans text-gray-400 opacity-0 group-hover:opacity-100 bg-white p-1 shadow rounded border z-10 w-24 text-center transition-opacity pointer-events-none font-bold uppercase">${config.labels[2]}</span>
                </div>
            `;
                    };

                    // 5. Listeners
                    inputV1.addEventListener('input', update);
                    inputV2.addEventListener('input', update);
                    update();
                }
                ,
                interactive_multiplication_vertical(container) {
                    // 1. Configura√ß√£o
                    const config = {
                        symbol: "√ó",
                        colorText: "text-brand-purple",
                        colorBorder: "border-brand-purple",
                        labels: ["Fator 1", "Fator 2", "Produto"]
                    };

                    // 2. HTML
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col md:flex-row items-center justify-center gap-8 shadow-sm">
                <div class="flex flex-col gap-4">
                    <div class="flex flex-col gap-1">
                        <label class="text-[10px] font-bold text-gray-400 uppercase tracking-wide">${config.labels[0]}</label>
                        <input type="number" class="input-v1 border-2 border-brand-gray rounded-lg p-2 w-28 text-center font-bold text-xl outline-none focus:${config.colorBorder} transition-colors text-brand-text" value="12">
                    </div>
                    <div class="flex flex-col gap-1">
                        <label class="text-[10px] font-bold text-gray-400 uppercase tracking-wide">${config.labels[1]}</label>
                        <input type="number" class="input-v2 border-2 border-brand-gray rounded-lg p-2 w-28 text-center font-bold text-xl outline-none focus:${config.colorBorder} transition-colors text-brand-text" value="4">
                    </div>
                </div>

                <div class="display-area bg-gray-50 p-6 rounded-xl border-2 border-gray-100 min-w-[180px] flex flex-col items-end font-mono text-4xl shadow-inner select-none cursor-default">
                    </div>
            </div>
        `;

                    // 3. Seletores e L√≥gica
                    const inputV1 = container.querySelector('.input-v1');
                    const inputV2 = container.querySelector('.input-v2');
                    const display = container.querySelector('.display-area');

                    const update = () => {
                        const v1 = parseInt(inputV1.value) || 0;
                        const v2 = parseInt(inputV2.value) || 0;
                        const res = v1 * v2;

                        display.innerHTML = `
                <div class="relative w-full text-right group mb-1">
                    ${v1}
                    <span class="absolute -right-32 top-1 text-xs font-sans text-gray-400 opacity-0 group-hover:opacity-100 bg-white p-1 shadow rounded border z-10 w-24 text-center transition-opacity pointer-events-none font-bold uppercase">${config.labels[0]}</span>
                </div>
                
                <div class="relative w-full text-right border-b-4 border-brand-text pr-2 group pb-1">
                    <span class="absolute left-0 ${config.colorText}">${config.symbol}</span> 
                    ${v2}
                    <span class="absolute -right-32 top-1 text-xs font-sans text-gray-400 opacity-0 group-hover:opacity-100 bg-white p-1 shadow rounded border z-10 w-24 text-center transition-opacity pointer-events-none font-bold uppercase">${config.labels[1]}</span>
                </div>
                
                <div class="relative w-full text-right ${config.colorText} pt-2 group font-extrabold">
                    ${res}
                    <span class="absolute -right-32 top-3 text-xs font-sans text-gray-400 opacity-0 group-hover:opacity-100 bg-white p-1 shadow rounded border z-10 w-24 text-center transition-opacity pointer-events-none font-bold uppercase">${config.labels[2]}</span>
                </div>
            `;
                    };

                    inputV1.addEventListener('input', update);
                    inputV2.addEventListener('input', update);
                    update();
                },

                interactive_division_vertical(container) {
                    // 1. Configura√ß√£o
                    const config = {
                        colorMain: "text-brand-orange",
                        colorBorder: "border-brand-orange",
                        labels: ["Dividendo", "Divisor", "Quociente", "Resto"]
                    };

                    // 2. HTML
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col md:flex-row items-center justify-center gap-8 shadow-sm">
                <div class="flex flex-col gap-4">
                    <div class="flex flex-col gap-1">
                        <label class="text-[10px] font-bold text-gray-400 uppercase tracking-wide">${config.labels[0]}</label>
                        <input type="number" class="input-v1 border-2 border-brand-gray rounded-lg p-2 w-28 text-center font-bold text-xl outline-none focus:${config.colorBorder} transition-colors text-brand-text" value="20">
                    </div>
                    <div class="flex flex-col gap-1">
                        <label class="text-[10px] font-bold text-gray-400 uppercase tracking-wide">${config.labels[1]}</label>
                        <input type="number" class="input-v2 border-2 border-brand-gray rounded-lg p-2 w-28 text-center font-bold text-xl outline-none focus:${config.colorBorder} transition-colors text-brand-text" value="3">
                    </div>
                </div>

                <div class="display-area bg-gray-50 p-6 rounded-xl border-2 border-gray-100 min-w-[200px] flex items-center justify-center font-mono text-3xl shadow-inner select-none cursor-default">
                    </div>
            </div>
        `;

                    // 3. Seletores e L√≥gica
                    const inputV1 = container.querySelector('.input-v1');
                    const inputV2 = container.querySelector('.input-v2');
                    const display = container.querySelector('.display-area');

                    const update = () => {
                        const v1 = parseInt(inputV1.value) || 0;
                        // Evita divis√£o por zero convertendo 0 para 1 visualmente ou lidando com erro
                        const v2 = parseInt(inputV2.value) === 0 ? 1 : (parseInt(inputV2.value) || 1);

                        const q = Math.floor(v1 / v2);
                        const r = v1 % v2;

                        // Layout do M√©todo da Chave
                        display.innerHTML = `
                <div class="flex items-start">
                    <div class="flex flex-col items-end pr-3 group relative">
                         <div>${v1}</div>
                         <div class="text-brand-red text-xl mt-1 opacity-70">-${q * v2}</div>
                         <div class="border-t-2 border-gray-400 mt-1 font-bold text-brand-blue">${r}</div>
                         
                         <span class="absolute -left-24 bottom-0 text-xs font-sans text-gray-400 opacity-0 group-hover:opacity-100 bg-white p-1 shadow rounded border z-10 w-20 text-center transition-opacity pointer-events-none font-bold uppercase">${config.labels[3]}</span>
                    </div>

                    <div class="flex flex-col items-start pl-3 border-l-2 border-brand-text h-full group relative">
                         <div class="border-b-2 border-brand-text pb-1 mb-1 w-full text-center">${v2}</div>
                         <div class="font-bold ${config.colorMain}">${q}</div>

                         <span class="absolute -right-24 bottom-0 text-xs font-sans text-gray-400 opacity-0 group-hover:opacity-100 bg-white p-1 shadow rounded border z-10 w-20 text-center transition-opacity pointer-events-none font-bold uppercase">${config.labels[2]}</span>
                    </div>
                </div>
            `;
                    };

                    inputV1.addEventListener('input', update);
                    inputV2.addEventListener('input', update);
                    update();

                },
                interactive_power_visualizer(container) {
                    // 1. Inje√ß√£o do HTML
                    container.innerHTML = `
            <div class="bg-brand-bg border-2 border-brand-gray rounded-xl p-6 flex flex-col items-center gap-6 w-full shadow-sm">
                
                <div class="flex items-start gap-2 font-extrabold text-brand-text select-none">
                    
                    <div class="flex flex-col items-center">
                        <input type="number" class="input-base text-4xl md:text-5xl w-20 text-center bg-transparent border-b-4 border-brand-gray focus:border-brand-blue outline-none transition-colors text-brand-blue" value="2" min="1" max="10">
                        <span class="text-[10px] text-gray-400 uppercase font-bold mt-1 tracking-wide">Base</span>
                    </div>

                    <div class="flex flex-col items-center -mt-2">
                        <input type="number" class="input-exp text-xl md:text-2xl w-12 text-center bg-transparent border-b-4 border-brand-gray focus:border-brand-purple outline-none mb-2 transition-colors text-brand-purple" value="9" min="0" max="10">
                        <span class="text-[10px] text-gray-400 uppercase font-bold tracking-wide">Exp</span>
                    </div>

                    <span class="text-4xl self-center pt-4 text-gray-300">=</span>
                    <span class="result-text text-4xl md:text-5xl self-center pt-4 text-brand-green ml-2 min-w-[60px] text-center">512</span>
                </div>

                <div class="w-full bg-white rounded-lg border-2 border-gray-100 p-4 min-h-[100px] flex flex-col items-center justify-center transition-all duration-500">
                    <div class="blocks-container flex flex-wrap justify-center gap-1 content-center max-w-2xl">
                        </div>
                    <p class="limit-warning text-xs text-orange-400 font-bold mt-4 hidden uppercase tracking-wide animate-pulse">
                        <i class="fas fa-exclamation-triangle"></i> Visualiza√ß√£o limitada a 512 itens
                    </p>
                </div>
            </div>
        `;

                    // 2. Seletores Escopados
                    const baseInput = container.querySelector('.input-base');
                    const expInput = container.querySelector('.input-exp');
                    const resText = container.querySelector('.result-text');
                    const blocksContainer = container.querySelector('.blocks-container');
                    const warning = container.querySelector('.limit-warning');

                    // 3. Fun√ß√£o de Atualiza√ß√£o
                    const update = () => {
                        const b = parseInt(baseInput.value) || 0;
                        const e = parseInt(expInput.value) || 0;

                        const res = Math.pow(b, e);
                        resText.innerText = res > 10000 ? "..." : res;

                        blocksContainer.innerHTML = '';

                        // --- ALTERA√á√ÉO AQUI: Limite aumentado para 512 ---
                        const visualLimit = 512;
                        const countToRender = Math.min(res, visualLimit);

                        // Fragmento de documento para performance (renderizar 512 itens de uma vez)
                        const fragment = document.createDocumentFragment();

                        for (let i = 0; i < countToRender; i++) {
                            const dot = document.createElement('div');

                            // Separa grupos visualmente
                            const isGroupStart = (b > 1) && (i % b === 0) && (i !== 0);

                            // --- ALTERA√á√ÉO AQUI: Tamanho reduzido (w-2/w-3) para caber 512 melhor ---
                            // 'w-2 h-2' em mobile, 'w-3 h-3' em desktop
                            dot.className = `w-2 h-2 md:w-3 md:h-3 bg-brand-blue rounded-sm shadow-sm transition-all hover:scale-150 hover:bg-brand-blueDark ${isGroupStart ? 'ml-2 md:ml-3' : ''}`;

                            fragment.appendChild(dot);
                        }

                        blocksContainer.appendChild(fragment);

                        if (res > visualLimit) {
                            blocksContainer.innerHTML += `<div class="flex items-center justify-center w-full text-gray-400 font-black tracking-widest text-xs mt-2">...e muito mais!</div>`;
                            warning.classList.remove('hidden');
                        } else {
                            warning.classList.add('hidden');
                        }
                    };

                    // 4. Listeners
                    baseInput.addEventListener('input', update);
                    expInput.addEventListener('input', update);
                    update();
                },
                interactive_expression_solver(container) {
                    // 1. Dados: Os passos da resolu√ß√£o
                    // Voc√™ pode alterar isso para receber uma express√£o din√¢mica no futuro
                    const steps = [
                        { latex: "10 + [ 4 + ( 3 \\times 2 ) - 1 ]", desc: "Express√£o Inicial" },
                        { latex: "10 + [ 4 + \\mathbf{6} - 1 ]", desc: "Resolveu (3 √ó 2)" },
                        { latex: "10 + [ \\mathbf{10} - 1 ]", desc: "Resolveu 4 + 6" },
                        { latex: "10 + \\mathbf{9}", desc: "Resolveu colchete [10-1]" },
                        { latex: "\\mathbf{19}", desc: "Resultado Final" }
                    ];

                    let currentStep = 0; // Estado atual

                    // 2. Inje√ß√£o do HTML
                    // Usamos tons de Amarelo para indicar "Aten√ß√£o/Processo"
                    container.innerHTML = `
            <div class="bg-yellow-50 border-2 border-brand-yellow rounded-xl p-6 w-full shadow-sm flex flex-col gap-4">
                <div class="flex items-center gap-2 mb-2">
                    <i class="fas fa-calculator text-brand-yellowDark"></i>
                    <span class="text-xs font-bold text-brand-yellowDark uppercase tracking-wider">Resolvendo Passo a Passo</span>
                </div>
                
                <div class="step-list space-y-3 font-mono text-lg md:text-xl transition-all">
                    </div>

                <button class="action-btn w-full bg-brand-yellow hover:bg-yellow-500 text-white font-bold py-3 px-6 rounded-xl shadow-[0_4px_0_rgb(200,150,0)] active:shadow-none active:translate-y-[4px] transition-all mt-4">
                    Pr√≥ximo Passo
                </button>
            </div>
        `;

                    // 3. Seletores
                    const list = container.querySelector('.step-list');
                    const btn = container.querySelector('.action-btn');

                    // 4. Fun√ß√£o de Renderiza√ß√£o
                    const render = () => {
                        list.innerHTML = ''; // Limpa a lista

                        // Renderiza todos os passos at√© o atual
                        for (let i = 0; i <= currentStep && i < steps.length; i++) {
                            const step = steps[i];
                            const isLast = i === currentStep; // O √∫ltimo passo vis√≠vel recebe destaque

                            const item = document.createElement('div');

                            // Estilos condicionais: O √∫ltimo passo √© branco com borda amarela, os anteriores ficam cinza "apagados"
                            const activeStyle = "bg-white border-brand-yellow shadow-sm scale-[1.02]";
                            const inactiveStyle = "bg-gray-100 border-transparent text-gray-500 opacity-80";

                            item.className = `p-3 rounded-lg border-2 flex justify-between items-center transition-all duration-300 ${isLast ? activeStyle : inactiveStyle}`;

                            item.innerHTML = `
                    <span>$$${step.latex}$$</span> 
                    <span class="text-[10px] md:text-xs font-bold uppercase ${isLast ? 'text-brand-yellowDark' : 'text-gray-400'}">${step.desc}</span>
                `;

                            list.appendChild(item);
                        }

                        // Renderiza a matem√°tica (KaTeX) nos novos elementos
                        // Verifica se a biblioteca existe para n√£o dar erro
                        if (window.renderMathInElement) {
                            renderMathInElement(list, {
                                delimiters: [{ left: "$$", right: "$$", display: false }]
                            });
                        }

                        // Atualiza o texto do bot√£o
                        if (currentStep >= steps.length - 1) {
                            btn.innerText = "Reiniciar";
                            btn.classList.replace('bg-brand-yellow', 'bg-brand-green'); // Muda cor para verde
                            btn.classList.replace('shadow-[0_4px_0_rgb(200,150,0)]', 'shadow-[0_4px_0_#2e8b01]');
                        } else {
                            btn.innerText = "Pr√≥ximo Passo";
                            btn.classList.replace('bg-brand-green', 'bg-brand-yellow'); // Volta para amarelo
                            btn.classList.replace('shadow-[0_4px_0_#2e8b01]', 'shadow-[0_4px_0_rgb(200,150,0)]');
                        }
                    };

                    // 5. Listener do Bot√£o
                    btn.onclick = () => {
                        if (currentStep >= steps.length - 1) {
                            currentStep = 0; // Reinicia
                        } else {
                            currentStep++; // Avan√ßa
                        }
                        render();
                    };

                    // Renderiza a primeira vez
                    render();
                },

                interactive_equality_balance(container) {
                    // 1. Estado Inicial
                    let isSolved = false;

                    // 2. Inje√ß√£o do HTML (Estrutura da Balan√ßa)
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col items-center w-full shadow-sm select-none">
                
                <div class="relative w-full max-w-sm h-48 mt-4 mb-2 flex justify-center items-end">
                    <div class="absolute bottom-0 w-0 h-0 border-l-[20px] border-l-transparent border-r-[20px] border-r-transparent border-b-[40px] border-b-brand-text z-10"></div>
                    
                    <div class="absolute bottom-[38px] w-72 h-2 bg-brand-text rounded-full z-10 transition-transform duration-500 origin-center" id="beam"></div>

                    <div class="absolute bottom-[38px] left-[50%] -translate-x-36 flex flex-col items-center transition-all duration-500">
                        <div class="w-0.5 h-16 bg-gray-400"></div> <div class="w-24 h-2 bg-brand-text rounded-full shadow-sm"></div> <div id="plate-left" class="absolute bottom-4 flex gap-1 items-end justify-center w-full transition-all"></div> </div>

                    <div class="absolute bottom-[38px] left-[25%] translate-x-36 flex flex-col items-center transition-all duration-500">
                        <div class="w-0.5 h-16 bg-gray-400"></div> <div class="w-24 h-2 bg-brand-text rounded-full shadow-sm"></div> <div id="plate-right" class="absolute bottom-4 flex gap-1 items-end justify-center w-full transition-all"></div> </div>
                </div>

                <div class="mt-8 mb-4 bg-gray-50 px-6 py-2 rounded-lg border border-gray-200 transition-all duration-300" id="eq-container">
                    <p class="text-xl md:text-2xl font-mono font-bold text-brand-blue transition-all" id="eq-text">
                        $$x + 2 = 5$$
                    </p>
                </div>

                <button id="solve-btn" class="bg-brand-blue text-white px-6 py-3 rounded-xl font-bold text-sm shadow-btn active:shadow-none active:translate-y-1 transition-all flex items-center gap-2 hover:bg-brand-blueDark">
                    <i class="fas fa-balance-scale"></i>
                    <span>Resolver: Tirar 2 de cada lado</span>
                </button>
            </div>
        `;

                    // 3. Seletores
                    const plateLeft = container.querySelector('#plate-left');
                    const plateRight = container.querySelector('#plate-right');
                    const eqText = container.querySelector('#eq-text');
                    const btn = container.querySelector('#solve-btn');
                    const beam = container.querySelector('#beam');

                    // 4. Fun√ß√£o de Renderiza√ß√£o do Conte√∫do dos Pratos
                    const renderPlates = () => {
                        // Limpa
                        plateLeft.innerHTML = '';
                        plateRight.innerHTML = '';

                        // --- LADO ESQUERDO ---
                        // Sempre tem o X
                        const xBlock = document.createElement('div');
                        xBlock.className = "w-10 h-10 bg-brand-purple text-white flex items-center justify-center font-bold rounded shadow-sm text-xl z-20 border-2 border-purple-600";
                        xBlock.innerText = "x";
                        plateLeft.appendChild(xBlock);

                        // Tem +2 (se n√£o estiver resolvido)
                        // Usamos opacidade para animar a sa√≠da
                        if (!isSolved) {
                            // Adiciona 2 bolinhas
                            for (let i = 0; i < 2; i++) {
                                const ball = document.createElement('div');
                                ball.className = "w-6 h-6 bg-brand-green rounded-full border border-green-600 shadow-sm animate-fade-in";
                                plateLeft.appendChild(ball);
                            }
                        }

                        // --- LADO DIREITO ---
                        // Tem 5 (se n√£o resolvido) ou 3 (se resolvido)
                        const count = isSolved ? 3 : 5;
                        for (let i = 0; i < count; i++) {
                            const ball = document.createElement('div');
                            ball.className = "w-6 h-6 bg-brand-green rounded-full border border-green-600 shadow-sm animate-fade-in";
                            plateRight.appendChild(ball);
                        }
                    };

                    // 5. L√≥gica de Atualiza√ß√£o (Bot√£o)
                    btn.onclick = () => {
                        if (!isSolved) {
                            // A√á√ÉO: RESOLVER
                            isSolved = true;

                            // Atualiza Texto Matem√°tico
                            eqText.innerText = "$$x = 3$$";

                            // Atualiza Bot√£o
                            btn.innerHTML = `<i class="fas fa-undo"></i> <span>Reiniciar</span>`;
                            btn.classList.replace('bg-brand-blue', 'bg-brand-gray');
                            btn.classList.add('text-gray-600');

                            // Anima√ß√£o visual da balan√ßa (um leve balan√ßo para mostrar equil√≠brio)
                            beam.classList.add('animate-wiggle');
                            setTimeout(() => beam.classList.remove('animate-wiggle'), 500);

                        } else {
                            // A√á√ÉO: REINICIAR
                            isSolved = false;

                            // Atualiza Texto Matem√°tico
                            eqText.innerText = "$$x + 2 = 5$$";

                            // Atualiza Bot√£o
                            btn.innerHTML = `<i class="fas fa-balance-scale"></i> <span>Resolver: Tirar 2 de cada lado</span>`;
                            btn.classList.replace('bg-brand-gray', 'bg-brand-blue');
                            btn.classList.remove('text-gray-600');
                        }

                        // Renderiza os pratos novamente
                        renderPlates();

                        // Re-renderiza o KaTeX (f√≥rmulas matem√°ticas)
                        if (window.renderMathInElement) {
                            renderMathInElement(container, {
                                delimiters: [{ left: "$$", right: "$$", display: false }]
                            });
                        }
                    };

                    // Renderiza√ß√£o Inicial
                    renderPlates();
                    // Chamada inicial do KaTeX caso j√° esteja carregado
                    if (window.renderMathInElement) {
                        renderMathInElement(container, {
                            delimiters: [{ left: "$$", right: "$$", display: false }]
                        });
                    }
                },
                interactive_equation_builder(container) {
                    // Estado inicial
                    let currentState = {
                        lhs: { x: 0, c: 0 },
                        rhs: { x: 0, c: 0 },
                        step: 0
                    };

                    // 1. Inje√ß√£o do HTML
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col items-center w-full shadow-sm">
                
                <div class="w-full max-w-md mb-6 bg-blue-50 p-4 rounded-xl border border-blue-100 flex flex-col gap-2">
                    <label class="text-xs font-bold text-brand-blue uppercase">Digite a Equa√ß√£o (Ex: 2x + 4 = 10)</label>
                    <div class="flex gap-2">
                        <input type="text" id="eq-input" value="2x + 4 = 10" class="flex-1 text-xl font-mono font-bold text-center border-2 border-brand-gray rounded-lg p-2 focus:border-brand-blue outline-none text-brand-text uppercase" placeholder="ax + b = c">
                        <button id="build-btn" class="bg-brand-blue text-white px-4 rounded-lg font-bold hover:bg-brand-blueDark transition-colors">
                            <i class="fas fa-hammer"></i> Montar
                        </button>
                    </div>
                </div>

                <div class="relative w-full max-w-sm h-48 mb-4 flex justify-center items-end select-none">
                    <div class="absolute bottom-0 w-0 h-0 border-l-[20px] border-l-transparent border-r-[20px] border-r-transparent border-b-[40px] border-b-brand-text z-10"></div>
                    <div class="absolute bottom-[38px] w-72 h-2 bg-brand-text rounded-full z-10 transition-transform duration-500 origin-center" id="beam"></div>
                    
                    <div class="absolute bottom-[38px] left-[50%] -translate-x-36 flex flex-col items-center transition-all duration-500" id="pan-l">
                        <div class="w-0.5 h-16 bg-gray-400"></div>
                        <div class="w-24 h-2 bg-brand-text rounded-full"></div>
                        <div id="content-l" class="absolute bottom-4 flex flex-wrap-reverse gap-1 justify-center w-24 transition-all"></div>
                    </div>

                    <div class="absolute bottom-[38px] left-[25%] translate-x-36 flex flex-col items-center transition-all duration-500" id="pan-r">
                        <div class="w-0.5 h-16 bg-gray-400"></div>
                        <div class="w-24 h-2 bg-brand-text rounded-full"></div>
                        <div id="content-r" class="absolute bottom-4 flex flex-wrap-reverse gap-1 justify-center w-24 transition-all"></div>
                    </div>
                </div>

                <div id="controls" class="hidden w-full max-w-md bg-gray-50 p-4 rounded-xl border border-gray-200 flex flex-col gap-3">
                    <div class="text-center font-mono text-xl font-bold text-brand-text transition-all" id="status-text">$$2x + 4 = 10$$</div>
                    
                    <div class="flex gap-2 justify-center">
                        <button id="step1-btn" class="flex-1 bg-brand-orange text-white py-2 rounded-lg font-bold text-sm opacity-50 cursor-not-allowed shadow-sm transition-all flex items-center justify-center gap-2">
                            <span>1. Tirar Sobras</span>
                        </button>
                        <button id="step2-btn" class="flex-1 bg-brand-green text-white py-2 rounded-lg font-bold text-sm opacity-50 cursor-not-allowed shadow-sm transition-all flex items-center justify-center gap-2">
                            <span>2. Dividir Grupos</span>
                        </button>
                    </div>
                </div>
            </div>
        `;

                    // 2. Seletores
                    const input = container.querySelector('#eq-input');
                    const buildBtn = container.querySelector('#build-btn');
                    const contentL = container.querySelector('#content-l');
                    const contentR = container.querySelector('#content-r');
                    const controls = container.querySelector('#controls');
                    const statusText = container.querySelector('#status-text');
                    const step1Btn = container.querySelector('#step1-btn');
                    const step2Btn = container.querySelector('#step2-btn');
                    const beam = container.querySelector('#beam');

                    // 3. Parser (Mesma l√≥gica anterior)
                    const parseEquation = (str) => {
                        const clean = str.replace(/\s+/g, '').toLowerCase();
                        const parts = clean.split('=');
                        if (parts.length !== 2) return null;

                        const parseSide = (s) => {
                            let x = 0, c = 0;
                            const xMatch = s.match(/(\d*)x/);
                            if (xMatch) x = xMatch[1] === '' ? 1 : parseInt(xMatch[1]);
                            const terms = s.split('+');
                            terms.forEach(t => { if (!t.includes('x')) c += parseInt(t) || 0; });
                            return { x, c };
                        };
                        return { lhs: parseSide(parts[0]), rhs: parseSide(parts[1]) };
                    };

                    // 4. Desenha Elementos
                    const draw = (data) => {
                        contentL.innerHTML = ''; contentR.innerHTML = '';

                        // Adicionei a classe 'unit-ball' nas bolinhas verdes para podermos selecion√°-las depois
                        const createX = () => `<div class="block-x w-8 h-8 bg-brand-purple text-white border-2 border-purple-700 rounded flex items-center justify-center font-bold text-sm animate-pop-in mb-1">x</div>`;
                        const createUnit = () => `<div class="unit-ball w-5 h-5 bg-brand-green border border-green-700 rounded-full shadow-sm animate-pop-in mb-1"></div>`;

                        for (let i = 0; i < data.lhs.x; i++) contentL.innerHTML += createX();
                        for (let i = 0; i < data.lhs.c; i++) contentL.innerHTML += createUnit();

                        for (let i = 0; i < data.rhs.x; i++) contentR.innerHTML += createX();
                        for (let i = 0; i < data.rhs.c; i++) contentR.innerHTML += createUnit();
                    };

                    // 5. Bot√£o Montar
                    buildBtn.onclick = () => {
                        const eq = parseEquation(input.value);
                        if (!eq) { alert("Tente: 2x + 4 = 10"); return; }

                        currentState = { ...eq, step: 0 };
                        draw(currentState);

                        controls.classList.remove('hidden');
                        statusText.innerText = `$$${input.value}$$`;
                        if (window.renderMathInElement) renderMathInElement(statusText);

                        step1Btn.className = "flex-1 bg-brand-orange text-white py-2 rounded-lg font-bold text-sm shadow-[0_4px_0_#c2410c] active:shadow-none active:translate-y-[4px] transition-all hover:bg-orange-600";
                        step1Btn.disabled = false;

                        step2Btn.className = "flex-1 bg-brand-green text-white py-2 rounded-lg font-bold text-sm opacity-50 cursor-not-allowed shadow-none";
                        step2Btn.disabled = true;

                        beam.classList.add('animate-wiggle');
                        setTimeout(() => beam.classList.remove('animate-wiggle'), 500);
                    };

                    // 6. Bot√£o Passo 1: TIRAR SOBRAS (Com Anima√ß√£o)
                    step1Btn.onclick = () => {
                        // Descobre quantas bolinhas tirar
                        const minC = Math.min(currentState.lhs.c, currentState.rhs.c);

                        if (minC > 0) {
                            // Seleciona as bolinhas no DOM
                            // Array.from(...).slice(-N) pega as √öLTIMAS N bolinhas adicionadas (que ficam no topo visualmente)
                            const ballsL = Array.from(contentL.querySelectorAll('.unit-ball')).slice(-minC);
                            const ballsR = Array.from(contentR.querySelectorAll('.unit-ball')).slice(-minC);

                            // Aplica anima√ß√£o de sa√≠da
                            [...ballsL, ...ballsR].forEach(ball => {
                                ball.classList.remove('animate-pop-in'); // Remove entrada
                                ball.classList.add('animate-pop-out'); // Adiciona sa√≠da
                            });

                            // Espera 500ms (tempo da anima√ß√£o) antes de atualizar os dados reais
                            setTimeout(() => {
                                currentState.lhs.c -= minC;
                                currentState.rhs.c -= minC;
                                draw(currentState); // Redesenha limpo

                                statusText.innerText = `$$${currentState.lhs.x}x = ${currentState.rhs.c}$$`;
                                if (window.renderMathInElement) renderMathInElement(statusText);
                            }, 500);

                        } else {
                            statusText.innerText = "Nada para subtrair!";
                        }

                        // Atualiza estado dos bot√µes
                        currentState.step = 1;
                        step1Btn.className = "flex-1 bg-brand-orange text-white py-2 rounded-lg font-bold text-sm opacity-50 cursor-not-allowed shadow-none";
                        step1Btn.disabled = true;

                        step2Btn.className = "flex-1 bg-brand-green text-white py-2 rounded-lg font-bold text-sm shadow-[0_4px_0_#2e8b01] active:shadow-none active:translate-y-[4px] transition-all hover:bg-green-600";
                        step2Btn.disabled = false;
                    };

                    // 7. Bot√£o Passo 2: DIVIDIR
                    step2Btn.onclick = () => {
                        if (currentState.lhs.x > 1) {
                            // Anima√ß√£o simples de fade para a divis√£o
                            contentL.classList.add('opacity-0');
                            contentR.classList.add('opacity-0');

                            setTimeout(() => {
                                const divisor = currentState.lhs.x;
                                currentState.lhs.x = 1;
                                currentState.rhs.c = currentState.rhs.c / divisor;

                                draw(currentState);
                                contentL.classList.remove('opacity-0');
                                contentR.classList.remove('opacity-0');
                                contentL.classList.add('animate-pop-in');
                                contentR.classList.add('animate-pop-in');

                                statusText.innerText = `$$x = ${currentState.rhs.c}$$`;
                                if (window.renderMathInElement) renderMathInElement(statusText);

                                // Sucesso visual
                                statusText.classList.add('text-brand-green', 'scale-125');
                            }, 300);
                        }

                        step2Btn.className = "flex-1 bg-brand-green text-white py-2 rounded-lg font-bold text-sm opacity-50 cursor-not-allowed shadow-none";
                        step2Btn.disabled = true;
                    };

                    // Estilos CSS Inline para Anima√ß√µes
                    const style = document.createElement('style');
                    style.innerHTML = `
            @keyframes popIn { 0% { transform: scale(0); } 70% { transform: scale(1.2); } 100% { transform: scale(1); } }
            .animate-pop-in { animation: popIn 0.4s ease-out forwards; }
            
            @keyframes popOut { 0% { transform: scale(1); opacity: 1; } 100% { transform: scale(0); opacity: 0; } }
            .animate-pop-out { animation: popOut 0.5s ease-in forwards; pointer-events: none; }
            
            @keyframes wiggle { 0%, 100% { transform: rotate(0deg); } 25% { transform: rotate(-2deg); } 75% { transform: rotate(2deg); } }
            .animate-wiggle { animation: wiggle 0.4s ease-in-out; }
        `;
                    container.appendChild(style);
                },


                interactive_equation_advanced(container) {
                    // Estado inicial
                    let currentState = {
                        lhs: { x: 0, c: 0 },
                        rhs: { x: 0, c: 0 },
                        step: 0
                    };

                    // 1. HTML (Agora com 3 bot√µes de a√ß√£o)
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col items-center w-full shadow-sm">
                
                <div class="w-full max-w-md mb-6 bg-purple-50 p-4 rounded-xl border border-purple-100 flex flex-col gap-2">
                    <label class="text-xs font-bold text-brand-purple uppercase">Digite a Equa√ß√£o (Ex: 3x + 4 = 10 + x)</label>
                    <div class="flex gap-2">
                        <input type="text" id="eq-input" value="3x + 4 = 10 + x" class="flex-1 text-lg md:text-xl font-mono font-bold text-center border-2 border-brand-gray rounded-lg p-2 focus:border-brand-purple outline-none text-brand-text uppercase" placeholder="ax + b = cx + d">
                        <button id="build-btn" class="bg-brand-purple text-white px-4 rounded-lg font-bold hover:bg-purple-600 transition-colors shadow-btn active:shadow-none active:translate-y-1">
                            <i class="fas fa-hammer"></i>
                        </button>
                    </div>
                </div>

                <div class="relative w-full max-w-sm h-48 mb-4 flex justify-center items-end select-none">
                    <div class="absolute bottom-0 w-0 h-0 border-l-[20px] border-l-transparent border-r-[20px] border-r-transparent border-b-[40px] border-b-brand-text z-10"></div>
                    <div class="absolute bottom-[38px] w-72 h-2 bg-brand-text rounded-full z-10 transition-transform duration-500 origin-center" id="beam"></div>
                    
                    <div class="absolute bottom-[38px] left-[50%] -translate-x-36 flex flex-col items-center transition-all duration-500" id="pan-l">
                        <div class="w-0.5 h-16 bg-gray-400"></div>
                        <div class="w-24 h-2 bg-brand-text rounded-full"></div>
                        <div id="content-l" class="absolute bottom-4 flex flex-wrap-reverse gap-1 justify-center w-28 transition-all"></div>
                    </div>

                    <div class="absolute bottom-[38px] left-[25%] translate-x-36 flex flex-col items-center transition-all duration-500" id="pan-r">
                        <div class="w-0.5 h-16 bg-gray-400"></div>
                        <div class="w-24 h-2 bg-brand-text rounded-full"></div>
                        <div id="content-r" class="absolute bottom-4 flex flex-wrap-reverse gap-1 justify-center w-28 transition-all"></div>
                    </div>
                </div>

                <div id="controls" class="hidden w-full max-w-lg bg-gray-50 p-4 rounded-xl border border-gray-200 flex flex-col gap-4">
                    <div class="text-center font-mono text-xl font-bold text-brand-text bg-white p-2 rounded border border-gray-100" id="status-text">$$3x + 4 = 10 + x$$</div>
                    
                    <div class="grid grid-cols-3 gap-2">
                        <button id="step1-btn" class="bg-brand-blue text-white py-3 rounded-lg font-bold text-xs md:text-sm shadow-btn active:shadow-none active:translate-y-1 transition-all flex flex-col items-center justify-center gap-1">
                            <i class="fas fa-balance-scale-left"></i>
                            <span>1. Tirar X</span>
                        </button>
                        
                        <button id="step2-btn" class="bg-brand-orange text-white py-3 rounded-lg font-bold text-xs md:text-sm opacity-50 cursor-not-allowed shadow-none transition-all flex flex-col items-center justify-center gap-1" disabled>
                            <i class="fas fa-minus-circle"></i>
                            <span>2. Tirar Sobras</span>
                        </button>
                        
                        <button id="step3-btn" class="bg-brand-green text-white py-3 rounded-lg font-bold text-xs md:text-sm opacity-50 cursor-not-allowed shadow-none transition-all flex flex-col items-center justify-center gap-1" disabled>
                            <i class="fas fa-divide"></i>
                            <span>3. Dividir</span>
                        </button>
                    </div>
                </div>
            </div>
        `;

                    // 2. Seletores
                    const els = {
                        input: container.querySelector('#eq-input'),
                        buildBtn: container.querySelector('#build-btn'),
                        contentL: container.querySelector('#content-l'),
                        contentR: container.querySelector('#content-r'),
                        controls: container.querySelector('#controls'),
                        statusText: container.querySelector('#status-text'),
                        step1Btn: container.querySelector('#step1-btn'),
                        step2Btn: container.querySelector('#step2-btn'),
                        step3Btn: container.querySelector('#step3-btn'),
                        beam: container.querySelector('#beam')
                    };

                    // 3. Parser (Adaptado para ler x dos dois lados corretamente)
                    const parseEquation = (str) => {
                        const clean = str.replace(/\s+/g, '').toLowerCase();
                        const parts = clean.split('=');
                        if (parts.length !== 2) return null;

                        const parseSide = (s) => {
                            let x = 0, c = 0;
                            // Regex melhorado para pegar v√°rios termos (ex: 3x + 2 + x)
                            // Quebra pelos + e analisa cada peda√ßo
                            const terms = s.split('+');
                            terms.forEach(t => {
                                if (t.includes('x')) {
                                    const val = t.replace('x', '');
                                    x += val === '' ? 1 : parseInt(val);
                                } else {
                                    c += parseInt(t) || 0;
                                }
                            });
                            return { x, c };
                        };
                        return { lhs: parseSide(parts[0]), rhs: parseSide(parts[1]) };
                    };

                    // 4. Draw (Com classes para anima√ß√£o)
                    const draw = (data) => {
                        els.contentL.innerHTML = ''; els.contentR.innerHTML = '';

                        const createX = () => `<div class="block-x w-8 h-8 bg-brand-purple text-white border-2 border-purple-700 rounded flex items-center justify-center font-bold text-sm animate-pop-in mb-1 relative z-10">x</div>`;
                        const createUnit = () => `<div class="unit-ball w-5 h-5 bg-brand-green border border-green-700 rounded-full shadow-sm animate-pop-in mb-1 relative z-10"></div>`;

                        for (let i = 0; i < data.lhs.x; i++) els.contentL.innerHTML += createX();
                        for (let i = 0; i < data.lhs.c; i++) els.contentL.innerHTML += createUnit();

                        for (let i = 0; i < data.rhs.x; i++) els.contentR.innerHTML += createX();
                        for (let i = 0; i < data.rhs.c; i++) els.contentR.innerHTML += createUnit();
                    };

                    // 5. Setup Inicial
                    els.buildBtn.onclick = () => {
                        const eq = parseEquation(els.input.value);
                        if (!eq) return alert("Formato inv√°lido.");

                        currentState = { ...eq };
                        draw(currentState);

                        els.controls.classList.remove('hidden');
                        updateMathText();

                        // Reseta bot√µes
                        activateBtn(els.step1Btn);
                        disableBtn(els.step2Btn);
                        disableBtn(els.step3Btn);

                        animateWiggle();
                    };

                    // 6. Passo 1: TIRAR X (A Novidade)
                    els.step1Btn.onclick = () => {
                        // Descobre qual lado tem menos X para tirar esse valor de ambos
                        const minX = Math.min(currentState.lhs.x, currentState.rhs.x);

                        if (minX > 0) {
                            // Anima√ß√£o de sa√≠da dos blocos X
                            const xL = Array.from(els.contentL.querySelectorAll('.block-x')).slice(-minX);
                            const xR = Array.from(els.contentR.querySelectorAll('.block-x')).slice(-minX);

                            [...xL, ...xR].forEach(el => el.classList.add('animate-pop-out'));

                            setTimeout(() => {
                                currentState.lhs.x -= minX;
                                currentState.rhs.x -= minX;
                                draw(currentState);
                                updateMathText();
                            }, 500);
                        } else {
                            updateMathText("Sem X para tirar!");
                        }

                        disableBtn(els.step1Btn);
                        activateBtn(els.step2Btn);
                    };

                    // 7. Passo 2: TIRAR SOBRAS (Constantes)
                    els.step2Btn.onclick = () => {
                        const minC = Math.min(currentState.lhs.c, currentState.rhs.c);

                        if (minC > 0) {
                            const cL = Array.from(els.contentL.querySelectorAll('.unit-ball')).slice(-minC);
                            const cR = Array.from(els.contentR.querySelectorAll('.unit-ball')).slice(-minC);

                            [...cL, ...cR].forEach(el => el.classList.add('animate-pop-out'));

                            setTimeout(() => {
                                currentState.lhs.c -= minC;
                                currentState.rhs.c -= minC;
                                draw(currentState);
                                updateMathText();
                            }, 500);
                        } else {
                            updateMathText("Sem sobras para tirar!");
                        }

                        disableBtn(els.step2Btn);
                        activateBtn(els.step3Btn);
                    };

                    // 8. Passo 3: DIVIDIR
                    els.step3Btn.onclick = () => {
                        // Assume que sobrou ax = c (onde a > 1)
                        // Precisamos encontrar onde est√° o X (esquerda ou direita)
                        const sideWithX = currentState.lhs.x > 0 ? 'lhs' : 'rhs';
                        const sideWithC = currentState.lhs.c > 0 ? 'lhs' : 'rhs'; // Geralmente oposto

                        // Se o X j√° for 1, acabou
                        const divisor = currentState[sideWithX].x;

                        if (divisor > 1) {
                            // Anima√ß√£o simples de transi√ß√£o
                            els.contentL.classList.add('opacity-0');
                            els.contentR.classList.add('opacity-0');

                            setTimeout(() => {
                                currentState[sideWithX].x = 1;
                                // Se a divis√£o n√£o for exata, arredondamos visualmente ou mostramos decimal
                                currentState[sideWithC].c = currentState[sideWithC].c / divisor;

                                draw(currentState);
                                els.contentL.classList.remove('opacity-0');
                                els.contentR.classList.remove('opacity-0');
                                els.contentL.classList.add('animate-pop-in');
                                els.contentR.classList.add('animate-pop-in');

                                updateMathText();
                                els.statusText.classList.add('text-brand-green', 'scale-110');
                            }, 300);
                        }

                        disableBtn(els.step3Btn);
                    };

                    // Helpers
                    const updateMathText = (msg) => {
                        if (msg) {
                            els.statusText.innerText = msg;
                            return;
                        }
                        // Reconstr√≥i a string da equa√ß√£o baseada no estado atual
                        const buildSide = (s) => {
                            let parts = [];
                            if (s.x > 0) parts.push(s.x === 1 ? "x" : `${s.x}x`);
                            if (s.c > 0) parts.push(`${s.c}`);
                            if (parts.length === 0) return "0";
                            return parts.join(" + ");
                        };
                        const txt = `$$${buildSide(currentState.lhs)} = ${buildSide(currentState.rhs)}$$`;
                        els.statusText.innerText = txt;
                        if (window.renderMathInElement) renderMathInElement(els.statusText);
                    };

                    const activateBtn = (btn) => {
                        btn.classList.remove('opacity-50', 'cursor-not-allowed', 'shadow-none');
                        btn.classList.add('shadow-btn');
                        btn.disabled = false;
                    };
                    const disableBtn = (btn) => {
                        btn.classList.add('opacity-50', 'cursor-not-allowed', 'shadow-none');
                        btn.classList.remove('shadow-btn');
                        btn.disabled = true;
                    };
                    const animateWiggle = () => {
                        els.beam.classList.add('animate-wiggle');
                        setTimeout(() => els.beam.classList.remove('animate-wiggle'), 500);
                    };

                    // Estilos CSS Inline
                    if (!document.getElementById('anim-styles')) {
                        const style = document.createElement('style');
                        style.id = 'anim-styles';
                        style.innerHTML = `
                @keyframes popIn { 0% { transform: scale(0); } 70% { transform: scale(1.2); } 100% { transform: scale(1); } }
                .animate-pop-in { animation: popIn 0.4s ease-out forwards; }
                @keyframes popOut { 0% { transform: scale(1); opacity: 1; } 100% { transform: scale(0); opacity: 0; } }
                .animate-pop-out { animation: popOut 0.5s ease-in forwards; pointer-events: none; }
                @keyframes wiggle { 0%, 100% { transform: rotate(0deg); } 25% { transform: rotate(-2deg); } 75% { transform: rotate(2deg); } }
                .animate-wiggle { animation: wiggle 0.4s ease-in-out; }
            `;
                        container.appendChild(style);
                    }
                },

                interactive_primes_sieve(container) {
                    // Configura√ß√£o
                    const maxNum = 50;
                    let currentStep = 0;
                    // Passos do algoritmo: 1 (regra especial), depois filtrar m√∫ltiplos de 2, 3, 5, 7...
                    // Para N=50, s√≥ precisamos ir at√© a raiz quadrada (7), pois 7*7=49.
                    const steps = [
                        { type: 'init', label: "Iniciar: O n√∫mero 1" },
                        { type: 'filter', num: 2, label: "Filtrar M√∫ltiplos de 2" },
                        { type: 'filter', num: 3, label: "Filtrar M√∫ltiplos de 3" },
                        { type: 'filter', num: 5, label: "Filtrar M√∫ltiplos de 5" },
                        { type: 'filter', num: 7, label: "Filtrar M√∫ltiplos de 7" },
                        { type: 'finish', label: "Finalizar" }
                    ];

                    // 1. Inje√ß√£o do HTML
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col items-center w-full shadow-sm">
                
                <div class="text-center mb-4">
                    <h3 class="text-brand-blue font-extrabold text-xl uppercase tracking-wider">A Peneira dos Primos</h3>
                    <p class="text-xs text-gray-500 font-bold mt-1" id="instruction-text">Vamos encontrar os primos at√© ${maxNum}?</p>
                </div>

                <div class="grid grid-cols-10 gap-2 mb-6 w-full max-w-md select-none" id="sieve-grid">
                    </div>

                <button id="action-btn" class="w-full max-w-xs bg-brand-blue hover:bg-brand-blueDark text-white font-bold py-3 px-6 rounded-xl shadow-[0_4px_0_#1899D6] active:shadow-none active:translate-y-[4px] transition-all flex items-center justify-center gap-2">
                    <i class="fas fa-play"></i>
                    <span id="btn-label">Come√ßar</span>
                </button>

                <div class="flex gap-4 mt-6 text-[10px] uppercase font-bold text-gray-400">
                    <div class="flex items-center gap-1"><div class="w-3 h-3 bg-brand-green rounded"></div> Primos</div>
                    <div class="flex items-center gap-1"><div class="w-3 h-3 bg-gray-200 rounded"></div> Compostos</div>
                </div>
            </div>
        `;

                    // 2. Seletores
                    const grid = container.querySelector('#sieve-grid');
                    const btn = container.querySelector('#action-btn');
                    const btnLabel = container.querySelector('#btn-label');
                    const instruction = container.querySelector('#instruction-text');

                    // 3. Renderiza√ß√£o Inicial do Grid
                    const createGrid = () => {
                        grid.innerHTML = '';
                        for (let i = 1; i <= maxNum; i++) {
                            const el = document.createElement('div');
                            el.id = `num-${i}`;
                            el.className = "aspect-square flex items-center justify-center rounded-lg font-bold text-brand-blue border-2 border-blue-100 bg-blue-50 transition-all duration-300 text-sm md:text-base";
                            el.innerText = i;
                            grid.appendChild(el);
                        }
                    };

                    // 4. L√≥gica Passo a Passo
                    btn.onclick = async () => {
                        // Se o bot√£o estiver desabilitado (durante anima√ß√£o), ignora
                        if (btn.classList.contains('opacity-50')) return;

                        // Trava bot√£o
                        btn.classList.add('opacity-50', 'cursor-not-allowed', 'shadow-none');
                        const stepData = steps[currentStep];

                        if (stepData.type === 'init') {
                            // Passo 1: Eliminar o n√∫mero 1
                            instruction.innerText = "O n√∫mero 1 n√£o √© primo (tem apenas 1 divisor).";
                            const el1 = container.querySelector('#num-1');
                            el1.className = "aspect-square flex items-center justify-center rounded-lg font-bold text-gray-400 bg-gray-200 border-2 border-transparent scale-90";

                            await wait(500);
                            nextStep();

                        } else if (stepData.type === 'filter') {
                            const p = stepData.num;
                            instruction.innerText = `O ${p} √© primo! Vamos marcar ele e eliminar seus m√∫ltiplos.`;

                            // Marca o Primo atual (Verde)
                            const primeEl = container.querySelector(`#num-${p}`);
                            // S√≥ marca se ainda n√£o foi processado (embora logicamente deva estar livre)
                            if (!primeEl.classList.contains('bg-gray-200')) {
                                primeEl.className = "aspect-square flex items-center justify-center rounded-lg font-bold text-white bg-brand-green border-2 border-brand-green shadow-md scale-110 z-10 relative";
                            }

                            await wait(600);

                            // Elimina os m√∫ltiplos (Anima√ß√£o em cascata)
                            for (let i = p * p; i <= maxNum; i += p) { // Otimiza√ß√£o: come√ßa do quadrado
                                // Ou podemos fazer i = p + p para ser mais did√°tico
                                let m = i;
                                // No loop did√°tico, vamos de 2*p
                            }

                            // Vamos usar o loop simples (2p, 3p...) para visualiza√ß√£o completa
                            for (let m = p + p; m <= maxNum; m += p) {
                                const el = container.querySelector(`#num-${m}`);

                                // Se j√° n√£o estiver eliminado
                                if (!el.classList.contains('bg-gray-200')) {
                                    // Efeito visual de "ser atingido"
                                    el.classList.add('bg-brand-red', 'text-white', 'border-brand-red'); // Flash vermelho r√°pido
                                    await wait(100);

                                    // Estado final: Composto (Cinza)
                                    el.className = "aspect-square flex items-center justify-center rounded-lg font-bold text-gray-400 bg-gray-200 border-2 border-transparent scale-90 decoration-slice line-through decoration-gray-400";
                                }
                            }

                            nextStep();

                        } else if (stepData.type === 'finish') {
                            // Finaliza√ß√£o: Marca tudo que sobrou como primo
                            instruction.innerText = "Pronto! Todos os n√∫meros que sobraram s√£o Primos.";
                            instruction.className = "text-sm text-brand-green font-bold mt-1";

                            for (let i = 2; i <= maxNum; i++) {
                                const el = container.querySelector(`#num-${i}`);
                                if (!el.classList.contains('bg-gray-200') && !el.classList.contains('bg-brand-green')) {
                                    el.className = "aspect-square flex items-center justify-center rounded-lg font-bold text-white bg-brand-green border-2 border-brand-green shadow-md scale-110 animate-pop-in";
                                    await wait(50); // Efeito cascata final satisfat√≥rio
                                }
                            }

                            // Muda bot√£o para reiniciar
                            currentStep++; // Para sair do array
                            btn.innerHTML = `<i class="fas fa-undo"></i> <span>Reiniciar</span>`;
                            btn.classList.replace('bg-brand-blue', 'bg-brand-gray');
                            btn.classList.add('text-gray-600');
                            btn.classList.remove('opacity-50', 'cursor-not-allowed', 'shadow-none');
                            btn.classList.add('shadow-btn');
                            return; // Sai sem chamar nextStep padr√£o
                        }

                        // Reiniciar
                        if (currentStep > steps.length) {
                            currentStep = 0;
                            createGrid();
                            btn.innerHTML = `<i class="fas fa-play"></i> <span id="btn-label">Come√ßar</span>`;
                            btn.classList.replace('bg-brand-gray', 'bg-brand-blue');
                            btn.classList.remove('text-gray-600');
                            instruction.innerText = `Vamos encontrar os primos at√© ${maxNum}?`;
                            instruction.className = "text-xs text-gray-500 font-bold mt-1";
                        }
                    };

                    // Helper para avan√ßar o estado
                    const nextStep = () => {
                        currentStep++;
                        if (currentStep < steps.length) {
                            btnLabel.innerText = steps[currentStep].label;
                        } else {
                            // Se acabaram os passos definidos, manda finalizar
                            // Nota: steps cont√©m 'finish' como √∫ltimo, ent√£o cai ali.
                        }
                        // Destrava bot√£o
                        btn.classList.remove('opacity-50', 'cursor-not-allowed', 'shadow-none');
                        btn.classList.add('shadow-btn');
                    };

                    // Helper de tempo (Promise)
                    const wait = (ms) => new Promise(resolve => setTimeout(resolve, ms));

                    // CSS Inline para Anima√ß√£o Pop
                    if (!document.getElementById('anim-pop')) {
                        const style = document.createElement('style');
                        style.id = 'anim-pop';
                        style.innerHTML = `@keyframes popIn { 0% { transform: scale(0.5); opacity: 0; } 70% { transform: scale(1.2); } 100% { transform: scale(1.1); opacity: 1; } } .animate-pop-in { animation: popIn 0.3s ease-out forwards; }`;
                        container.appendChild(style);
                    }

                    // Inicializa
                    createGrid();
                    // Atualiza label inicial
                    btnLabel.innerText = steps[0].label;
                },

                interactive_mmc_mdc(container) {
                    // 1. Inje√ß√£o do HTML
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col items-center w-full shadow-sm">
                
                <div class="text-center mb-6">
                    <h3 class="text-brand-text font-extrabold text-lg uppercase tracking-wider mb-2">Comparando Dois N√∫meros</h3>
                    <div class="flex gap-4 justify-center items-center">
                        <input type="number" class="input-n1 text-3xl font-extrabold text-center w-20 p-2 rounded-xl border-2 border-brand-gray focus:border-brand-blue outline-none text-brand-blue transition-colors" value="12" min="1">
                        <span class="text-gray-300 font-bold text-xl">&</span>
                        <input type="number" class="input-n2 text-3xl font-extrabold text-center w-20 p-2 rounded-xl border-2 border-brand-gray focus:border-brand-blue outline-none text-brand-blue transition-colors" value="18" min="1">
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-4 w-full max-w-sm">
                    
                    <div class="bg-orange-50 border-2 border-orange-100 rounded-xl p-4 flex flex-col items-center justify-center transition-transform hover:scale-105">
                        <span class="text-[10px] font-black text-brand-orange uppercase tracking-widest mb-1">MDC</span>
                        <span class="text-xs text-orange-400 font-bold mb-2 text-center leading-tight">Maior Divisor Comum</span>
                        <div class="res-mdc text-4xl md:text-5xl font-black text-brand-orange drop-shadow-sm">6</div>
                    </div>

                    <div class="bg-purple-50 border-2 border-purple-100 rounded-xl p-4 flex flex-col items-center justify-center transition-transform hover:scale-105">
                        <span class="text-[10px] font-black text-brand-purple uppercase tracking-widest mb-1">MMC</span>
                        <span class="text-xs text-purple-400 font-bold mb-2 text-center leading-tight">M√≠nimo M√∫ltiplo Comum</span>
                        <div class="res-mmc text-4xl md:text-5xl font-black text-brand-purple drop-shadow-sm">36</div>
                    </div>

                </div>

                <div class="mt-6 text-center text-xs text-gray-400 font-medium bg-gray-50 px-4 py-2 rounded-full">
                    <i class="fas fa-lightbulb text-brand-yellow"></i> 
                    Dica: O MMC nunca √© menor que o maior n√∫mero!
                </div>
            </div>
        `;

                    // 2. Seletores
                    const n1Input = container.querySelector('.input-n1');
                    const n2Input = container.querySelector('.input-n2');
                    const resMdc = container.querySelector('.res-mdc');
                    const resMmc = container.querySelector('.res-mmc');

                    // 3. Fun√ß√µes Matem√°ticas (Algoritmo de Euclides)
                    const getMDC = (a, b) => {
                        return !b ? a : getMDC(b, a % b);
                    };

                    const getMMC = (a, b) => {
                        return (a * b) / getMDC(a, b);
                    };

                    // 4. L√≥gica de Atualiza√ß√£o
                    const update = () => {
                        let v1 = parseInt(n1Input.value);
                        let v2 = parseInt(n2Input.value);

                        // Valida√ß√£o simples (evita 0 ou negativo)
                        if (v1 < 1 || isNaN(v1)) v1 = 1;
                        if (v2 < 1 || isNaN(v2)) v2 = 1;

                        const mdc = getMDC(v1, v2);
                        const mmc = getMMC(v1, v2);

                        // Atualiza o DOM
                        resMdc.innerText = mdc;
                        resMmc.innerText = mmc;

                        // Feedback visual nos inputs (caso tenham sido corrigidos)
                        // n1Input.value = v1; 
                        // n2Input.value = v2;
                    };

                    // 5. Listeners
                    n1Input.addEventListener('input', update);
                    n2Input.addEventListener('input', update);

                    // Inicializa
                    update();
                },

                interactive_pizza_fractions(container) {
                    // Estado Inicial
                    let num = 3; // Numerador (Partes pintadas)
                    let den = 8; // Denominador (Total de cortes)

                    // 1. Inje√ß√£o do HTML
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col md:flex-row items-center justify-center gap-8 w-full shadow-sm select-none">
                
                <div class="relative w-48 h-48 md:w-56 md:h-56 shrink-0 transition-transform duration-300 hover:scale-105">
                    <div id="pizza-fill" class="absolute inset-0 rounded-full border-4 border-brand-text transition-all duration-500" 
                         style="background: conic-gradient(#FF9600 0% 0%, #FFF 0% 100%); box-shadow: 4px 4px 0px rgba(0,0,0,0.1);"></div>
                    
                    <svg id="pizza-slices" class="absolute inset-0 w-full h-full pointer-events-none" viewBox="0 0 100 100">
                        </svg>
                </div>

                <div class="flex flex-col items-center gap-6 w-full max-w-xs">
                    
                    <div class="flex flex-col items-center font-black text-brand-text">
                        <span id="num-display" class="text-5xl md:text-6xl text-brand-orange leading-none transition-all">3</span>
                        <div class="w-24 h-1 bg-brand-text my-2 rounded-full"></div>
                        <span id="den-display" class="text-5xl md:text-6xl text-brand-blue leading-none transition-all">8</span>
                    </div>

                    <div class="flex gap-4 w-full">
                        <div class="flex-1 flex flex-col items-center gap-2 bg-orange-50 p-3 rounded-xl border border-orange-100">
                            <span class="text-[10px] font-bold uppercase text-brand-orange tracking-wide">Fatias (Num)</span>
                            <div class="flex items-center gap-2">
                                <button id="btn-num-minus" class="w-8 h-8 rounded-full bg-white text-brand-orange border-2 border-brand-orange font-black hover:bg-orange-100 active:scale-95 transition-all">-</button>
                                <button id="btn-num-plus" class="w-8 h-8 rounded-full bg-brand-orange text-white border-2 border-brand-orange font-black hover:bg-orange-500 active:scale-95 transition-all shadow-sm">+</button>
                            </div>
                        </div>

                        <div class="flex-1 flex flex-col items-center gap-2 bg-blue-50 p-3 rounded-xl border border-blue-100">
                            <span class="text-[10px] font-bold uppercase text-brand-blue tracking-wide">Cortes (Den)</span>
                            <div class="flex items-center gap-2">
                                <button id="btn-den-minus" class="w-8 h-8 rounded-full bg-white text-brand-blue border-2 border-brand-blue font-black hover:bg-blue-100 active:scale-95 transition-all">-</button>
                                <button id="btn-den-plus" class="w-8 h-8 rounded-full bg-brand-blue text-white border-2 border-brand-blue font-black hover:bg-blue-600 active:scale-95 transition-all shadow-sm">+</button>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        `;

                    // 2. Seletores
                    const pizzaFill = container.querySelector('#pizza-fill');
                    const pizzaSlices = container.querySelector('#pizza-slices');
                    const numDisp = container.querySelector('#num-display');
                    const denDisp = container.querySelector('#den-display');

                    const btnNumPlus = container.querySelector('#btn-num-plus');
                    const btnNumMinus = container.querySelector('#btn-num-minus');
                    const btnDenPlus = container.querySelector('#btn-den-plus');
                    const btnDenMinus = container.querySelector('#btn-den-minus');

                    // 3. Fun√ß√£o de Atualiza√ß√£o Visual
                    const update = () => {
                        // Limites de Seguran√ßa
                        if (den < 1) den = 1;
                        if (den > 16) den = 16; // Limite visual para n√£o poluir
                        if (num < 0) num = 0;
                        if (num > den) num = den; // Mant√©m fra√ß√£o pr√≥pria (visualiza√ß√£o mais simples)

                        // Atualiza Texto
                        numDisp.innerText = num;
                        denDisp.innerText = den;

                        // 1. Pinta a Pizza (Numerador)
                        // Usa laranja (#FF9600) para a parte comida e branco/cinza para o resto
                        const percent = (num / den) * 100;
                        pizzaFill.style.background = `conic-gradient(#FF9600 0% ${percent}%, #F3F4F6 ${percent}% 100%)`;

                        // 2. Desenha as Linhas de Corte (Denominador)
                        // Usa SVG para calcular os √¢ngulos exatos
                        pizzaSlices.innerHTML = '';

                        // S√≥ desenha cortes se den > 1
                        if (den > 1) {
                            const centerX = 50;
                            const centerY = 50;
                            const radius = 50;

                            for (let i = 0; i < den; i++) {
                                const angle = (i * 360) / den;
                                // Converte graus para radianos e ajusta -90deg para come√ßar do topo (12h)
                                const rad = (angle - 90) * (Math.PI / 180);

                                const x2 = centerX + radius * Math.cos(rad);
                                const y2 = centerY + radius * Math.sin(rad);

                                const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
                                line.setAttribute("x1", centerX);
                                line.setAttribute("y1", centerY);
                                line.setAttribute("x2", x2);
                                line.setAttribute("y2", y2);
                                line.setAttribute("stroke", "#4B4B4B"); // Cor da linha (text-brand-text)
                                line.setAttribute("stroke-width", "1");

                                pizzaSlices.appendChild(line);
                            }
                        }
                    };

                    // 4. Listeners dos Controles
                    btnNumPlus.onclick = () => { if (num < den) num++; update(); };
                    btnNumMinus.onclick = () => { if (num > 0) num--; update(); };

                    btnDenPlus.onclick = () => {
                        if (den < 16) {
                            den++;
                            // Opcional: Se aumentar o corte, aumenta o num proporcionalmente? 
                            // N√£o, melhor manter o num fixo para ver a fra√ß√£o diminuir visualmente (pedag√≥gico)
                            update();
                        }
                    };
                    btnDenMinus.onclick = () => {
                        if (den > 1) {
                            den--;
                            if (num > den) num = den; // Ajusta numerador se passar do total
                            update();
                        }
                    };

                    // Inicializa
                    update();
                },

                interactive_fraction_wall(container) {
                    // Configura√ß√£o: Quais denominadores mostrar
                    const rows = [1, 2, 3, 4, 5, 6, 8, 10, 12];

                    // Cores para cada denominador (Cores Brand do MathLingo)
                    // Reciclando cores para dar variedade
                    const colors = {
                        1: "bg-brand-red border-red-600 text-white",
                        2: "bg-brand-orange border-orange-600 text-white",
                        3: "bg-brand-yellow border-yellow-500 text-yellow-900",
                        4: "bg-brand-green border-green-600 text-white",
                        5: "bg-brand-blue border-blue-600 text-white",
                        6: "bg-brand-purple border-purple-600 text-white",
                        8: "bg-pink-400 border-pink-600 text-white",
                        10: "bg-teal-400 border-teal-600 text-white",
                        12: "bg-indigo-400 border-indigo-600 text-white"
                    };

                    // Estado Inicial
                    let activeValue = 0.5; // Come√ßa selecionando 1/2

                    // 1. Inje√ß√£o do HTML
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-4 md:p-6 flex flex-col items-center w-full shadow-sm select-none">
                
                <div class="text-center mb-4 w-full">
                    <h3 class="text-brand-text font-extrabold text-sm md:text-base uppercase tracking-wider mb-2">Toque nos blocos para ver equival√™ncias</h3>
                    <div class="bg-blue-50 border border-blue-100 p-2 rounded-lg min-h-[40px] flex items-center justify-center">
                        <span id="feedback-text" class="text-lg md:text-xl font-mono font-bold text-brand-blue"></span>
                    </div>
                </div>

                <div class="relative w-full max-w-2xl flex flex-col gap-1 md:gap-2 p-2 bg-gray-100 rounded-xl border border-gray-200" id="wall-container">
                    
                    <div id="ruler-line" class="absolute top-0 bottom-0 w-1 bg-brand-text z-20 transition-all duration-300 pointer-events-none shadow-xl transform -translate-x-1/2" style="left: 50%">
                        <div class="absolute -top-3 left-1/2 -translate-x-1/2 w-0 h-0 border-l-[6px] border-l-transparent border-r-[6px] border-r-transparent border-t-[8px] border-t-brand-text"></div>
                        <div class="absolute -bottom-3 left-1/2 -translate-x-1/2 w-0 h-0 border-l-[6px] border-l-transparent border-r-[6px] border-r-transparent border-b-[8px] border-b-brand-text"></div>
                    </div>

                    <div id="blocks-area" class="flex flex-col gap-1 md:gap-2 w-full"></div>
                </div>

                <div class="mt-4 text-[10px] text-gray-400 font-bold uppercase text-center">
                    Blocos alinhados pela r√©gua s√£o equivalentes!
                </div>
            </div>
        `;

                    // 2. Seletores
                    const blocksArea = container.querySelector('#blocks-area');
                    const rulerLine = container.querySelector('#ruler-line');
                    const feedbackText = container.querySelector('#feedback-text');

                    // 3. Fun√ß√£o de Renderiza√ß√£o do Muro
                    const renderWall = () => {
                        blocksArea.innerHTML = '';

                        rows.forEach(denom => {
                            const rowEl = document.createElement('div');
                            rowEl.className = "flex w-full h-8 md:h-10 gap-[1px] md:gap-[2px]"; // Gap pequeno para ver separa√ß√£o

                            for (let num = 1; num <= denom; num++) {
                                const block = document.createElement('div');
                                const colorClass = colors[denom] || "bg-gray-400 text-white";

                                // C√°lculo do valor fracion√°rio deste bloco espec√≠fico (ex: o 2¬∫ bloco de 1/4 representa o fim de 2/4 = 0.5)
                                const fractionValue = num / denom;

                                block.className = `flex-1 flex items-center justify-center text-[10px] md:text-xs font-bold rounded-sm cursor-pointer transition-all duration-300 border-b-2 shadow-sm hover:brightness-110 active:scale-95 ${colorClass}`;
                                block.innerText = `1/${denom}`;

                                // Evento de Clique
                                block.onclick = () => {
                                    updateState(fractionValue, `${num}/${denom}`);
                                };

                                // Armazena dados no elemento para atualiza√ß√£o visual
                                block.dataset.value = fractionValue; // Valor acumulado (ex: 0.5)
                                block.dataset.denom = denom;
                                block.dataset.num = num;

                                rowEl.appendChild(block);
                            }
                            blocksArea.appendChild(rowEl);
                        });
                    };

                    // 4. L√≥gica de Atualiza√ß√£o (A m√°gica da equival√™ncia)
                    const updateState = (val, fractionLabel) => {
                        activeValue = val;

                        // 1. Move a R√©gua
                        const percent = val * 100;
                        rulerLine.style.left = `${percent}%`;

                        // 2. Atualiza visual dos blocos
                        // Precisamos iterar sobre todos os blocos criados
                        const allBlocks = blocksArea.querySelectorAll('div > div'); // Seleciona os filhos das linhas
                        const equivalents = [];

                        allBlocks.forEach(block => {
                            const blockVal = parseFloat(block.dataset.value); // Valor onde o bloco termina
                            const denom = parseInt(block.dataset.denom);
                            const num = parseInt(block.dataset.num);

                            // L√≥gica de "Acender/Apagar"
                            // Margem de erro min√∫scula para float precision (0.33333...)
                            const epsilon = 0.0001;

                            if (blockVal < activeValue + epsilon) {
                                // Bloco est√° √Ä ESQUERDA da r√©gua (ou nela)
                                block.style.opacity = "1";

                                // Verifica se termina EXATAMENTE na r√©gua (Equivalente!)
                                if (Math.abs(blockVal - activeValue) < epsilon) {
                                    block.classList.add('ring-2', 'ring-white', 'z-10'); // Destaque
                                    block.style.filter = "brightness(1.2)";
                                    equivalents.push(`${num}/${denom}`);
                                } else {
                                    block.classList.remove('ring-2', 'ring-white', 'z-10');
                                    block.style.filter = "brightness(1)";
                                }

                            } else {
                                // Bloco est√° √Ä DIREITA da r√©gua
                                block.style.opacity = "0.3"; // Apaga
                                block.classList.remove('ring-2', 'ring-white', 'z-10');
                                block.style.filter = "brightness(1)";
                            }
                        });

                        // 3. Atualiza Texto de Feedback
                        // Mostra a lista de equivalentes encontrados
                        feedbackText.innerHTML = equivalents.join(' = ');
                    };

                    // Inicializa
                    renderWall();
                    updateState(0.5, "1/2"); // Come√ßa mostrando 1/2
                },
                interactive_fraction_addition(container) {
                    // Fun√ß√£o Auxiliar de Simplifica√ß√£o (MDC)
                    const gcd = (a, b) => b === 0 ? a : gcd(b, a % b);

                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col items-center w-full shadow-sm font-sans">
                <h3 class="text-brand-blue font-bold uppercase text-xs mb-6 tracking-widest">Soma e Subtra√ß√£o</h3>
                
                <div class="flex items-center gap-2 md:gap-4 mb-6 text-xl md:text-2xl font-bold text-brand-text">
                    
                    <div class="flex flex-col items-center gap-1">
                        <input type="number" id="n1" value="1" class="w-12 md:w-16 text-center border-2 border-brand-blue rounded-lg p-1 outline-none focus:bg-blue-50 text-brand-blue">
                        <div class="w-full h-0.5 bg-brand-text"></div>
                        <input type="number" id="d1" value="2" class="w-12 md:w-16 text-center border-2 border-brand-blue rounded-lg p-1 outline-none focus:bg-blue-50 text-brand-blue">
                    </div>

                    <select id="op" class="bg-gray-100 rounded-lg p-2 font-bold cursor-pointer outline-none border-2 border-transparent focus:border-brand-gray">
                        <option value="+">+</option>
                        <option value="-">-</option>
                    </select>

                    <div class="flex flex-col items-center gap-1">
                        <input type="number" id="n2" value="1" class="w-12 md:w-16 text-center border-2 border-brand-orange rounded-lg p-1 outline-none focus:bg-orange-50 text-brand-orange">
                        <div class="w-full h-0.5 bg-brand-text"></div>
                        <input type="number" id="d2" value="3" class="w-12 md:w-16 text-center border-2 border-brand-orange rounded-lg p-1 outline-none focus:bg-orange-50 text-brand-orange">
                    </div>

                    <span class="text-gray-400 mx-1">=</span>

                    <div id="result-area" class="flex flex-col items-center gap-1 opacity-50">
                        <span class="res-n text-brand-purple">?</span>
                        <div class="w-full h-0.5 bg-brand-text"></div>
                        <span class="res-d text-brand-purple">?</span>
                    </div>
                </div>

                <div id="steps-container" class="w-full bg-yellow-50 border border-yellow-200 rounded-xl p-4 text-sm hidden">
                    <p class="font-bold text-yellow-800 mb-2 flex items-center gap-2">
                        <i class="fas fa-info-circle"></i> Denominadores diferentes!
                    </p>
                    <div class="flex flex-col gap-2 font-mono text-center text-yellow-900">
                        <div>1. MMC de <span id="lbl-d1"></span> e <span id="lbl-d2"></span> √© <strong id="lbl-mmc"></strong>.</div>
                        <div class="flex items-center justify-center gap-2">
                            <span>Nova conta:</span>
                            <div class="inline-flex flex-col align-middle text-xs">
                                <span class="border-b border-black px-1" id="step-n1"></span><span id="step-mmc1"></span>
                            </div>
                            <span id="step-op"></span>
                            <div class="inline-flex flex-col align-middle text-xs">
                                <span class="border-b border-black px-1" id="step-n2"></span><span id="step-mmc2"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        `;

                    const inputs = container.querySelectorAll('input, select');
                    const stepsContainer = container.querySelector('#steps-container');

                    const update = () => {
                        const n1 = parseInt(container.querySelector('#n1').value) || 0;
                        const d1 = parseInt(container.querySelector('#d1').value) || 1;
                        const n2 = parseInt(container.querySelector('#n2').value) || 0;
                        const d2 = parseInt(container.querySelector('#d2').value) || 1;
                        const op = container.querySelector('#op').value;

                        // L√≥gica do MMC
                        const getMMC = (a, b) => (a * b) / gcd(a, b);
                        const mmc = getMMC(d1, d2);

                        // Novos Numeradores
                        const newN1 = n1 * (mmc / d1);
                        const newN2 = n2 * (mmc / d2);

                        // Resultado Final
                        let resN = op === '+' ? (newN1 + newN2) : (newN1 - newN2);
                        let resD = mmc;

                        // Simplifica√ß√£o
                        const common = gcd(Math.abs(resN), resD);
                        const simpleN = resN / common;
                        const simpleD = resD / common;

                        // Renderiza Resultado
                        const resArea = container.querySelector('#result-area');
                        resArea.querySelector('.res-n').innerText = simpleN;
                        resArea.querySelector('.res-d').innerText = simpleD;
                        resArea.classList.remove('opacity-50');

                        // Renderiza Passos (Se necess√°rio)
                        if (d1 !== d2) {
                            stepsContainer.classList.remove('hidden');
                            container.querySelector('#lbl-d1').innerText = d1;
                            container.querySelector('#lbl-d2').innerText = d2;
                            container.querySelector('#lbl-mmc').innerText = mmc;

                            container.querySelector('#step-n1').innerText = newN1;
                            container.querySelector('#step-mmc1').innerText = mmc;
                            container.querySelector('#step-op').innerText = op;
                            container.querySelector('#step-n2').innerText = newN2;
                            container.querySelector('#step-mmc2').innerText = mmc;
                        } else {
                            stepsContainer.classList.add('hidden');
                        }
                    };

                    inputs.forEach(i => i.addEventListener('input', update));
                    update();
                },

                // --- WIDGET 2: MULTIPLICA√á√ÉO DE FRA√á√ïES (Modelo de √Årea) ---
                interactive_fraction_mult(container) {
                    const gcd = (a, b) => b === 0 ? a : gcd(b, a % b);

                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col md:flex-row items-center justify-center gap-8 w-full shadow-sm">
                
                <div class="flex flex-col items-center gap-4">
                    <h3 class="text-brand-purple font-bold uppercase text-xs tracking-widest">Multiplica√ß√£o</h3>
                    <div class="flex items-center gap-2 text-xl font-bold">
                        <div class="flex flex-col items-center">
                            <input type="number" id="mn1" value="2" min="1" max="5" class="w-12 text-center border-b-2 border-brand-purple outline-none">
                            <input type="number" id="md1" value="3" min="1" max="5" class="w-12 text-center border-t-2 border-gray-300 outline-none">
                        </div>
                        <span class="text-brand-purple">√ó</span>
                        <div class="flex flex-col items-center">
                            <input type="number" id="mn2" value="1" min="1" max="5" class="w-12 text-center border-b-2 border-brand-blue outline-none">
                            <input type="number" id="md2" value="4" min="1" max="5" class="w-12 text-center border-t-2 border-gray-300 outline-none">
                        </div>
                        <span>=</span>
                        <div class="flex flex-col items-center text-brand-green">
                            <span id="m-res-n">2</span>
                            <div class="w-8 h-0.5 bg-current"></div>
                            <span id="m-res-d">12</span>
                        </div>
                    </div>
                    <div id="simp-msg" class="text-xs text-gray-400 font-bold hidden">Simplificando: <span id="simp-val"></span></div>
                </div>

                <div class="relative w-32 h-32 border-2 border-gray-800 bg-white shadow-md">
                    <div id="grid-container" class="w-full h-full grid">
                        </div>
                    <div class="absolute -left-6 top-0 bottom-0 flex flex-col justify-center items-center text-xs font-bold text-brand-purple">
                        <span class="transform -rotate-90">Fra√ß√£o 1</span>
                    </div>
                    <div class="absolute -top-6 left-0 right-0 flex justify-center items-center text-xs font-bold text-brand-blue">
                        <span>Fra√ß√£o 2</span>
                    </div>
                </div>
            </div>
        `;

                    const inputs = container.querySelectorAll('input');

                    const update = () => {
                        const n1 = parseInt(container.querySelector('#mn1').value) || 1;
                        const d1 = parseInt(container.querySelector('#md1').value) || 1;
                        const n2 = parseInt(container.querySelector('#mn2').value) || 1;
                        const d2 = parseInt(container.querySelector('#md2').value) || 1;

                        // Atualiza Grid CSS
                        const grid = container.querySelector('#grid-container');
                        grid.style.gridTemplateRows = `repeat(${d1}, 1fr)`;    // Denominador 1 = Linhas
                        grid.style.gridTemplateColumns = `repeat(${d2}, 1fr)`; // Denominador 2 = Colunas

                        grid.innerHTML = '';

                        // Gera C√©lulas
                        // Linhas (i) de 0 a d1-1
                        // Colunas (j) de 0 a d2-1
                        for (let i = 0; i < d1; i++) {
                            for (let j = 0; j < d2; j++) {
                                const cell = document.createElement('div');
                                cell.className = "border border-gray-200 transition-colors duration-300";

                                // L√≥gica de Pintura (Interse√ß√£o)
                                // Pinta a linha se i < n1
                                // Pinta a coluna se j < n2
                                const rowSelected = i < n1;
                                const colSelected = j < n2;

                                if (rowSelected && colSelected) {
                                    cell.className += " bg-brand-green border-green-600"; // Interse√ß√£o (Resultado)
                                } else if (rowSelected) {
                                    cell.className += " bg-purple-100"; // Apenas Frac 1
                                } else if (colSelected) {
                                    cell.className += " bg-blue-100"; // Apenas Frac 2
                                }

                                grid.appendChild(cell);
                            }
                        }

                        // Resultado Num√©rico
                        const resN = n1 * n2;
                        const resD = d1 * d2;
                        container.querySelector('#m-res-n').innerText = resN;
                        container.querySelector('#m-res-d').innerText = resD;

                        // Checa Simplifica√ß√£o
                        const s = gcd(resN, resD);
                        if (s > 1) {
                            container.querySelector('#simp-msg').classList.remove('hidden');
                            container.querySelector('#simp-val').innerText = `${resN / s}/${resD / s}`;
                        } else {
                            container.querySelector('#simp-msg').classList.add('hidden');
                        }
                    };

                    inputs.forEach(i => i.addEventListener('input', update));
                    update();
                },

                // --- WIDGET 3: DIVIS√ÉO DE FRA√á√ïES (Anima√ß√£o de Invers√£o) ---
                interactive_fraction_div(container) {
                    const gcd = (a, b) => b === 0 ? a : gcd(b, a % b);

                    let state = { n1: 2, d1: 3, n2: 1, d2: 2, flipped: false };

                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col items-center w-full shadow-sm font-sans">
                <h3 class="text-brand-orange font-bold uppercase text-xs mb-6 tracking-widest">Divis√£o (Regra do Inverso)</h3>
                
                <div class="flex items-center gap-2 md:gap-4 mb-8 relative h-20">
                    
                    <div class="flex flex-col items-center gap-1">
                        <input type="number" id="div-n1" value="2" class="w-14 text-center border-2 border-brand-gray rounded-lg p-1 font-bold text-xl outline-none">
                        <div class="w-full h-0.5 bg-brand-text"></div>
                        <input type="number" id="div-d1" value="3" class="w-14 text-center border-2 border-brand-gray rounded-lg p-1 font-bold text-xl outline-none">
                    </div>

                    <div id="div-op" class="text-3xl font-black text-brand-orange transition-all duration-500">√∑</div>

                    <div id="frac-2-container" class="flex flex-col items-center gap-1 transition-transform duration-700">
                        <input type="number" id="div-n2" value="1" class="w-14 text-center border-2 border-brand-blue rounded-lg p-1 font-bold text-xl outline-none bg-blue-50">
                        <div class="w-full h-0.5 bg-brand-text"></div>
                        <input type="number" id="div-d2" value="4" class="w-14 text-center border-2 border-brand-green rounded-lg p-1 font-bold text-xl outline-none bg-green-50">
                    </div>

                    <span class="text-2xl text-gray-300 ml-2">=</span>

                    <div class="flex flex-col items-center gap-1 opacity-50 transition-opacity duration-500" id="div-res">
                        <span class="text-2xl font-bold text-brand-text" id="r-n">?</span>
                        <div class="w-full h-0.5 bg-brand-text"></div>
                        <span class="text-2xl font-bold text-brand-text" id="r-d">?</span>
                    </div>

                </div>

                <button id="btn-flip" class="bg-brand-orange hover:bg-orange-600 text-white font-bold py-2 px-6 rounded-xl shadow-btn active:translate-y-1 active:shadow-none transition-all flex items-center gap-2">
                    <i class="fas fa-sync-alt"></i> Inverter e Multiplicar
                </button>
                <div class="text-xs text-gray-400 mt-2 font-bold uppercase tracking-wide hidden" id="reset-msg">Clique para reiniciar</div>
            </div>
        `;

                    const n1El = container.querySelector('#div-n1');
                    const d1El = container.querySelector('#div-d1');
                    const n2El = container.querySelector('#div-n2');
                    const d2El = container.querySelector('#div-d2');
                    const frac2 = container.querySelector('#frac-2-container');
                    const op = container.querySelector('#div-op');
                    const btn = container.querySelector('#btn-flip');
                    const resDiv = container.querySelector('#div-res');

                    // Fun√ß√£o de Resolver
                    const solve = () => {
                        const n1 = parseInt(n1El.value);
                        const d1 = parseInt(d1El.value);
                        // Se flipou, usamos os valores visuais (que est√£o invertidos no DOM, mas logicamente aqui queremos o c√°lculo final)
                        // C√°lculo real: (n1/d1) / (n2/d2) = (n1 * d2) / (d1 * n2)
                        const n2 = parseInt(n2El.value);
                        const d2 = parseInt(d2El.value);

                        // Resultado Final sempre baseado nos inputs originais (antes de inverter visualmente)
                        // Se o estado √© "flipped", os inputs visuais j√° est√£o trocados? N√£o, vamos manter a l√≥gica simples:
                        // O c√°lculo matem√°tico √© fixo: N1*D2 e D1*N2 (Cruzado)

                        // Como visualmente invertemos os inputs, vamos calcular baseado no que o usu√°rio v√™.
                        // Se state.flipped √© true, o usu√°rio v√™ uma multiplica√ß√£o.

                        let finalN, finalD;

                        if (state.flipped) {
                            // Usu√°rio v√™ multiplica√ß√£o: Topo * Topo
                            // Nota: Ao flipar, trocamos os valores dos inputs via JS
                            finalN = parseInt(n1El.value) * parseInt(n2El.value);
                            finalD = parseInt(d1El.value) * parseInt(d2El.value);
                        } else {
                            // Usu√°rio v√™ divis√£o: C√°lculo cruzado
                            finalN = parseInt(n1El.value) * parseInt(d2El.value);
                            finalD = parseInt(d1El.value) * parseInt(n2El.value);
                        }

                        // Simplifica
                        const s = gcd(finalN, finalD);
                        container.querySelector('#r-n').innerText = finalN / s;
                        container.querySelector('#r-d').innerText = finalD / s;
                    };

                    btn.onclick = async () => {
                        if (!state.flipped) {
                            // Passo 1: Anima√ß√£o de Invers√£o
                            state.flipped = true;

                            // Trava inputs
                            [n1El, d1El, n2El, d2El].forEach(i => i.disabled = true);

                            // 1. Gira o container
                            frac2.style.transform = "rotate(180deg)";

                            // 2. Muda o operador
                            op.style.opacity = 0;

                            await new Promise(r => setTimeout(r, 300));

                            op.innerText = "√ó"; // Vira multiplica√ß√£o
                            op.style.opacity = 1;
                            op.classList.replace('text-brand-orange', 'text-brand-purple');

                            await new Promise(r => setTimeout(r, 400)); // Espera rota√ß√£o terminar

                            // 3. Troca os valores internamente e des-rotaciona instantaneamente (truque visual)
                            // para que os n√∫meros n√£o fiquem de cabe√ßa para baixo
                            const tempVal = n2El.value;
                            const tempClass = n2El.className; // Troca cores tamb√©m

                            n2El.value = d2El.value;
                            d2El.value = tempVal;

                            // Reset rota√ß√£o (sem transi√ß√£o para o usu√°rio n√£o ver)
                            frac2.style.transition = "none";
                            frac2.style.transform = "rotate(0deg)";

                            // Feedback visual de resultado
                            solve();
                            resDiv.style.opacity = 1;
                            resDiv.classList.add('scale-110');

                            // Atualiza Bot√£o
                            btn.innerHTML = `<i class="fas fa-undo"></i> Reiniciar`;
                            btn.className = "bg-gray-400 text-white font-bold py-2 px-6 rounded-xl hover:bg-gray-500 transition-all flex items-center gap-2";
                            container.querySelector('#reset-msg').classList.remove('hidden');

                        } else {
                            // Reiniciar
                            state.flipped = false;

                            // Restaura Inputs
                            [n1El, d1El, n2El, d2El].forEach(i => i.disabled = false);

                            // Restaura Estilos
                            frac2.style.transition = "transform 0.7s";
                            op.innerText = "√∑";
                            op.classList.replace('text-brand-purple', 'text-brand-orange');
                            resDiv.style.opacity = 0.5;
                            resDiv.classList.remove('scale-110');
                            container.querySelector('#r-n').innerText = "?";
                            container.querySelector('#r-d').innerText = "?";

                            btn.innerHTML = `<i class="fas fa-sync-alt"></i> Inverter e Multiplicar`;
                            btn.className = "bg-brand-orange hover:bg-orange-600 text-white font-bold py-2 px-6 rounded-xl shadow-btn active:translate-y-1 active:shadow-none transition-all flex items-center gap-2";
                            container.querySelector('#reset-msg').classList.add('hidden');
                        }
                    };
                },

                interactive_decimal_align(container) {
                    // Estado inicial
                    let offset = -2; // Come√ßa desalinhado propositalmente (valores de -4 a 4)

                    // N√∫meros do problema (Fixos para este exemplo pedag√≥gico)
                    // Conta: 12,5 + 3,42
                    const num1 = { int: "12", dec: "5" }; // 12,5
                    const num2 = { int: "3", dec: "42" }; // 3,42

                    // 1. Inje√ß√£o do HTML
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col items-center w-full shadow-sm select-none font-sans">
                
                <div class="text-center mb-6">
                    <h3 class="text-brand-blue font-bold uppercase text-xs tracking-widest mb-1">Miss√£o: Alinhar as V√≠rgulas</h3>
                    <p class="text-sm text-gray-400">Arraste o n√∫mero de baixo at√© as v√≠rgulas se encontrarem!</p>
                </div>

                <div class="relative bg-gray-50 border-2 border-dashed border-gray-300 rounded-xl p-8 w-full max-w-sm overflow-hidden flex flex-col items-center justify-center gap-2 mb-6 transition-colors duration-300" id="math-zone">
                    
                    <div class="absolute top-0 bottom-0 left-1/2 w-0.5 bg-brand-red opacity-50 z-0 dashed-line"></div>

                    <div class="flex items-baseline text-4xl md:text-5xl font-mono font-bold text-gray-400 z-10 relative">
                        <span>12</span>
                        <span class="text-brand-red mx-1">,</span>
                        <span>5&nbsp;</span> </div>

                    <div class="absolute left-4 top-1/2 -translate-y-1/2 text-2xl font-bold text-gray-300">+</div>

                    <div id="movable-row" class="flex items-baseline text-4xl md:text-5xl font-mono font-bold text-brand-blue z-10 relative transition-transform duration-100 cursor-grab active:cursor-grabbing" style="transform: translateX(-50px)">
                        <span>3</span>
                        <span class="text-brand-red mx-1 scale-125 inline-block transition-transform" id="comma-2">,</span>
                        <span>42</span>
                    </div>

                    <div class="w-full border-b-4 border-gray-300 mt-2 z-10"></div>

                    <div id="result-display" class="h-12 mt-2 text-4xl md:text-5xl font-mono font-bold text-brand-green opacity-0 transition-all duration-300 transform translate-y-2">
                        15,92
                    </div>
                </div>

                <div class="w-full max-w-xs px-4">
                    <input type="range" id="align-slider" min="-4" max="4" value="-2" step="1" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-brand-blue hover:accent-brand-blueDark">
                    <div class="flex justify-between text-[10px] text-gray-400 font-bold mt-2 uppercase">
                        <span>Esquerda</span>
                        <span>Direita</span>
                    </div>
                </div>

                <div id="feedback-msg" class="mt-4 font-bold text-brand-red animate-pulse">
                    <i class="fas fa-times-circle"></i> V√≠rgula desalinhada!
                </div>
            </div>
        `;

                    // 2. Seletores
                    const slider = container.querySelector('#align-slider');
                    const movableRow = container.querySelector('#movable-row');
                    const mathZone = container.querySelector('#math-zone');
                    const resultDisplay = container.querySelector('#result-display');
                    const feedbackMsg = container.querySelector('#feedback-msg');
                    const comma2 = container.querySelector('#comma-2');

                    // 3. Fun√ß√£o de Atualiza√ß√£o
                    const update = () => {
                        const val = parseInt(slider.value);

                        // Move o n√∫mero visualmente (aprox 30px por passo do slider)
                        // A l√≥gica aqui √© visual: alinhar o elemento DOM
                        const pxOffset = val * 24;
                        movableRow.style.transform = `translateX(${pxOffset}px)`;

                        // Verifica se alinhou (O valor 0 √© o "centro" l√≥gico que definimos)
                        // No nosso caso, o valor correto no slider que alinha 3,42 com 12,5 depende do layout visual.
                        // Vamos assumir que '1' √© o alinhamento correto para este exemplo espec√≠fico
                        // Ajuste fino: 12,5 vs 3,42. 
                        // 12,5
                        //  3,42
                        // O '3' deve ficar embaixo do '2'. A v√≠rgula embaixo da v√≠rgula.

                        // Para simplificar a l√≥gica visual do slider, vamos dizer que 0 √© o alvo.
                        // Ajustaremos o CSS inicial para que 0 seja visualmente alinhado.

                        if (val === 0) {
                            // SUCESSO
                            mathZone.classList.remove('border-gray-300', 'bg-gray-50');
                            mathZone.classList.add('border-brand-green', 'bg-green-50');

                            resultDisplay.style.opacity = 1;
                            resultDisplay.style.transform = "translateY(0)";

                            feedbackMsg.className = "mt-4 font-bold text-brand-green";
                            feedbackMsg.innerHTML = `<i class="fas fa-check-circle"></i> Perfeito! V√≠rgula sobre v√≠rgula.`;

                            comma2.classList.add('scale-150', 'text-brand-green'); // Destaque na v√≠rgula

                        } else {
                            // ERRO
                            mathZone.classList.add('border-gray-300', 'bg-gray-50');
                            mathZone.classList.remove('border-brand-green', 'bg-green-50');

                            resultDisplay.style.opacity = 0;
                            resultDisplay.style.transform = "translateY(10px)";

                            feedbackMsg.className = "mt-4 font-bold text-brand-red";
                            feedbackMsg.innerHTML = `<i class="fas fa-times-circle"></i> V√≠rgula desalinhada!`;

                            comma2.classList.remove('scale-150', 'text-brand-green');
                        }
                    };

                    // 4. Listeners
                    slider.addEventListener('input', update);

                    // Inicializa (Dispara o evento para setar a posi√ß√£o inicial errada)
                    update();
                },
                interactive_decimal_add_sub(container) {
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col items-center w-full shadow-sm font-sans">
                <h3 class="text-brand-blue font-bold uppercase text-xs mb-4 tracking-widest">Alinhamento Autom√°tico</h3>
                
                <div class="flex items-center gap-2 mb-6">
                    <input type="number" id="dec-n1" value="12.5" step="0.1" class="w-20 md:w-24 text-center border-2 border-brand-blue rounded-lg p-2 font-bold text-lg outline-none focus:bg-blue-50 text-brand-text">
                    <select id="dec-op" class="bg-gray-100 rounded-lg p-2 font-bold cursor-pointer outline-none border-2 border-transparent focus:border-brand-gray text-xl">
                        <option value="+">+</option>
                        <option value="-">-</option>
                    </select>
                    <input type="number" id="dec-n2" value="3.42" step="0.01" class="w-20 md:w-24 text-center border-2 border-brand-orange rounded-lg p-2 font-bold text-lg outline-none focus:bg-orange-50 text-brand-text">
                </div>

                <div class="bg-gray-800 text-white p-6 rounded-xl font-mono text-2xl md:text-3xl flex flex-col items-end shadow-inner border-4 border-gray-300 relative min-w-[200px]">
                    
                    <div class="absolute top-0 bottom-0 right-[3.25rem] w-px bg-red-500 opacity-50 z-0"></div>

                    <div id="row-1" class="z-10 relative">12,50</div>
                    <div id="row-2" class="z-10 relative pr-2 border-b-2 border-white w-full text-right mb-2 pb-1">
                        <span class="absolute left-0 text-gray-400" id="op-display">+</span>
                        3,42
                    </div>
                    <div id="row-res" class="z-10 relative text-brand-green font-bold">15,92</div>

                </div>
                
                <p class="mt-4 text-xs text-gray-400 font-bold uppercase">
                    <i class="fas fa-info-circle"></i> O computador preenche com zeros para alinhar!
                </p>
            </div>
        `;

                    const n1El = container.querySelector('#dec-n1');
                    const n2El = container.querySelector('#dec-n2');
                    const opEl = container.querySelector('#dec-op');

                    const row1 = container.querySelector('#row-1');
                    const row2 = container.querySelector('#row-2');
                    const rowRes = container.querySelector('#row-res');
                    const opDisplay = container.querySelector('#op-display');

                    const update = () => {
                        let val1 = parseFloat(n1El.value) || 0;
                        let val2 = parseFloat(n2El.value) || 0;
                        const operator = opEl.value;

                        // Calcula resultado real
                        let res = operator === '+' ? val1 + val2 : val1 - val2;

                        // Formata√ß√£o para Alinhamento Visual
                        // Descobre qual tem mais casas decimais para padronizar
                        const s1 = val1.toString();
                        const s2 = val2.toString();
                        const dec1 = s1.includes('.') ? s1.split('.')[1].length : 0;
                        const dec2 = s2.includes('.') ? s2.split('.')[1].length : 0;
                        const maxDec = Math.max(dec1, dec2);

                        // Formata fixando as casas decimais (isso adiciona os zeros fantasmas)
                        // e troca ponto por v√≠rgula para o padr√£o BR
                        const fmt = (n) => n.toFixed(maxDec).replace('.', ',');

                        row1.innerHTML = fmt(val1).replace(/0+$/, match => `<span class="text-gray-500">${match}</span>`); // Zeros extras cinza? (Opcional, aqui deixei normal)
                        // Melhor: Apenas formatar string
                        row1.innerText = fmt(val1);

                        // Atualiza linha 2 mantendo o operador visual
                        row2.innerHTML = `<span class="absolute left-0 text-gray-400">${operator}</span> ${fmt(val2)}`;

                        rowRes.innerText = fmt(res);
                    };

                    [n1El, n2El, opEl].forEach(el => el.addEventListener('input', update));
                    update();
                },

                // --- WIDGET 2: MULTIPLICA√á√ÉO DE DECIMAIS (Contagem de Casas) ---
                interactive_decimal_mult(container) {
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col items-center w-full shadow-sm font-sans">
                <h3 class="text-brand-purple font-bold uppercase text-xs mb-6 tracking-widest">Multiplica√ß√£o: Conte as Casas!</h3>

                <div class="flex flex-col md:flex-row items-center gap-8 w-full justify-center">
                    
                    <div class="flex flex-col gap-4">
                        <div class="flex items-center gap-2">
                            <input type="number" id="mul-n1" value="2.5" step="0.1" class="w-20 text-center border-b-2 border-brand-purple outline-none font-bold text-xl">
                            <span class="text-xs font-bold text-brand-purple bg-purple-50 px-2 py-1 rounded-full whitespace-nowrap" id="count-1">1 casa</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <span class="text-xl font-bold text-gray-300">√ó</span>
                            <input type="number" id="mul-n2" value="0.03" step="0.01" class="w-20 text-center border-b-2 border-brand-purple outline-none font-bold text-xl">
                            <span class="text-xs font-bold text-brand-purple bg-purple-50 px-2 py-1 rounded-full whitespace-nowrap" id="count-2">2 casas</span>
                        </div>
                    </div>

                    <div class="flex flex-col items-center bg-gray-50 p-4 rounded-xl border-2 border-dashed border-gray-200 min-w-[200px]">
                        <div class="text-sm text-gray-400 font-bold mb-2">Total de Casas: <span id="total-count" class="text-brand-red">3</span></div>
                        
                        <div class="opacity-50 text-sm font-mono mb-1" id="int-calc">25 √ó 3 = 75</div>
                        
                        <div class="text-4xl font-mono font-bold text-brand-green" id="mul-res">0,075</div>
                        
                        <div class="flex mt-1 gap-1" id="dots-container">
                            </div>
                    </div>
                </div>
            </div>
        `;

                    const n1El = container.querySelector('#mul-n1');
                    const n2El = container.querySelector('#mul-n2');
                    const count1El = container.querySelector('#count-1');
                    const count2El = container.querySelector('#count-2');
                    const totalCountEl = container.querySelector('#total-count');
                    const intCalcEl = container.querySelector('#int-calc');
                    const resEl = container.querySelector('#mul-res');
                    const dotsContainer = container.querySelector('#dots-container');

                    const countDecimals = (n) => {
                        if (Math.floor(n) === n) return 0;
                        return n.toString().split(".")[1].length || 0;
                    }

                    const update = () => {
                        const v1 = parseFloat(n1El.value) || 0;
                        const v2 = parseFloat(n2El.value) || 0;

                        const c1 = countDecimals(v1);
                        const c2 = countDecimals(v2);
                        const total = c1 + c2;

                        // Atualiza Labels
                        count1El.innerText = c1 === 1 ? "1 casa" : `${c1} casas`;
                        count2El.innerText = c2 === 1 ? "1 casa" : `${c2} casas`;
                        totalCountEl.innerText = total;

                        // C√°lculo Inteiro (Ignorando v√≠rgula)
                        // Remove o ponto e trata como string -> int para mostrar a l√≥gica "Esquece a v√≠rgula"
                        const int1 = parseInt(v1.toString().replace('.', ''));
                        const int2 = parseInt(v2.toString().replace('.', ''));
                        const intRes = int1 * int2;
                        intCalcEl.innerText = `${int1} √ó ${int2} = ${intRes}`;

                        // Resultado Real
                        // Resolvemos problemas de ponto flutuante multiplicando e dividindo por pot√™ncias de 10
                        // Ou simplesmente usamos toFixed para o total de casas
                        let res = v1 * v2;
                        // Hackzinho JS para evitar 0.30000000004
                        res = parseFloat(res.toFixed(total + 2)); // Limpa lixo

                        // Formata BR
                        let resStr = res.toString().replace('.', ',');

                        // Se o JS "comeu" zeros (ex: 0.075 -> 0.075), precisamos garantir que mostre todas as casas?
                        // Para multiplica√ß√£o did√°tica, usamos toFixed(total) se necess√°rio, mas as vezes simplifica.
                        // Vamos deixar o c√°lculo JS padr√£o, mas formatado.

                        // Caso especial: for√ßar mostrar zeros √† esquerda se necess√°rio para did√°tica?
                        // Ex: 0,2 x 0,3 = 0,06. O JS faz certo.
                        resEl.innerText = resStr;

                        // Pontinhos Visuais (Pulos do Sapo)
                        dotsContainer.innerHTML = '';
                        for (let i = 0; i < total; i++) {
                            const dot = document.createElement('div');
                            dot.className = "w-2 h-2 bg-brand-red rounded-full animate-bounce";
                            dot.style.animationDelay = `${i * 0.2}s`;
                            dotsContainer.appendChild(dot);
                        }
                    };

                    n1El.addEventListener('input', update);
                    n2El.addEventListener('input', update);
                    update();
                },

                // --- WIDGET 3: DIVIS√ÉO DE DECIMAIS (Eliminando a V√≠rgula) ---
                interactive_decimal_div(container) {
                    let state = { multiplied: false, power: 0 };

                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col items-center w-full shadow-sm font-sans">
                <h3 class="text-brand-orange font-bold uppercase text-xs mb-6 tracking-widest">Divis√£o: Elimine a V√≠rgula!</h3>

                <div class="flex items-center gap-4 text-2xl md:text-4xl font-mono font-bold text-brand-text mb-8 p-4 bg-gray-50 rounded-xl border border-gray-200 transition-all duration-500" id="div-box">
                    
                    <span id="d-n1" class="transition-all">2,5</span>
                    
                    <span class="text-brand-orange">√∑</span>
                    
                    <span id="d-n2" class="transition-all">0,05</span>

                </div>

                <div class="flex flex-col items-center gap-2">
                    <button id="btn-elim" class="bg-brand-orange hover:bg-orange-600 text-white font-bold py-3 px-6 rounded-xl shadow-btn active:shadow-none active:translate-y-1 transition-all flex items-center gap-2">
                        <i class="fas fa-magic"></i>
                        <span>Multiplicar por 10, 100...</span>
                    </button>
                    
                    <div id="div-res-container" class="opacity-0 transition-opacity mt-4 text-center">
                        <div class="text-xs text-gray-400 uppercase font-bold mb-1">Resultado</div>
                        <div class="text-4xl font-bold text-brand-green" id="div-result">50</div>
                    </div>
                </div>

                <div class="mt-8 pt-4 border-t border-gray-100 w-full flex justify-center gap-4 text-sm">
                    <div class="flex flex-col items-center">
                        <label class="text-[10px] uppercase font-bold text-gray-400">Dividendo</label>
                        <input type="number" id="in-n1" value="2.5" step="0.1" class="w-16 text-center border rounded bg-gray-50">
                    </div>
                    <div class="flex flex-col items-center">
                        <label class="text-[10px] uppercase font-bold text-gray-400">Divisor</label>
                        <input type="number" id="in-n2" value="0.05" step="0.01" class="w-16 text-center border rounded bg-gray-50">
                    </div>
                    <button id="btn-reset" class="text-xs text-brand-blue font-bold underline">Reiniciar</button>
                </div>
            </div>
        `;

                    const n1Display = container.querySelector('#d-n1');
                    const n2Display = container.querySelector('#d-n2');
                    const divBox = container.querySelector('#div-box');
                    const btnElim = container.querySelector('#btn-elim');
                    const resContainer = container.querySelector('#div-res-container');
                    const resDisplay = container.querySelector('#div-result');

                    const inN1 = container.querySelector('#in-n1');
                    const inN2 = container.querySelector('#in-n2');
                    const btnReset = container.querySelector('#btn-reset');

                    const getDecimals = (n) => {
                        if (Math.floor(n) === n) return 0;
                        return n.toString().split(".")[1].length || 0;
                    };

                    const updateDisplay = (v1, v2) => {
                        n1Display.innerText = v1.toString().replace('.', ',');
                        n2Display.innerText = v2.toString().replace('.', ',');
                    };

                    // L√≥gica Principal
                    btnElim.onclick = () => {
                        const v1 = parseFloat(inN1.value);
                        const v2 = parseFloat(inN2.value);

                        // Descobre por quanto multiplicar (10, 100, 1000...)
                        const maxDec = Math.max(getDecimals(v1), getDecimals(v2));

                        if (maxDec === 0) {
                            // J√° s√£o inteiros, s√≥ mostra o resultado
                            showResult(v1, v2);
                            return;
                        }

                        const multiplier = Math.pow(10, maxDec);
                        const newV1 = Math.round(v1 * multiplier); // Round remove erros de float
                        const newV2 = Math.round(v2 * multiplier);

                        // Anima√ß√£o
                        divBox.classList.add('scale-110', 'bg-orange-50', 'border-brand-orange');

                        // Texto indicativo
                        btnElim.innerHTML = `<i class="fas fa-check"></i> V√≠rgulas Eliminadas (x${multiplier})`;
                        btnElim.classList.replace('bg-brand-orange', 'bg-brand-green');
                        btnElim.classList.add('pointer-events-none'); // Trava bot√£o

                        setTimeout(() => {
                            updateDisplay(newV1, newV2);
                            showResult(newV1, newV2);
                        }, 300);
                    };

                    const showResult = (v1, v2) => {
                        const res = v2 === 0 ? "Erro" : (v1 / v2);
                        // Formata resultado (se ainda for decimal, usa v√≠rgula)
                        resDisplay.innerText = res.toString().replace('.', ',');
                        resContainer.classList.remove('opacity-0');
                        divBox.classList.remove('scale-110');
                    };

                    // Reset
                    const reset = () => {
                        const v1 = parseFloat(inN1.value);
                        const v2 = parseFloat(inN2.value);
                        updateDisplay(v1, v2);

                        divBox.classList.remove('bg-orange-50', 'border-brand-orange');
                        resContainer.classList.add('opacity-0');

                        btnElim.innerHTML = `<i class="fas fa-magic"></i> <span>Multiplicar por 10, 100...</span>`;
                        btnElim.classList.replace('bg-brand-green', 'bg-brand-orange');
                        btnElim.classList.remove('pointer-events-none');
                    };

                    inN1.addEventListener('input', reset);
                    inN2.addEventListener('input', reset);
                    btnReset.addEventListener('click', reset);

                    // Init
                    updateDisplay(parseFloat(inN1.value), parseFloat(inN2.value));
                },
                interactive_geometry_canvas(container) {
                    // ESTADO DO WIDGET
                    let state = {
                        tool: 'select', // Ferramenta atual: 'select', 'rect', 'circle', 'line'
                        isDrawing: false,
                        startPos: { x: 0, y: 0 },
                        currentShape: null, // A forma que est√° sendo desenhada agora
                        selectedShape: null // A forma que foi clicada para ver propriedades
                    };

                    // 1. INJE√á√ÉO DO HTML ESTRUTURAL
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-4 flex flex-col gap-4 w-full shadow-sm font-sans select-none">
                
                <div class="flex flex-col md:flex-row justify-between items-center gap-4 border-b-2 border-gray-100 pb-4">
                    <h3 class="text-brand-blue font-bold uppercase text-xs tracking-widest">Geometria Explorat√≥ria</h3>
                    
                    <div class="flex gap-2 bg-gray-50 p-1 rounded-lg">
                        <button data-tool="select" class="tool-btn bg-white text-brand-blue shadow-sm p-2 rounded-md w-10 h-10 flex items-center justify-center transition-all active:scale-95 ring-2 ring-brand-blue">
                            <i class="fas fa-mouse-pointer"></i>
                        </button>
                        <div class="w-px bg-gray-300 mx-1"></div>
                        <button data-tool="rect" class="tool-btn bg-transparent text-gray-500 p-2 rounded-md w-10 h-10 flex items-center justify-center transition-all hover:bg-gray-200 active:scale-95">
                            <i class="far fa-square"></i>
                        </button>
                        <button data-tool="circle" class="tool-btn bg-transparent text-gray-500 p-2 rounded-md w-10 h-10 flex items-center justify-center transition-all hover:bg-gray-200 active:scale-95">
                            <i class="far fa-circle"></i>
                        </button>
                        <button data-tool="line" class="tool-btn bg-transparent text-gray-500 p-2 rounded-md w-10 h-10 flex items-center justify-center transition-all hover:bg-gray-200 active:scale-95">
                            <i class="fas fa-slash" style="transform: rotate(-45deg);"></i>
                        </button>
                    </div>
                    
                    <div class="flex gap-2">
                         <button id="btn-delete" class="text-gray-400 hover:text-brand-red p-2 rounded transition-colors hidden" title="Apagar Selecionado">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                        <button id="btn-clear" class="text-gray-400 hover:text-brand-red p-2 rounded transition-colors" title="Limpar Tudo">
                            <i class="fas fa-eraser"></i>
                        </button>
                    </div>
                </div>

                <div class="flex flex-col md:flex-row gap-4 h-[400px]">
                    <div class="flex-1 bg-gray-50 rounded-xl border-2 border-gray-200 overflow-hidden relative cursor-crosshair" id="canvas-container">
                        <svg id="svg-canvas" class="w-full h-full" xmlns="http://www.w3.org/2000/svg">
                            <defs>
                                <pattern id="smallGrid" width="20" height="20" patternUnits="userSpaceOnUse">
                                    <path d="M 20 0 L 0 0 0 20" fill="none" stroke="rgba(0,0,0,0.05)" stroke-width="1"/>
                                </pattern>
                            </defs>
                            <rect width="100%" height="100%" fill="url(#smallGrid)" />
                            <g id="shapes-layer"></g> </svg>
                        <div id="tool-tip" class="absolute bottom-2 left-2 bg-white px-2 py-1 rounded text-[10px] text-gray-500 font-bold shadow-sm pointer-events-none">
                            Modo: Selecionar (Clique em uma forma)
                        </div>
                    </div>

                    <div class="w-full md:w-64 bg-blue-50 rounded-xl border-2 border-blue-100 p-4 flex flex-col overflow-y-auto">
                        <h4 class="font-bold text-brand-blue mb-4 text-sm uppercase"><i class="fas fa-info-circle"></i> Propriedades</h4>
                        
                        <div id="properties-content" class="flex-1 flex flex-col gap-3 text-sm text-brand-text opacity-50">
                            <p class="text-center italic mt-10">Selecione uma forma no canvas para ver seus detalhes geom√©tricos.</p>
                        </div>
                    </div>
                </div>
            </div>
        `;

                    // 2. SELETORES
                    const svgCanvas = container.querySelector('#svg-canvas');
                    const shapesLayer = container.querySelector('#shapes-layer');
                    const toolBtns = container.querySelectorAll('.tool-btn');
                    const toolTip = container.querySelector('#tool-tip');
                    const propPanel = container.querySelector('#properties-content');
                    const btnClear = container.querySelector('#btn-clear');
                    const btnDelete = container.querySelector('#btn-delete');

                    // 3. FUN√á√ïES AUXILIARES

                    // Pega coordenadas do mouse relativas ao SVG
                    const getMousePos = (evt) => {
                        const CTM = svgCanvas.getScreenCTM();
                        return {
                            x: (evt.clientX - CTM.e) / CTM.a,
                            y: (evt.clientY - CTM.f) / CTM.d
                        };
                    };

                    // Calcula dist√¢ncia entre dois pontos (Pit√°goras)
                    const getDistance = (p1, p2) => Math.sqrt(Math.pow(p2.x - p1.x, 2) + Math.pow(p2.y - p1.y, 2));

                    // Formata n√∫meros para exibir
                    const fmt = (n) => Math.round(n * 10) / 10;

                    // Atualiza a UI da barra de ferramentas
                    const updateToolUI = (tool) => {
                        toolBtns.forEach(btn => {
                            const isSelected = btn.dataset.tool === tool;
                            btn.classList.toggle('bg-white', isSelected);
                            btn.classList.toggle('text-brand-blue', isSelected);
                            btn.classList.toggle('shadow-sm', isSelected);
                            btn.classList.toggle('ring-2', isSelected);
                            btn.classList.toggle('ring-brand-blue', isSelected);
                            btn.classList.toggle('bg-transparent', !isSelected);
                            btn.classList.toggle('text-gray-500', !isSelected);
                        });
                        const tips = {
                            'select': 'Modo: Selecionar (Clique em uma forma)',
                            'rect': 'Modo: Ret√¢ngulo (Clique e arraste)',
                            'circle': 'Modo: C√≠rculo (Clique no centro e arraste)',
                            'line': 'Modo: Linha (Clique no in√≠cio e arraste)'
                        };
                        toolTip.innerText = tips[tool];
                        svgCanvas.style.cursor = tool === 'select' ? 'default' : 'crosshair';
                    };

                    // Seleciona uma forma
                    const selectShape = (shapeEl) => {
                        // Remove sele√ß√£o anterior
                        if (state.selectedShape) {
                            state.selectedShape.classList.remove('stroke-brand-blue', 'stroke-[3]');
                            state.selectedShape.classList.add('stroke-brand-text', 'stroke-2');
                        }

                        state.selectedShape = shapeEl;
                        btnDelete.classList.toggle('hidden', !shapeEl);

                        if (shapeEl) {
                            // Adiciona destaque visual
                            shapeEl.classList.remove('stroke-brand-text', 'stroke-2');
                            shapeEl.classList.add('stroke-brand-blue', 'stroke-[3]');
                            calculateProperties(shapeEl);
                        } else {
                            // Limpa painel
                            propPanel.innerHTML = `<p class="text-center italic mt-10">Selecione uma forma no canvas para ver seus detalhes geom√©tricos.</p>`;
                            propPanel.classList.add('opacity-50');
                        }
                    };

                    // 4. L√ìGICA DE GEOMETRIA (C√°lculo de Propriedades)
                    const calculateProperties = (el) => {
                        propPanel.classList.remove('opacity-50');
                        const type = el.tagName;
                        let html = '';

                        const createPropRow = (label, value, unit = 'px') => `
                <div class="flex justify-between items-center bg-white p-2 rounded shadow-sm border border-blue-100">
                    <span class="font-bold text-brand-blue">${label}</span>
                    <span class="font-mono font-bold">${fmt(value)}${unit}</span>
                </div>`;
                        const createHeader = (icon, title) => `
                <div class="flex items-center gap-2 text-lg font-bold text-brand-blue mb-2 border-b border-blue-200 pb-1">
                    <i class="${icon}"></i> <span>${title}</span>
                </div>`;

                        if (type === 'rect') {
                            const w = parseFloat(el.getAttribute('width'));
                            const h = parseFloat(el.getAttribute('height'));
                            html += createHeader('far fa-square', 'Ret√¢ngulo');
                            html += createPropRow('Largura (b)', w);
                            html += createPropRow('Altura (h)', h);
                            html += `<div class="my-2"></div>`;
                            html += createPropRow('Per√≠metro (2b+2h)', 2 * (w + h));
                            html += createPropRow('√Årea (b√óh)', w * h, 'px¬≤');

                        } else if (type === 'circle') {
                            const r = parseFloat(el.getAttribute('r'));
                            html += createHeader('far fa-circle', 'C√≠rculo');
                            html += createPropRow('Raio (r)', r);
                            html += createPropRow('Di√¢metro (d)', 2 * r);
                            html += `<div class="my-2"></div>`;
                            html += createPropRow('Circunfer√™ncia (2œÄr)', 2 * Math.PI * r);
                            html += createPropRow('√Årea (œÄr¬≤)', Math.PI * r * r, 'px¬≤');

                        } else if (type === 'line') {
                            const x1 = parseFloat(el.getAttribute('x1'));
                            const y1 = parseFloat(el.getAttribute('y1'));
                            const x2 = parseFloat(el.getAttribute('x2'));
                            const y2 = parseFloat(el.getAttribute('y2'));
                            const length = getDistance({ x: x1, y: y1 }, { x: x2, y: y2 });

                            html += createHeader('fas fa-slash', 'Segmento de Reta');
                            html += createPropRow('Ponto A', `(${fmt(x1)}, ${fmt(y1)})`, '');
                            html += createPropRow('Ponto B', `(${fmt(x2)}, ${fmt(y2)})`, '');
                            html += `<div class="my-2"></div>`;
                            html += createPropRow('Comprimento', length);
                        }

                        propPanel.innerHTML = html;
                    };


                    // 5. LISTENERS DE INTERA√á√ÉO (O Cora√ß√£o do Widget)

                    // Troca de Ferramenta
                    toolBtns.forEach(btn => {
                        btn.onclick = () => {
                            state.tool = btn.dataset.tool;
                            updateToolUI(state.tool);
                            if (state.tool !== 'select') selectShape(null); // Deseleciona ao mudar para desenho
                        }
                    });

                    // A√ß√µes do Mouse no Canvas
                    svgCanvas.onmousedown = (e) => {
                        if (state.tool === 'select') {
                            // Se clicou no fundo (svgCanvas), deseleciona. Se clicou numa forma, o evento da forma trata.
                            if (e.target === svgCanvas) selectShape(null);
                            return;
                        }

                        // Inicia Desenho
                        state.isDrawing = true;
                        state.startPos = getMousePos(e);

                        // Cria o elemento SVG inicial
                        let newShape;
                        const commonClasses = "fill-brand-blue fill-opacity-20 stroke-brand-text stroke-2 pointer-events-auto transition-colors hover:stroke-brand-blue";

                        if (state.tool === 'rect') {
                            newShape = document.createElementNS("http://www.w3.org/2000/svg", "rect");
                            newShape.setAttribute('x', state.startPos.x);
                            newShape.setAttribute('y', state.startPos.y);
                            newShape.setAttribute('width', 0);
                            newShape.setAttribute('height', 0);
                        } else if (state.tool === 'circle') {
                            newShape = document.createElementNS("http://www.w3.org/2000/svg", "circle");
                            newShape.setAttribute('cx', state.startPos.x);
                            newShape.setAttribute('cy', state.startPos.y);
                            newShape.setAttribute('r', 0);
                        } else if (state.tool === 'line') {
                            newShape = document.createElementNS("http://www.w3.org/2000/svg", "line");
                            newShape.setAttribute('x1', state.startPos.x);
                            newShape.setAttribute('y1', state.startPos.y);
                            newShape.setAttribute('x2', state.startPos.x);
                            newShape.setAttribute('y2', state.startPos.y);
                            newShape.classList.add('stroke-brand-text', 'stroke-2', 'pointer-events-auto', 'hover:stroke-brand-blue', 'transition-colors'); // Linha n√£o tem fill
                        }

                        if (newShape) {
                            if (state.tool !== 'line') newShape.setAttribute('class', commonClasses);
                            shapesLayer.appendChild(newShape);
                            state.currentShape = newShape;
                        }
                    };

                    svgCanvas.onmousemove = (e) => {
                        if (!state.isDrawing || !state.currentShape) return;
                        const currentPos = getMousePos(e);

                        if (state.tool === 'rect') {
                            // L√≥gica para permitir arrastar para qualquer dire√ß√£o (largura/altura negativas n√£o existem)
                            const x = Math.min(state.startPos.x, currentPos.x);
                            const y = Math.min(state.startPos.y, currentPos.y);
                            const width = Math.abs(currentPos.x - state.startPos.x);
                            const height = Math.abs(currentPos.y - state.startPos.y);

                            state.currentShape.setAttribute('x', x);
                            state.currentShape.setAttribute('y', y);
                            state.currentShape.setAttribute('width', width);
                            state.currentShape.setAttribute('height', height);

                        } else if (state.tool === 'circle') {
                            const radius = getDistance(state.startPos, currentPos);
                            state.currentShape.setAttribute('r', radius);

                        } else if (state.tool === 'line') {
                            state.currentShape.setAttribute('x2', currentPos.x);
                            state.currentShape.setAttribute('y2', currentPos.y);
                        }
                    };

                    svgCanvas.onmouseup = (e) => {
                        if (!state.isDrawing) return;
                        state.isDrawing = false;

                        // Adiciona evento de clique para sele√ß√£o na nova forma
                        if (state.currentShape) {
                            // Evita criar formas min√∫sculas (cliques acidentais)
                            const bbox = state.currentShape.getBBox();
                            if (bbox.width < 5 && bbox.height < 5) {
                                shapesLayer.removeChild(state.currentShape);
                            } else {
                                // O const para capturar o elemento atual no closure
                                const thisShape = state.currentShape;
                                thisShape.onclick = (evt) => {
                                    evt.stopPropagation(); // N√£o propaga para o canvas atr√°s
                                    if (state.tool === 'select') {
                                        selectShape(thisShape);
                                    }
                                };
                                // Seleciona automaticamente ap√≥s desenhar para ver as propriedades
                                state.tool = 'select';
                                updateToolUI('select');
                                selectShape(thisShape);
                            }
                        }
                        state.currentShape = null;
                    };

                    // Listener global para parar de desenhar se o mouse sair do canvas
                    svgCanvas.onmouseleave = svgCanvas.onmouseup;


                    // Bot√µes de A√ß√£o
                    btnClear.onclick = () => {
                        if (confirm('Tem certeza que deseja limpar todo o canvas?')) {
                            shapesLayer.innerHTML = '';
                            selectShape(null);
                        }
                    };

                    btnDelete.onclick = () => {
                        if (state.selectedShape) {
                            shapesLayer.removeChild(state.selectedShape);
                            selectShape(null);
                        }
                    };

                    // Inicializa√ß√£o CSS Inline para garantir √≠cones
                    if (!document.getElementById('fa-icons-css')) {
                        const link = document.createElement('link');
                        link.id = 'fa-icons-css';
                        link.rel = 'stylesheet';
                        link.href = 'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css';
                        document.head.appendChild(link);
                    }
                },

                interactive_angle_maker(container) {
                    // Estado inicial
                    let currentAngle = 45;

                    // 1. INJE√á√ÉO DO HTML
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col items-center w-full shadow-sm font-sans select-none">
                
                <h3 class="text-brand-blue font-bold uppercase text-xs tracking-widest mb-4">Classifica√ß√£o de √Çngulos</h3>

                <div class="relative mb-4">
                    <canvas id="angle-canvas" width="300" height="180" class="bg-white rounded-xl"></canvas>
                    
                    <div id="angle-value" class="absolute top-4 right-4 text-4xl font-black text-brand-text opacity-20">
                        45¬∞
                    </div>
                </div>

                <div class="w-full max-w-xs mb-6 px-2">
                    <input type="range" id="angle-slider" min="0" max="180" value="45" class="w-full h-3 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-brand-blue hover:accent-brand-blueDark transition-all">
                </div>

                <div class="flex items-center justify-between w-full max-w-xs bg-gray-50 p-4 rounded-xl border-2 transition-colors duration-300" id="info-panel">
                    <div class="flex flex-col">
                        <span class="text-[10px] text-gray-400 font-bold uppercase">Classifica√ß√£o</span>
                        <span id="angle-type" class="text-xl font-black text-brand-blue uppercase tracking-wide">Agudo</span>
                    </div>
                    <div class="text-3xl font-bold text-brand-text" id="angle-display">45¬∞</div>
                </div>

                <div class="flex gap-2 mt-4 flex-wrap justify-center">
                    <button class="shortcut-btn bg-white border border-gray-200 px-3 py-1 rounded-lg text-xs font-bold text-gray-500 hover:bg-gray-100 active:scale-95 transition-transform" data-val="0">0¬∞</button>
                    <button class="shortcut-btn bg-white border border-gray-200 px-3 py-1 rounded-lg text-xs font-bold text-gray-500 hover:bg-gray-100 active:scale-95 transition-transform" data-val="45">45¬∞</button>
                    <button class="shortcut-btn bg-white border border-gray-200 px-3 py-1 rounded-lg text-xs font-bold text-gray-500 hover:bg-gray-100 active:scale-95 transition-transform" data-val="90">90¬∞</button>
                    <button class="shortcut-btn bg-white border border-gray-200 px-3 py-1 rounded-lg text-xs font-bold text-gray-500 hover:bg-gray-100 active:scale-95 transition-transform" data-val="135">135¬∞</button>
                    <button class="shortcut-btn bg-white border border-gray-200 px-3 py-1 rounded-lg text-xs font-bold text-gray-500 hover:bg-gray-100 active:scale-95 transition-transform" data-val="180">180¬∞</button>
                </div>
            </div>
        `;

                    // 2. SELETORES
                    const canvas = container.querySelector('#angle-canvas');
                    const ctx = canvas.getContext('2d');
                    const slider = container.querySelector('#angle-slider');
                    const angleDisplay = container.querySelector('#angle-display');
                    const angleValueOverlay = container.querySelector('#angle-value');
                    const angleType = container.querySelector('#angle-type');
                    const infoPanel = container.querySelector('#info-panel');
                    const buttons = container.querySelectorAll('.shortcut-btn');

                    // Configura√ß√µes de Desenho
                    // Aumentando a resolu√ß√£o visual do canvas para telas retina
                    const scale = window.devicePixelRatio || 1;
                    canvas.width = 300 * scale;
                    canvas.height = 180 * scale;
                    ctx.scale(scale, scale);
                    canvas.style.width = "300px";
                    canvas.style.height = "180px";

                    // Origem (Ponto central inferior)
                    const cx = 150;
                    const cy = 150;
                    const radius = 100; // Comprimento da reta

                    // 3. FUN√á√ÉO DE DESENHO
                    const draw = (deg) => {
                        // Limpa
                        ctx.clearRect(0, 0, 300, 180);

                        // Determina Cor e Tipo
                        let color = "#58CC02"; // Verde (Agudo)
                        let type = "AGUDO";
                        let bgClass = "border-brand-green bg-green-50";

                        if (deg === 0) {
                            type = "NULO";
                            color = "#E5E5E5"; // Cinza
                            bgClass = "border-gray-200 bg-gray-50";
                        } else if (deg === 90) {
                            type = "RETO";
                            color = "#1CB0F6"; // Azul
                            bgClass = "border-brand-blue bg-blue-50";
                        } else if (deg > 90 && deg < 180) {
                            type = "OBTUSO";
                            color = "#FFC800"; // Amarelo
                            bgClass = "border-brand-yellow bg-yellow-50";
                        } else if (deg === 180) {
                            type = "RASO";
                            color = "#FF4B4B"; // Vermelho
                            bgClass = "border-brand-red bg-red-50";
                        }

                        // Atualiza UI Texto
                        angleDisplay.innerText = `${deg}¬∞`;
                        angleValueOverlay.innerText = `${deg}¬∞`;
                        angleType.innerText = type;
                        angleType.style.color = color;
                        infoPanel.className = `flex items-center justify-between w-full max-w-xs p-4 rounded-xl border-2 transition-colors duration-300 ${bgClass}`;

                        // --- DESENHO NO CANVAS ---

                        // Converter para radianos
                        // Nota: Canvas Y cresce para baixo. 0 rad √© direita (3h).
                        // Queremos 0 rad na direita e ir subindo (anti-hor√°rio).
                        // A coordenada Y deve ser: cy - sin(rad) * r
                        const rad = deg * (Math.PI / 180);

                        // 1. Linha Base (Fixa na horizontal direita)
                        ctx.beginPath();
                        ctx.lineWidth = 4;
                        ctx.lineCap = "round";
                        ctx.strokeStyle = "#4B4B4B"; // Cinza escuro
                        ctx.moveTo(cx, cy);
                        ctx.lineTo(cx + radius, cy);
                        ctx.stroke();

                        // 2. Linha M√≥vel (Gira)
                        // Math.cos(rad) d√° X, Math.sin(rad) d√° Y.
                        // Negativo no Y porque o canvas √© invertido verticalmente.
                        const x2 = cx + radius * Math.cos(-rad);
                        const y2 = cy + radius * Math.sin(-rad);

                        ctx.beginPath();
                        ctx.moveTo(cx, cy);
                        ctx.lineTo(x2, y2);
                        ctx.stroke();

                        // 3. Arco do √Çngulo (Preenchimento)
                        if (deg > 0) {
                            ctx.beginPath();

                            // Desenho Especial para 90 Graus (Quadrado)
                            if (deg === 90) {
                                const size = 20;
                                ctx.strokeStyle = color;
                                ctx.lineWidth = 2;
                                ctx.moveTo(cx + size, cy); // Ponto na base
                                ctx.lineTo(cx + size, cy - size); // Canto flutuante
                                ctx.lineTo(cx, cy - size); // Ponto na reta vertical
                                ctx.stroke();

                                // Pontinho no meio
                                ctx.beginPath();
                                ctx.fillStyle = color;
                                ctx.arc(cx + size / 2, cy - size / 2, 2, 0, Math.PI * 2);
                                ctx.fill();
                            } else {
                                // Arco Normal
                                const arcRadius = 40;
                                ctx.fillStyle = color + "33"; // 20% opacidade (hex alpha)
                                ctx.strokeStyle = color;
                                ctx.lineWidth = 2;

                                ctx.moveTo(cx, cy);
                                // arc(x, y, radius, startAngle, endAngle, counterClockwise)
                                // Start: 0. End: -rad (porque √© anti-hor√°rio no visual, mas canvas conta hor√°rio positivo)
                                ctx.arc(cx, cy, arcRadius, 0, -rad, true);
                                ctx.lineTo(cx, cy);
                                ctx.fill();
                                ctx.stroke();
                            }
                        }

                        // 4. V√©rtice (Ponto A)
                        ctx.beginPath();
                        ctx.fillStyle = "#4B4B4B";
                        ctx.arc(cx, cy, 6, 0, Math.PI * 2);
                        ctx.fill();
                    };

                    // 4. LISTENERS

                    // Slider
                    slider.addEventListener('input', (e) => {
                        currentAngle = parseInt(e.target.value);
                        draw(currentAngle);
                    });

                    // Bot√µes
                    buttons.forEach(btn => {
                        btn.onclick = () => {
                            const val = parseInt(btn.dataset.val);
                            currentAngle = val;
                            slider.value = val; // Sincroniza slider
                            draw(val);
                        };
                    });

                    // Inicializa
                    draw(45);
                },

                interactive_poly_types(container) {
                    // Estado
                    let state = {
                        isDragging: false,
                        // Coordenadas iniciais (Is√≥sceles)
                        A: { x: 50, y: 250 },  // Base Esq
                        B: { x: 250, y: 250 }, // Base Dir
                        C: { x: 150, y: 50 }   // Topo (M√≥vel)
                    };

                    // 1. Inje√ß√£o HTML
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col items-center w-full shadow-sm font-sans select-none">
                
                <div class="text-center mb-4">
                    <h3 class="text-brand-purple font-bold uppercase text-xs tracking-widest mb-1">Classifica√ß√£o de Tri√¢ngulos</h3>
                    <p class="text-sm text-gray-400">Arraste a bolinha roxa para transformar o tri√¢ngulo!</p>
                </div>

                <div class="relative w-[300px] h-[300px] bg-purple-50 rounded-xl border-2 border-purple-100 touch-none">
                    <svg id="poly-svg" class="w-full h-full overflow-visible" xmlns="http://www.w3.org/2000/svg">
                        <path id="triangle-path" d="" fill="rgba(155, 89, 182, 0.2)" stroke="#9B59B6" stroke-width="4" stroke-linejoin="round"/>
                        
                        <g id="ticks-layer" stroke="#9B59B6" stroke-width="2"></g>

                        <circle cx="50" cy="250" r="4" fill="#9B59B6" />
                        <circle cx="250" cy="250" r="4" fill="#9B59B6" />

                        <circle id="vertex-c" cx="150" cy="50" r="12" fill="#9B59B6" class="cursor-grab hover:scale-125 transition-transform shadow-md" style="filter: drop-shadow(0px 2px 2px rgba(0,0,0,0.3));" />
                        <circle cx="150" cy="50" r="4" fill="white" class="pointer-events-none" id="vertex-c-dot" />
                    </svg>
                </div>

                <div class="mt-6 flex flex-col items-center gap-2 w-full">
                    <div id="type-badge" class="bg-brand-purple text-white px-6 py-2 rounded-full font-black text-xl md:text-2xl uppercase tracking-wider shadow-md transition-all">
                        Is√≥sceles
                    </div>
                    <div class="flex gap-4 text-xs font-mono text-gray-500 mt-2">
                        <span>Lado A: <b id="side-a">?</b></span>
                        <span>Lado B: <b id="side-b">?</b></span>
                        <span>Lado C: <b id="side-c">?</b></span>
                    </div>
                </div>

                <div class="flex gap-2 mt-6">
                    <button id="btn-equi" class="text-xs font-bold border-2 border-brand-purple text-brand-purple px-3 py-1 rounded hover:bg-purple-50 transition-colors">Equil√°tero</button>
                    <button id="btn-iso" class="text-xs font-bold border-2 border-brand-purple text-brand-purple px-3 py-1 rounded hover:bg-purple-50 transition-colors">Is√≥sceles</button>
                    <button id="btn-esc" class="text-xs font-bold border-2 border-brand-purple text-brand-purple px-3 py-1 rounded hover:bg-purple-50 transition-colors">Escaleno</button>
                </div>
            </div>
        `;

                    // 2. Seletores
                    const svg = container.querySelector('#poly-svg');
                    const path = container.querySelector('#triangle-path');
                    const vertexC = container.querySelector('#vertex-c');
                    const vertexCDot = container.querySelector('#vertex-c-dot');
                    const ticksLayer = container.querySelector('#ticks-layer');
                    const badge = container.querySelector('#type-badge');

                    const sideADisplay = container.querySelector('#side-a');
                    const sideBDisplay = container.querySelector('#side-b');
                    const sideCDisplay = container.querySelector('#side-c');

                    // 3. Fun√ß√µes Matem√°ticas
                    const dist = (p1, p2) => Math.sqrt(Math.pow(p2.x - p1.x, 2) + Math.pow(p2.y - p1.y, 2));

                    // Desenha marca de congru√™ncia (tracinho) no meio da linha
                    const drawTick = (p1, p2, count) => {
                        const midX = (p1.x + p2.x) / 2;
                        const midY = (p1.y + p2.y) / 2;

                        // Vetor diretor da linha
                        const dx = p2.x - p1.x;
                        const dy = p2.y - p1.y;
                        const len = Math.sqrt(dx * dx + dy * dy);

                        // Vetor Normal (Perpendicular) unit√°rio
                        const nx = -dy / len;
                        const ny = dx / len;

                        const size = 6;
                        const gap = 4;
                        let svgStr = '';

                        // Desenha 'count' tracinhos
                        for (let i = 0; i < count; i++) {
                            // Offset para m√∫ltiplos tracinhos
                            const offset = (i - (count - 1) / 2) * gap;
                            // Move ao longo da linha
                            const startX = midX + (dx / len) * offset;
                            const startY = midY + (dy / len) * offset;

                            svgStr += `<line x1="${startX - nx * size}" y1="${startY - ny * size}" x2="${startX + nx * size}" y2="${startY + ny * size}" />`;
                        }
                        return svgStr;
                    };

                    const update = () => {
                        // Atualiza visual do v√©rtice
                        vertexC.setAttribute('cx', state.C.x);
                        vertexC.setAttribute('cy', state.C.y);
                        vertexCDot.setAttribute('cx', state.C.x);
                        vertexCDot.setAttribute('cy', state.C.y);

                        // Desenha Tri√¢ngulo
                        const d = `M ${state.A.x} ${state.A.y} L ${state.B.x} ${state.B.y} L ${state.C.x} ${state.C.y} Z`;
                        path.setAttribute('d', d);

                        // Calcula Lados (Dist√¢ncias)
                        const sideC_len = dist(state.A, state.B); // Base (fixa)
                        const sideB_len = dist(state.A, state.C); // Esq
                        const sideA_len = dist(state.B, state.C); // Dir

                        // Toler√¢ncia para "igualdade" (facilitar para o usu√°rio acertar com o mouse)
                        const tolerance = 5;

                        // Classifica√ß√£o
                        let type = "Escaleno";
                        let colorClass = "bg-brand-red"; // Escaleno (Vermelho/Laranja)
                        let tickCount = { a: 0, b: 0, c: 0 };

                        // Verifica igualdade com toler√¢ncia
                        const ab_eq = Math.abs(sideA_len - sideB_len) < tolerance;
                        const bc_eq = Math.abs(sideB_len - sideC_len) < tolerance;
                        const ac_eq = Math.abs(sideA_len - sideC_len) < tolerance;

                        if (ab_eq && bc_eq) {
                            type = "Equil√°tero";
                            colorClass = "bg-brand-green";
                            tickCount = { a: 1, b: 1, c: 1 }; // Todos lados com 1 tra√ßo
                        } else if (ab_eq || bc_eq || ac_eq) {
                            type = "Is√≥sceles";
                            colorClass = "bg-brand-purple";

                            // Define onde desenhar os tra√ßos duplos
                            if (ab_eq) { tickCount.a = 2; tickCount.b = 2; }
                            else if (bc_eq) { tickCount.b = 2; tickCount.c = 2; }
                            else if (ac_eq) { tickCount.a = 2; tickCount.c = 2; }
                        }

                        // Atualiza UI
                        badge.innerText = type;
                        badge.className = `${colorClass} text-white px-6 py-2 rounded-full font-black text-xl md:text-2xl uppercase tracking-wider shadow-md transition-all`;

                        // Exibe valores arredondados
                        sideADisplay.innerText = Math.round(sideA_len);
                        sideBDisplay.innerText = Math.round(sideB_len);
                        sideCDisplay.innerText = Math.round(sideC_len);

                        // Desenha Marcas (Tracinhos)
                        let ticksHTML = "";
                        if (tickCount.c > 0) ticksHTML += drawTick(state.A, state.B, tickCount.c); // Base
                        if (tickCount.b > 0) ticksHTML += drawTick(state.A, state.C, tickCount.b); // Esq
                        if (tickCount.a > 0) ticksHTML += drawTick(state.B, state.C, tickCount.a); // Dir
                        ticksLayer.innerHTML = ticksHTML;
                    };

                    // 4. Intera√ß√£o (Mouse/Touch)
                    const getSVGPos = (evt) => {
                        const pt = svg.createSVGPoint();
                        // Trata Touch vs Mouse
                        pt.x = evt.clientX || evt.touches[0].clientX;
                        pt.y = evt.clientY || evt.touches[0].clientY;
                        return pt.matrixTransform(svg.getScreenCTM().inverse());
                    };

                    const onMove = (e) => {
                        if (!state.isDragging) return;
                        // e.preventDefault(); // Evita scroll em mobile enquanto arrasta
                        const pos = getSVGPos(e);

                        // Limita a √°rea de desenho para n√£o sair do box
                        state.C.x = Math.max(10, Math.min(290, pos.x));
                        state.C.y = Math.max(10, Math.min(240, pos.y)); // N√£o deixa descer muito perto da base
                        update();
                    };

                    const onStart = (e) => { state.isDragging = true; vertexC.classList.add('cursor-grabbing'); };
                    const onEnd = (e) => { state.isDragging = false; vertexC.classList.remove('cursor-grabbing'); };

                    vertexC.addEventListener('mousedown', onStart);
                    vertexC.addEventListener('touchstart', onStart);

                    window.addEventListener('mousemove', onMove);
                    window.addEventListener('touchmove', onMove, { passive: false });

                    window.addEventListener('mouseup', onEnd);
                    window.addEventListener('touchend', onEnd);

                    // 5. Bot√µes de Atalho
                    const setShape = (cx, cy) => {
                        state.C = { x: cx, y: cy };
                        update();
                    };

                    // Posi√ß√µes pr√©-calculadas para garantir classifica√ß√£o exata
                    // Base est√° em Y=250, comprimento 200. Centro X=150.
                    // Altura Equil√°tero = 200 * (sqrt(3)/2) approx 173.2. Y = 250 - 173.2 = 76.8
                    container.querySelector('#btn-equi').onclick = () => setShape(150, 76.8);
                    container.querySelector('#btn-iso').onclick = () => setShape(150, 20); // Bem alto
                    container.querySelector('#btn-esc').onclick = () => setShape(50, 50); // Jogado para a esquerda

                    // Inicializa
                    update();
                },

                interactive_solids_viewer(container) {
                    // Banco de Dados dos S√≥lidos
                    const solids = {
                        cube: {
                            name: "Cubo (Hexaedro)",
                            type: "poly", // poly ou round
                            stats: { f: 6, v: 8, e: 12 },
                            color: "text-brand-blue",
                            // SVG do S√≥lido 3D
                            svg3d: `<path d="M20 20 L80 20 L80 80 L20 80 Z" fill="none" stroke="currentColor" stroke-width="2"/><path d="M20 20 L40 5 L100 5 L80 20" fill="none" stroke="currentColor" stroke-width="2"/><path d="M80 80 L100 65 L100 5" fill="none" stroke="currentColor" stroke-width="2"/><path d="M20 80 L40 65 L40 5" fill="none" stroke="currentColor" stroke-width="2" stroke-dasharray="4,2" class="opacity-50"/><path d="M40 65 L100 65" fill="none" stroke="currentColor" stroke-width="2" stroke-dasharray="4,2" class="opacity-50"/>`,
                            // SVG da Planifica√ß√£o (Net)
                            svg2d: `<rect x="40" y="40" width="20" height="20" fill="currentColor" fill-opacity="0.2" stroke="currentColor"/><rect x="40" y="20" width="20" height="20" fill="currentColor" fill-opacity="0.2" stroke="currentColor"/><rect x="40" y="60" width="20" height="20" fill="currentColor" fill-opacity="0.2" stroke="currentColor"/><rect x="40" y="80" width="20" height="20" fill="currentColor" fill-opacity="0.2" stroke="currentColor"/><rect x="20" y="40" width="20" height="20" fill="currentColor" fill-opacity="0.2" stroke="currentColor"/><rect x="60" y="40" width="20" height="20" fill="currentColor" fill-opacity="0.2" stroke="currentColor"/>`
                        },
                        pyramid: {
                            name: "Pir√¢mide Quadrangular",
                            type: "poly",
                            stats: { f: 5, v: 5, e: 8 },
                            color: "text-brand-purple",
                            svg3d: `<path d="M20 70 L80 70 L50 10 Z" fill="none" stroke="currentColor" stroke-width="2"/><path d="M20 70 L40 50 L80 70" fill="none" stroke="currentColor" stroke-width="2" stroke-dasharray="4,2" class="opacity-50"/><path d="M40 50 L50 10" fill="none" stroke="currentColor" stroke-width="2" stroke-dasharray="4,2" class="opacity-50"/>`,
                            svg2d: `<rect x="40" y="40" width="20" height="20" fill="currentColor" fill-opacity="0.2" stroke="currentColor"/><path d="M40 40 L50 20 L60 40 Z" fill="currentColor" fill-opacity="0.2" stroke="currentColor"/><path d="M40 60 L50 80 L60 60 Z" fill="currentColor" fill-opacity="0.2" stroke="currentColor"/><path d="M40 40 L20 50 L40 60 Z" fill="currentColor" fill-opacity="0.2" stroke="currentColor"/><path d="M60 40 L80 50 L60 60 Z" fill="currentColor" fill-opacity="0.2" stroke="currentColor"/>`
                        },
                        cylinder: {
                            name: "Cilindro",
                            type: "round",
                            stats: { desc: "N√£o tem v√©rtices" },
                            color: "text-brand-orange",
                            svg3d: `<ellipse cx="50" cy="20" rx="30" ry="10" fill="none" stroke="currentColor" stroke-width="2"/><path d="M20 20 L20 80" stroke="currentColor" stroke-width="2"/><path d="M80 20 L80 80" stroke="currentColor" stroke-width="2"/><ellipse cx="50" cy="80" rx="30" ry="10" fill="none" stroke="currentColor" stroke-width="2"/>`,
                            svg2d: `<rect x="20" y="30" width="60" height="40" fill="currentColor" fill-opacity="0.2" stroke="currentColor"/><circle cx="50" cy="15" r="10" fill="currentColor" fill-opacity="0.2" stroke="currentColor"/><circle cx="50" cy="85" r="10" fill="currentColor" fill-opacity="0.2" stroke="currentColor"/>`
                        },
                        cone: {
                            name: "Cone",
                            type: "round",
                            stats: { desc: "1 V√©rtice (√Åpice)" },
                            color: "text-brand-green",
                            svg3d: `<ellipse cx="50" cy="80" rx="30" ry="10" fill="none" stroke="currentColor" stroke-width="2"/><path d="M20 80 L50 10 L80 80" stroke="currentColor" stroke-width="2"/>`,
                            svg2d: `<circle cx="50" cy="70" r="15" fill="currentColor" fill-opacity="0.2" stroke="currentColor"/><path d="M50 70 L10 20 A 50 50 0 0 1 90 20 Z" fill="currentColor" fill-opacity="0.2" stroke="currentColor" transform="translate(0, -10) scale(0.8)"/>`
                        },
                        sphere: {
                            name: "Esfera",
                            type: "round",
                            stats: { desc: "Sem faces planas" },
                            color: "text-brand-red",
                            svg3d: `<circle cx="50" cy="50" r="35" fill="none" stroke="currentColor" stroke-width="2"/><ellipse cx="50" cy="50" rx="35" ry="10" fill="none" stroke="currentColor" stroke-width="1" stroke-dasharray="4,2"/>`,
                            svg2d: `<text x="50" y="55" text-anchor="middle" font-size="10" fill="currentColor">N√£o planific√°vel</text><circle cx="50" cy="50" r="35" fill="none" stroke="currentColor" stroke-width="2" stroke-dasharray="4,2"/>`
                        }
                    };

                    let currentSolid = 'cube';
                    let isFlat = false; // Modo Planifica√ß√£o

                    // 1. HTML
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col md:flex-row gap-6 w-full shadow-sm font-sans">
                
                <div class="flex flex-row md:flex-col gap-2 overflow-x-auto md:w-1/4 pb-2 md:pb-0">
                    <button data-id="cube" class="solid-btn bg-blue-50 text-brand-blue p-3 rounded-xl border-2 border-brand-blue flex items-center justify-center gap-2 hover:bg-blue-100 transition-all">
                        <i class="fas fa-cube"></i> <span class="hidden md:inline text-xs font-bold">Cubo</span>
                    </button>
                    <button data-id="pyramid" class="solid-btn bg-white text-gray-500 p-3 rounded-xl border-2 border-transparent flex items-center justify-center gap-2 hover:bg-gray-100 transition-all">
                        <i class="fas fa-caret-up"></i> <span class="hidden md:inline text-xs font-bold">Pir√¢mide</span>
                    </button>
                    <button data-id="cylinder" class="solid-btn bg-white text-gray-500 p-3 rounded-xl border-2 border-transparent flex items-center justify-center gap-2 hover:bg-gray-100 transition-all">
                        <i class="fas fa-database"></i> <span class="hidden md:inline text-xs font-bold">Cilindro</span>
                    </button>
                    <button data-id="cone" class="solid-btn bg-white text-gray-500 p-3 rounded-xl border-2 border-transparent flex items-center justify-center gap-2 hover:bg-gray-100 transition-all">
                        <i class="fas fa-filter"></i> <span class="hidden md:inline text-xs font-bold">Cone</span>
                    </button>
                    <button data-id="sphere" class="solid-btn bg-white text-gray-500 p-3 rounded-xl border-2 border-transparent flex items-center justify-center gap-2 hover:bg-gray-100 transition-all">
                        <i class="fas fa-globe"></i> <span class="hidden md:inline text-xs font-bold">Esfera</span>
                    </button>
                </div>

                <div class="flex-1 flex flex-col items-center justify-center bg-gray-50 rounded-xl border-2 border-gray-100 p-6 relative min-h-[250px]">
                    
                    <div id="type-badge" class="absolute top-4 left-4 text-[10px] font-black uppercase tracking-wider bg-brand-blue text-white px-2 py-1 rounded shadow-sm">
                        Poliedro
                    </div>

                    <div id="svg-container" class="w-40 h-40 transition-all duration-500 text-brand-blue">
                        </div>

                    <button id="btn-toggle-view" class="absolute bottom-4 right-4 text-xs font-bold text-gray-400 bg-white px-3 py-1 rounded border border-gray-200 hover:text-brand-blue hover:border-brand-blue transition-colors flex items-center gap-2 shadow-sm">
                        <i class="fas fa-expand-arrows-alt"></i> <span>Planificar</span>
                    </button>
                </div>

                <div class="md:w-1/3 flex flex-col gap-4">
                    <h3 id="solid-name" class="text-xl font-black text-brand-text leading-tight">Cubo</h3>
                    
                    <div id="stats-container" class="space-y-2">
                        </div>

                    <div id="poly-tip" class="bg-blue-50 p-3 rounded-lg border-l-4 border-brand-blue text-xs text-brand-text hidden">
                        <strong>Rela√ß√£o de Euler:</strong><br>
                        V + F = A + 2<br>
                        <span id="euler-calc" class="font-mono mt-1 block">8 + 6 = 12 + 2</span>
                    </div>
                     <div id="round-tip" class="bg-orange-50 p-3 rounded-lg border-l-4 border-brand-orange text-xs text-brand-text hidden">
                        <strong>Corpo Redondo:</strong><br>
                        Possui superf√≠cies curvas e pode rolar se colocado numa rampa.
                    </div>
                </div>
            </div>
        `;

                    // 2. Seletores
                    const svgContainer = container.querySelector('#svg-container');
                    const solidName = container.querySelector('#solid-name');
                    const typeBadge = container.querySelector('#type-badge');
                    const statsContainer = container.querySelector('#stats-container');
                    const polyTip = container.querySelector('#poly-tip');
                    const roundTip = container.querySelector('#round-tip');
                    const eulerCalc = container.querySelector('#euler-calc');
                    const btnToggle = container.querySelector('#btn-toggle-view');
                    const buttons = container.querySelectorAll('.solid-btn');

                    // 3. Atualiza√ß√£o
                    const update = () => {
                        const s = solids[currentSolid];
                        const isPoly = s.type === 'poly';

                        // SVG
                        svgContainer.className = `w-48 h-48 transition-all duration-500 ${s.color}`;
                        // Simula uma transi√ß√£o de morphing trocando o HTML
                        svgContainer.innerHTML = `<svg viewBox="0 0 100 100" class="w-full h-full drop-shadow-lg animate-fade-in">${isFlat ? s.svg2d : s.svg3d}</svg>`;

                        // Textos
                        solidName.innerText = s.name;
                        typeBadge.innerText = isPoly ? "Poliedro" : "Corpo Redondo";
                        typeBadge.className = `absolute top-4 left-4 text-[10px] font-black uppercase tracking-wider px-2 py-1 rounded shadow-sm text-white ${isPoly ? 'bg-brand-blue' : 'bg-brand-orange'}`;

                        // Bot√£o Planificar
                        btnToggle.innerHTML = isFlat ? `<i class="fas fa-box"></i> <span>Montar</span>` : `<i class="fas fa-expand-arrows-alt"></i> <span>Planificar</span>`;
                        if (currentSolid === 'sphere') btnToggle.style.display = 'none'; // Esfera n√£o planifica f√°cil
                        else btnToggle.style.display = 'flex';

                        // Stats
                        let statsHTML = '';
                        if (isPoly) {
                            statsHTML += `<div class="flex justify-between border-b border-gray-100 py-1"><span class="text-gray-400 font-bold text-xs uppercase">Faces</span><span class="font-bold">${s.stats.f}</span></div>`;
                            statsHTML += `<div class="flex justify-between border-b border-gray-100 py-1"><span class="text-gray-400 font-bold text-xs uppercase">V√©rtices</span><span class="font-bold">${s.stats.v}</span></div>`;
                            statsHTML += `<div class="flex justify-between border-b border-gray-100 py-1"><span class="text-gray-400 font-bold text-xs uppercase">Arestas</span><span class="font-bold">${s.stats.e}</span></div>`;

                            polyTip.classList.remove('hidden');
                            roundTip.classList.add('hidden');
                            eulerCalc.innerText = `${s.stats.v} + ${s.stats.f} = ${s.stats.e} + 2`;
                        } else {
                            statsHTML += `<div class="text-sm text-gray-500 italic">${s.stats.desc}</div>`;
                            polyTip.classList.add('hidden');
                            roundTip.classList.remove('hidden');
                        }
                        statsContainer.innerHTML = statsHTML;

                        // Atualiza Menu Ativo
                        buttons.forEach(btn => {
                            const active = btn.dataset.id === currentSolid;
                            if (active) {
                                btn.className = `solid-btn ${s.color.replace('text-', 'bg-').replace('blue', 'blue-50').replace('orange', 'orange-50').replace('purple', 'purple-50').replace('green', 'green-50').replace('red', 'red-50')} ${s.color} p-3 rounded-xl border-2 ${s.color.replace('text-', 'border-')} flex items-center justify-center gap-2 transition-all shadow-sm`;
                            } else {
                                btn.className = "solid-btn bg-white text-gray-400 p-3 rounded-xl border-2 border-transparent flex items-center justify-center gap-2 hover:bg-gray-50 transition-all";
                            }
                        });
                    };

                    // 4. Listeners
                    buttons.forEach(btn => {
                        btn.onclick = () => {
                            currentSolid = btn.dataset.id;
                            isFlat = false; // Reseta para 3D ao trocar
                            update();
                        }
                    });

                    btnToggle.onclick = () => {
                        isFlat = !isFlat;
                        update();
                    };

                    // Init
                    update();
                },

                interactive_unit_converter(container) {
                    // Estado
                    let state = {
                        type: 'm', // m (comprimento), g (massa), l (capacidade)
                        value: 1,
                        from: 3,   // √çndice inicial (0=k, 3=base, 6=m)
                        to: 5      // √çndice final
                    };

                    // Configura√ß√£o das Unidades
                    const unitsData = {
                        m: { name: "Comprimento", color: "text-brand-blue", border: "border-brand-blue", bg: "bg-blue-50", base: "m" },
                        g: { name: "Massa", color: "text-brand-orange", border: "border-brand-orange", bg: "bg-orange-50", base: "g" },
                        l: { name: "Capacidade", color: "text-brand-green", border: "border-brand-green", bg: "bg-green-50", base: "L" }
                    };

                    const prefixes = [
                        { p: 'k', n: 'Quilo' }, { p: 'h', n: 'Hecto' }, { p: 'da', n: 'Deca' },
                        { p: '', n: 'Base' },
                        { p: 'd', n: 'Deci' }, { p: 'c', n: 'Centi' }, { p: 'm', n: 'Mili' }
                    ];

                    // 1. HTML
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col items-center w-full shadow-sm font-sans select-none">
                
                <div class="flex bg-gray-100 p-1 rounded-lg mb-6 gap-1 w-full max-w-sm">
                    <button data-type="m" class="type-btn flex-1 py-2 rounded-md text-xs font-bold uppercase transition-all shadow-sm bg-white text-brand-blue">Metros</button>
                    <button data-type="g" class="type-btn flex-1 py-2 rounded-md text-xs font-bold uppercase transition-all text-gray-400 hover:bg-white">Gramas</button>
                    <button data-type="l" class="type-btn flex-1 py-2 rounded-md text-xs font-bold uppercase transition-all text-gray-400 hover:bg-white">Litros</button>
                </div>

                <div class="flex flex-col md:flex-row items-center gap-4 mb-8 w-full justify-center">
                    
                    <div class="flex flex-col items-center">
                        <label class="text-[10px] font-bold text-gray-400 uppercase">Valor</label>
                        <input type="number" id="val-input" value="1" class="w-24 text-center border-b-2 border-brand-gray focus:border-brand-blue outline-none text-2xl font-bold bg-transparent text-brand-text">
                    </div>

                    <div class="flex flex-col items-center">
                        <label class="text-[10px] font-bold text-gray-400 uppercase">De</label>
                        <select id="sel-from" class="bg-gray-50 border border-gray-200 text-brand-text text-sm rounded-lg focus:ring-brand-blue focus:border-brand-blue block p-2.5 font-bold cursor-pointer outline-none">
                            </select>
                    </div>

                    <i class="fas fa-arrow-right text-gray-300 mx-2"></i>

                    <div class="flex flex-col items-center">
                        <label class="text-[10px] font-bold text-gray-400 uppercase">Para</label>
                        <select id="sel-to" class="bg-gray-50 border border-gray-200 text-brand-text text-sm rounded-lg focus:ring-brand-blue focus:border-brand-blue block p-2.5 font-bold cursor-pointer outline-none">
                            </select>
                    </div>
                </div>

                <div class="w-full overflow-x-auto pb-4 mb-4">
                    <div class="flex justify-between items-center min-w-[320px] px-4 relative h-20" id="ruler-container">
                        <div class="absolute top-1/2 left-4 right-4 h-1 bg-gray-200 -z-10 rounded"></div>
                        <div id="jump-path" class="absolute top-1/2 h-1 bg-brand-blue -z-0 transition-all duration-500 rounded opacity-50"></div>
                        
                        </div>
                </div>

                <div class="w-full bg-gray-50 rounded-xl border border-gray-200 p-4 flex flex-col items-center text-center transition-colors duration-300" id="res-box">
                    <div class="text-xs font-bold text-gray-400 uppercase mb-1">Resultado</div>
                    <div class="text-4xl font-mono font-bold text-brand-text mb-2 break-all" id="res-val">100</div>
                    
                    <div class="text-sm font-medium text-gray-600 bg-white px-3 py-1 rounded-full border border-gray-100 shadow-sm">
                        <span id="logic-steps">2 pulos para a direita</span> 
                        <span class="text-brand-blue font-bold mx-1">‚Üí</span> 
                        <span id="logic-math">√ó 100</span>
                    </div>
                </div>

            </div>
        `;

                    // 2. Seletores
                    const typeBtns = container.querySelectorAll('.type-btn');
                    const valInput = container.querySelector('#val-input');
                    const selFrom = container.querySelector('#sel-from');
                    const selTo = container.querySelector('#sel-to');
                    const ruler = container.querySelector('#ruler-container');
                    const jumpPath = container.querySelector('#jump-path');
                    const resVal = container.querySelector('#res-val');
                    const resBox = container.querySelector('#res-box');
                    const logicSteps = container.querySelector('#logic-steps');
                    const logicMath = container.querySelector('#logic-math');

                    // 3. Fun√ß√µes Auxiliares
                    const getUnitList = () => prefixes.map((p, i) => ({
                        val: i,
                        label: `${p.p}${unitsData[state.type].base}`,
                        desc: `${p.n}${unitsData[state.type].name.toLowerCase().slice(0, 5)}` // Ex: Quilometro
                    }));

                    const renderOptions = () => {
                        const list = getUnitList();
                        const opts = list.map(u => `<option value="${u.val}">${u.label}</option>`).join('');
                        selFrom.innerHTML = opts;
                        selTo.innerHTML = opts;
                        selFrom.value = state.from;
                        selTo.value = state.to;
                    };

                    const renderRuler = () => {
                        // Limpa apenas os itens (mant√©m as linhas de fundo)
                        const existingItems = ruler.querySelectorAll('.unit-item');
                        existingItems.forEach(e => e.remove());

                        const list = getUnitList();
                        const currentStyle = unitsData[state.type];

                        list.forEach(u => {
                            const el = document.createElement('div');
                            el.className = "unit-item flex flex-col items-center gap-1 cursor-pointer transition-transform hover:scale-110 z-10";
                            el.dataset.idx = u.val;

                            // Bolinha
                            const circle = document.createElement('div');
                            circle.className = `w-4 h-4 rounded-full border-2 bg-white transition-colors duration-300 ${u.val === state.from || u.val === state.to ? currentStyle.border + ' ' + currentStyle.bg : 'border-gray-300'}`;

                            // Texto
                            const label = document.createElement('span');
                            label.className = `text-xs font-bold ${u.val === state.from || u.val === state.to ? currentStyle.color : 'text-gray-400'}`;
                            label.innerText = u.label;

                            el.appendChild(circle);
                            el.appendChild(label);

                            // Clique r√°pido na r√©gua
                            el.onclick = () => {
                                // L√≥gica simples: clica no destino
                                state.to = u.val;
                                selTo.value = u.val;
                                update();
                            };

                            ruler.appendChild(el);
                        });
                    };

                    const update = () => {
                        // Atualiza inputs
                        state.value = parseFloat(valInput.value) || 0;
                        state.from = parseInt(selFrom.value);
                        state.to = parseInt(selTo.value);

                        // C√°lculos
                        const diff = state.to - state.from; // Positivo = Direita, Negativo = Esquerda
                        const steps = Math.abs(diff);
                        const factor = Math.pow(10, steps);

                        // Resultado (Evita erros de ponto flutuante tipo 0.300004)
                        let result;
                        if (diff > 0) result = state.value * factor;
                        else result = state.value / factor;

                        // Limpeza de float
                        result = parseFloat(result.toPrecision(12));

                        // Atualiza UI Texto
                        resVal.innerText = result.toString().replace('.', ','); // Padr√£o BR

                        const currentData = unitsData[state.type];
                        resVal.className = `text-4xl font-mono font-bold mb-2 break-all ${currentData.color}`;
                        resBox.className = `w-full rounded-xl border p-4 flex flex-col items-center text-center transition-colors duration-300 ${currentData.bg} ${currentData.border.replace('border-', 'border-opacity-30 ')}`;

                        // Texto L√≥gico
                        if (diff === 0) {
                            logicSteps.innerText = "Mesma unidade";
                            logicMath.innerText = "√ó 1";
                        } else {
                            const direction = diff > 0 ? "direita" : "esquerda";
                            const op = diff > 0 ? "√ó" : "√∑";
                            // Pluraliza√ß√£o
                            const stepText = steps === 1 ? "pulo" : "pulos";
                            logicSteps.innerText = `${steps} ${stepText} para a ${direction}`;
                            logicMath.innerText = `${op} ${factor}`;
                        }

                        // Atualiza R√©gua Visual
                        renderRuler(); // Re-renderiza para atualizar cores

                        // Anima√ß√£o da Linha de Salto
                        // Precisamos das posi√ß√µes dos elementos
                        const items = ruler.querySelectorAll('.unit-item');
                        if (items[state.from] && items[state.to]) {
                            const startEl = items[Math.min(state.from, state.to)];
                            const endEl = items[Math.max(state.from, state.to)];

                            // Posi√ß√£o relativa ao container
                            const startX = startEl.offsetLeft + (startEl.offsetWidth / 2);
                            const endX = endEl.offsetLeft + (endEl.offsetWidth / 2);
                            const width = endX - startX;

                            jumpPath.style.left = `${startX}px`;
                            jumpPath.style.width = `${width}px`;
                            jumpPath.className = `absolute top-1/2 h-1 -z-0 transition-all duration-500 rounded opacity-50 ${currentData.bg.replace('bg-', 'bg-brand-')}`; // Gambiarra de cor, ideal usar cor direta

                            // Ajuste de cor manual para a barra
                            if (state.type === 'm') jumpPath.style.backgroundColor = '#1CB0F6';
                            if (state.type === 'g') jumpPath.style.backgroundColor = '#FF9600';
                            if (state.type === 'l') jumpPath.style.backgroundColor = '#58CC02';
                        }
                    };

                    // 4. Listeners

                    // Troca de Tipo (Abas)
                    typeBtns.forEach(btn => {
                        btn.onclick = () => {
                            state.type = btn.dataset.type;

                            // Atualiza estilo das abas
                            typeBtns.forEach(b => {
                                const active = b.dataset.type === state.type;
                                const style = unitsData[state.type];
                                if (active) {
                                    b.className = `type-btn flex-1 py-2 rounded-md text-xs font-bold uppercase transition-all shadow-sm bg-white ${style.color}`;
                                } else {
                                    b.className = `type-btn flex-1 py-2 rounded-md text-xs font-bold uppercase transition-all text-gray-400 hover:bg-white`;
                                }
                            });

                            renderOptions();
                            renderRuler();
                            update();
                        }
                    });

                    valInput.addEventListener('input', update);
                    selFrom.addEventListener('change', update);
                    selTo.addEventListener('change', update);

                    // Inicializa
                    renderOptions();
                    renderRuler();
                    update();
                },

                interactive_clock_math(container) {
                    // Estado inicial
                    let state = {
                        h: 2,
                        m: 30
                    };

                    // 1. INJE√á√ÉO DO HTML
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col md:flex-row items-center justify-center gap-8 w-full shadow-sm font-sans select-none">
                
                <div class="relative w-48 h-48 md:w-56 md:h-56 shrink-0 bg-white rounded-full border-4 border-gray-200 shadow-inner flex items-center justify-center">
                    
                    <svg class="absolute inset-0 w-full h-full text-gray-300" viewBox="0 0 100 100">
                        ${[...Array(12)].map((_, i) => {
                        const deg = i * 30;
                        return `<line x1="50" y1="10" x2="50" y2="15" stroke="currentColor" stroke-width="2" transform="rotate(${deg} 50 50)" />`;
                    }).join('')}
                    </svg>

                    <div class="absolute top-2 text-xs font-bold text-gray-400">12</div>
                    <div class="absolute bottom-2 text-xs font-bold text-gray-400">6</div>
                    <div class="absolute left-2 text-xs font-bold text-gray-400">9</div>
                    <div class="absolute right-2 text-xs font-bold text-gray-400">3</div>

                    <div id="hand-h" class="absolute w-1.5 h-14 bg-brand-blue rounded-full origin-bottom" style="bottom: 50%; left: calc(50% - 3px); transform: rotate(0deg); transition: transform 0.5s cubic-bezier(0.4, 2.08, 0.55, 0.44);"></div>

                    <div id="hand-m" class="absolute w-1 h-20 bg-brand-orange rounded-full origin-bottom" style="bottom: 50%; left: calc(50% - 2px); transform: rotate(0deg); transition: transform 0.5s cubic-bezier(0.4, 2.08, 0.55, 0.44);"></div>
                    
                    <div class="absolute w-4 h-4 bg-brand-text rounded-full border-2 border-white z-10"></div>
                </div>

                <div class="flex flex-col items-center w-full max-w-xs">
                    
                    <h3 class="text-brand-text font-bold uppercase text-xs tracking-widest mb-4">Conversor de Tempo</h3>

                    <div class="flex items-center gap-2 mb-6 text-4xl font-mono font-bold">
                        <div class="flex flex-col items-center">
                            <input type="number" id="in-h" value="2" min="0" max="23" class="w-16 text-center border-b-2 border-brand-blue text-brand-blue outline-none focus:bg-blue-50 transition-colors">
                            <span class="text-[10px] text-gray-400 uppercase font-sans mt-1">Horas</span>
                        </div>
                        <span class="text-gray-300 pb-4">:</span>
                        <div class="flex flex-col items-center">
                            <input type="number" id="in-m" value="30" min="0" max="59" class="w-16 text-center border-b-2 border-brand-orange text-brand-orange outline-none focus:bg-orange-50 transition-colors">
                            <span class="text-[10px] text-gray-400 uppercase font-sans mt-1">Min</span>
                        </div>
                    </div>

                    <div class="bg-gray-50 rounded-xl border border-gray-200 p-4 w-full mb-4">
                        <div class="text-[10px] font-bold text-gray-400 uppercase mb-2 text-center">Total em Minutos</div>
                        <div class="flex flex-col gap-1 font-mono text-sm md:text-base text-gray-600">
                            <div class="flex justify-between items-center border-b border-gray-200 pb-1">
                                <span><span class="text-brand-blue font-bold" id="math-h">2</span> √ó 60</span>
                                <span class="font-bold" id="math-h-res">120</span>
                            </div>
                            <div class="flex justify-between items-center text-brand-orange">
                                <span>+ <span class="font-bold" id="math-m">30</span></span>
                                <span class="font-bold" id="math-m-res">30</span>
                            </div>
                            <div class="flex justify-between items-center pt-1 border-t-2 border-gray-300 font-bold text-xl text-brand-green">
                                <span>Total</span>
                                <span id="math-total">150 min</span>
                            </div>
                        </div>
                    </div>

                    <div class="flex gap-2 w-full">
                        <button class="add-btn flex-1 bg-white border border-gray-200 text-gray-500 font-bold py-2 rounded-lg text-xs hover:bg-gray-100 active:scale-95 transition-all" data-add="15">+15m</button>
                        <button class="add-btn flex-1 bg-white border border-gray-200 text-gray-500 font-bold py-2 rounded-lg text-xs hover:bg-gray-100 active:scale-95 transition-all" data-add="30">+30m</button>
                        <button class="add-btn flex-1 bg-white border border-gray-200 text-gray-500 font-bold py-2 rounded-lg text-xs hover:bg-gray-100 active:scale-95 transition-all" data-add="60">+1h</button>
                    </div>

                </div>
            </div>
        `;

                    // 2. SELETORES
                    const handH = container.querySelector('#hand-h');
                    const handM = container.querySelector('#hand-m');
                    const inH = container.querySelector('#in-h');
                    const inM = container.querySelector('#in-m');

                    const mathH = container.querySelector('#math-h');
                    const mathHRes = container.querySelector('#math-h-res');
                    const mathM = container.querySelector('#math-m');
                    const mathMRes = container.querySelector('#math-m-res');
                    const mathTotal = container.querySelector('#math-total');

                    const addBtns = container.querySelectorAll('.add-btn');

                    // 3. ATUALIZA√á√ÉO
                    const update = () => {
                        // Normaliza√ß√£o (Se m > 60, converte para horas)
                        let rawH = parseInt(inH.value) || 0;
                        let rawM = parseInt(inM.value) || 0;

                        // Ajuste de "wrap around" (ex: 65 min -> 1h 05min)
                        // Mas s√≥ atualizamos os inputs se o usu√°rio n√£o estiver digitando ativamente neles (para n√£o bugar a UX)
                        // Aqui vamos assumir que state √© a fonte da verdade

                        // C√°lculos para o Rel√≥gio
                        const totalMin = (rawH * 60) + rawM;

                        // Rota√ß√£o Ponteiros
                        // Minutos: 6 graus por minuto
                        const degM = rawM * 6;
                        // Horas: 30 graus por hora + 0.5 graus por minuto
                        const degH = (rawH % 12) * 30 + (rawM * 0.5);

                        handM.style.transform = `rotate(${degM}deg)`;
                        handH.style.transform = `rotate(${degH}deg)`;

                        // C√°lculos da Tabela
                        mathH.innerText = rawH;
                        mathHRes.innerText = rawH * 60;
                        mathM.innerText = `+ ${rawM}`;
                        mathMRes.innerText = rawM;
                        mathTotal.innerText = `${totalMin} min`;
                    };

                    // 4. INTERA√á√ÉO
                    // Inputs manuais
                    inH.addEventListener('input', update);
                    inM.addEventListener('input', update);

                    // Bot√µes de Soma (L√≥gica de Rel√≥gio)
                    addBtns.forEach(btn => {
                        btn.onclick = () => {
                            let h = parseInt(inH.value) || 0;
                            let m = parseInt(inM.value) || 0;
                            const add = parseInt(btn.dataset.add);

                            m += add;

                            // L√≥gica de "Vai um" (Carry over)
                            while (m >= 60) {
                                m -= 60;
                                h++;
                            }

                            // Atualiza Inputs e Estado
                            inH.value = h;
                            inM.value = m;
                            update();
                        }
                    });

                    // Init
                    update();
                },

                interactive_area_calc(container) {
                    // Estado
                    let shape = 'rect'; // rect, tri, circle
                    let dims = { w: 10, h: 6, b: 8, r: 5 }; // Valores Iniciais

                    // Configura√ß√£o Visual por forma
                    const configs = {
                        rect: { name: 'Ret√¢ngulo', color: 'text-brand-blue', fill: 'fill-blue-100', stroke: 'stroke-brand-blue' },
                        tri: { name: 'Tri√¢ngulo', color: 'text-brand-orange', fill: 'fill-orange-100', stroke: 'stroke-brand-orange' },
                        circle: { name: 'C√≠rculo', color: 'text-brand-green', fill: 'fill-green-100', stroke: 'stroke-brand-green' }
                    };

                    // 1. Inje√ß√£o do HTML
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col items-center w-full shadow-sm font-sans select-none">
                <h3 class="text-brand-blue font-bold uppercase text-xs tracking-widest mb-4">Calculadora de √Åreas</h3>

                <div class="flex gap-2 mb-6 bg-gray-50 p-1 rounded-lg w-full max-w-xs justify-center">
                    <button data-s="rect" class="shape-btn flex-1 py-2 rounded-md text-xs font-bold uppercase transition-all bg-white text-brand-blue shadow-sm">Ret√¢ngulo</button>
                    <button data-s="tri" class="shape-btn flex-1 py-2 rounded-md text-xs font-bold uppercase transition-all text-gray-400 hover:bg-white">Tri√¢ngulo</button>
                    <button data-s="circle" class="shape-btn flex-1 py-2 rounded-md text-xs font-bold uppercase transition-all text-gray-400 hover:bg-white">C√≠rculo</button>
                </div>

                <div class="flex flex-col md:flex-row gap-8 items-center justify-center w-full">
                    
                    <div class="relative w-64 h-64 bg-gray-50 rounded-xl border-2 border-dashed border-gray-200 flex items-center justify-center overflow-hidden">
                        <svg id="area-svg" width="240" height="240" viewBox="0 0 240 240" class="transition-all duration-500">
                            </svg>
                        
                        <div class="absolute inset-0 opacity-10 pointer-events-none" style="background-image: radial-gradient(#000 1px, transparent 1px); background-size: 20px 20px;"></div>
                    </div>

                    <div class="flex flex-col gap-4 w-full max-w-xs">
                        
                        <div id="inputs-area" class="flex flex-col gap-3 bg-white p-2 rounded-lg">
                            </div>

                        <div class="bg-blue-50 rounded-xl p-4 border border-blue-100 transition-colors duration-300" id="result-card">
                            <div class="flex justify-between items-end mb-2">
                                <div class="text-[10px] font-bold text-gray-400 uppercase">F√≥rmula</div>
                                <div id="formula-display" class="font-mono text-sm text-brand-blue font-bold">A = b √ó h</div>
                            </div>
                            
                            <div class="w-full h-px bg-current opacity-20 mb-3"></div>
                            
                            <div class="text-[10px] font-bold text-gray-400 uppercase mb-1">C√°lculo</div>
                            <div id="calc-display" class="font-mono text-sm text-gray-600 mb-2">10 √ó 6</div>
                            <div id="res-display" class="text-3xl font-bold text-brand-blue">60</div>
                            <div class="text-xs text-right text-gray-400 font-bold mt-1">unidades quadradas</div>
                        </div>
                    </div>
                </div>
            </div>
        `;

                    // 2. Seletores
                    const svg = container.querySelector('#area-svg');
                    const inputsArea = container.querySelector('#inputs-area');
                    const formulaDisplay = container.querySelector('#formula-display');
                    const calcDisplay = container.querySelector('#calc-display');
                    const resDisplay = container.querySelector('#res-display');
                    const resultCard = container.querySelector('#result-card');
                    const shapeBtns = container.querySelectorAll('.shape-btn');

                    // 3. Helper de Cria√ß√£o de Input
                    const createInput = (id, label, val, max = 20) => `
            <div class="flex items-center justify-between group">
                <label class="text-xs font-bold text-gray-400 uppercase group-hover:text-brand-blue transition-colors">${label}</label>
                <div class="flex items-center gap-2">
                    <input type="range" id="${id}-range" value="${val}" min="1" max="${max}" class="w-20 h-1 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-brand-blue">
                    <input type="number" id="${id}" value="${val}" min="1" max="${max}" class="dim-input w-12 text-center border-b-2 border-gray-200 focus:border-brand-blue outline-none font-bold text-lg bg-transparent text-brand-text">
                </div>
            </div>
        `;

                    // 4. Renderiza√ß√£o da UI (Inputs e Bot√µes)
                    const updateUI = () => {
                        const style = configs[shape];

                        // Atualiza Bot√µes
                        shapeBtns.forEach(btn => {
                            if (btn.dataset.s === shape) {
                                btn.className = `shape-btn flex-1 py-2 rounded-md text-xs font-bold uppercase transition-all bg-white ${style.color} shadow-sm ring-1 ring-gray-200`;
                            } else {
                                btn.className = "shape-btn flex-1 py-2 rounded-md text-xs font-bold uppercase transition-all text-gray-400 hover:bg-white hover:text-gray-500";
                            }
                        });

                        // Atualiza Card de Resultado (Cores)
                        resultCard.className = `rounded-xl p-4 border transition-colors duration-300 ${style.fill.replace('fill-', 'bg-')} ${style.stroke.replace('stroke-', 'border-').replace('text-', 'border-opacity-30 ')}`;
                        formulaDisplay.className = `font-mono text-sm font-bold ${style.color}`;
                        resDisplay.className = `text-3xl font-bold ${style.color}`;

                        // Gera Inputs
                        let htmlInputs = '';
                        if (shape === 'rect') {
                            htmlInputs += createInput('in-w', 'Base (b)', dims.w);
                            htmlInputs += createInput('in-h', 'Altura (h)', dims.h);
                        } else if (shape === 'tri') {
                            htmlInputs += createInput('in-b', 'Base (b)', dims.b);
                            htmlInputs += createInput('in-h', 'Altura (h)', dims.h); // Altura menor para caber no tri√¢ngulo
                        } else if (shape === 'circle') {
                            htmlInputs += createInput('in-r', 'Raio (r)', dims.r, 10); // Raio m√°x 10 (diametro 20)
                        }
                        inputsArea.innerHTML = htmlInputs;

                        // Re-adiciona Listeners aos novos inputs
                        // Sincroniza Slider e Number Input
                        container.querySelectorAll('.dim-input').forEach(input => {
                            const range = container.querySelector(`#${input.id}-range`);

                            // Fun√ß√£o √∫nica de atualiza√ß√£o
                            const sync = (val) => {
                                val = parseFloat(val) || 0;
                                if (shape === 'rect') {
                                    if (input.id === 'in-w') dims.w = val;
                                    if (input.id === 'in-h') dims.h = val;
                                } else if (shape === 'tri') {
                                    if (input.id === 'in-b') dims.b = val;
                                    if (input.id === 'in-h') dims.h = val; // Altura
                                } else if (shape === 'circle') {
                                    if (input.id === 'in-r') dims.r = val;
                                }
                                draw();
                            };

                            input.addEventListener('input', (e) => {
                                range.value = e.target.value;
                                sync(e.target.value);
                            });

                            range.addEventListener('input', (e) => {
                                input.value = e.target.value;
                                sync(e.target.value);
                            });
                        });

                        draw();
                    };

                    // 5. Desenho e C√°lculo
                    const draw = () => {
                        // Escala: O SVG √© 240x240. Vamos dizer que 1 unidade = 10px.
                        // Centro √© 120, 120.
                        const scale = 10;
                        const center = 120;
                        const style = configs[shape];

                        svg.innerHTML = '';
                        let res = 0;
                        let formula = '';
                        let calc = '';
                        let svgContent = '';

                        if (shape === 'rect') {
                            const wPx = dims.w * scale;
                            const hPx = dims.h * scale;
                            const x = center - wPx / 2;
                            const y = center - hPx / 2;

                            svgContent = `<rect x="${x}" y="${y}" width="${wPx}" height="${hPx}" class="${style.fill} ${style.stroke}" stroke-width="3" rx="4" />`;

                            // Labels de Dimens√£o
                            svgContent += `<text x="${center}" y="${y - 8}" text-anchor="middle" class="text-xs fill-gray-400 font-bold">${dims.w}</text>`;
                            svgContent += `<text x="${x + wPx + 8}" y="${center}" text-anchor="start" class="text-xs fill-gray-400 font-bold">${dims.h}</text>`;

                            res = dims.w * dims.h;
                            formula = 'A = b √ó h';
                            calc = `${dims.w} √ó ${dims.h}`;

                        } else if (shape === 'tri') {
                            const bPx = dims.b * scale;
                            const hPx = dims.h * scale; // Altura visual
                            // Tri√¢ngulo Is√≥sceles centralizado
                            const x1 = center - bPx / 2;
                            const x2 = center + bPx / 2;
                            const yBase = center + hPx / 2;
                            const yTop = center - hPx / 2;

                            svgContent = `<polygon points="${x1},${yBase} ${x2},${yBase} ${center},${yTop}" class="${style.fill} ${style.stroke}" stroke-width="3" stroke-linejoin="round" />`;

                            // Linha da Altura (Tracejada)
                            svgContent += `<line x1="${center}" y1="${yTop}" x2="${center}" y2="${yBase}" stroke="#4B4B4B" stroke-dasharray="4,2" stroke-width="1" />`;

                            // Labels
                            svgContent += `<text x="${center}" y="${yBase + 15}" text-anchor="middle" class="text-xs fill-gray-400 font-bold">${dims.b}</text>`;
                            svgContent += `<text x="${center + 4}" y="${center}" text-anchor="start" class="text-xs fill-gray-500 font-bold" style="text-shadow: 0 0 2px white">h=${dims.h}</text>`;

                            res = (dims.b * dims.h) / 2;
                            formula = 'A = (b √ó h) / 2';
                            calc = `(${dims.b} √ó ${dims.h}) / 2`;

                        } else if (shape === 'circle') {
                            const rPx = dims.r * scale;

                            svgContent = `<circle cx="${center}" cy="${center}" r="${rPx}" class="${style.fill} ${style.stroke}" stroke-width="3" />`;

                            // Linha do Raio
                            svgContent += `<line x1="${center}" y1="${center}" x2="${center + rPx}" y2="${center}" stroke="#4B4B4B" stroke-width="2" />`;

                            // Ponto Central
                            svgContent += `<circle cx="${center}" cy="${center}" r="3" fill="#4B4B4B" />`;

                            // Label
                            svgContent += `<text x="${center + rPx / 2}" y="${center - 6}" text-anchor="middle" class="text-xs fill-gray-500 font-bold">r=${dims.r}</text>`;

                            res = Math.PI * Math.pow(dims.r, 2);
                            formula = 'A = œÄ √ó r¬≤';
                            calc = `3,14 √ó ${dims.r}¬≤`;
                            res = parseFloat(res.toFixed(2));
                        }

                        svg.innerHTML = svgContent;

                        // Updates Finais de Texto
                        formulaDisplay.innerText = formula;
                        calcDisplay.innerText = calc;
                        resDisplay.innerText = res.toString().replace('.', ',');
                    };

                    // Listener Global
                    shapeBtns.forEach(btn => {
                        btn.onclick = () => {
                            shape = btn.dataset.s;
                            updateUI();
                        };
                    });

                    // Init
                    updateUI();
                },

                interactive_volume_cube(container) {
                    // Estado Inicial
                    let dims = { w: 4, d: 3, h: 5 }; // Largura, Profundidade, Altura
                    let isFilling = false;

                    // 1. HTML
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col md:flex-row items-center gap-8 w-full shadow-sm font-sans select-none overflow-hidden">
                
                <div class="flex flex-col gap-6 w-full max-w-xs z-10">
                    <h3 class="text-brand-blue font-bold uppercase text-xs tracking-widest">Laborat√≥rio de Volume</h3>

                    <div class="space-y-4">
                        <div>
                            <div class="flex justify-between text-xs font-bold text-gray-400 uppercase mb-1">
                                <span>Comprimento (c)</span>
                                <span class="text-brand-blue"><span id="val-w">4</span> cm</span>
                            </div>
                            <input type="range" id="range-w" min="2" max="6" value="4" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-brand-blue">
                        </div>

                        <div>
                            <div class="flex justify-between text-xs font-bold text-gray-400 uppercase mb-1">
                                <span>Largura (l)</span>
                                <span class="text-brand-orange"><span id="val-d">3</span> cm</span>
                            </div>
                            <input type="range" id="range-d" min="2" max="6" value="3" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-brand-orange">
                        </div>

                        <div>
                            <div class="flex justify-between text-xs font-bold text-gray-400 uppercase mb-1">
                                <span>Altura (a)</span>
                                <span class="text-brand-green"><span id="val-h">5</span> cm</span>
                            </div>
                            <input type="range" id="range-h" min="2" max="6" value="5" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-brand-green">
                        </div>
                    </div>

                    <button id="btn-fill" class="bg-brand-blue hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-xl shadow-btn active:shadow-none active:translate-y-1 transition-all flex items-center justify-center gap-2">
                        <i class="fas fa-tint"></i>
                        <span id="btn-label">Encher de √Ågua</span>
                    </button>
                </div>

                <div class="flex-1 flex flex-col items-center justify-center min-h-[300px] w-full relative perspective-container">
                    
                    <div id="scene" class="relative transition-all duration-500" style="transform-style: preserve-3d; transform: rotateX(-20deg) rotateY(-30deg);">
                        
                        <div id="tank" class="relative transition-all duration-500" style="transform-style: preserve-3d;">
                            <div class="face back absolute border-2 border-brand-blue bg-blue-50 opacity-30"></div>
                            <div class="face left absolute border-2 border-brand-blue bg-blue-50 opacity-30"></div>
                            <div class="face bottom absolute border-2 border-brand-blue bg-blue-100 opacity-80"></div>

                            <div id="water" class="absolute bottom-0 left-0 transition-all duration-[2s] ease-in-out opacity-80" style="transform-style: preserve-3d; width: 100%; height: 0%;">
                                <div class="water-face front absolute bg-blue-400 opacity-60"></div>
                                <div class="water-face back absolute bg-blue-400 opacity-60"></div>
                                <div class="water-face right absolute bg-blue-500 opacity-60"></div>
                                <div class="water-face left absolute bg-blue-500 opacity-60"></div>
                                <div class="water-face top absolute bg-blue-300 opacity-90"></div>
                            </div>

                            <div class="face right absolute border-2 border-brand-blue bg-blue-50 opacity-20 pointer-events-none"></div>
                            <div class="face front absolute border-2 border-brand-blue bg-blue-50 opacity-10 pointer-events-none"></div>
                        </div>

                    </div>

                    <div class="mt-12 w-full max-w-xs bg-gray-50 border border-gray-200 rounded-xl p-3 flex justify-around text-center z-10">
                        <div>
                            <div class="text-[10px] font-bold text-gray-400 uppercase">Volume</div>
                            <div class="text-xl font-mono font-bold text-brand-text" id="res-vol">60 cm¬≥</div>
                        </div>
                        <div class="w-px bg-gray-200"></div>
                        <div>
                            <div class="text-[10px] font-bold text-gray-400 uppercase">Capacidade</div>
                            <div class="text-xl font-mono font-bold text-brand-blue" id="res-cap">60 mL</div>
                        </div>
                    </div>

                </div>
            </div>
        `;

                    // 2. CSS Din√¢mico (Para controlar o 3D)
                    const style = document.createElement('style');
                    style.innerHTML = `
            .perspective-container { perspective: 800px; }
            .face { position: absolute; box-sizing: border-box; }
            .water-face { position: absolute; box-sizing: border-box; }
            
            /* Posicionamento Din√¢mico via Vari√°veis CSS */
            #tank {
                width: var(--w-px);
                height: var(--h-px);
                /* Centraliza o ponto de rota√ß√£o no meio do cubo */
                transform-origin: 50% 50% calc(var(--d-px) / -2);
            }

            /* --- FACES DO TANQUE --- */
            .face.front  { width: var(--w-px); height: var(--h-px); transform: translateZ(0); }
            .face.back   { width: var(--w-px); height: var(--h-px); transform: translateZ(calc(var(--d-px) * -1)); }
            .face.right  { width: var(--d-px); height: var(--h-px); transform: rotateY(90deg) translateZ(calc(var(--d-px) / 2 + var(--w-px) - var(--d-px)/2)); } 
            /* Ajuste matem√°tico complexo simplificado: Right face pivot */
            /* Vamos usar transform-origin left para facilitar */
            
            /* Simplificando Transforms com Origin */
            .face.right { width: var(--d-px); height: var(--h-px); transform-origin: top right; right: 0; transform: rotateY(90deg); }
            .face.left  { width: var(--d-px); height: var(--h-px); transform-origin: top left; left: 0; transform: rotateY(-90deg); }
            .face.top    { width: var(--w-px); height: var(--d-px); transform-origin: top left; transform: rotateX(90deg); }
            .face.bottom { width: var(--w-px); height: var(--d-px); transform-origin: bottom left; bottom: 0; transform: rotateX(90deg); }

            /* --- √ÅGUA --- */
            .water-face.front { width: 100%; height: 100%; transform: translateZ(0); }
            .water-face.back  { width: 100%; height: 100%; transform: translateZ(calc(var(--d-px) * -1)); }
            .water-face.left  { width: var(--d-px); height: 100%; transform-origin: top left; left: 0; transform: rotateY(-90deg); }
            .water-face.right { width: var(--d-px); height: 100%; transform-origin: top right; right: 0; transform: rotateY(90deg); }
            .water-face.top   { width: 100%; height: var(--d-px); transform-origin: top left; top: 0; transform: rotateX(90deg); }
        `;
                    container.appendChild(style);

                    // 3. Seletores
                    const rW = container.querySelector('#range-w');
                    const rD = container.querySelector('#range-d');
                    const rH = container.querySelector('#range-h');

                    const vW = container.querySelector('#val-w');
                    const vD = container.querySelector('#val-d');
                    const vH = container.querySelector('#val-h');

                    const tank = container.querySelector('#tank');
                    const water = container.querySelector('#water');
                    const btnFill = container.querySelector('#btn-fill');
                    const btnLabel = container.querySelector('#btn-label');

                    const resVol = container.querySelector('#res-vol');
                    const resCap = container.querySelector('#res-cap');

                    // 4. L√≥gica de Atualiza√ß√£o
                    const update = () => {
                        // Atualiza inputs
                        dims.w = parseInt(rW.value);
                        dims.d = parseInt(rD.value);
                        dims.h = parseInt(rH.value);

                        // Atualiza Textos
                        vW.innerText = dims.w;
                        vD.innerText = dims.d;
                        vH.innerText = dims.h;

                        // Calcula Volume
                        const vol = dims.w * dims.d * dims.h;
                        resVol.innerText = `${vol} cm¬≥`;
                        resCap.innerText = `${vol} mL`; // 1 cm¬≥ = 1 mL

                        // Atualiza CSS Variables para redimensionar o 3D
                        const scale = 30; // 1cm = 30px
                        tank.style.setProperty('--w-px', `${dims.w * scale}px`);
                        tank.style.setProperty('--d-px', `${dims.d * scale}px`);
                        tank.style.setProperty('--h-px', `${dims.h * scale}px`);
                    };

                    // 5. A√ß√£o de Encher
                    btnFill.onclick = () => {
                        isFilling = !isFilling;
                        if (isFilling) {
                            water.style.height = "100%"; // Enche at√© o topo
                            btnLabel.innerText = "Esvaziar";
                            btnFill.classList.replace('bg-brand-blue', 'bg-brand-red');
                            btnFill.classList.replace('hover:bg-blue-600', 'hover:bg-red-600');
                        } else {
                            water.style.height = "0%"; // Esvazia
                            btnLabel.innerText = "Encher de √Ågua";
                            btnFill.classList.replace('bg-brand-red', 'bg-brand-blue');
                            btnFill.classList.replace('hover:bg-red-600', 'hover:bg-blue-600');
                        }
                    };

                    // Listeners
                    [rW, rD, rH].forEach(el => el.addEventListener('input', update));

                    // Init
                    update();
                },

                interactive_charts_demo(container) {
                    // Estado
                    let chartType = 'bar'; // bar, pie, line

                    // Dados Iniciais (Pesquisa de Prefer√™ncia)
                    let data = {
                        labels: ['Futebol', 'V√¥lei', 'Basquete'],
                        values: [12, 8, 5]
                    };

                    // Cores do Tema
                    const colors = {
                        bg: ['rgba(28, 176, 246, 0.7)', 'rgba(255, 150, 0, 0.7)', 'rgba(88, 204, 2, 0.7)'], // Blue, Orange, Green
                        border: ['#1CB0F6', '#FF9600', '#58CC02']
                    };

                    let chartInstance = null;

                    // 1. HTML
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col items-center w-full shadow-sm font-sans">
                
                <h3 class="text-brand-text font-bold uppercase text-xs tracking-widest mb-4">Laborat√≥rio de Gr√°ficos</h3>

                <div class="flex gap-2 mb-6 bg-gray-50 p-1 rounded-lg w-full max-w-xs justify-center">
                    <button data-type="bar" class="chart-btn flex-1 py-2 rounded-md text-xs font-bold uppercase transition-all bg-white text-brand-blue shadow-sm">
                        <i class="fas fa-chart-bar"></i> Barras
                    </button>
                    <button data-type="pie" class="chart-btn flex-1 py-2 rounded-md text-xs font-bold uppercase transition-all text-gray-400 hover:bg-white">
                        <i class="fas fa-chart-pie"></i> Pizza
                    </button>
                    <button data-type="line" class="chart-btn flex-1 py-2 rounded-md text-xs font-bold uppercase transition-all text-gray-400 hover:bg-white">
                        <i class="fas fa-chart-line"></i> Linha
                    </button>
                </div>

                <div class="relative w-full max-w-sm h-64 bg-white mb-6">
                    <canvas id="myChart"></canvas>
                </div>

                <div class="w-full max-w-sm bg-gray-50 rounded-xl border border-gray-200 p-4">
                    <div class="flex justify-between text-[10px] font-bold text-gray-400 uppercase mb-2 px-2">
                        <span>Categoria</span>
                        <span>Votos</span>
                    </div>
                    
                    <div class="flex flex-col gap-2" id="inputs-list">
                        <div class="flex items-center gap-2">
                            <div class="w-3 h-3 rounded-full bg-brand-blue"></div>
                            <input type="text" class="lbl-input flex-1 bg-white border border-gray-200 rounded px-2 py-1 text-sm font-bold text-gray-600 outline-none focus:border-brand-blue" data-idx="0" value="Futebol">
                            <input type="number" class="val-input w-16 bg-white border border-gray-200 rounded px-2 py-1 text-sm font-bold text-brand-blue outline-none focus:border-brand-blue text-center" data-idx="0" value="12" min="0">
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-3 h-3 rounded-full bg-brand-orange"></div>
                            <input type="text" class="lbl-input flex-1 bg-white border border-gray-200 rounded px-2 py-1 text-sm font-bold text-gray-600 outline-none focus:border-brand-orange" data-idx="1" value="V√¥lei">
                            <input type="number" class="val-input w-16 bg-white border border-gray-200 rounded px-2 py-1 text-sm font-bold text-brand-orange outline-none focus:border-brand-orange text-center" data-idx="1" value="8" min="0">
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-3 h-3 rounded-full bg-brand-green"></div>
                            <input type="text" class="lbl-input flex-1 bg-white border border-gray-200 rounded px-2 py-1 text-sm font-bold text-gray-600 outline-none focus:border-brand-green" data-idx="2" value="Basquete">
                            <input type="number" class="val-input w-16 bg-white border border-gray-200 rounded px-2 py-1 text-sm font-bold text-brand-green outline-none focus:border-brand-green text-center" data-idx="2" value="5" min="0">
                        </div>
                    </div>
                </div>

                <div id="chart-tip" class="mt-4 text-xs text-center text-gray-500 font-medium italic">
                    Use gr√°fico de <strong>Barras</strong> para comparar quem tem mais ou menos.
                </div>
            </div>
        `;

                    // 2. Seletores
                    const ctx = container.querySelector('#myChart').getContext('2d');
                    const btns = container.querySelectorAll('.chart-btn');
                    const lblInputs = container.querySelectorAll('.lbl-input');
                    const valInputs = container.querySelectorAll('.val-input');
                    const tipEl = container.querySelector('#chart-tip');

                    // 3. Renderiza√ß√£o do Gr√°fico (Chart.js)
                    const renderChart = () => {
                        // Destroi anterior para n√£o sobrepor
                        if (chartInstance) chartInstance.destroy();

                        // Configura√ß√µes espec√≠ficas por tipo
                        const isPie = chartType === 'pie';

                        // Dicas Pedag√≥gicas
                        const tips = {
                            bar: "Use <strong>Barras</strong> para comparar quantidades absolutas (quem ganhou?).",
                            pie: "Use <strong>Pizza</strong> para ver a divis√£o do todo (porcentagem).",
                            line: "Use <strong>Linha</strong> para ver evolu√ß√£o (crescimento ou queda)."
                        };
                        tipEl.innerHTML = tips[chartType];

                        chartInstance = new Chart(ctx, {
                            type: chartType,
                            data: {
                                labels: data.labels,
                                datasets: [{
                                    label: 'Votos',
                                    data: data.values,
                                    backgroundColor: isPie ? colors.bg : colors.bg[0], // Pizza usa v√°rias cores, barra usa uma (ou array mapeado)
                                    // Para ficar bonito no MathLingo, vamos for√ßar cores diferentes nas barras tamb√©m
                                    backgroundColor: colors.bg,
                                    borderColor: colors.border,
                                    borderWidth: 2,
                                    borderRadius: isPie ? 0 : 5, // Arredonda barras
                                    tension: 0.4 // Suaviza linha
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: {
                                        display: isPie, // S√≥ mostra legenda na pizza
                                        position: 'bottom',
                                        labels: { font: { family: "'Nunito', sans-serif", weight: 'bold' } }
                                    },
                                    tooltip: {
                                        backgroundColor: 'rgba(75, 75, 75, 0.9)',
                                        titleFont: { family: "'Nunito', sans-serif" },
                                        bodyFont: { family: "'Nunito', sans-serif" }
                                    }
                                },
                                scales: {
                                    y: {
                                        display: !isPie, // Esconde eixo Y na pizza
                                        beginAtZero: true,
                                        grid: { display: true, drawBorder: false }
                                    },
                                    x: {
                                        display: !isPie,
                                        grid: { display: false }
                                    }
                                },
                                animation: {
                                    duration: 800,
                                    easing: 'easeOutQuart'
                                }
                            }
                        });
                    };

                    // 4. Listeners

                    // Bot√µes de Tipo
                    btns.forEach(btn => {
                        btn.onclick = () => {
                            chartType = btn.dataset.type;

                            // Atualiza UI dos bot√µes
                            btns.forEach(b => {
                                const active = b.dataset.type === chartType;
                                b.className = active
                                    ? "chart-btn flex-1 py-2 rounded-md text-xs font-bold uppercase transition-all bg-white text-brand-blue shadow-sm ring-1 ring-gray-200"
                                    : "chart-btn flex-1 py-2 rounded-md text-xs font-bold uppercase transition-all text-gray-400 hover:bg-white";
                            });

                            renderChart();
                        };
                    });

                    // Inputs da Tabela (Labels e Valores)
                    const updateData = () => {
                        lblInputs.forEach(inp => {
                            const idx = inp.dataset.idx;
                            data.labels[idx] = inp.value;
                        });
                        valInputs.forEach(inp => {
                            const idx = inp.dataset.idx;
                            data.values[idx] = parseInt(inp.value) || 0;
                        });

                        // Chart.js permite atualizar dados sem destruir tudo
                        chartInstance.data.labels = data.labels;
                        chartInstance.data.datasets[0].data = data.values;
                        chartInstance.update();
                    };

                    lblInputs.forEach(i => i.addEventListener('input', updateData));
                    valInputs.forEach(i => i.addEventListener('input', updateData));

                    // Checagem de seguran√ßa (Se Chart.js n√£o carregou)
                    if (typeof Chart !== 'undefined') {
                        renderChart();
                    } else {
                        container.innerHTML = `<div class="text-red-500 font-bold text-center p-4">Erro: Biblioteca Chart.js n√£o carregada.</div>`;
                    }
                },

                interactive_head_tail(container) {
                    // 1. HTML
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col items-center w-full shadow-sm font-sans">
                <h3 class="text-brand-blue font-bold uppercase text-xs tracking-widest mb-1">Cara ou Coroa?</h3>
                <p class="text-xs text-gray-400 mb-4 text-center">Observe como a propor√ß√£o se equilibra com muitos lan√ßamentos.</p>

                <!-- Painel de Estat√≠sticas -->
                <div class="flex gap-4 w-full max-w-sm mb-6">
                    <!-- Cara -->
                    <div class="flex-1 bg-yellow-50 border-2 border-yellow-200 rounded-xl p-3 flex flex-col items-center">
                        <div class="w-8 h-8 rounded-full bg-brand-yellow border-2 border-yellow-600 flex items-center justify-center text-white font-bold mb-1 shadow-sm text-xs">C</div>
                        <span class="text-[10px] font-bold uppercase text-yellow-600">Cara</span>
                        <div class="text-2xl font-black text-brand-yellow" id="count-cara">0</div>
                        <div class="text-xs font-bold text-yellow-600 opacity-60" id="pct-cara">0%</div>
                        <!-- Barra de Progresso -->
                        <div class="w-full h-1.5 bg-yellow-200 rounded-full mt-2 overflow-hidden">
                            <div id="bar-cara" class="h-full bg-brand-yellow transition-all duration-500" style="width: 0%"></div>
                        </div>
                    </div>

                    <!-- Coroa -->
                    <div class="flex-1 bg-gray-100 border-2 border-gray-200 rounded-xl p-3 flex flex-col items-center">
                        <div class="w-8 h-8 rounded-full bg-gray-400 border-2 border-gray-600 flex items-center justify-center text-white font-bold mb-1 shadow-sm text-xs">K</div>
                        <span class="text-[10px] font-bold uppercase text-gray-500">Coroa</span>
                        <div class="text-2xl font-black text-gray-500" id="count-coroa">0</div>
                        <div class="text-xs font-bold text-gray-400 opacity-60" id="pct-coroa">0%</div>
                        <!-- Barra de Progresso -->
                        <div class="w-full h-1.5 bg-gray-200 rounded-full mt-2 overflow-hidden">
                            <div id="bar-coroa" class="h-full bg-gray-500 transition-all duration-500" style="width: 0%"></div>
                        </div>
                    </div>
                </div>

                <!-- Bot√µes de A√ß√£o -->
                <div class="flex gap-2 mb-6 w-full max-w-sm">
                    <button class="action-btn flex-1 bg-white border-2 border-brand-blue text-brand-blue hover:bg-blue-50 font-bold py-2 rounded-lg text-xs transition-all shadow-sm active:scale-95" data-n="1">
                        1 Moeda
                    </button>
                    <button class="action-btn flex-1 bg-white border-2 border-brand-blue text-brand-blue hover:bg-blue-50 font-bold py-2 rounded-lg text-xs transition-all shadow-sm active:scale-95" data-n="10">
                        10 Moedas
                    </button>
                    <button class="action-btn flex-1 bg-brand-blue text-white hover:bg-brand-blueDark font-bold py-2 rounded-lg text-xs transition-all shadow-btn active:shadow-none active:translate-y-1" data-n="100">
                        100 Moedas!
                    </button>
                </div>

                <!-- √Årea Visual (Moedas) -->
                <div class="w-full bg-brand-bg rounded-xl border-inner p-4 min-h-[100px] max-h-[220px] overflow-y-auto">
                    <div id="coins-container" class="flex flex-wrap justify-center gap-1 content-start">
                        <span class="text-gray-400 text-xs italic mt-4">Lance as moedas para ver o resultado...</span>
                    </div>
                </div>
            </div>
        `;

                    // 2. Seletores
                    const countCaraEl = container.querySelector('#count-cara');
                    const pctCaraEl = container.querySelector('#pct-cara');
                    const barCara = container.querySelector('#bar-cara');

                    const countCoroaEl = container.querySelector('#count-coroa');
                    const pctCoroaEl = container.querySelector('#pct-coroa');
                    const barCoroa = container.querySelector('#bar-coroa');

                    const coinsContainer = container.querySelector('#coins-container');
                    const btns = container.querySelectorAll('.action-btn');

                    // 3. Fun√ß√£o de Lan√ßamento
                    const flip = (n) => {
                        coinsContainer.innerHTML = ''; // Limpa anteriores (Reset Mode)

                        let cara = 0;
                        let coroa = 0;

                        // Fragmento para performance ao inserir 100 elementos
                        const fragment = document.createDocumentFragment();

                        for (let i = 0; i < n; i++) {
                            const isCara = Math.random() < 0.5;
                            if (isCara) cara++; else coroa++;

                            const coin = document.createElement('div');
                            // Estilo da moeda
                            const colorClass = isCara ? 'bg-brand-yellow border-yellow-600 text-yellow-800' : 'bg-gray-300 border-gray-500 text-gray-700';
                            const sizeClass = n === 100 ? 'w-4 h-4 text-[8px]' : 'w-8 h-8 text-xs'; // Menor se forem muitas

                            coin.className = `${sizeClass} rounded-full border-2 flex items-center justify-center font-black shadow-sm animate-pop-in ${colorClass}`;
                            coin.innerText = isCara ? 'C' : 'K';
                            // Delay aleat√≥rio leve para efeito de "chuva"
                            coin.style.animationDelay = `${Math.random() * 0.2}s`;

                            fragment.appendChild(coin);
                        }

                        coinsContainer.appendChild(fragment);

                        // Atualiza Stats
                        updateStats(cara, coroa, n);
                    };

                    const updateStats = (cara, coroa, total) => {
                        countCaraEl.innerText = cara;
                        countCoroaEl.innerText = coroa;

                        const pCara = Math.round((cara / total) * 100);
                        const pCoroa = Math.round((coroa / total) * 100); // Pode dar 99% ou 101% em rounding, ok para demo

                        pctCaraEl.innerText = `${pCara}%`;
                        pctCoroaEl.innerText = `${pCoroa}%`;

                        barCara.style.width = `${pCara}%`;
                        barCoroa.style.width = `${pCoroa}%`;
                    };

                    // 4. Listeners
                    btns.forEach(btn => {
                        btn.onclick = () => flip(parseInt(btn.dataset.n));
                    });
                },

                // WIDGET: DADOS E M√âDIA (A Converg√™ncia para 3,5)
                interactive_prob_dice_intuitive(container) {
                    // 1. HTML
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col items-center w-full shadow-sm font-sans">
                <h3 class="text-brand-purple font-bold uppercase text-xs tracking-widest mb-1">Dados e M√©dia</h3>
                <p class="text-xs text-gray-400 mb-4 text-center">Lance muitos dados e veja a m√°gica da m√©dia 3,5.</p>

                <!-- Painel de M√©dia -->
                <div class="bg-purple-50 border border-purple-100 rounded-xl p-4 w-full max-w-sm mb-6 flex justify-between items-center">
                    <div class="text-xs font-bold text-brand-purple uppercase">
                        Soma Total: <span id="sum-val" class="text-brand-text">0</span><br>
                        Dados: <span id="count-val" class="text-brand-text">0</span>
                    </div>
                    <div class="text-right">
                        <div class="text-[10px] font-bold text-gray-400 uppercase">M√©dia (Soma √∑ Qtd)</div>
                        <div class="text-4xl font-black text-brand-purple transition-all" id="avg-display">0.0</div>
                    </div>
                </div>

                <!-- Bot√µes -->
                <div class="flex gap-2 mb-6 w-full max-w-sm">
                    <button class="dice-btn flex-1 bg-white border-2 border-brand-purple text-brand-purple hover:bg-purple-50 font-bold py-2 rounded-lg text-xs transition-all shadow-sm active:scale-95" data-n="1">
                        1 Dado
                    </button>
                    <button class="dice-btn flex-1 bg-white border-2 border-brand-purple text-brand-purple hover:bg-purple-50 font-bold py-2 rounded-lg text-xs transition-all shadow-sm active:scale-95" data-n="10">
                        10 Dados
                    </button>
                    <button class="dice-btn flex-1 bg-brand-purple text-white hover:bg-purple-700 font-bold py-2 rounded-lg text-xs transition-all shadow-btn active:shadow-none active:translate-y-1" data-n="100">
                        100 Dados
                    </button>
                </div>

                <!-- √Årea Visual (Dados) -->
                <div class="w-full bg-brand-bg rounded-xl border-inner p-4 min-h-[100px] max-h-[220px] overflow-y-auto">
                    <div id="dice-container" class="flex flex-wrap justify-center gap-2 content-start">
                        <span class="text-gray-400 text-xs italic mt-4">Role os dados...</span>
                    </div>
                </div>
                
                <!-- Gr√°fico de Barras Simplificado (Distribui√ß√£o) -->
                <div class="w-full max-w-sm mt-4 grid grid-cols-6 gap-1 h-16 items-end" id="bars-container">
                    <!-- Barras geradas via JS -->
                </div>
                <div class="w-full max-w-sm grid grid-cols-6 gap-1 text-center text-[10px] font-bold text-gray-400">
                    <span>1</span><span>2</span><span>3</span><span>4</span><span>5</span><span>6</span>
                </div>
            </div>
        `;

                    // 2. Seletores
                    const sumVal = container.querySelector('#sum-val');
                    const countVal = container.querySelector('#count-val');
                    const avgDisplay = container.querySelector('#avg-display');
                    const diceContainer = container.querySelector('#dice-container');
                    const barsContainer = container.querySelector('#bars-container');
                    const btns = container.querySelectorAll('.dice-btn');

                    // Helper: Criar face do dado com grid CSS
                    // Retorna o HTML interno das bolinhas
                    const getDiceFace = (val) => {
                        const dots = {
                            1: '<div class="bg-brand-text w-1.5 h-1.5 rounded-full" style="grid-area: 2/2"></div>',
                            2: '<div class="bg-brand-text w-1.5 h-1.5 rounded-full" style="grid-area: 1/1"></div><div class="bg-brand-text w-1.5 h-1.5 rounded-full" style="grid-area: 3/3"></div>',
                            3: '<div class="bg-brand-text w-1.5 h-1.5 rounded-full" style="grid-area: 1/1"></div><div class="bg-brand-text w-1.5 h-1.5 rounded-full" style="grid-area: 2/2"></div><div class="bg-brand-text w-1.5 h-1.5 rounded-full" style="grid-area: 3/3"></div>',
                            4: '<div class="bg-brand-text w-1.5 h-1.5 rounded-full" style="grid-area: 1/1"></div><div class="bg-brand-text w-1.5 h-1.5 rounded-full" style="grid-area: 1/3"></div><div class="bg-brand-text w-1.5 h-1.5 rounded-full" style="grid-area: 3/1"></div><div class="bg-brand-text w-1.5 h-1.5 rounded-full" style="grid-area: 3/3"></div>',
                            5: '<div class="bg-brand-text w-1.5 h-1.5 rounded-full" style="grid-area: 1/1"></div><div class="bg-brand-text w-1.5 h-1.5 rounded-full" style="grid-area: 1/3"></div><div class="bg-brand-text w-1.5 h-1.5 rounded-full" style="grid-area: 2/2"></div><div class="bg-brand-text w-1.5 h-1.5 rounded-full" style="grid-area: 3/1"></div><div class="bg-brand-text w-1.5 h-1.5 rounded-full" style="grid-area: 3/3"></div>',
                            6: '<div class="bg-brand-text w-1.5 h-1.5 rounded-full" style="grid-area: 1/1"></div><div class="bg-brand-text w-1.5 h-1.5 rounded-full" style="grid-area: 1/3"></div><div class="bg-brand-text w-1.5 h-1.5 rounded-full" style="grid-area: 2/1"></div><div class="bg-brand-text w-1.5 h-1.5 rounded-full" style="grid-area: 2/3"></div><div class="bg-brand-text w-1.5 h-1.5 rounded-full" style="grid-area: 3/1"></div><div class="bg-brand-text w-1.5 h-1.5 rounded-full" style="grid-area: 3/3"></div>'
                        };
                        return dots[val];
                    };

                    // 3. Fun√ß√£o de Rolar
                    const roll = (n) => {
                        diceContainer.innerHTML = '';

                        let sum = 0;
                        let frequencies = [0, 0, 0, 0, 0, 0, 0]; // Index 1-6

                        const fragment = document.createDocumentFragment();

                        for (let i = 0; i < n; i++) {
                            const val = Math.floor(Math.random() * 6) + 1;
                            sum += val;
                            frequencies[val]++;

                            const dice = document.createElement('div');
                            const sizeClass = n === 100 ? 'w-6 h-6 p-0.5' : 'w-10 h-10 p-1.5';

                            dice.className = `${sizeClass} bg-white rounded-lg shadow-sm border border-gray-300 grid grid-cols-3 grid-rows-3 gap-0.5 animate-pop-in`;
                            dice.innerHTML = getDiceFace(val);
                            dice.style.animationDelay = `${Math.random() * 0.3}s`;

                            fragment.appendChild(dice);
                        }
                        diceContainer.appendChild(fragment);

                        // Atualiza Stats
                        const avg = sum / n;
                        sumVal.innerText = sum;
                        countVal.innerText = n;
                        avgDisplay.innerText = avg.toFixed(2); // Ex: 3.45

                        // Feedback visual na M√©dia
                        // Se estiver entre 3 e 4, fica verde (zona esperada para grandes n√∫meros)
                        if (n > 10 && avg >= 3 && avg <= 4) {
                            avgDisplay.className = "text-4xl font-black text-brand-green transition-all scale-110";
                        } else {
                            avgDisplay.className = "text-4xl font-black text-brand-purple transition-all";
                        }

                        // Atualiza Barras
                        barsContainer.innerHTML = '';
                        // Encontra o maior valor para escalar as barras (max-height: 100%)
                        const maxFreq = Math.max(...frequencies.slice(1));

                        for (let i = 1; i <= 6; i++) {
                            const hPercent = maxFreq > 0 ? (frequencies[i] / maxFreq) * 100 : 0;
                            const bar = document.createElement('div');
                            bar.className = "bg-brand-purple rounded-t-sm w-full transition-all duration-500 opacity-80 hover:opacity-100 relative group";
                            bar.style.height = `${hPercent}%`;

                            // Tooltip simples
                            bar.innerHTML = `<div class="absolute bottom-full left-1/2 -translate-x-1/2 text-[10px] bg-black text-white px-1 rounded opacity-0 group-hover:opacity-100 pointer-events-none mb-1">${frequencies[i]}</div>`;

                            barsContainer.appendChild(bar);
                        }
                    };

                    // 4. Listeners
                    btns.forEach(btn => {
                        btn.onclick = () => roll(parseInt(btn.dataset.n));
                    });
                },

                interactive_sign_rules(container) {
                    // Estado Inicial (1 = Positivo, -1 = Negativo)
                    let s1 = 1;
                    let s2 = 1;

                    // Configura√ß√£o Visual
                    const styles = {
                        pos: {
                            symbol: "+",
                            color: "text-brand-green",
                            bg: "bg-green-100",
                            border: "border-brand-green",
                            icon: "fa-smile-beam", // Carinha feliz
                            label: "Amigo",
                            desc: "Positivo"
                        },
                        neg: {
                            symbol: "-",
                            color: "text-brand-red",
                            bg: "bg-red-100",
                            border: "border-brand-red",
                            icon: "fa-angry", // Carinha brava
                            label: "Inimigo",
                            desc: "Negativo"
                        }
                    };

                    // 1. Inje√ß√£o do HTML
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col items-center w-full shadow-sm font-sans select-none">
                
                <h3 class="text-brand-blue font-bold uppercase text-xs tracking-widest mb-2">Multiplica√ß√£o e Divis√£o</h3>
                <p class="text-xs text-gray-400 mb-6 font-bold">Toque nos cart√µes para trocar o sinal!</p>

                <div class="flex flex-col md:flex-row items-center justify-center gap-4 mb-8 w-full">
                    
                    <button id="btn-s1" class="sign-card w-24 h-32 rounded-2xl border-4 flex flex-col items-center justify-center transition-all duration-300 hover:scale-105 active:scale-95 shadow-md group">
                        <i class="fas text-3xl mb-2 transition-transform duration-300 group-hover:rotate-12"></i>
                        <span class="text-5xl font-black mb-1 symbol"></span>
                        <span class="text-[10px] font-bold uppercase tracking-wider opacity-60 label"></span>
                    </button>

                    <div class="text-3xl font-black text-gray-300">√ó</div>

                    <button id="btn-s2" class="sign-card w-24 h-32 rounded-2xl border-4 flex flex-col items-center justify-center transition-all duration-300 hover:scale-105 active:scale-95 shadow-md group">
                        <i class="fas text-3xl mb-2 transition-transform duration-300 group-hover:-rotate-12"></i>
                        <span class="text-5xl font-black mb-1 symbol"></span>
                        <span class="text-[10px] font-bold uppercase tracking-wider opacity-60 label"></span>
                    </button>

                    <div class="text-3xl font-black text-gray-300">=</div>

                    <div id="res-card" class="w-24 h-32 rounded-2xl border-4 border-dashed flex flex-col items-center justify-center transition-all duration-500 relative overflow-hidden bg-gray-50">
                        <div class="absolute inset-0 opacity-20 bg-current transition-colors"></div>
                        <i class="fas text-3xl mb-2 z-10 transition-all" id="res-icon"></i>
                        <span class="text-5xl font-black mb-1 z-10" id="res-symbol"></span>
                        <span class="text-[10px] font-bold uppercase tracking-wider opacity-60 z-10" id="res-label"></span>
                    </div>

                </div>

                <div class="bg-gray-50 rounded-xl p-4 w-full max-w-md border-2 border-gray-100 text-center transition-all duration-300" id="logic-box">
                    <p class="text-lg font-bold text-brand-text mb-1" id="logic-title">logic</p>
                    <p class="text-sm text-gray-500 italic" id="logic-desc">desc</p>
                </div>

            </div>
        `;

                    // 2. Seletores
                    const btnS1 = container.querySelector('#btn-s1');
                    const btnS2 = container.querySelector('#btn-s2');
                    const resCard = container.querySelector('#res-card');
                    const resIcon = container.querySelector('#res-icon');
                    const resSymbol = container.querySelector('#res-symbol');
                    const resLabel = container.querySelector('#res-label');

                    const logicBox = container.querySelector('#logic-box');
                    const logicTitle = container.querySelector('#logic-title');
                    const logicDesc = container.querySelector('#logic-desc');

                    // 3. Fun√ß√£o de Renderiza√ß√£o de um Cart√£o
                    const renderCard = (element, signVal) => {
                        const style = signVal === 1 ? styles.pos : styles.neg;

                        // Remove classes antigas de cor
                        element.className = element.className.replace(/text-brand-\w+|bg-\w+-\d+|border-brand-\w+|border-\w+-\d+/g, '');

                        // Adiciona novas
                        element.classList.add(style.color, style.bg, style.border);

                        // Atualiza conte√∫do interno
                        element.querySelector('i').className = `fas ${style.icon} text-3xl mb-2 transition-transform duration-300 group-hover:rotate-12`;
                        element.querySelector('.symbol').innerText = style.symbol;
                        element.querySelector('.label').innerText = style.desc;
                    };

                    // 4. L√≥gica Principal
                    const update = () => {
                        const resVal = s1 * s2; // A matem√°tica real: 1*1=1, 1*-1=-1, -1*-1=1

                        // Renderiza Inputs
                        renderCard(btnS1, s1);
                        renderCard(btnS2, s2);

                        // Renderiza Resultado
                        const resStyle = resVal === 1 ? styles.pos : styles.neg;

                        resCard.className = `w-24 h-32 rounded-2xl border-4 flex flex-col items-center justify-center transition-all duration-500 relative overflow-hidden ${resStyle.bg} ${resStyle.border} ${resStyle.color}`;
                        resIcon.className = `fas ${resStyle.icon} text-3xl mb-2 z-10 animate-pop-in`;
                        resSymbol.innerText = resStyle.symbol;
                        resLabel.innerText = resStyle.desc;

                        // Renderiza L√≥gica (Met√°fora)
                        // L√≥gica: Amigo (+) ou Inimigo (-)
                        const p1 = s1 === 1 ? "Amigo" : "Inimigo";
                        const p2 = s2 === 1 ? "Amigo" : "Inimigo";
                        const resText = resVal === 1 ? "Amigo" : "Inimigo";

                        // Frase montada: "O (Amigo) do meu (Inimigo) √© meu..."
                        logicTitle.innerHTML = `O <span class="${s1 === 1 ? 'text-brand-green' : 'text-brand-red'}">${p1}</span> do meu <span class="${s2 === 1 ? 'text-brand-green' : 'text-brand-red'}">${p2}</span> √© meu...`;

                        logicDesc.innerHTML = `<span class="font-black text-xl ${resStyle.color} uppercase not-italic animate-pulse">${resText}</span>`;

                        // Feedback de borda na caixa de texto
                        logicBox.className = `bg-gray-50 rounded-xl p-4 w-full max-w-md border-2 text-center transition-all duration-300 ${resStyle.border.replace('border-', 'border-opacity-30 border-')}`;
                    };

                    // 5. Listeners
                    btnS1.onclick = () => {
                        s1 *= -1; // Inverte sinal
                        update();
                    };

                    btnS2.onclick = () => {
                        s2 *= -1; // Inverte sinal
                        update();
                    };

                    // CSS Inline para anima√ß√£o
                    if (!document.getElementById('anim-pop')) {
                        const style = document.createElement('style');
                        style.id = 'anim-pop';
                        style.innerHTML = `@keyframes popIn { 0% { transform: scale(0.5); opacity: 0; } 70% { transform: scale(1.2); } 100% { transform: scale(1); opacity: 1; } } .animate-pop-in { animation: popIn 0.4s ease-out forwards; }`;
                        container.appendChild(style);
                    }

                    // Init
                    update();
                },

                interactive_rule_of_three(container) {
                    // Estado
                    let mode = 'direct'; // 'direct' ou 'inverse'

                    // Dados de Exemplo (Presets)
                    const scenarios = {
                        custom: { label: "Personalizado", u1: "A", u2: "B", v1: 2, v2: 10, v3: 5 },
                        gas: { label: "Gasolina (Direta)", u1: "Litros", u2: "Dist√¢ncia (km)", v1: 10, v2: 100, v3: 20, mode: 'direct' },
                        speed: { label: "Viagem (Inversa)", u1: "Velocidade (km/h)", u2: "Tempo (h)", v1: 80, v2: 2, v3: 40, mode: 'inverse' },
                        food: { label: "Comida (Direta)", u1: "Pessoas", u2: "Gramas", v1: 2, v2: 500, v3: 5, mode: 'direct' },
                        work: { label: "Obra (Inversa)", u1: "Pedreiros", u2: "Dias", v1: 3, v2: 10, v3: 6, mode: 'inverse' }
                    };

                    // 1. HTML
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col items-center w-full shadow-sm font-sans select-none">
                
                <h3 class="text-brand-text font-bold uppercase text-xs tracking-widest mb-4">A Ferramenta Suprema</h3>

                <select id="scenario-select" class="mb-6 bg-gray-100 border border-gray-200 text-gray-700 text-sm rounded-lg focus:ring-brand-blue focus:border-brand-blue block w-full p-2.5 font-bold cursor-pointer outline-none max-w-xs">
                    <option value="custom">-- Modo Livre --</option>
                    <option value="gas">üöó Gasolina vs Dist√¢ncia</option>
                    <option value="speed">‚è±Ô∏è Velocidade vs Tempo</option>
                    <option value="food">üçï Pessoas vs Comida</option>
                    <option value="work">üß± Oper√°rios vs Dias</option>
                </select>

                <div class="flex bg-gray-100 p-1 rounded-lg mb-8 w-full max-w-xs relative">
                    <div id="mode-bg" class="absolute top-1 bottom-1 w-[calc(50%-4px)] bg-white rounded-md shadow-sm transition-all duration-300 left-1"></div>
                    <button data-m="direct" class="mode-btn flex-1 py-2 rounded-md text-xs font-bold uppercase z-10 transition-colors text-brand-blue">Direta</button>
                    <button data-m="inverse" class="mode-btn flex-1 py-2 rounded-md text-xs font-bold uppercase z-10 transition-colors text-gray-400">Inversa</button>
                </div>

                <div class="relative w-full max-w-sm flex justify-between items-center gap-8 mb-8">
                    
                    <svg id="lines-svg" class="absolute inset-0 w-full h-full pointer-events-none z-0 overflow-visible">
                        </svg>

                    <div class="flex flex-col gap-6 z-10 w-24">
                        <div class="flex flex-col">
                            <input type="text" id="label-u1" value="Grandeza A" class="text-[10px] font-bold text-gray-400 uppercase text-center bg-transparent border-none outline-none mb-1">
                            <input type="number" id="val-a" class="calc-input text-center font-bold text-xl p-2 rounded-lg border-2 border-gray-200 bg-white shadow-sm focus:border-brand-blue outline-none text-brand-text" value="2">
                        </div>
                        <div class="flex flex-col">
                            <input type="number" id="val-c" class="calc-input text-center font-bold text-xl p-2 rounded-lg border-2 border-gray-200 bg-white shadow-sm focus:border-brand-blue outline-none text-brand-text" value="5">
                        </div>
                    </div>

                    <div class="flex flex-col gap-6 z-10 w-24">
                        <div class="flex flex-col">
                            <input type="text" id="label-u2" value="Grandeza B" class="text-[10px] font-bold text-gray-400 uppercase text-center bg-transparent border-none outline-none mb-1">
                            <input type="number" id="val-b" class="calc-input text-center font-bold text-xl p-2 rounded-lg border-2 border-gray-200 bg-white shadow-sm focus:border-brand-blue outline-none text-brand-text" value="10">
                        </div>
                        <div class="flex flex-col relative">
                            <div class="h-[46px] flex items-center justify-center bg-gray-100 rounded-lg border-2 border-gray-200 border-dashed text-brand-purple font-black text-2xl" id="val-x">
                                ?
                            </div>
                            <span class="absolute -right-6 top-1/2 -translate-y-1/2 text-brand-purple font-bold text-xs">X</span>
                        </div>
                    </div>

                </div>

                <div class="w-full max-w-md bg-gray-50 border-2 border-gray-200 rounded-xl p-4 transition-colors duration-300" id="result-box">
                    <div class="flex justify-between items-center mb-2 border-b border-gray-200 pb-2">
                        <span class="text-xs font-bold text-gray-400 uppercase" id="logic-label">Multiplica Cruzado</span>
                        <i class="fas fa-calculator text-gray-300"></i>
                    </div>
                    
                    <div class="font-mono text-sm md:text-base text-gray-600 space-y-1 text-center">
                        <div id="step-1">2 ¬∑ x = 10 ¬∑ 5</div>
                        <div id="step-2">2x = 50</div>
                        <div id="step-3" class="font-bold text-lg text-brand-text mt-2">x = 25</div>
                    </div>
                </div>

            </div>
        `;

                    // 2. Seletores
                    const modeBtns = container.querySelectorAll('.mode-btn');
                    const modeBg = container.querySelector('#mode-bg');
                    const scenarioSelect = container.querySelector('#scenario-select');
                    const svg = container.querySelector('#lines-svg');

                    const inpA = container.querySelector('#val-a');
                    const inpB = container.querySelector('#val-b');
                    const inpC = container.querySelector('#val-c');
                    const dispX = container.querySelector('#val-x');

                    const labelU1 = container.querySelector('#label-u1');
                    const labelU2 = container.querySelector('#label-u2');

                    const resultBox = container.querySelector('#result-box');
                    const logicLabel = container.querySelector('#logic-label');
                    const step1 = container.querySelector('#step-1');
                    const step2 = container.querySelector('#step-2');
                    const step3 = container.querySelector('#step-3');

                    // 3. Fun√ß√µes de Desenho e L√≥gica
                    const setMode = (newMode) => {
                        mode = newMode;

                        // UI do Toggle
                        if (mode === 'direct') {
                            modeBg.style.left = '4px';
                            modeBtns[0].className = "mode-btn flex-1 py-2 rounded-md text-xs font-bold uppercase z-10 transition-colors text-brand-blue";
                            modeBtns[1].className = "mode-btn flex-1 py-2 rounded-md text-xs font-bold uppercase z-10 transition-colors text-gray-400";
                        } else {
                            modeBg.style.left = 'calc(50% + 0px)'; // Ajuste visual
                            modeBtns[0].className = "mode-btn flex-1 py-2 rounded-md text-xs font-bold uppercase z-10 transition-colors text-gray-400";
                            modeBtns[1].className = "mode-btn flex-1 py-2 rounded-md text-xs font-bold uppercase z-10 transition-colors text-brand-orange";
                        }
                        update();
                    };

                    const update = () => {
                        const a = parseFloat(inpA.value) || 1; // Evita div por zero
                        const b = parseFloat(inpB.value) || 0;
                        const c = parseFloat(inpC.value) || 0;
                        let x, s1, s2;

                        const color = mode === 'direct' ? '#1CB0F6' : '#FF9600'; // Azul ou Laranja

                        // L√≥gica Matem√°tica
                        if (mode === 'direct') {
                            // Regra Direta: A/B = C/x => A*x = B*C => x = (B*C)/A
                            x = (b * c) / a;
                            s1 = `${a} ¬∑ x = ${b} ¬∑ ${c}`;
                            s2 = `${a}x = ${b * c}`;
                            logicLabel.innerText = "Diretamente Proporcional (Cruzado)";

                            // Desenho do X (Cruzado)
                            // Coordenadas relativas do SVG (0,0 a 100%,100%)
                            // Inputs est√£o em posi√ß√µes fixas aproximadas
                            svg.innerHTML = `
                    <line x1="20%" y1="20%" x2="80%" y2="80%" stroke="${color}" stroke-width="3" stroke-dasharray="8" class="animate-dash" />
                    <line x1="20%" y1="80%" x2="80%" y2="20%" stroke="${color}" stroke-width="3" stroke-dasharray="8" class="animate-dash" style="animation-delay: 0.5s"/>
                    <circle cx="80%" cy="80%" r="4" fill="${color}" />
                    <circle cx="80%" cy="20%" r="4" fill="${color}" />
                `;

                            resultBox.className = "w-full max-w-md bg-blue-50 border-2 border-blue-100 rounded-xl p-4 transition-colors duration-300";

                        } else {
                            // Regra Inversa: A*B = C*x => x = (A*B)/C
                            x = (a * b) / c;
                            s1 = `${c} ¬∑ x = ${a} ¬∑ ${b}`;
                            s2 = `${c}x = ${a * b}`;
                            logicLabel.innerText = "Inversamente Proporcional (Reto)";

                            // Desenho do = (Paralelo)
                            svg.innerHTML = `
                    <line x1="25%" y1="20%" x2="75%" y2="20%" stroke="${color}" stroke-width="3" stroke-dasharray="8" class="animate-dash" />
                    <line x1="25%" y1="80%" x2="75%" y2="80%" stroke="${color}" stroke-width="3" stroke-dasharray="8" class="animate-dash" />
                    <circle cx="75%" cy="20%" r="4" fill="${color}" />
                    <circle cx="75%" cy="80%" r="4" fill="${color}" />
                `;

                            resultBox.className = "w-full max-w-md bg-orange-50 border-2 border-orange-100 rounded-xl p-4 transition-colors duration-300";
                        }

                        // Exibir Resultado
                        // Arredonda para 2 casas decimais se necess√°rio
                        const displayX = Number.isInteger(x) ? x : x.toFixed(2).replace('.', ',');
                        dispX.innerText = displayX;
                        dispX.style.color = color;
                        dispX.style.borderColor = color;

                        step1.innerText = s1;
                        step2.innerText = s2;
                        step3.innerText = `x = ${displayX}`;
                        step3.className = `font-bold text-lg mt-2 ${mode === 'direct' ? 'text-brand-blue' : 'text-brand-orange'}`;
                    };

                    // 4. Listeners

                    // Inputs num√©ricos
                    [inpA, inpB, inpC].forEach(el => el.addEventListener('input', update));
                    [labelU1, labelU2].forEach(el => el.addEventListener('input', () => { })); // Apenas permite editar

                    // Bot√µes de Modo
                    modeBtns.forEach(btn => {
                        btn.onclick = () => setMode(btn.dataset.m);
                    });

                    // Seletor de Cen√°rio
                    scenarioSelect.onchange = () => {
                        const val = scenarioSelect.value;
                        const data = scenarios[val];
                        if (data) {
                            // Atualiza Labels
                            labelU1.value = data.u1;
                            labelU2.value = data.u2;

                            // Atualiza Valores
                            inpA.value = data.v1;
                            inpB.value = data.v2;
                            inpC.value = data.v3;

                            // Atualiza Modo (se definido no preset)
                            if (data.mode) setMode(data.mode);
                            else update();
                        }
                    };

                    // CSS Inline para anima√ß√£o das linhas
                    if (!document.getElementById('anim-dash')) {
                        const style = document.createElement('style');
                        style.id = 'anim-dash';
                        style.innerHTML = `
                @keyframes dash { to { stroke-dashoffset: -16; } }
                .animate-dash { animation: dash 1s linear infinite; }
            `;
                        container.appendChild(style);
                    }

                    // Init
                    update();
                },

                interactive_square_sum(container) {
                    // Estado inicial
                    let state = { a: 3, b: 2 };

                    // Configura√ß√£o de Cores
                    const styles = {
                        a: { bg: 'fill-brand-blue', text: 'text-brand-blue', stroke: 'stroke-brand-blue' },
                        b: { bg: 'fill-brand-orange', text: 'text-brand-orange', stroke: 'stroke-brand-orange' },
                        ab: { bg: 'fill-brand-purple', text: 'text-brand-purple', stroke: 'stroke-brand-purple' }
                    };

                    // 1. INJE√á√ÉO DO HTML
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col items-center w-full shadow-sm font-sans select-none">
                
                <h3 class="text-brand-text font-bold uppercase text-xs tracking-widest mb-6">O Quadrado da Soma: $(a+b)^2$</h3>

                <div class="flex flex-col md:flex-row items-start gap-10 w-full justify-center">
                    
                    <div class="relative flex flex-col items-center">
                        <svg id="geo-canvas" width="260" height="260" viewBox="0 0 260 260" class="overflow-visible">
                            <rect id="rect-a2" x="0" y="0" class="${styles.a.bg} fill-opacity-20 ${styles.a.stroke}" stroke-width="2" />
                            <rect id="rect-ab1" class="${styles.ab.bg} fill-opacity-20 ${styles.ab.stroke}" stroke-width="2" />
                            <rect id="rect-ab2" class="${styles.ab.bg} fill-opacity-20 ${styles.ab.stroke}" stroke-width="2" />
                            <rect id="rect-b2" class="${styles.b.bg} fill-opacity-20 ${styles.b.stroke}" stroke-width="2" />
                            
                            <text id="lbl-a2" class="text-sm font-bold fill-brand-blue pointer-events-none" text-anchor="middle" dominant-baseline="middle">a¬≤</text>
                            <text id="lbl-ab1" class="text-sm font-bold fill-brand-purple pointer-events-none" text-anchor="middle" dominant-baseline="middle">ab</text>
                            <text id="lbl-ab2" class="text-sm font-bold fill-brand-purple pointer-events-none" text-anchor="middle" dominant-baseline="middle">ab</text>
                            <text id="lbl-b2" class="text-sm font-bold fill-brand-orange pointer-events-none" text-anchor="middle" dominant-baseline="middle">b¬≤</text>

                            <text id="dim-a-top" y="-10" class="text-xs font-bold fill-brand-blue" text-anchor="middle">a</text>
                            <text id="dim-b-top" y="-10" class="text-xs font-bold fill-brand-orange" text-anchor="middle">b</text>
                            <text id="dim-a-left" x="-15" class="text-xs font-bold fill-brand-blue" text-anchor="end" dominant-baseline="middle">a</text>
                            <text id="dim-b-left" x="-15" class="text-xs font-bold fill-brand-orange" text-anchor="end" dominant-baseline="middle">b</text>
                        </svg>
                    </div>

                    <div class="flex flex-col gap-6 w-full max-w-xs">
                        
                        <div class="bg-gray-50 p-4 rounded-xl border border-gray-200 space-y-4">
                            <div>
                                <div class="flex justify-between text-xs font-bold uppercase mb-1">
                                    <span class="text-brand-blue">Valor de A</span>
                                    <span id="val-a" class="text-brand-blue font-mono text-lg">3</span>
                                </div>
                                <input type="range" id="range-a" min="1" max="5" value="3" class="w-full h-2 bg-blue-100 rounded-lg appearance-none cursor-pointer accent-brand-blue">
                            </div>
                            <div>
                                <div class="flex justify-between text-xs font-bold uppercase mb-1">
                                    <span class="text-brand-orange">Valor de B</span>
                                    <span id="val-b" class="text-brand-orange font-mono text-lg">2</span>
                                </div>
                                <input type="range" id="range-b" min="1" max="5" value="2" class="w-full h-2 bg-orange-100 rounded-lg appearance-none cursor-pointer accent-brand-orange">
                            </div>
                        </div>

                        <div class="text-center font-mono space-y-2">
                            <div class="text-lg text-gray-400 font-bold mb-2">Substituindo:</div>
                            
                            <div class="bg-white border-2 border-brand-gray rounded-lg p-3 shadow-inner">
                                <span class="text-xl">
                                    (<strong class="text-brand-blue" id="form-a">3</strong> + <strong class="text-brand-orange" id="form-b">2</strong>)¬≤
                                </span>
                            </div>
                            
                            <div class="text-2xl font-bold text-gray-300">‚Üì</div>

                            <div class="bg-white border-2 border-brand-gray rounded-lg p-3 shadow-inner flex flex-wrap justify-center gap-1 text-lg md:text-xl font-bold">
                                <span class="text-brand-blue" id="res-a2">9</span>
                                <span class="text-gray-400">+</span>
                                <span class="text-brand-purple" id="res-2ab">12</span>
                                <span class="text-gray-400">+</span>
                                <span class="text-brand-orange" id="res-b2">4</span>
                                <span class="text-gray-400">=</span>
                                <span class="text-brand-green" id="res-total">25</span>
                            </div>
                            
                            <div class="text-[10px] text-gray-400 uppercase font-bold mt-1 flex justify-center gap-4">
                                <span class="text-brand-blue">a¬≤</span>
                                <span class="text-brand-purple">2ab</span>
                                <span class="text-brand-orange">b¬≤</span>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        `;

                    // 2. SELETORES
                    const rA = container.querySelector('#range-a');
                    const rB = container.querySelector('#range-b');
                    const vA = container.querySelector('#val-a');
                    const vB = container.querySelector('#val-b');

                    // SVG Elements
                    const rectA2 = container.querySelector('#rect-a2');
                    const rectAb1 = container.querySelector('#rect-ab1');
                    const rectAb2 = container.querySelector('#rect-ab2');
                    const rectB2 = container.querySelector('#rect-b2');

                    const lblA2 = container.querySelector('#lbl-a2');
                    const lblAb1 = container.querySelector('#lbl-ab1');
                    const lblAb2 = container.querySelector('#lbl-ab2');
                    const lblB2 = container.querySelector('#lbl-b2');

                    const dimATop = container.querySelector('#dim-a-top');
                    const dimBTop = container.querySelector('#dim-b-top');
                    const dimALeft = container.querySelector('#dim-a-left');
                    const dimBLeft = container.querySelector('#dim-b-left');

                    // Formula Elements
                    const formA = container.querySelector('#form-a');
                    const formB = container.querySelector('#form-b');
                    const resA2 = container.querySelector('#res-a2');
                    const res2ab = container.querySelector('#res-2ab');
                    const resB2 = container.querySelector('#res-b2');
                    const resTotal = container.querySelector('#res-total');

                    // 3. L√ìGICA DE ATUALIZA√á√ÉO
                    const update = () => {
                        const a = parseInt(rA.value);
                        const b = parseInt(rB.value);

                        // Atualiza Textos de Controle
                        vA.innerText = a;
                        vB.innerText = b;

                        // Escala para o SVG (1 unidade = 30px)
                        const scale = 30;
                        const sizeA = a * scale;
                        const sizeB = b * scale;

                        // --- ATUALIZA SVG ---

                        // 1. Quadrado A¬≤ (Topo Esquerda)
                        rectA2.setAttribute('width', sizeA);
                        rectA2.setAttribute('height', sizeA);

                        // 2. Ret√¢ngulo AB1 (Topo Direita)
                        rectAb1.setAttribute('x', sizeA);
                        rectAb1.setAttribute('y', 0);
                        rectAb1.setAttribute('width', sizeB);
                        rectAb1.setAttribute('height', sizeA);

                        // 3. Ret√¢ngulo AB2 (Baixo Esquerda)
                        rectAb2.setAttribute('x', 0);
                        rectAb2.setAttribute('y', sizeA);
                        rectAb2.setAttribute('width', sizeA);
                        rectAb2.setAttribute('height', sizeB);

                        // 4. Quadrado B¬≤ (Baixo Direita)
                        rectB2.setAttribute('x', sizeA);
                        rectB2.setAttribute('y', sizeA);
                        rectB2.setAttribute('width', sizeB);
                        rectB2.setAttribute('height', sizeB);

                        // Posiciona Labels (Centro das formas)
                        const setLabelPos = (el, x, y) => { el.setAttribute('x', x); el.setAttribute('y', y); };

                        setLabelPos(lblA2, sizeA / 2, sizeA / 2);
                        setLabelPos(lblAb1, sizeA + sizeB / 2, sizeA / 2);
                        setLabelPos(lblAb2, sizeA / 2, sizeA + sizeB / 2);
                        setLabelPos(lblB2, sizeA + sizeB / 2, sizeA + sizeB / 2);

                        // Atualiza Texto dos Labels (√Årea)
                        lblA2.textContent = a * a;
                        lblAb1.textContent = a * b;
                        lblAb2.textContent = a * b;
                        lblB2.textContent = b * b;

                        // Posiciona Dimens√µes Externas
                        dimATop.setAttribute('x', sizeA / 2);
                        dimATop.textContent = a;

                        dimBTop.setAttribute('x', sizeA + sizeB / 2);
                        dimBTop.textContent = b;

                        dimALeft.setAttribute('y', sizeA / 2);
                        dimALeft.textContent = a;

                        dimBLeft.setAttribute('y', sizeA + sizeB / 2);
                        dimBLeft.textContent = b;


                        // --- ATUALIZA F√ìRMULA ---
                        formA.innerText = a;
                        formB.innerText = b;

                        resA2.innerText = a * a;
                        res2ab.innerText = 2 * (a * b); // Soma dos dois ret√¢ngulos roxos
                        resB2.innerText = b * b;
                        resTotal.innerText = Math.pow(a + b, 2);
                    };

                    // 4. LISTENERS
                    rA.addEventListener('input', update);
                    rB.addEventListener('input', update);

                    // Init
                    update();
                },

                interactive_system_steps(container) {
                    // Estado
                    let currentStep = 0;

                    // Dados do Sistema (Exemplo fixo did√°tico: x+y=6 e x-y=2)
                    // Solu√ß√£o: x=4, y=2
                    const systemData = {
                        eq1: { x: 1, y: 1, r: 6 },
                        eq2: { x: 1, y: -1, r: 2 }
                    };

                    // Passos da Anima√ß√£o
                    const steps = [
                        { id: 0, btn: "Somar as Equa√ß√µes (+)", text: "O M√©todo da Adi√ß√£o consiste em somar as duas equa√ß√µes verticalmente para eliminar uma letra." },
                        { id: 1, btn: "Calcular X", text: "O Y foi eliminado! Agora temos uma equa√ß√£o simples de 1¬∫ grau." },
                        { id: 2, btn: "Substituir X na 1¬™ Eq.", text: "J√° sabemos que X vale 4. Vamos trocar o X pelo 4 na primeira equa√ß√£o." },
                        { id: 3, btn: "Calcular Y", text: "Agora resolvemos a equa√ß√£o para encontrar o valor de Y." },
                        { id: 4, btn: "Reiniciar", text: "Parab√©ns! Encontramos o par ordenado (4, 2)." }
                    ];

                    // 1. HTML
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col items-center w-full shadow-sm font-sans select-none">
                
                <h3 class="text-brand-purple font-bold uppercase text-xs tracking-widest mb-2">M√©todo da Adi√ß√£o</h3>
                
                <div class="relative bg-gray-50 border-2 border-gray-200 rounded-xl p-6 mb-6 w-full max-w-sm min-h-[200px] flex flex-col justify-center items-center transition-all duration-500" id="board">
                    
                    <div id="bracket" class="absolute left-4 top-1/2 -translate-y-1/2 text-6xl font-light text-gray-300 transform scale-y-150">{</div>

                    <div class="flex flex-col gap-4 text-2xl font-mono font-bold w-full pl-8" id="equations-area">
                        <div id="row-1" class="flex items-center gap-2 transition-all duration-500">
                            <span class="text-brand-purple">x</span>
                            <span class="text-gray-400">+</span>
                            <span class="text-brand-orange" id="y1">y</span>
                            <span class="text-gray-400">=</span>
                            <span>6</span>
                        </div>
                        
                        <div id="sum-line" class="w-full h-0.5 bg-gray-300 opacity-0 transition-opacity"></div>

                        <div id="row-2" class="flex items-center gap-2 transition-all duration-500">
                            <span class="text-brand-purple">x</span>
                            <span class="text-gray-400">-</span>
                            <span class="text-brand-orange" id="y2">y</span>
                            <span class="text-gray-400">=</span>
                            <span>2</span>
                        </div>

                        <div id="row-res" class="hidden text-brand-text mt-2 border-t-2 border-gray-800 pt-2">
                            </div>
                    </div>
                </div>

                <div class="bg-blue-50 border border-blue-100 rounded-lg p-3 mb-4 text-sm text-brand-blue text-center w-full max-w-sm min-h-[60px] flex items-center justify-center">
                    <span id="step-desc" class="animate-fade-in">${steps[0].text}</span>
                </div>

                <button id="next-btn" class="bg-brand-purple hover:bg-purple-600 text-white font-bold py-3 px-8 rounded-xl shadow-btn active:shadow-none active:translate-y-1 transition-all w-full max-w-xs flex items-center justify-center gap-2">
                    <i class="fas fa-arrow-down"></i>
                    <span id="btn-text">${steps[0].btn}</span>
                </button>

            </div>
        `;

                    // 2. Seletores
                    const board = container.querySelector('#board');
                    const row1 = container.querySelector('#row-1');
                    const row2 = container.querySelector('#row-2');
                    const rowRes = container.querySelector('#row-res');
                    const sumLine = container.querySelector('#sum-line');
                    const bracket = container.querySelector('#bracket');

                    const y1 = container.querySelector('#y1');
                    const y2 = container.querySelector('#y2');

                    const btn = container.querySelector('#next-btn');
                    const btnText = container.querySelector('#btn-text');
                    const stepDesc = container.querySelector('#step-desc');

                    // 3. L√≥gica de Passos
                    const updateStep = () => {
                        // Atualiza Textos
                        const s = steps[currentStep];
                        btnText.innerText = s.btn;
                        stepDesc.innerHTML = s.text; // innerHTML para permitir bold se precisar

                        // L√≥gica Visual por Passo
                        if (currentStep === 0) {
                            // RESET
                            rowRes.classList.add('hidden');
                            rowRes.innerHTML = '';
                            row1.style.opacity = '1';
                            row2.style.opacity = '1';
                            sumLine.style.opacity = '0';
                            bracket.style.opacity = '1';

                            // Restaura HTML original das linhas
                            row1.innerHTML = `<span class="text-brand-purple">x</span> <span class="text-gray-400">+</span> <span class="text-brand-orange">y</span> <span class="text-gray-400">=</span> <span>6</span>`;
                            row2.innerHTML = `<span class="text-brand-purple">x</span> <span class="text-gray-400">-</span> <span class="text-brand-orange">y</span> <span class="text-gray-400">=</span> <span>2</span>`;
                        }

                        else if (currentStep === 1) {
                            // SOMAR: Anima√ß√£o de corte do Y
                            sumLine.style.opacity = '1';

                            // Seleciona os Ys atuais para animar
                            const yTerms = container.querySelectorAll('.text-brand-orange');
                            yTerms.forEach(el => {
                                el.classList.add('text-brand-red', 'line-through', 'decoration-4', 'decoration-brand-red', 'opacity-50', 'transition-all');
                            });

                            // Mostra resultado parcial (2x = 8)
                            setTimeout(() => {
                                rowRes.classList.remove('hidden');
                                rowRes.innerHTML = `<div class="flex items-center gap-2 animate-pop-in"><span class="text-brand-purple font-black">2x</span> <span class="text-gray-300 ml-8">=</span> <span class="font-black">8</span></div>`;
                            }, 500);
                        }

                        else if (currentStep === 2) {
                            // CALCULAR X
                            // Some com as equa√ß√µes de cima para focar no resultado
                            row1.style.opacity = '0.1';
                            row2.style.opacity = '0.1';
                            sumLine.style.opacity = '0.1';
                            bracket.style.opacity = '0.1';

                            // Transforma 2x=8 em x=4
                            rowRes.innerHTML = `
                    <div class="flex flex-col items-center animate-slide-up">
                        <div class="text-gray-400 text-sm mb-1">8 √∑ 2</div>
                        <div class="text-3xl font-black text-brand-purple border-2 border-brand-purple px-4 py-2 rounded-lg bg-purple-50">x = 4</div>
                    </div>
                `;
                        }

                        else if (currentStep === 3) {
                            // SUBSTITUIR X
                            // Limpa a lousa e traz a Eq 1
                            row2.classList.add('hidden');
                            sumLine.classList.add('hidden');
                            bracket.classList.add('hidden');
                            rowRes.classList.add('hidden');

                            row1.style.opacity = '1';
                            row1.classList.add('scale-110', 'mb-4'); // Destaque

                            // Anima√ß√£o: X vira 4
                            row1.innerHTML = `<span class="text-brand-purple font-black bg-purple-100 px-2 rounded animate-pulse">x</span> <span class="text-gray-400">+</span> <span class="text-brand-orange">y</span> <span class="text-gray-400">=</span> <span>6</span>`;

                            setTimeout(() => {
                                row1.innerHTML = `<span class="text-brand-purple font-black animate-pop-in">4</span> <span class="text-gray-400">+</span> <span class="text-brand-orange">y</span> <span class="text-gray-400">=</span> <span>6</span>`;
                            }, 800);
                        }

                        else if (currentStep === 4) {
                            // CALCULAR Y
                            // Mostra passo final: y = 6 - 4
                            row1.innerHTML = `
                    <div class="flex flex-col items-center animate-slide-up gap-2">
                        <div class="flex items-center gap-2 text-gray-400">
                            <span class="text-brand-orange">y</span> = 6 - <span class="text-brand-purple">4</span>
                        </div>
                        <div class="text-3xl font-black text-brand-orange border-2 border-brand-orange px-4 py-2 rounded-lg bg-orange-50">y = 2</div>
                    </div>
                `;

                            // Mostra Solu√ß√£o Final
                            setTimeout(() => {
                                rowRes.classList.remove('hidden');
                                rowRes.innerHTML = `<div class="text-center mt-4 font-bold text-gray-600 animate-pop-in">S = { (<span class="text-brand-purple">4</span>, <span class="text-brand-orange">2</span>) }</div>`;
                            }, 800);

                            // Muda bot√£o para reiniciar
                            btn.classList.replace('bg-brand-purple', 'bg-brand-green');
                        }
                    };

                    // 4. Listener
                    btn.onclick = () => {
                        currentStep++;
                        if (currentStep >= steps.length) {
                            currentStep = 0;
                            // Reseta classes e estilos manuais
                            btn.classList.replace('bg-brand-green', 'bg-brand-purple');
                            row2.classList.remove('hidden');
                            sumLine.classList.remove('hidden');
                            bracket.classList.remove('hidden');
                            row1.classList.remove('scale-110', 'mb-4');
                        }
                        updateStep();
                    };

                    // Init
                    // updateStep(); // J√° come√ßa no estado 0 pelo HTML est√°tico
                },
                interactive_combinatorics(container) {
                    // Estado
                    let state = {
                        shirts: 2, // Max 4
                        pants: 3   // Max 4
                    };

                    // Cores
                    const cShirt = "text-brand-blue";
                    const cPants = "text-brand-orange";
                    const bgShirt = "bg-blue-100";
                    const bgPants = "bg-orange-100";

                    // 1. INJE√á√ÉO DO HTML
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col items-center w-full shadow-sm font-sans select-none">
                
                <h3 class="text-brand-text font-bold uppercase text-xs tracking-widest mb-6">Princ√≠pio Fundamental da Contagem</h3>

                <div class="flex flex-col md:flex-row items-center gap-8 w-full justify-center mb-8 bg-gray-50 p-4 rounded-xl border border-gray-200">
                    
                    <div class="flex flex-col items-center gap-2">
                        <span class="text-[10px] font-bold uppercase text-gray-400">Op√ß√µes de Camisetas</span>
                        <div class="flex items-center gap-2">
                            <button id="btn-shirt-minus" class="w-8 h-8 rounded-full bg-white border-2 border-brand-blue text-brand-blue font-bold hover:bg-blue-50">-</button>
                            <span class="text-2xl font-black ${cShirt}" id="val-shirts">2</span>
                            <button id="btn-shirt-plus" class="w-8 h-8 rounded-full bg-brand-blue border-2 border-brand-blue text-white font-bold hover:bg-blue-600 shadow-sm">+</button>
                        </div>
                    </div>

                    <span class="text-2xl font-black text-gray-300">√ó</span>

                    <div class="flex flex-col items-center gap-2">
                        <span class="text-[10px] font-bold uppercase text-gray-400">Op√ß√µes de Cal√ßas</span>
                        <div class="flex items-center gap-2">
                            <button id="btn-pants-minus" class="w-8 h-8 rounded-full bg-white border-2 border-brand-orange text-brand-orange font-bold hover:bg-orange-50">-</button>
                            <span class="text-2xl font-black ${cPants}" id="val-pants">3</span>
                            <button id="btn-pants-plus" class="w-8 h-8 rounded-full bg-brand-orange border-2 border-brand-orange text-white font-bold hover:bg-orange-600 shadow-sm">+</button>
                        </div>
                    </div>

                    <span class="text-2xl font-black text-gray-300">=</span>

                    <div class="flex flex-col items-center">
                        <span class="text-[10px] font-bold uppercase text-gray-400">Combina√ß√µes</span>
                        <span class="text-4xl font-black text-brand-green" id="val-total">6</span>
                    </div>
                </div>

                <div class="w-full overflow-x-auto">
                    <div class="relative min-w-[300px] h-[400px] bg-white border-2 border-dashed border-gray-200 rounded-xl" id="tree-container">
                        <svg id="tree-lines" class="absolute inset-0 w-full h-full pointer-events-none z-0">
                            </svg>
                        
                        <div id="tree-nodes" class="absolute inset-0 w-full h-full z-10"></div>
                    </div>
                </div>
                
                <p class="text-center text-xs text-gray-400 mt-2 italic">Acompanhe as linhas para ver cada look poss√≠vel!</p>
            </div>
        `;

                    // 2. SELETORES
                    const valShirts = container.querySelector('#val-shirts');
                    const valPants = container.querySelector('#val-pants');
                    const valTotal = container.querySelector('#val-total');

                    const treeLines = container.querySelector('#tree-lines');
                    const treeNodes = container.querySelector('#tree-nodes');

                    // 3. FUN√á√ÉO DE DESENHO DA √ÅRVORE
                    const renderTree = () => {
                        treeLines.innerHTML = '';
                        treeNodes.innerHTML = '';

                        const total = state.shirts * state.pants;
                        const containerH = 400;
                        const containerW = treeNodes.offsetWidth || 300;

                        // Configura√ß√£o de Espa√ßamento
                        // Raiz (Voc√™) -> N√≠vel 1 (Camisas) -> N√≠vel 2 (Cal√ßas)
                        const xRoot = 20;
                        const xL1 = containerW * 0.4; // Coluna Camisas
                        const xL2 = containerW * 0.8; // Coluna Cal√ßas

                        // 1. Desenhar N√≥ Raiz (Voc√™)
                        const rootY = containerH / 2;
                        createNode(xRoot, rootY, 'fas fa-user', 'bg-gray-200 text-gray-500', 'Voc√™');

                        // Altura dispon√≠vel para dividir as camisas
                        const shirtGap = containerH / (state.shirts + 1);

                        for (let i = 1; i <= state.shirts; i++) {
                            const shirtY = shirtGap * i;

                            // Linha Raiz -> Camisa
                            createLine(xRoot + 15, rootY, xL1 - 15, shirtY, '#1CB0F6'); // Azul

                            // N√≥ Camisa
                            createNode(xL1, shirtY, 'fas fa-tshirt', 'bg-blue-100 text-brand-blue border-brand-blue', `C${i}`);

                            // Para cada camisa, desenhar as cal√ßas
                            // O espa√ßo das cal√ßas deve ser "local" √† camisa para n√£o cruzar feio
                            // Mas para ficar bonito, distribu√≠mos todas as cal√ßas uniformemente na vertical final
                            // Por√©m, a √°rvore cl√°ssica agrupa por ramo. Vamos agrupar.

                            // Altura dispon√≠vel para este sub-grupo
                            // Vamos calcular a posi√ß√£o Y absoluta de cada folha final para ficar uniforme

                        }

                        // --- Abordagem Melhorada de Layout ---
                        // Vamos iterar sobre o total de folhas (Combina√ß√µes finais) para saber onde colocar as cal√ßas
                        // Cada cal√ßa ocupa um slot vertical final.
                        const slotHeight = containerH / (total + 1); // Altura de cada combina√ß√£o final
                        let currentSlot = 1;

                        for (let i = 1; i <= state.shirts; i++) {
                            // Posi√ß√£o Y da Camisa: M√©dia das posi√ß√µes Y das suas cal√ßas filhas
                            // As cal√ßas dessa camisa v√£o dos slots 'currentSlot' at√© 'currentSlot + pants - 1'

                            const startSlot = currentSlot;
                            const endSlot = currentSlot + state.pants - 1;

                            // Y das cal√ßas
                            const pantsYs = [];
                            for (let p = 0; p < state.pants; p++) {
                                const y = (currentSlot + p) * slotHeight;
                                pantsYs.push(y);
                            }

                            // Y da Camisa (Centro das suas filhas)
                            const shirtY = (pantsYs[0] + pantsYs[pantsYs.length - 1]) / 2;

                            // Desenha Linha Raiz -> Camisa
                            createLine(xRoot + 20, rootY, xL1 - 20, shirtY, '#E5E5E5', 2);

                            // Desenha N√≥ Camisa
                            createNode(xL1, shirtY, 'fas fa-tshirt', 'bg-white border-2 border-brand-blue text-brand-blue z-20', `C${i}`);

                            // Desenha Cal√ßas e Linhas
                            pantsYs.forEach((y, idx) => {
                                // Linha Camisa -> Cal√ßa
                                createLine(xL1 + 20, shirtY, xL2 - 20, y, '#FF9600', 1.5); // Laranja

                                // N√≥ Cal√ßa
                                // Usamos √≠cone de 'bars' ou 'socks' para representar parte de baixo, ou um quadrado
                                // FontAwesome 'fa-running' ou apenas um quadrado colorido
                                const pIndex = idx + 1;

                                // Cria n√≥ da cal√ßa
                                const node = document.createElement('div');
                                node.className = `absolute flex items-center gap-2 transform -translate-x-1/2 -translate-y-1/2 animate-pop-in`;
                                node.style.left = `${xL2}px`;
                                node.style.top = `${y}px`;
                                node.style.animationDelay = `${(i * 0.1) + (idx * 0.05)}s`;

                                node.innerHTML = `
                        <div class="w-8 h-8 rounded-full bg-white border-2 border-brand-orange text-brand-orange flex items-center justify-center shadow-sm z-10">
                            <span class="text-xs font-bold">${pIndex}</span>
                        </div>
                        <span class="text-[10px] font-bold text-gray-400 whitespace-nowrap">Look ${i}-${pIndex}</span>
                    `;
                                treeNodes.appendChild(node);
                            });

                            currentSlot += state.pants;
                        }
                    };

                    // Helpers de SVG e DOM
                    const createLine = (x1, y1, x2, y2, color, width) => {
                        // Curva de B√©zier para ficar elegante
                        // Control points: Metade do caminho em X
                        const cp1x = x1 + (x2 - x1) / 2;
                        const cp2x = x1 + (x2 - x1) / 2;

                        const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
                        const d = `M ${x1} ${y1} C ${cp1x} ${y1}, ${cp2x} ${y2}, ${x2} ${y2}`;

                        path.setAttribute("d", d);
                        path.setAttribute("fill", "none");
                        path.setAttribute("stroke", color);
                        path.setAttribute("stroke-width", width);
                        path.setAttribute("stroke-linecap", "round");
                        treeLines.appendChild(path);
                    };

                    const createNode = (x, y, icon, classes, label) => {
                        const el = document.createElement('div');
                        el.className = `absolute w-10 h-10 rounded-full flex flex-col items-center justify-center shadow-md transform -translate-x-1/2 -translate-y-1/2 ${classes}`;
                        el.style.left = `${x}px`;
                        el.style.top = `${y}px`;
                        el.innerHTML = `<i class="${icon}"></i>`;

                        // Label flutuante
                        if (label) {
                            const lbl = document.createElement('span');
                            lbl.className = "absolute -bottom-4 text-[10px] font-bold text-gray-400 whitespace-nowrap";
                            lbl.innerText = label;
                            el.appendChild(lbl);
                        }
                        treeNodes.appendChild(el);
                    };

                    // 4. L√ìGICA DE ATUALIZA√á√ÉO
                    const update = () => {
                        // Atualiza Textos
                        valShirts.innerText = state.shirts;
                        valPants.innerText = state.pants;
                        valTotal.innerText = state.shirts * state.pants;

                        // Redesenha √Årvore
                        renderTree();
                    };

                    // 5. LISTENERS
                    const limitS = 4;
                    const limitP = 3; // Mantemos baixo para n√£o estourar a tela visualmente (4x3 = 12 ramos)

                    container.querySelector('#btn-shirt-plus').onclick = () => { if (state.shirts < limitS) { state.shirts++; update(); } };
                    container.querySelector('#btn-shirt-minus').onclick = () => { if (state.shirts > 1) { state.shirts--; update(); } };

                    container.querySelector('#btn-pants-plus').onclick = () => { if (state.pants < limitP) { state.pants++; update(); } };
                    container.querySelector('#btn-pants-minus').onclick = () => { if (state.pants > 1) { state.pants--; update(); } };

                    // Init
                    update();
                },

                interactive_bhaskara_steps(container) {
                    // Estado
                    let step = 0;
                    let coeffs = { a: 1, b: -5, c: 6 }; // Exemplo cl√°ssico: x¬≤ - 5x + 6 = 0 (x=2, x=3)

                    // Cores
                    const cA = "text-brand-purple";
                    const cB = "text-brand-blue";
                    const cC = "text-brand-orange";
                    const bgA = "bg-purple-50 border-brand-purple";
                    const bgB = "bg-blue-50 border-brand-blue";
                    const bgC = "bg-orange-50 border-brand-orange";

                    // 1. HTML
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col items-center w-full shadow-sm font-sans select-none">
                
                <h3 class="text-brand-text font-bold uppercase text-xs tracking-widest mb-6">A Receita de Bh√°skara</h3>

                <div class="flex flex-wrap items-center justify-center gap-2 mb-8 bg-gray-50 p-4 rounded-xl border border-gray-200 w-full max-w-lg transition-all duration-500" id="input-area">
                    
                    <div class="flex flex-col items-center">
                        <label class="text-[10px] font-bold text-gray-400 uppercase mb-1">a</label>
                        <input type="number" id="in-a" value="1" class="w-14 text-center border-2 border-gray-300 rounded-lg p-2 font-bold text-xl outline-none focus:${cA.replace('text-', 'border-')} ${cA} transition-colors">
                    </div>
                    <span class="text-xl font-black text-gray-400 mt-4">x¬≤ +</span>

                    <div class="flex flex-col items-center">
                        <label class="text-[10px] font-bold text-gray-400 uppercase mb-1">b</label>
                        <input type="number" id="in-b" value="-5" class="w-14 text-center border-2 border-gray-300 rounded-lg p-2 font-bold text-xl outline-none focus:${cB.replace('text-', 'border-')} ${cB} transition-colors">
                    </div>
                    <span class="text-xl font-black text-gray-400 mt-4">x +</span>

                    <div class="flex flex-col items-center">
                        <label class="text-[10px] font-bold text-gray-400 uppercase mb-1">c</label>
                        <input type="number" id="in-c" value="6" class="w-14 text-center border-2 border-gray-300 rounded-lg p-2 font-bold text-xl outline-none focus:${cC.replace('text-', 'border-')} ${cC} transition-colors">
                    </div>
                    <span class="text-xl font-black text-gray-400 mt-4">= 0</span>

                    <button id="btn-start" class="ml-4 bg-brand-green text-white w-12 h-12 rounded-full shadow-lg hover:scale-110 active:scale-95 transition-all flex items-center justify-center">
                        <i class="fas fa-play"></i>
                    </button>
                </div>

                <div id="steps-display" class="w-full max-w-lg hidden flex-col gap-4">
                    
                    <div class="bg-white border-2 border-brand-text rounded-xl p-6 shadow-md relative overflow-hidden transition-all duration-500" id="card-step">
                        <div class="absolute top-0 left-0 w-2 h-full bg-brand-text" id="step-bar"></div>
                        <div class="pl-4">
                            <h4 class="text-sm font-bold text-gray-400 uppercase mb-2" id="step-title">Passo 1: O Delta</h4>
                            <div class="text-2xl md:text-3xl font-mono font-bold text-brand-text break-words leading-relaxed" id="math-content">
                                </div>
                            <p class="text-sm text-gray-500 mt-4 italic" id="step-desc">Substituindo os valores na f√≥rmula do discriminante.</p>
                        </div>
                    </div>

                    <div class="flex justify-between items-center mt-2">
                        <button id="btn-reset" class="text-gray-400 font-bold text-xs uppercase hover:text-brand-red transition-colors hidden">
                            <i class="fas fa-trash-alt"></i> Mudar Equa√ß√£o
                        </button>
                        <button id="btn-next" class="bg-brand-blue text-white font-bold py-3 px-8 rounded-xl shadow-btn active:shadow-none active:translate-y-1 transition-all flex items-center gap-2 ml-auto">
                            <span>Pr√≥ximo</span> <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>

                </div>
            </div>
        `;

                    // 2. Seletores
                    const inA = container.querySelector('#in-a');
                    const inB = container.querySelector('#in-b');
                    const inC = container.querySelector('#in-c');
                    const btnStart = container.querySelector('#btn-start');
                    const inputArea = container.querySelector('#input-area');

                    const stepsDisplay = container.querySelector('#steps-display');
                    const cardStep = container.querySelector('#card-step');
                    const stepTitle = container.querySelector('#step-title');
                    const mathContent = container.querySelector('#math-content');
                    const stepDesc = container.querySelector('#step-desc');
                    const stepBar = container.querySelector('#step-bar');
                    const btnNext = container.querySelector('#btn-next');
                    const btnReset = container.querySelector('#btn-reset');

                    // 3. L√≥gica
                    let delta = 0;

                    const renderStep = () => {
                        // Garante cores
                        const valA = `<span class="${cA}">${coeffs.a < 0 ? `(${coeffs.a})` : coeffs.a}</span>`;
                        const valB = `<span class="${cB}">${coeffs.b < 0 ? `(${coeffs.b})` : coeffs.b}</span>`;
                        const valC = `<span class="${cC}">${coeffs.c < 0 ? `(${coeffs.c})` : coeffs.c}</span>`;

                        // Vari√°veis limpas para c√°lculo
                        const a = coeffs.a;
                        const b = coeffs.b;
                        const c = coeffs.c;

                        // HTML Din√¢mico
                        if (step === 1) {
                            // CALCULAR DELTA (Substitui√ß√£o)
                            stepBar.className = "absolute top-0 left-0 w-2 h-full bg-brand-yellow";
                            stepTitle.innerText = "1. Calculando o Delta (Œî)";
                            stepTitle.className = "text-sm font-bold text-brand-yellowDark uppercase mb-2";

                            // F√≥rmula: b¬≤ - 4ac
                            mathContent.innerHTML = `
                    <div>Œî = <span class="text-gray-400">b</span>¬≤ - 4<span class="text-gray-400">ac</span></div>
                    <div class="mt-2">Œî = ${valB}¬≤ - 4¬∑${valA}¬∑${valC}</div>
                `;
                            stepDesc.innerText = "Trocamos as letras pelos n√∫meros. Aten√ß√£o aos sinais!";

                            delta = (b * b) - (4 * a * c);
                        }
                        else if (step === 2) {
                            // RESULTADO DELTA
                            stepBar.className = "absolute top-0 left-0 w-2 h-full bg-brand-yellow";

                            const part1 = b * b; // b¬≤
                            const part2 = -4 * a * c; // -4ac
                            const sign = part2 >= 0 ? '+' : ''; // Sinal expl√≠cito

                            mathContent.innerHTML = `
                    <div>Œî = ${part1} ${sign} ${part2}</div>
                    <div class="mt-2 font-black">Œî = ${delta}</div>
                `;

                            if (delta < 0) {
                                stepDesc.innerHTML = `<span class="text-brand-red font-bold"><i class="fas fa-ban"></i> Delta Negativo!</span> N√£o existem ra√≠zes reais. A conta acaba aqui.`;
                                btnNext.innerHTML = `<i class="fas fa-undo"></i> Reiniciar`;
                                btnNext.onclick = reset; // Atalho para reset
                            } else if (delta === 0) {
                                stepDesc.innerHTML = `<span class="text-brand-blue font-bold"><i class="fas fa-equals"></i> Delta Zero!</span> Teremos apenas uma raiz real (ou duas iguais).`;
                            } else {
                                stepDesc.innerHTML = `<span class="text-brand-green font-bold"><i class="fas fa-check"></i> Delta Positivo!</span> Teremos duas ra√≠zes reais diferentes.`;
                            }
                        }
                        else if (step === 3) {
                            // F√ìRMULA DE BHASKARA (Substitui√ß√£o)
                            stepBar.className = "absolute top-0 left-0 w-2 h-full bg-brand-text";
                            stepTitle.innerText = "2. A F√≥rmula Principal";
                            stepTitle.className = "text-sm font-bold text-gray-400 uppercase mb-2";

                            // x = (-b ¬± ‚àöŒî) / 2a
                            // Aten√ß√£o: -b inverte o sinal visualmente
                            const negB = -b;

                            mathContent.innerHTML = `
                    <div class="text-lg text-gray-400 mb-2">x = <span class="border-t border-gray-400 px-1">-b ¬± ‚àöŒî</span> / 2a</div>
                    <div>x = <span class="border-t-2 border-brand-text px-1">${-b} ¬± ‚àö${delta}</span></div>
                    <div class="text-center w-full mt-1">2¬∑${valA}</div>
                `;
                            stepDesc.innerText = `O oposto de b √© ${-b}. A raiz de Delta (${delta}) vamos calcular agora.`;
                        }
                        else if (step === 4) {
                            // CALCULAR RA√çZES
                            stepBar.className = "absolute top-0 left-0 w-2 h-full bg-brand-green";
                            stepTitle.innerText = "3. As Duas Ra√≠zes";
                            stepTitle.className = "text-sm font-bold text-brand-green uppercase mb-2";

                            const sqrtDelta = Math.sqrt(delta);

                            // Verifica se raiz √© exata para visualiza√ß√£o bonita
                            const sqrtDisplay = Number.isInteger(sqrtDelta) ? sqrtDelta : sqrtDelta.toFixed(2);

                            const x1 = (-b + sqrtDelta) / (2 * a);
                            const x2 = (-b - sqrtDelta) / (2 * a);

                            // Formata√ß√£o BR
                            const f = n => Number.isInteger(n) ? n : n.toFixed(2).replace('.', ',');

                            mathContent.innerHTML = `
                    <div class="grid grid-cols-1 gap-4 w-full">
                        <div class="bg-green-50 p-2 rounded border border-green-200">
                            <span class="text-xs font-bold text-green-600 uppercase">Raiz 1 (+)</span>
                            <div>x' = <span class="whitespace-nowrap">(${-b} + ${sqrtDisplay}) / ${2 * a}</span></div>
                            <div class="text-brand-green font-black text-2xl mt-1">x' = ${f(x1)}</div>
                        </div>
                        <div class="bg-green-50 p-2 rounded border border-green-200">
                            <span class="text-xs font-bold text-green-600 uppercase">Raiz 2 (-)</span>
                            <div>x'' = <span class="whitespace-nowrap">(${-b} - ${sqrtDisplay}) / ${2 * a}</span></div>
                            <div class="text-brand-green font-black text-2xl mt-1">x'' = ${f(x2)}</div>
                        </div>
                    </div>
                `;
                            stepDesc.innerText = "Separamos o 'Mais ou Menos' em duas contas. Aqui est√£o as solu√ß√µes!";

                            btnNext.innerHTML = `<i class="fas fa-undo"></i> Nova Conta`;
                        }
                    };

                    const start = () => {
                        coeffs.a = parseFloat(inA.value);
                        coeffs.b = parseFloat(inB.value);
                        coeffs.c = parseFloat(inC.value);

                        if (coeffs.a === 0) {
                            alert("O valor de 'a' n√£o pode ser 0 numa equa√ß√£o do 2¬∫ grau!");
                            return;
                        }

                        // Anima√ß√£o de Entrada
                        inputArea.classList.add('scale-75', 'opacity-50', 'pointer-events-none');
                        stepsDisplay.classList.remove('hidden');
                        stepsDisplay.classList.add('animate-slide-up');
                        btnReset.classList.remove('hidden');

                        step = 1;
                        renderStep();
                    };

                    const reset = () => {
                        step = 0;
                        inputArea.classList.remove('scale-75', 'opacity-50', 'pointer-events-none');
                        stepsDisplay.classList.add('hidden');
                        btnNext.innerHTML = `<span>Pr√≥ximo</span> <i class="fas fa-arrow-right"></i>`;
                        btnNext.onclick = next; // Restaura handler
                    };

                    const next = () => {
                        if (step === 2 && delta < 0) {
                            reset(); // Se delta negativo, bot√£o vira reset
                            return;
                        }
                        if (step < 4) {
                            step++;
                            renderStep();
                        } else {
                            reset(); // Fim
                        }
                    };

                    // 4. Listeners
                    btnStart.onclick = start;
                    btnNext.onclick = next;
                    btnReset.onclick = reset;
                }, interactive_parabola_graph(container) {
                    // Estado Inicial
                    let params = { a: 1, b: 0, c: -4 };

                    // Configura√ß√µes do Gr√°fico
                    const width = 300;
                    const height = 300;
                    const scale = 15; // 1 unidade = 15px (Zoom)
                    const range = 10; // X vai de -10 a 10

                    // 1. HTML
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col items-center w-full shadow-sm font-sans select-none">
                
                <h3 class="text-brand-purple font-bold uppercase text-xs tracking-widest mb-2">Laborat√≥rio de Par√°bolas</h3>

                <div class="bg-gray-50 border border-gray-200 rounded-lg px-6 py-3 mb-6 text-xl md:text-2xl font-mono font-bold text-gray-700 shadow-inner">
                    f(x) = <span class="text-brand-purple" id="disp-a">1</span>x¬≤ + <span class="text-brand-blue" id="disp-b">0</span>x + <span class="text-brand-orange" id="disp-c">-4</span>
                </div>

                <div class="flex flex-col md:flex-row gap-8 w-full items-center justify-center">
                    
                    <div class="relative w-[300px] h-[300px] bg-white rounded-xl border-2 border-gray-200 overflow-hidden shadow-sm cursor-crosshair">
                        <svg id="graph-svg" width="300" height="300" viewBox="0 0 300 300">
                            <defs>
                                <pattern id="grid" width="15" height="15" patternUnits="userSpaceOnUse">
                                    <path d="M 15 0 L 0 0 0 15" fill="none" stroke="rgba(0,0,0,0.05)" stroke-width="1"/>
                                </pattern>
                            </defs>
                            <rect width="100%" height="100%" fill="url(#grid)" />
                            
                            <line x1="0" y1="150" x2="300" y2="150" stroke="#aaa" stroke-width="1" />
                            <line x1="150" y1="0" x2="150" y2="300" stroke="#aaa" stroke-width="1" />

                            <path id="curve" d="" fill="none" stroke="#9B59B6" stroke-width="3" stroke-linecap="round" />

                            <circle id="pt-vertex" r="4" fill="#1CB0F6" stroke="white" stroke-width="2" />
                            <circle id="pt-c" r="4" fill="#FF9600" stroke="white" stroke-width="2" />
                        </svg>
                        
                        <div class="absolute top-2 right-2 flex flex-col items-end gap-1 pointer-events-none">
                            <span class="text-[10px] font-bold text-brand-blue bg-white px-1 rounded shadow border border-blue-100">‚óè V√©rtice</span>
                            <span class="text-[10px] font-bold text-brand-orange bg-white px-1 rounded shadow border border-orange-100">‚óè Corta Y (c)</span>
                        </div>
                    </div>

                    <div class="flex flex-col gap-4 w-full max-w-xs">
                        
                        <div class="bg-purple-50 p-3 rounded-xl border border-purple-100">
                            <div class="flex justify-between text-xs font-bold text-brand-purple uppercase mb-1">
                                <span>Concavidade (a)</span>
                                <span id="val-a">1</span>
                            </div>
                            <input type="range" id="range-a" min="-3" max="3" step="0.1" value="1" class="w-full h-2 bg-purple-200 rounded-lg appearance-none cursor-pointer accent-brand-purple">
                        </div>

                        <div class="bg-blue-50 p-3 rounded-xl border border-blue-100">
                            <div class="flex justify-between text-xs font-bold text-brand-blue uppercase mb-1">
                                <span>Inclina√ß√£o (b)</span>
                                <span id="val-b">0</span>
                            </div>
                            <input type="range" id="range-b" min="-5" max="5" step="0.5" value="0" class="w-full h-2 bg-blue-200 rounded-lg appearance-none cursor-pointer accent-brand-blue">
                        </div>

                        <div class="bg-orange-50 p-3 rounded-xl border border-orange-100">
                            <div class="flex justify-between text-xs font-bold text-brand-orange uppercase mb-1">
                                <span>Altura (c)</span>
                                <span id="val-c">-4</span>
                            </div>
                            <input type="range" id="range-c" min="-8" max="8" step="0.5" value="-4" class="w-full h-2 bg-orange-200 rounded-lg appearance-none cursor-pointer accent-brand-orange">
                        </div>

                        <div class="mt-2 text-xs font-mono text-gray-500 bg-gray-50 p-2 rounded border text-center">
                            <div id="info-vertex">V√©rtice: (0, -4)</div>
                            <div id="info-delta">Œî > 0 (2 Ra√≠zes)</div>
                        </div>
                    </div>
                </div>
            </div>
        `;

                    // 2. Seletores
                    const rA = container.querySelector('#range-a');
                    const rB = container.querySelector('#range-b');
                    const rC = container.querySelector('#range-c');

                    const dispA = container.querySelector('#disp-a');
                    const dispB = container.querySelector('#disp-b');
                    const dispC = container.querySelector('#disp-c');

                    const valA = container.querySelector('#val-a');
                    const valB = container.querySelector('#val-b');
                    const valC = container.querySelector('#val-c');

                    const curve = container.querySelector('#curve');
                    const ptVertex = container.querySelector('#pt-vertex');
                    const ptC = container.querySelector('#pt-c');

                    const infoVertex = container.querySelector('#info-vertex');
                    const infoDelta = container.querySelector('#info-delta');

                    // 3. Sistema de Coordenadas
                    // Transforma (x,y) matem√°tico em (x,y) pixels do SVG
                    const mapX = (x) => 150 + (x * scale);
                    const mapY = (y) => 150 - (y * scale); // Y do SVG √© invertido

                    // 4. L√≥gica de Atualiza√ß√£o
                    const update = () => {
                        // Pega valores
                        let a = parseFloat(rA.value);
                        // Evita a=0 (pois deixaria de ser par√°bola)
                        if (a === 0) { a = 0.1; rA.value = 0.1; }

                        const b = parseFloat(rB.value);
                        const c = parseFloat(rC.value);

                        // Atualiza Textos
                        valA.innerText = a; dispA.innerText = a;
                        valB.innerText = b; dispB.innerText = b >= 0 ? `+ ${b}` : b;
                        valC.innerText = c; dispC.innerText = c >= 0 ? `+ ${c}` : c;

                        // --- DESENHAR CURVA ---
                        // Gera um path SVG iterando X de -10 a 10
                        let d = "";
                        for (let x = -range; x <= range; x += 0.2) {
                            const y = (a * x * x) + (b * x) + c;

                            // Mapeia para pixels
                            const px = mapX(x);
                            const py = mapY(y);

                            // Evita desenhar muito fora do canvas (otimiza√ß√£o)
                            if (py > -100 && py < 400) {
                                d += d === "" ? `M ${px} ${py}` : ` L ${px} ${py}`;
                            }
                        }
                        curve.setAttribute('d', d);

                        // --- PONTOS NOT√ÅVEIS ---

                        // 1. V√©rtice (xv = -b/2a)
                        const xv = -b / (2 * a);
                        const yv = (a * xv * xv) + (b * xv) + c;

                        ptVertex.setAttribute('cx', mapX(xv));
                        ptVertex.setAttribute('cy', mapY(yv));
                        infoVertex.innerText = `V√©rtice: (${xv.toFixed(1)}, ${yv.toFixed(1)})`;

                        // 2. Intercepto Y (0, c)
                        ptC.setAttribute('cx', mapX(0));
                        ptC.setAttribute('cy', mapY(c));

                        // 3. Delta e Ra√≠zes
                        const delta = (b * b) - (4 * a * c);
                        if (delta > 0) {
                            infoDelta.innerText = `Œî = ${delta.toFixed(1)} (2 Ra√≠zes Reais)`;
                            infoDelta.className = "text-brand-green font-bold";
                        } else if (delta === 0) {
                            infoDelta.innerText = `Œî = 0 (1 Raiz Real)`;
                            infoDelta.className = "text-brand-blue font-bold";
                        } else {
                            infoDelta.innerText = `Œî = ${delta.toFixed(1)} (Sem Ra√≠zes Reais)`;
                            infoDelta.className = "text-brand-red font-bold";
                        }
                    };

                    // 5. Listeners
                    [rA, rB, rC].forEach(el => el.addEventListener('input', update));

                    // Init
                    update();
                }, interactive_pythagoras_calc(container) {
                    // Estado inicial (Terno Pitag√≥rico 3-4-5)
                    let state = {
                        a: 3, // Cateto Vertical
                        b: 4  // Cateto Horizontal
                    };

                    // Cores
                    const cA = "text-brand-purple";
                    const cB = "text-brand-blue";
                    const cC = "text-brand-orange"; // Hipotenusa
                    const strokeA = "stroke-brand-purple";
                    const strokeB = "stroke-brand-blue";
                    const strokeC = "stroke-brand-orange";

                    // 1. HTML
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col items-center w-full shadow-sm font-sans select-none">
                
                <h3 class="text-brand-text font-bold uppercase text-xs tracking-widest mb-6">O Teorema de Pit√°goras</h3>

                <div class="flex flex-col md:flex-row items-center gap-8 w-full justify-center">
                    
                    <div class="relative w-64 h-64 bg-gray-50 rounded-xl border border-gray-200 shadow-inner flex items-center justify-center overflow-hidden">
                        <svg id="pythagoras-svg" width="240" height="240" viewBox="0 0 240 240">
                            <defs>
                                <pattern id="grid-p" width="20" height="20" patternUnits="userSpaceOnUse">
                                    <path d="M 20 0 L 0 0 0 20" fill="none" stroke="rgba(0,0,0,0.05)" stroke-width="1"/>
                                </pattern>
                            </defs>
                            <rect width="100%" height="100%" fill="url(#grid-p)" />

                            <path id="tri-path" fill="rgba(255, 150, 0, 0.1)" stroke-width="3" stroke-linejoin="round" />
                            
                            <line id="line-a" stroke-width="4" class="${strokeA}" stroke-linecap="round" />
                            <line id="line-b" stroke-width="4" class="${strokeB}" stroke-linecap="round" />
                            <line id="line-c" stroke-width="4" class="${strokeC}" stroke-linecap="round" />

                            <rect id="right-angle" width="15" height="15" fill="none" stroke="#aaa" stroke-width="2" />

                            <text id="lbl-a" class="text-sm font-bold fill-brand-purple" text-anchor="end" dominant-baseline="middle">a</text>
                            <text id="lbl-b" class="text-sm font-bold fill-brand-blue" text-anchor="middle" dominant-baseline="hanging">b</text>
                            <text id="lbl-c" class="text-sm font-bold fill-brand-orange" text-anchor="middle" dominant-baseline="middle">c</text>
                        </svg>
                    </div>

                    <div class="flex flex-col gap-6 w-full max-w-xs">
                        
                        <div class="space-y-4">
                            <div>
                                <div class="flex justify-between text-xs font-bold uppercase mb-1">
                                    <span class="${cA}">Cateto a (Altura)</span>
                                    <span id="val-a" class="font-mono text-lg ${cA}">3</span>
                                </div>
                                <input type="range" id="range-a" min="1" max="8" value="3" class="w-full h-2 bg-purple-100 rounded-lg appearance-none cursor-pointer accent-brand-purple">
                            </div>
                            
                            <div>
                                <div class="flex justify-between text-xs font-bold uppercase mb-1">
                                    <span class="${cB}">Cateto b (Base)</span>
                                    <span id="val-b" class="font-mono text-lg ${cB}">4</span>
                                </div>
                                <input type="range" id="range-b" min="1" max="8" value="4" class="w-full h-2 bg-blue-100 rounded-lg appearance-none cursor-pointer accent-brand-blue">
                            </div>
                        </div>

                        <div class="bg-gray-50 border-2 border-gray-100 rounded-xl p-4">
                            <div class="text-center font-mono text-lg font-bold text-gray-400 mb-2">
                                <span class="${cA}">a¬≤</span> + <span class="${cB}">b¬≤</span> = <span class="${cC}">c¬≤</span>
                            </div>
                            
                            <div class="flex justify-center items-center gap-2 font-mono text-sm md:text-base font-bold mb-2">
                                <div class="flex flex-col items-center">
                                    <span class="${cA}" id="calc-a2">3¬≤</span>
                                    <span class="text-xs text-gray-400" id="res-a2">9</span>
                                </div>
                                <span class="text-gray-400">+</span>
                                <div class="flex flex-col items-center">
                                    <span class="${cB}" id="calc-b2">4¬≤</span>
                                    <span class="text-xs text-gray-400" id="res-b2">16</span>
                                </div>
                                <span class="text-gray-400">=</span>
                                <div class="flex flex-col items-center">
                                    <span class="${cC}">c¬≤</span>
                                    <span class="text-xs text-brand-orange" id="res-c2">25</span>
                                </div>
                            </div>

                            <div class="w-full h-px bg-gray-200 my-2"></div>

                            <div class="flex justify-between items-center">
                                <span class="text-xs font-bold text-gray-400 uppercase">Hipotenusa (c)</span>
                                <div class="text-2xl font-black text-brand-orange">
                                    <span class="text-sm text-gray-400 font-normal mr-1">‚àö<span id="root-val">25</span> = </span>
                                    <span id="final-c">5</span>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        `;

                    // 2. Seletores
                    const rA = container.querySelector('#range-a');
                    const rB = container.querySelector('#range-b');
                    const vA = container.querySelector('#val-a');
                    const vB = container.querySelector('#val-b');

                    // SVG
                    const lineA = container.querySelector('#line-a');
                    const lineB = container.querySelector('#line-b');
                    const lineC = container.querySelector('#line-c');
                    const rightAngle = container.querySelector('#right-angle');
                    const lblA = container.querySelector('#lbl-a');
                    const lblB = container.querySelector('#lbl-b');
                    const lblC = container.querySelector('#lbl-c');

                    // Calc Elements
                    const calcA2 = container.querySelector('#calc-a2');
                    const resA2 = container.querySelector('#res-a2');
                    const calcB2 = container.querySelector('#calc-b2');
                    const resB2 = container.querySelector('#res-b2');
                    const resC2 = container.querySelector('#res-c2');
                    const rootVal = container.querySelector('#root-val');
                    const finalC = container.querySelector('#final-c');

                    // 3. Atualiza√ß√£o
                    const update = () => {
                        const a = parseInt(rA.value);
                        const b = parseInt(rB.value);

                        // Inputs UI
                        vA.innerText = a;
                        vB.innerText = b;

                        // C√°lculos
                        const a2 = a * a;
                        const b2 = b * b;
                        const c2 = a2 + b2;
                        const c = Math.sqrt(c2);

                        // Math UI
                        calcA2.innerText = `${a}¬≤`;
                        resA2.innerText = a2;
                        calcB2.innerText = `${b}¬≤`;
                        resB2.innerText = b2;
                        resC2.innerText = c2;
                        rootVal.innerText = c2;

                        // Se for inteiro, mostra inteiro. Se n√£o, mostra 2 casas decimais.
                        finalC.innerText = Number.isInteger(c) ? c : c.toFixed(2).replace('.', ',');

                        // SVG Logic
                        // Origem do √¢ngulo reto: (40, 200) - canto inferior esquerdo com margem
                        // O SVG tem 240x240.
                        // Escala: 1 unidade = 20px
                        const scale = 20;
                        const originX = 40;
                        const originY = 200;

                        const xTop = originX;
                        const yTop = originY - (a * scale); // Y cresce pra baixo
                        const xRight = originX + (b * scale);
                        const yRight = originY;

                        // Desenha Linhas
                        // A (Vertical)
                        lineA.setAttribute('x1', originX);
                        lineA.setAttribute('y1', originY);
                        lineA.setAttribute('x2', xTop);
                        lineA.setAttribute('y2', yTop);

                        // B (Horizontal)
                        lineB.setAttribute('x1', originX);
                        lineB.setAttribute('y1', originY);
                        lineB.setAttribute('x2', xRight);
                        lineB.setAttribute('y2', yRight);

                        // C (Diagonal)
                        lineC.setAttribute('x1', xTop);
                        lineC.setAttribute('y1', yTop);
                        lineC.setAttribute('x2', xRight);
                        lineC.setAttribute('y2', yRight);

                        // Marca do √Çngulo Reto
                        rightAngle.setAttribute('x', originX);
                        rightAngle.setAttribute('y', originY - 15);

                        // Labels
                        lblA.setAttribute('x', originX - 10);
                        lblA.setAttribute('y', originY - (a * scale) / 2);
                        lblA.textContent = a;

                        lblB.setAttribute('x', originX + (b * scale) / 2);
                        lblB.setAttribute('y', originY + 20);
                        lblB.textContent = b;

                        // Label C (Posicionado no meio da hipotenusa, levemente deslocado)
                        const midX = (xTop + xRight) / 2;
                        const midY = (yTop + yRight) / 2;
                        lblC.setAttribute('x', midX + 15);
                        lblC.setAttribute('y', midY - 15);
                        lblC.textContent = Number.isInteger(c) ? c : c.toFixed(1);
                    };

                    // 4. Listeners
                    rA.addEventListener('input', update);
                    rB.addEventListener('input', update);

                    // Init
                    update();
                }, interactive_trig_calc(container) {
                    // Estado
                    let angle = 30;
                    const radius = 180; // Tamanho visual da hipotenusa em px
                    const origin = { x: 40, y: 220 }; // Canto inferior esquerdo do SVG

                    // 1. HTML
                    container.innerHTML = `
            <div class="bg-white border-2 border-brand-gray rounded-xl p-6 flex flex-col items-center w-full shadow-sm font-sans select-none">
                
                <h3 class="text-brand-text font-bold uppercase text-xs tracking-widest mb-6">Trigonometria: SOH CAH TOA</h3>

                <div class="flex flex-col md:flex-row gap-8 w-full justify-center items-center">
                    
                    <div class="relative bg-gray-50 border border-gray-200 rounded-xl shadow-inner p-4">
                        <svg id="trig-svg" width="260" height="240" viewBox="0 0 260 240" class="overflow-visible">
                            
                            <path id="arc-angle" fill="rgba(75, 75, 75, 0.1)" stroke="none" />
                            <text id="lbl-angle" x="60" y="210" class="text-xs font-bold fill-gray-500">30¬∞</text>

                            <line id="line-adj" x1="40" y1="220" x2="200" y2="220" stroke="#1CB0F6" stroke-width="4" stroke-linecap="round" />
                            
                            <line id="line-opp" x1="200" y1="220" x2="200" y2="100" stroke="#FF4B4B" stroke-width="4" stroke-linecap="round" />
                            
                            <line id="line-hyp" x1="40" y1="220" x2="200" y2="100" stroke="#58CC02" stroke-width="4" stroke-linecap="round" />

                            <rect id="rect-90" x="185" y="205" width="15" height="15" fill="none" stroke="#aaa" stroke-width="2" />

                            <text id="lbl-hyp" class="text-xs font-bold fill-brand-green" text-anchor="middle">H</text>
                            <text id="lbl-opp" class="text-xs font-bold fill-brand-red" text-anchor="start" dominant-baseline="middle">O</text>
                            <text id="lbl-adj" class="text-xs font-bold fill-brand-blue" text-anchor="middle" dominant-baseline="hanging" dy="8">A</text>

                        </svg>
                    </div>

                    <div class="flex flex-col gap-6 w-full max-w-xs">
                        
                        <div>
                            <div class="flex justify-between text-xs font-bold uppercase mb-2">
                                <span class="text-gray-400">√Çngulo (Œ∏)</span>
                                <span class="text-brand-text text-lg" id="val-angle">30¬∞</span>
                            </div>
                            <input type="range" id="range-angle" min="0" max="89" value="30" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-brand-text">
                        </div>

                        <div class="flex flex-col gap-2">
                            
                            <div class="bg-red-50 border border-red-200 rounded-lg p-3 flex justify-between items-center">
                                <div class="flex flex-col">
                                    <span class="text-[10px] font-bold text-red-400 uppercase tracking-widest">SENO (SOH)</span>
                                    <span class="text-xs font-mono text-red-800">Oposto / Hip.</span>
                                </div>
                                <div class="text-2xl font-black text-brand-red" id="val-sin">0,50</div>
                            </div>

                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 flex justify-between items-center">
                                <div class="flex flex-col">
                                    <span class="text-[10px] font-bold text-blue-400 uppercase tracking-widest">COSSENO (CAH)</span>
                                    <span class="text-xs font-mono text-blue-800">Adj. / Hip.</span>
                                </div>
                                <div class="text-2xl font-black text-brand-blue" id="val-cos">0,87</div>
                            </div>

                            <div class="bg-gray-50 border border-gray-200 rounded-lg p-3 flex justify-between items-center">
                                <div class="flex flex-col">
                                    <span class="text-[10px] font-bold text-gray-400 uppercase tracking-widest">TANGENTE (TOA)</span>
                                    <span class="text-xs font-mono text-gray-600">Oposto / Adj.</span>
                                </div>
                                <div class="text-2xl font-black text-brand-text" id="val-tan">0,58</div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        `;

                    // 2. SELETORES
                    const rangeAngle = container.querySelector('#range-angle');
                    const valAngle = container.querySelector('#val-angle');
                    const valSin = container.querySelector('#val-sin');
                    const valCos = container.querySelector('#val-cos');
                    const valTan = container.querySelector('#val-tan');

                    // SVG Elements
                    const lineAdj = container.querySelector('#line-adj');
                    const lineOpp = container.querySelector('#line-opp');
                    const lineHyp = container.querySelector('#line-hyp');
                    const rect90 = container.querySelector('#rect-90');
                    const arcAngle = container.querySelector('#arc-angle');
                    const lblAngle = container.querySelector('#lbl-angle');

                    const lblHyp = container.querySelector('#lbl-hyp');
                    const lblOpp = container.querySelector('#lbl-opp');
                    const lblAdj = container.querySelector('#lbl-adj');

                    // 3. ATUALIZA√á√ÉO
                    const update = () => {
                        let deg = parseInt(rangeAngle.value);
                        // Evita 0 e 90 exatos para n√£o colapsar o tri√¢ngulo totalmente (UX melhor)
                        if (deg < 1) deg = 1;
                        if (deg > 89) deg = 89;

                        valAngle.innerText = `${deg}¬∞`;

                        // Converter para radianos
                        const rad = deg * (Math.PI / 180);

                        // C√°lculos Trigonom√©tricos
                        const sin = Math.sin(rad);
                        const cos = Math.cos(rad);
                        const tan = Math.tan(rad);

                        // Coordenadas do V√©rtice Superior
                        // Y no SVG cresce para baixo, ent√£o subtra√≠mos da origem Y
                        const x = origin.x + (radius * cos);
                        const y = origin.y - (radius * sin);

                        // --- DESENHO SVG ---

                        // Adjacente (Base: Origem at√© X)
                        lineAdj.setAttribute('x1', origin.x);
                        lineAdj.setAttribute('y1', origin.y);
                        lineAdj.setAttribute('x2', x);
                        lineAdj.setAttribute('y2', origin.y);

                        // Oposto (Altura: X at√© Topo)
                        lineOpp.setAttribute('x1', x);
                        lineOpp.setAttribute('y1', origin.y);
                        lineOpp.setAttribute('x2', x);
                        lineOpp.setAttribute('y2', y);

                        // Hipotenusa (Origem at√© Topo)
                        lineHyp.setAttribute('x1', origin.x);
                        lineHyp.setAttribute('y1', origin.y);
                        lineHyp.setAttribute('x2', x);
                        lineHyp.setAttribute('y2', y);

                        // Marca de 90 graus (segue o v√©rtice reto)
                        const boxS = 15;
                        rect90.setAttribute('x', x - boxS);
                        rect90.setAttribute('y', origin.y - boxS);

                        // Arco do √Çngulo (Path)
                        const arcR = 40;
                        // Comando SVG Arc: A rx ry rot large-arc sweep x y
                        // Linha at√© borda, arco at√© (arcX, arcY), fecha
                        const arcX = origin.x + (arcR * Math.cos(-rad)); // SVG Y invertido
                        const arcY = origin.y + (arcR * Math.sin(-rad));

                        const d = `M ${origin.x + arcR} ${origin.y} A ${arcR} ${arcR} 0 0 0 ${arcX} ${arcY} L ${origin.x} ${origin.y}`;
                        arcAngle.setAttribute('d', d);
                        lblAngle.innerText = `${deg}¬∞`;

                        // Labels de Lado (Posicionamento)
                        lblAdj.setAttribute('x', origin.x + (x - origin.x) / 2);
                        lblAdj.setAttribute('y', origin.y);

                        lblOpp.setAttribute('x', x + 5);
                        lblOpp.setAttribute('y', origin.y - (origin.y - y) / 2);

                        lblHyp.setAttribute('x', origin.x + (x - origin.x) / 2 - 10);
                        lblHyp.setAttribute('y', origin.y - (origin.y - y) / 2 - 10);


                        // --- VALORES NUM√âRICOS ---
                        valSin.innerText = sin.toFixed(2).replace('.', ',');
                        valCos.innerText = cos.toFixed(2).replace('.', ',');
                        valTan.innerText = tan.toFixed(2).replace('.', ',');
                    };

                    // 4. LISTENERS
                    rangeAngle.addEventListener('input', update);

                    // Init
                    update();
                },







                interactive_thermometer(div) {
                    div.innerHTML = `
                        <div class="flex items-center justify-center gap-8 bg-white border-2 border-gray-200 rounded-3xl p-8">
                            <div class="relative w-8 h-48 bg-gray-200 rounded-full border-2 border-gray-300 overflow-hidden">
                                <div id="merc" class="absolute bottom-0 w-full transition-all duration-300 bg-brand-purple" style="height: 50%"></div>
                                <div class="absolute top-1/2 w-full h-0.5 bg-black opacity-20"></div>
                            </div>
                            <div class="flex flex-col items-center gap-4">
                                <input type="range" min="-50" max="50" value="0" class="thermometer-slider" oninput="app.widgets.updateThermo(this)">
                                <div id="temp-val" class="text-3xl font-extrabold text-brand-purple">0¬∞</div>
                            </div>
                        </div>`;
                    app.widgets.updateThermo = (el) => {
                        const val = parseInt(el.value);
                        const merc = el.parentElement.previousElementSibling.querySelector('#merc');
                        const label = el.nextElementSibling;
                        const h = val + 50;
                        merc.style.height = `${h}%`;
                        label.innerText = `${val}¬∞`;
                        label.className = val < 0 ? "text-3xl font-extrabold text-brand-blue" : (val > 0 ? "text-3xl font-extrabold text-brand-red" : "text-3xl font-extrabold text-brand-purple");
                        merc.style.backgroundColor = val < 0 ? '#1CB0F6' : (val > 0 ? '#FF4B4B' : '#9B59B6');
                    };
                },
                interactive_cartesian_plane(c) {
                    c.innerHTML = '<canvas id="cartesianCanvas"></canvas>';
                    new Chart(c.querySelector('canvas'), { type: 'scatter', data: { datasets: [{ label: 'Ponto P(2, -3)', data: [{ x: 2, y: -3 }], backgroundColor: '#58CC02', pointRadius: 8 }] }, options: { scales: { x: { min: -5, max: 5 }, y: { min: -5, max: 5 } } } });
                },
                // Adicione os outros widgets placeholders se necess√°rio, mas esses s√£o os principais funcionais.
                createStepSolver(container, steps) {
                    let current = 0;
                    container.innerHTML = `<div class="bg-brand-bg border-2 border-brand-gray rounded-3xl p-6 w-full"><div class="step-list space-y-3 font-mono text-lg mb-6 min-h-[60px]"></div><button class="btn-step w-full bg-brand-yellow hover:bg-brand-yellowDark text-brand-text font-extrabold px-8 py-4 rounded-2xl shadow-btn btn-game flex items-center justify-center gap-2 text-lg"><span>Iniciar</span> <i class="fas fa-play"></i></button></div>`;
                    const list = container.querySelector('.step-list'), btn = container.querySelector('.btn-step');
                    const renderNext = () => {
                        if (current === 0) { list.innerHTML = ''; btn.innerHTML = `<span>Pr√≥ximo Passo</span> <i class="fas fa-arrow-down"></i>`; addStepHTML(0); current = 1; }
                        else if (current < steps.length) { addStepHTML(current); current++; if (current === steps.length) { btn.innerHTML = `<span>Reiniciar</span> <i class="fas fa-rotate-right"></i>`; btn.classList.replace('bg-brand-yellow', 'bg-brand-green'); btn.classList.replace('text-brand-text', 'text-white'); } }
                        else { current = 0; btn.classList.replace('bg-brand-green', 'bg-brand-yellow'); btn.classList.replace('text-white', 'text-brand-text'); renderNext(); }
                    };
                    const addStepHTML = (index) => {
                        const step = steps[index];
                        const div = document.createElement('div');
                        div.className = `flex flex-col md:flex-row md:items-center justify-between p-4 bg-white rounded-xl border-l-4 ${index === 0 ? 'border-gray-300' : 'border-brand-green'} shadow-sm fade-in`;
                        div.innerHTML = `<div class="text-brand-text font-black text-xl">$$${step.latex}$$</div><div class="text-xs font-bold text-brand-green uppercase tracking-wide mt-2 md:mt-0 bg-gray-50 px-2 py-1 rounded">${step.text}</div>`;
                        list.appendChild(div);
                        renderMathInElement(div, { delimiters: [{ left: "$$", right: "$$", display: false }] });
                    };
                    btn.onclick = renderNext;
                    list.innerHTML = `<div class="p-4 text-center text-gray-400 font-bold italic">Clique em Iniciar</div>`;
                }
            }
        };

        app.init();
    </script>
</body>

</html>